<!doctype html>
<html class="theme-next use-motion theme-next-mist">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="baidu-site-verification" content="EYxran2Vav" />

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />








  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>




<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.5.1"/>


    <meta name="description" content="相信自己做一个自信的人" />



  <meta name="keywords" content="SpringMVC集成Graphql,Graphql中集成MongoDB" />



  <link rel="alternate" href="/atom.xml" title="I am TKing" type="application/atom+xml" />



  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.1" />


<meta name="description" content="Graphql是一种API的查询语言,由Facebook开源，旨在替代Restful,最近公司刚好有使用就研究了一下，顺便总结出来">
<meta property="og:type" content="article">
<meta property="og:title" content="Graphql在项目中的使用">
<meta property="og:url" content="http://yoursite.com/2018/09/27/how-to-use-graphql/index.html">
<meta property="og:site_name" content="I am TKing">
<meta property="og:description" content="Graphql是一种API的查询语言,由Facebook开源，旨在替代Restful,最近公司刚好有使用就研究了一下，顺便总结出来">
<meta property="og:image" content="http://yoursite.com/images/graphql-postman-get.png">
<meta property="og:image" content="http://yoursite.com/images/graphql-test-background.png">
<meta property="og:updated_time" content="2018-10-28T13:11:18.377Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Graphql在项目中的使用">
<meta name="twitter:description" content="Graphql是一种API的查询语言,由Facebook开源，旨在替代Restful,最近公司刚好有使用就研究了一下，顺便总结出来">


<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mist',
    sidebar: 'post'
  };
</script>
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  <title> Graphql在项目中的使用 | I am TKing </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  



  <div class="container one-column page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand" rel="start">
      <span class="logo">
        <i class="icon-next-logo"></i>
      </span>
      <span class="site-title">I am TKing</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            <i class="menu-item-icon icon-next-home"></i> <br />
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            <i class="menu-item-icon icon-next-categories"></i> <br />
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            <i class="menu-item-icon icon-next-about"></i> <br />
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            <i class="menu-item-icon icon-next-archives"></i> <br />
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            <i class="menu-item-icon icon-next-commonweal"></i> <br />
            公益404
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            <i class="menu-item-icon icon-next-tags"></i> <br />
            标签
          </a>
        </li>
      

      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content"> 

  <div id="posts" class="posts-expand">
    

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              Graphql在项目中的使用
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2018-09-27T21:59:04+08:00" content="2018-09-27">
            2018-09-27
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/Graphql/" itemprop="url" rel="index">
                  <span itemprop="name">Graphql</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
        
        
        
           <span class="post-comments-count">
            <span id="busuanzi_container_page_pv">
              &nbsp; | &nbsp;<span id="busuanzi_value_page_pv"></span>次阅读
            </span>
          </span>
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        <span itemprop="articleBody"><h3 id="&#x4EC0;&#x4E48;&#x662F;graphql">&#x4EC0;&#x4E48;&#x662F;GraphQL</h3>
<p>GraphQL &#x662F;&#x4E00;&#x79CD;&#x7528;&#x4E8E; API &#x7684;&#x67E5;&#x8BE2;&#x8BED;&#x8A00;&#x3002; GraphQL &#x5BF9;&#x4F60;&#x7684; API &#x4E2D;&#x7684;&#x6570;&#x636E;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x5957;&#x6613;&#x4E8E;&#x7406;&#x89E3;&#x7684;&#x5B8C;&#x6574;&#x63CF;&#x8FF0;&#xFF0C;&#x4F7F;&#x5F97;&#x5BA2;&#x6237;&#x7AEF;&#x80FD;&#x591F;&#x51C6;&#x786E;&#x5730;&#x83B7;&#x5F97;&#x5B83;&#x9700;&#x8981;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x800C;&#x4E14;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x5197;&#x4F59;&#xFF0C;&#x4E5F;&#x8BA9; API &#x66F4;&#x5BB9;&#x6613;&#x5730;&#x968F;&#x7740;&#x65F6;&#x95F4;&#x63A8;&#x79FB;&#x800C;&#x6F14;&#x8FDB;&#xFF0C;&#x8FD8;&#x80FD;&#x7528;&#x4E8E;&#x6784;&#x5EFA;&#x5F3A;&#x5927;&#x7684;&#x5F00;&#x53D1;&#x8005;&#x5DE5;&#x5177;&#x3002;GraphQL &#x67E5;&#x8BE2;&#x4E0D;&#x4EC5;&#x80FD;&#x591F;&#x83B7;&#x5F97;&#x8D44;&#x6E90;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x8FD8;&#x80FD;&#x6CBF;&#x7740;&#x8D44;&#x6E90;&#x95F4;&#x5F15;&#x7528;&#x8FDB;&#x4E00;&#x6B65;&#x67E5;&#x8BE2;&#x3002;&#x5178;&#x578B;&#x7684; REST API &#x8BF7;&#x6C42;&#x591A;&#x4E2A;&#x8D44;&#x6E90;&#x65F6;&#x5F97;&#x8F7D;&#x5165;&#x591A;&#x4E2A; URL&#xFF0C;&#x800C; GraphQL &#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E00;&#x6B21;&#x8BF7;&#x6C42;&#x5C31;&#x83B7;&#x53D6;&#x4F60;&#x5E94;&#x7528;&#x6240;&#x9700;&#x7684;&#x6240;&#x6709;&#x6570;&#x636E;&#x3002;GraphQL API &#x57FA;&#x4E8E;&#x7C7B;&#x578B;&#x548C;&#x5B57;&#x6BB5;&#x7684;&#x65B9;&#x5F0F;&#x8FDB;&#x884C;&#x7EC4;&#x7EC7;&#xFF0C;&#x800C;&#x975E;&#x5165;&#x53E3;&#x7AEF;&#x70B9;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x5355;&#x4E00;&#x5165;&#x53E3;&#x7AEF;&#x70B9;&#x5F97;&#x5230;&#x4F60;&#x6240;&#x6709;&#x7684;&#x6570;&#x636E;&#x80FD;&#x529B;&#x3002;</p>
<p>Facebook &#x7684;&#x79FB;&#x52A8;&#x5E94;&#x7528;&#x4ECE; 2012 &#x5E74;&#x5C31;&#x5F00;&#x59CB;&#x4F7F;&#x7528; GraphQL&#x3002;GraphQL &#x89C4;&#x8303;&#x4E8E; 2015 &#x5E74;&#x5F00;&#x6E90;&#xFF0C;&#x73B0;&#x5DF2;&#x7ECF;&#x5728;&#x591A;&#x79CD;&#x73AF;&#x5883;&#x4E0B;&#x53EF;&#x7528;&#xFF0C;&#x5E76;&#x88AB;&#x5404;&#x79CD;&#x4F53;&#x91CF;&#x7684;&#x56E2;&#x961F;&#x6240;&#x4F7F;&#x7528;&#x3002;</p>
<h3 id="&#x6700;&#x597D;&#x7684;&#x5165;&#x95E8;&#x6587;&#x6863;">&#x6700;&#x597D;&#x7684;&#x5165;&#x95E8;&#x6587;&#x6863;</h3>
<p>&#x6700;&#x597D;&#x7684;&#x6587;&#x6863;&#x5F53;&#x7136;&#x662F;<a href="https://www.howtographql.com/graphql-java/1-getting-started/" target="_blank" rel="external">&#x5B98;&#x65B9;&#x6587;&#x6863;</a></p>
<h3 id="springmvc&#x96C6;&#x6210;graphql">SpringMVC&#x96C6;&#x6210;GraphQL</h3>
<h4 id="&#x5F15;&#x5165;java&#x5305;">&#x5F15;&#x5165;Java&#x5305;</h4>
<p>&#x8FD9;&#x91CC;&#x4E3A;&#x4E86;&#x5C3D;&#x91CF;&#x7684;&#x5C55;&#x793A;&#x6574;&#x4E2A;&#x96C6;&#x6210;&#x6D41;&#x7A0B;&#xFF0C;&#x6240;&#x4EE5;&#x4F1A;&#x4F7F;&#x7528;SpringBoot&#x6765;&#x8FDB;&#x884C;&#x6574;&#x4F53;&#x6846;&#x67B6;&#x642D;&#x5EFA;&#x3002;&#x4F46;&#x662F;&#x4F1A;&#x5C06;&#x66F4;&#x591A;&#x7684;&#x6D41;&#x7A0B;&#x805A;&#x7126;&#x5728;GraphQL&#x4E2D;&#x3002;&#x6240;&#x4EE5;&#x7B2C;&#x4E00;&#x6B65;&#x662F;&#x5F15;&#x5165;GraphQL&#x7684;jar&#x5305;&#xFF0C;&#x5173;&#x4E8E;SpringBoot&#x7684;&#x642D;&#x5EFA;,&#x53EF;&#x4EE5;&#x501F;&#x52A9;<a href="http://start.spring.io/" target="_blank" rel="external">http://start.spring.io/</a>&#x6765;&#x5FEB;&#x901F;&#x642D;&#x5EFA;&#x3002;&#x8FD9;&#x91CC;&#x4E0D;&#x505A;&#x8FC7;&#x591A;&#x53D9;&#x8FF0;&#x3002;</p>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-boot-starter-data-mongodb<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="title">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="title">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">version</span>&gt;</span>3.0.1<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="title">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--&#x96C6;&#x6210;GraphQL--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>com.graphql-java<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>graphql-java<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">version</span>&gt;</span>9.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>com.graphql-java<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>graphql-java-tools<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">version</span>&gt;</span>5.2.3<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>com.graphql-java<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>graphql-java-servlet<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">version</span>&gt;</span>5.2.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="title">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="&#x5F00;&#x59CB;&#x5F00;&#x53D1;">&#x5F00;&#x59CB;&#x5F00;&#x53D1;</h3>
<p>&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x8003;&#x8651;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x5177;&#x4F53;&#x7684;&#x573A;&#x666F;,&#x5C31;&#x4EE5;&#x4E8C;&#x624B;&#x4E66;&#x7F51;&#x7AD9;&#x5356;&#x4E66;&#x4E3E;&#x4F8B;&#x597D;&#x4E86;&#x3002;&#x5728;GraphQL&#x4E2D;&#x67E5;&#x8BE2;&#x548C;&#x4FEE;&#x6539;(&#x589E;&#x52A0;,&#x5220;&#x9664;,&#x66F4;&#x65B0;)&#x90FD;&#x662F;&#x5206;&#x522B;&#x5BF9;&#x5E94;Query&#x548C;Mutation.GraphQL&#x652F;&#x6301;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x53EA;&#x6709;Int(Java&#x4E2D;&#x7684;Integer),Float,String,Enum&#x4EE5;&#x53CA;Type(&#x76F8;&#x5F53;&#x4E8E;Java&#x4E2D;&#x7684;Class),&#x6240;&#x4EE5;&#x5BF9;&#x4E8E;&#x5176;&#x4ED6;&#x4E0D;&#x652F;&#x6301;&#x7684;&#x7C7B;&#x578B;&#x9700;&#x8981;&#x4F7F;&#x7528;scalars&#x81EA;&#x5B9A;&#x4E49;&#x3002;</p>
<h4 id="&#x5B9A;&#x4E49;&#x63A5;&#x53E3;&#x63CF;&#x8FF0;schemagraphqls">&#x5B9A;&#x4E49;&#x63A5;&#x53E3;&#x63CF;&#x8FF0;(schema.graphqls)</h4>
<p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="typedef"><span class="keyword">type</span> <span class="type">Book</span> <span class="container">{</span><br><span class="line">    <span class="title">id</span>: <span class="type">Long</span></span><br><span class="line">    <span class="title">name</span>: <span class="type">String</span></span><br><span class="line">    <span class="title">url</span>: <span class="type">String</span></span><br><span class="line">    <span class="title">person</span>: <span class="type">Person</span></span><br><span class="line">}</span></span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor"># &#x6CE8;&#x610F;&#x8FD9;&#x91CC;&#x5F97;&#x5173;&#x952E;&#x5B57;&#x662F; input</span></span><br><span class="line"><span class="title">input</span> <span class="type">PersonParam</span> {</span><br><span class="line">    name: <span class="type">String</span></span><br><span class="line">    age: <span class="type">Int</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="typedef"><span class="keyword">type</span> <span class="type">Person</span> <span class="container">{</span><br><span class="line">    <span class="title">name</span>: <span class="type">String</span></span><br><span class="line">    <span class="title">age</span>: <span class="type">Int</span></span><br><span class="line">}</span></span></span><br><span class="line"></span><br><span class="line"><span class="typedef"><span class="keyword">type</span> <span class="type">Query</span> <span class="container">{</span><br><span class="line">   <span class="title">books</span>(<span class="title">name</span>: <span class="type">String</span>, <span class="title">size</span>: <span class="type">Int</span>): [<span class="type">Book</span>]</span><br><span class="line">}</span></span></span><br><span class="line"></span><br><span class="line"><span class="typedef"><span class="keyword">type</span> <span class="type">Mutation</span> <span class="container">{</span><br><span class="line">    <span class="title">newBook</span>(<span class="title">name</span>: <span class="type">String</span>, <span class="title">url</span>: <span class="type">String</span>, <span class="title">person</span>: <span class="type">PersonParam</span>): <span class="type">Long</span></span><br><span class="line">}</span></span></span><br><span class="line"></span><br><span class="line"><span class="title">schema</span> {</span><br><span class="line">    query: <span class="type">Query</span></span><br><span class="line">    mutation: <span class="type">Mutation</span></span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line"><span class="title">scalar</span> <span class="type">Long</span></span><br></pre></td></tr></table></figure></p>
<p>&#x5728;GraphQL&#x4E2D;&#x5982;&#x679C;&#x53C2;&#x6570;&#x662F;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x800C;&#x4E0D;&#x662F;&#x6807;&#x91CF;&#x503C;(Float,Int,String,Enum)&#x7684;&#x8BDD;&#xFF0C;&#x90A3;&#x4E48;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x9700;&#x8981;&#x7533;&#x660E;&#x4E3A;input.&#x4E0A;&#x9762;&#x53EF;&#x4EE5;&#x770B;&#x5230;PersonParam&#x548C;Person&#x7684;&#x5B57;&#x6BB5;&#x90FD;&#x662F;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x4E24;&#x4E2A;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E3A;&#x540C;&#x4E00;&#x4E2A;&#x5417;&#xFF1F;
&#x6211;&#x544A;&#x8BC9;&#x4F60;&#x4E0D;&#x884C;&#xFF0C;&#x56E0;&#x4E3A;PersonParam&#x662F;&#x8F93;&#x5165;&#x53C2;&#x6570;,&#x800C;Person&#x662F;&#x8F93;&#x51FA;&#x53C2;&#x6570;&#xFF0C;&#x4E24;&#x8005;&#x5728;GraphQL&#x4E2D;&#x4E0D;&#x80FD;&#x6DF7;&#x4E3A;&#x4E00;&#x8C08;,&#x5982;&#x679C;&#x4F60;&#x8FD9;&#x6837;&#x505A;&#x4E86;&#xFF0C;&#x7A0B;&#x5E8F;&#x4F1A;&#x62A5;&#x9519;&#x3002;</p>
<h4 id="&#x5B9A;&#x4E49;&#x63A5;&#x53E3;&#x5B9E;&#x73B0;">&#x5B9A;&#x4E49;&#x63A5;&#x53E3;&#x5B9E;&#x73B0;</h4>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="annotation">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Query</span> <span class="keyword">implements</span> <span class="title">GraphQLQueryResolver</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BookRespository bookRespository;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&#x65B9;&#x6CD5;&#x540D;&#x79F0;,&#x53C2;&#x6570;&#x4EE5;&#x53CA;&#x8FD4;&#x56DE;&#x7C7B;&#x578B;&#x8981;&#x548C;schema.graphqls&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x5B9A;&#x4E49;&#x4FDD;&#x6301;&#x4E00;&#x81F4;.DataFetchingEnvironment&#x662F;GraphQL&#x63D0;&#x4F9B;&#x7684;&#x4E0A;&#x4E0B;&#x6587;,&#x5176;&#x4E2D;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x5230;request,response</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Book&gt; <span class="title">books</span><span class="params">(String name,Integer size,DataFetchingEnvironment env)</span> </span>{</span><br><span class="line">        <span class="comment">//AuthContext context = env.getContext()   &#x7528;&#x4E8E;&#x6743;&#x9650;&#x8FC7;&#x6EE4;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> bookRespository.getBooks(name,size);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"><span class="annotation">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mutation</span> <span class="keyword">implements</span> <span class="title">GraphQLMutationResolver</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BookRespository bookRespository;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&#x63A5;&#x53E3;&#x9700;&#x8981;&#x548C;schema.graphqls&#x4E2D;&#x4FDD;&#x6301;&#x4E00;&#x81F4;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Long <span class="title">newBook</span><span class="params">(String name, String url, PersonParam personParam)</span> </span>{</span><br><span class="line">        Person person = <span class="keyword">new</span> Person(personParam.getName(),personParam.getAge());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> bookRespository.saveBook(name,url,person);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x91CC;&#x7684;&#x63A5;&#x53E3;&#x5B9E;&#x9645;&#x4E0A;&#x4E5F;&#x662F;&#x8BF7;&#x6C42;&#x7684;&#x6700;&#x7EC8;&#x843D;&#x5730;&#x70B9;&#xFF0C;&#x53EF;&#x4EE5;&#x60F3;&#x6210;SpringMVC&#x4E2D;&#x7684;Controller&#xFF0C;&#x6700;&#x7EC8;&#x7684;&#x6267;&#x884C;&#x903B;&#x8F91;&#x5C31;&#x4F1A;&#x4ECE;&#x8FD9;&#x91CC;&#x5F00;&#x59CB;&#x3002;</p>
<h4 id="&#x96C6;&#x6210;mongodb">&#x96C6;&#x6210;MongoDB</h4>
<h5 id="applicationproperties&#x4E2D;&#x8BBE;&#x7F6E;mongodb&#x53C2;&#x6570;">application.properties&#x4E2D;&#x8BBE;&#x7F6E;mongodb&#x53C2;&#x6570;</h5>
<p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring<span class="class">.data</span><span class="class">.mongodb</span><span class="class">.uri</span>=mongodb:<span class="comment">//localhost:27017/gln-local-test</span></span><br></pre></td></tr></table></figure></p>
<h5 id="&#x6DFB;&#x52A0;&#x5BF9;mongodb&#x7684;&#x8BBF;&#x95EE;">&#x6DFB;&#x52A0;&#x5BF9;MongoDB&#x7684;&#x8BBF;&#x95EE;</h5>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookRespository</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MongoTemplate mongoTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Book&gt; <span class="title">getBooks</span><span class="params">(String name, Integer size)</span> </span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == size) {</span><br><span class="line">            size = <span class="number">10</span>;</span><br><span class="line">        }</span><br><span class="line">        Query query = <span class="keyword">new</span> Query();</span><br><span class="line">        query.addCriteria(Criteria.where(<span class="string">&quot;name&quot;</span>).alike(Example.of(name))).limit(size);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> mongoTemplate.findAll(Book.class, <span class="string">&quot;book&quot;</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> Long <span class="title">saveBook</span><span class="params">(String name, String url, Person person)</span> </span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">long</span> id = <span class="keyword">new</span> Random().nextLong();</span><br><span class="line"></span><br><span class="line">        Book book = Book.builder().id(id).name(name).url(url).person(person).build();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        mongoTemplate.save(book,<span class="string">&quot;book&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">   }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x6DFB;&#x52A0;scalar">&#x6DFB;&#x52A0;Scalar</h4>
<p>&#x521A;&#x624D;&#x63D0;&#x5230;&#x4E86;GraphQL,&#x5B83;&#x53EA;&#x63D0;&#x4F9B;&#x4E86;Int,Float,String,Enum&#x4EE5;&#x53CA;&#x81EA;&#x5B9A;&#x4E49;Type(class)&#x7C7B;&#x578B;,&#x5BF9;&#x4E8E;&#x5176;&#x4ED6;&#x7684;&#x9700;&#x8981;&#x81EA;&#x5B9A;&#x4E49;,&#x5B9E;&#x9645;&#x4E0A;&#x4E5F;&#x5C31;&#x662F;&#x5B9A;&#x4E49;&#x5982;&#x4F55;&#x5E8F;&#x5217;&#x5316;&#x4EE5;&#x53CA;&#x53CD;&#x5E8F;&#x5217;&#x5316;,&#x8FD9;&#x79CD;&#x81EA;&#x5B9A;&#x4E49;&#x7C7B;&#x578B;&#x88AB;&#x79F0;&#x4E3A;scalar.&#x521A;&#x624D;&#x63A5;&#x53E3;&#x4E2D;&#x5B9A;&#x4E49;&#x4E86;Long,&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5199;&#x4E00;&#x4E2A;Long&#x7684;scalar.&#x5B9E;&#x9645;&#x4E0A;&#x5C31;&#x662F;&#x81EA;&#x5B9A;&#x4E49;&#x5E8F;&#x5217;&#x5316;&#x4EE5;&#x53CA;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x89C4;&#x5219;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Scalars</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> GraphQLScalarType JAVA_LONG = <span class="keyword">new</span> GraphQLScalarType(<span class="string">&quot;Long&quot;</span>, <span class="string">&quot;Java Long scalar&quot;</span>,</span><br><span class="line">            <span class="keyword">new</span> Coercing() {</span><br><span class="line">                <span class="annotation">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> Long <span class="title">serialize</span><span class="params">(Object dataFetcherResult)</span> <span class="keyword">throws</span> CoercingSerializeException </span>{</span><br><span class="line">                    <span class="keyword">return</span> Long.parseLong(dataFetcherResult.toString());</span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line">                <span class="annotation">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> Object <span class="title">parseValue</span><span class="params">(Object input)</span> <span class="keyword">throws</span> CoercingParseValueException </span>{</span><br><span class="line">                    <span class="keyword">return</span> serialize(input);</span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line">                <span class="annotation">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> Long <span class="title">parseLiteral</span><span class="params">(Object input)</span> <span class="keyword">throws</span> CoercingParseLiteralException </span>{</span><br><span class="line">                    <span class="keyword">if</span>(input <span class="keyword">instanceof</span> StringValue) {</span><br><span class="line">                        <span class="keyword">return</span> Long.parseLong(((StringValue) input).getValue());</span><br><span class="line">                    } <span class="keyword">else</span> <span class="keyword">if</span>(input <span class="keyword">instanceof</span> IntValue) {</span><br><span class="line">                        <span class="keyword">return</span> ((IntValue) input).getValue().longValue();</span><br><span class="line">                    }</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">                }</span><br><span class="line">            });</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x6DFB;&#x52A0;springmvc&#x652F;&#x6301;">&#x6DFB;&#x52A0;SpringMVC&#x652F;&#x6301;</h4>
<p>&#x4E4B;&#x524D;&#x7684;&#x914D;&#x7F6E;&#x53EA;&#x662F;&#x5BF9;&#x63A5;&#x53E3;&#x5B9A;&#x4E49;&#x7684;&#x8BE0;&#x91CA;&#xFF0C;&#x4F46;&#x662F;&#x8981;&#x8C08;&#x5230;&#x548C;SpringMVC&#x5BF9;&#x63A5;&#x5176;&#x5B9E;&#x8FD8;&#x6CA1;&#x6709;&#xFF0C;&#x90A3;&#x4E48;&#x63A5;&#x4E0B;&#x6765;&#x7684;&#x914D;&#x7F6E;&#x5C31;&#x662F;&#x548C;SpringMVC&#x8FDB;&#x884C;&#x5BF9;&#x63A5;&#x4E86;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GraphqlEndpoint</span> <span class="keyword">extends</span> <span class="title">SimpleGraphQLServlet</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Autowired</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GraphqlEndpoint</span><span class="params">(Query query, Mutation mutation)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>(SchemaParser.newParser()</span><br><span class="line">                .file(<span class="string">&quot;schema.graphqls&quot;</span>)</span><br><span class="line">                .resolvers(query,mutation)      <span class="comment">//&#x5F15;&#x5982;resovler</span></span><br><span class="line">                .scalars(Scalars.JAVA_LONG)  <span class="comment">//&#x5F15;&#x5165;&#x521A;&#x624D;&#x5B9A;&#x4E49;&#x7684;scalar</span></span><br><span class="line">                .build()</span><br><span class="line">                .makeExecutableSchema());</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//&#x7EDF;&#x4E00;&#x7684;&#x5165;&#x53E3;,graphQL&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x7EDF;&#x4E00;&#x5165;&#x53E3;&#x5C06;&#x8BF7;&#x6C42;&#x8FDB;&#x884C;&#x5206;&#x53D1;&#x7ED9;&#x5404;&#x4E2A;resolver</span></span><br><span class="line"><span class="annotation">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GraphqlController</span> </span>{</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> GraphQLServlet graphQLServlet;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@RequestMapping</span>(<span class="string">&quot;/graphql&quot;</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">graphql</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>{</span><br><span class="line"></span><br><span class="line">        graphQLServlet.service(request,response);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x6DFB;&#x52A0;&#x5BF9;&#x5E94;&#x7684;&#x5B9E;&#x4F53;&#x7C7B;">&#x6DFB;&#x52A0;&#x5BF9;&#x5E94;&#x7684;&#x5B9E;&#x4F53;&#x7C7B;</h4>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="annotation">@Data</span></span><br><span class="line"><span class="annotation">@AllArgsConstructor</span></span><br><span class="line"><span class="annotation">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String age;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="annotation">@Data</span></span><br><span class="line"><span class="annotation">@AllArgsConstructor</span></span><br><span class="line"><span class="annotation">@NoArgsConstructor</span></span><br><span class="line"><span class="annotation">@Builder</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String url;</span><br><span class="line">    <span class="keyword">private</span> Person person;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="annotation">@Data</span></span><br><span class="line"><span class="annotation">@AllArgsConstructor</span></span><br><span class="line"><span class="annotation">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonParam</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String age;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x5F00;&#x59CB;&#x771F;&#x6B63;&#x7684;&#x8868;&#x6F14;&#x4E86;">&#x5F00;&#x59CB;&#x771F;&#x6B63;&#x7684;&#x8868;&#x6F14;&#x4E86;</h4>
<p>&#x63A5;&#x4E0B;&#x6765;&#x5C31;&#x8981;&#x5F00;&#x59CB;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#x4E86;,&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;GraphQL Playground(&#x6216;&#x8005;google graphiql&#x63D2;&#x4EF6;)&#x6216;&#x8005;post man&#x6765;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;,&#x8FD9;&#x91CC;&#x6211;&#x4E24;&#x4E2A;&#x90FD;&#x4F7F;&#x7528;</p>
<p><img src="/images/graphql-postman-get.png" alt="postman get&#x6D4B;&#x8BD5;"></p>
<p><img src="/images/graphql-test-background.png" alt="graphql background&#x6D4B;&#x8BD5;"></p>
<p>query&#x540E;&#x9762;&#x90A3;&#x4E00;&#x4E32;&#x5176;&#x5B9E;&#x662F;
query {
books(name:&quot;MongoDB&quot;,size:10) {
name
url
person {
name
age
}
}
}
&#x7684;url&#x8F6C;&#x4E49;&#x3002;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x4F7F;&#x7528;get&#x65B9;&#x6CD5;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#xFF0C;&#x5C06;&#x67E5;&#x8BE2;&#x53C2;&#x6570;&#x653E;&#x5230;url&#x540E;&#x9762;&#xFF0C;&#x9700;&#x8981;&#x5C06;&#x53C2;&#x6570;&#x8F6C;&#x4E49;&#x4E4B;&#x540E;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#x3002;&#x5982;&#x679C;&#x4F7F;&#x7528;post&#x65B9;&#x6CD5;&#x5219;&#x503C;&#x9700;&#x8981;&#x5C06;&#x8BF7;&#x6C42;&#x4F53;&#x653E;&#x5230;body&#x4E2D;&#x5373;&#x53EF;</p>
<h4 id="&#x5173;&#x4E8E;&#x6743;&#x9650;&#x7684;&#x9A8C;&#x8BC1;">&#x5173;&#x4E8E;&#x6743;&#x9650;&#x7684;&#x9A8C;&#x8BC1;</h4>
<p>&#x8FD9;&#x91CC;&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x5B9E;&#x73B0;,&#x5728;GraphqlEndpoint&#x590D;&#x5199;&#x4E0B;&#x9762;&#x7684;&#x65B9;&#x6CD5;,&#x7136;&#x540E;&#x5728;Query&#x6216;&#x8005;Mutation&#x4E2D;&#x5C31;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;DataFetchingEnvironment&#x83B7;&#x53D6;&#x5230;&#x81EA;&#x5B9A;&#x4E49;&#x7684;context,&#x901A;&#x8FC7;&#x5176;&#x4E2D;&#x7684;request&#x6765;&#x8FDB;&#x884C;&#x6743;&#x9650;&#x9A8C;&#x8BC1;&#x4E86;&#x3002;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">protected</span> GraphQLContext <span class="title">createContext</span><span class="params">(Optional&lt;HttpServletRequest&gt; request, Optional&lt;HttpServletResponse&gt; response)</span> </span>{</span><br><span class="line">            </span><br><span class="line">        <span class="comment">//&#x4ECE;request&#x83B7;&#x53D6;&#x5230;cookie token&#x7B49;&#x80FD;&#x8BC1;&#x660E;&#x7528;&#x4E8E;&#x8EAB;&#x4EFD;&#x7684;&#x6570;&#x636E;,&#x89E3;&#x6790;&#x51FA;user</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> AuthContext(user,request,response);</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AuthContext</span> <span class="keyword">extends</span> <span class="title">GraphQLContext</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AuthUser authUser;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AuthContext</span><span class="params">(AuthUser user, Optional&lt;HttpServletRequest&gt; request, Optional&lt;HttpServletResponse&gt; response)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>(request, response);</span><br><span class="line">        <span class="keyword">this</span>.authUser = user;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AuthUser <span class="title">getAuthUser</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> authUser;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<h3 id="&#x53C2;&#x8003;&#x6587;&#x6863;">&#x53C2;&#x8003;&#x6587;&#x6863;</h3>
<p>http://graphql.github.io/learn/schema/</p>
<p>https://www.howtographql.com/graphql-java/1-getting-started/</p>
</span>
      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Graphql/" rel="tag">#Graphql</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/10/30/how-to-use-graphql2/" rel="prev">Graphql在项目中的使用(二)</a>
            
          </div>

          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/08/13/springmvc-sourcecode-analysis/" rel="next">SpringMVC源码分析</a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

 </div>

       

        
          <div class="comments" id="comments">
            
              <div class="ds-thread" data-thread-key="2018/09/27/how-to-use-graphql/"
                   data-title="Graphql在项目中的使用" data-url="http://yoursite.com/2018/09/27/how-to-use-graphql/">
              </div>
            
          </div>
        
      </div>

      
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="http://7xlvme.com1.z0.glb.clouddn.com/avatar.jpg" alt="generalthink" itemprop="image"/>
          <p class="site-author-name" itemprop="name">generalthink</p>
        </div>
        <p class="site-description motion-element" itemprop="description">相信自己做一个自信的人</p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">29</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            <a href="/categories">
              <span class="site-state-item-count">14</span>
              <span class="site-state-item-name">分类</span>
              </a>
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">17</span>
              <span class="site-state-item-name">标签</span>
              </a>
          </div>

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="menu-item-icon icon-next-feed"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/generalthink" target="_blank">github</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.zhihu.com/people/think123" target="_blank">zhihu</a>
              </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
            <p class="site-author-name">友情链接</p>
            
              <span class="links-of-author-item">
              <a href="http://www.baidu.com" target="_blank">baidu</a>
              </span>
            
              <span class="links-of-author-item">
              <a href="http://www.it2048.cn" target="_blank">it2048</a>
              </span>
            
          
        </div>

      </section>

      
        <section class="post-toc-wrap sidebar-panel-active">
          <div class="post-toc-indicator-top post-toc-indicator"></div>
          <div class="post-toc">
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是graphql"><span class="nav-text">什么是GraphQL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#最好的入门文档"><span class="nav-text">最好的入门文档</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#springmvc集成graphql"><span class="nav-text">SpringMVC集成GraphQL</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#引入java包"><span class="nav-text">引入Java包</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#开始开发"><span class="nav-text">开始开发</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#定义接口描述schemagraphqls"><span class="nav-text">定义接口描述(schema.graphqls)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#定义接口实现"><span class="nav-text">定义接口实现</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#集成mongodb"><span class="nav-text">集成MongoDB</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#applicationproperties中设置mongodb参数"><span class="nav-text">application.properties中设置mongodb参数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#添加对mongodb的访问"><span class="nav-text">添加对MongoDB的访问</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#添加scalar"><span class="nav-text">添加Scalar</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#添加springmvc支持"><span class="nav-text">添加SpringMVC支持</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#添加对应的实体类"><span class="nav-text">添加对应的实体类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#开始真正的表演了"><span class="nav-text">开始真正的表演了</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#关于权限的验证"><span class="nav-text">关于权限的验证</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#参考文档"><span class="nav-text">参考文档</span></a></li></ol></div>
            
          </div>
          <div class="post-toc-indicator-bottom post-toc-indicator"></div>
        </section>
      

    </div>
  </aside>


    </main>



<div id="lv-container" data-id="city" data-uid="MTAyMC8zODYzMS8xNTE1OQ==">
  <script type="text/javascript">
    var livereQuery = {short_name:"generalthink"};
     (function(d, s) {
       var j, e = d.getElementsByTagName(s)[0];

       if (typeof LivereTower === 'function') { return; }

       j = d.createElement(s);
       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
       j.async = true;

       e.parentNode.insertBefore(j, e);
   })(document, 'script');
  </script>


    <footer id="footer" class="footer">
      <div class="footer-inner"> <div class="powered-by">
  <a href="http://www.miitbeian.gov.cn/">蜀ICP备16009462号</a>
</div>


<div class="theme-info">

  Copyright &copy; &nbsp;  2014 - 
  <span itemprop="copyrightYear">2018</span>
  <span class="author" itemprop="copyrightHolder">generalthink.All rights reserved.</span>
</div>


<div class="copyright" >
  
</div>


 </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  
  
  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.1"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.1"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js?v=0.4.5.1" id="motion.global"></script>




  <script type="text/javascript" src="/js/nav-toggle.js?v=0.4.5.1"></script>
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  
<script type="text/javascript" src="/js/bootstrap.scrollspy.js?v=0.4.5.1" id="bootstrap.scrollspy.custom"></script>


<script type="text/javascript" id="sidebar.toc.highlight">
  $(document).ready(function () {
    var tocSelector = '.post-toc';
    var $tocSelector = $(tocSelector);
    var activeCurrentSelector = '.active-current';

    $tocSelector
      .on('activate.bs.scrollspy', function () {
        var $currentActiveElement = $(tocSelector + ' .active').last();

        removeCurrentActiveClass();
        $currentActiveElement.addClass('active-current');

        $tocSelector[0].scrollTop = $currentActiveElement.position().top;
      })
      .on('clear.bs.scrollspy', function () {
        removeCurrentActiveClass();
      });

    function removeCurrentActiveClass () {
      $(tocSelector + ' ' + activeCurrentSelector)
        .removeClass(activeCurrentSelector.substring(1));
    }

    function processTOC () {
      getTOCMaxHeight();
      toggleTOCOverflowIndicators();
    }

    function getTOCMaxHeight () {
      var height = $('.sidebar').height() -
                   $tocSelector.position().top -
                   $('.post-toc-indicator-bottom').height();

      $tocSelector.css('height', height);

      return height;
    }

    function toggleTOCOverflowIndicators () {
      tocOverflowIndicator(
        '.post-toc-indicator-top',
        $tocSelector.scrollTop() > 0 ? 'show' : 'hide'
      );

      tocOverflowIndicator(
        '.post-toc-indicator-bottom',
        $tocSelector.scrollTop() >= $tocSelector.find('ol').height() - $tocSelector.height() ? 'hide' : 'show'
      )
    }

    $(document).on('sidebar.motion.complete', function () {
      processTOC();
    });

    $('body').scrollspy({ target: tocSelector });
    $(window).on('resize', function () {
      if ( $('.sidebar').hasClass('sidebar-active') ) {
        processTOC();
      }
    });

    onScroll($tocSelector);

    function onScroll (element) {
      element.on('mousewheel DOMMouseScroll', function (event) {
          var oe = event.originalEvent;
          var delta = oe.wheelDelta || -oe.detail;

          this.scrollTop += ( delta < 0 ? 1 : -1 ) * 30;
          event.preventDefault();

          toggleTOCOverflowIndicators();
      });
    }

    function tocOverflowIndicator (indicator, action) {
      var $indicator = $(indicator);
      var opacity = action === 'show' ? 0.4 : 0;
      $indicator.velocity ?
        $indicator.velocity('stop').velocity({
          opacity: opacity
        }, { duration: 100 }) :
        $indicator.stop().animate({
          opacity: opacity
        }, 100);
    }

  });
</script>

<script type="text/javascript" id="sidebar.nav">
  $(document).ready(function () {
    var html = $('html');
    var TAB_ANIMATE_DURATION = 200;
    var hasVelocity = $.isFunction(html.velocity);

    $('.sidebar-nav li').on('click', function () {
      var item = $(this);
      var activeTabClassName = 'sidebar-nav-active';
      var activePanelClassName = 'sidebar-panel-active';
      if (item.hasClass(activeTabClassName)) {
        return;
      }

      var currentTarget = $('.' + activePanelClassName);
      var target = $('.' + item.data('target'));

      hasVelocity ?
        currentTarget.velocity('transition.slideUpOut', TAB_ANIMATE_DURATION, function () {
          target
            .velocity('stop')
            .velocity('transition.slideDownIn', TAB_ANIMATE_DURATION)
            .addClass(activePanelClassName);
        }) :
        currentTarget.animate({ opacity: 0 }, TAB_ANIMATE_DURATION, function () {
          currentTarget.hide();
          target
            .stop()
            .css({'opacity': 0, 'display': 'block'})
            .animate({ opacity: 1 }, TAB_ANIMATE_DURATION, function () {
              currentTarget.removeClass(activePanelClassName);
              target.addClass(activePanelClassName);
            });
        });

      item.siblings().removeClass(activeTabClassName);
      item.addClass(activeTabClassName);
    });

    $('.post-toc a').on('click', function (e) {
      e.preventDefault();
      var targetSelector = escapeSelector(this.getAttribute('href'));
      var offset = $(targetSelector).offset().top;
      hasVelocity ?
        html.velocity('stop').velocity('scroll', {
          offset: offset  + 'px',
          mobileHA: false
        }) :
        $('html, body').stop().animate({
          scrollTop: offset
        }, 500);
    });

    // Expand sidebar on post detail page by default, when post has a toc.
    var $tocContent = $('.post-toc-content');
    if (isDesktop() && CONFIG.sidebar === 'post') {
      if ($tocContent.length > 0 && $tocContent.html().trim().length > 0) {
        displaySidebar();
      }
    }
  });
</script>



  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
      if (isMobile()) {
        FastClick.attach(document.body);
      }
    });
  </script>

  

  
  

  
  <script type="text/javascript" src="/js/lazyload.js"></script>
  <script type="text/javascript">
    $(function () {
      $("#posts").find('img').lazyload({
        placeholder: "/images/loading.gif",
        effect: "fadeIn"
      });
    });
  </script>
</body>
</html>
