<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[I am TKing]]></title>
  
  <link href="/atom.xml" rel="self"/>
  <link href="http://yoursite.com/"/>
  <updated>2018-11-24T07:12:10.441Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name><![CDATA[generalthink]]></name>
    <email><![CDATA[general_go@163.com]]></email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[在Docker中使用HBase]]></title>
    <link href="http://yoursite.com/2018/11/24/how-to-use-hbase-in-docker/"/>
    <id>http://yoursite.com/2018/11/24/how-to-use-hbase-in-docker/</id>
    <published>2018-11-24T06:53:39.000Z</published>
    <updated>2018-11-24T07:12:10.441Z</updated>
    <content type="html"><![CDATA[<p>&#x7531;&#x4E8E;hbase&#x4F9D;&#x8D56;&#x4E8E;hadoop,&#x6240;&#x4EE5;&#x60F3;&#x8981;&#x4F7F;&#x7528;hbase&#x5FC5;&#x987B;&#x5148;&#x8981;&#x5B89;&#x88C5;hadoop(&#x4E3B;&#x8981;&#x662F;&#x6211;&#x61D2;),&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;docker&#x4F7F;&#x7528;&#x522B;&#x4EBA;&#x5B89;&#x88C5;&#x597D;&#x7684;hbase.</p>
<h3 id="&#x5B89;&#x88C5;docker">&#x5B89;&#x88C5;docker</h3>
<p>docker&#x7684;&#x5B89;&#x88C5;&#x5F88;&#x7B80;&#x5355;,&#x8BF7;&#x53C2;&#x8003;<a href="http://www.runoob.com/docker/centos-docker-install.html" target="_blank" rel="external">http://www.runoob.com/docker/centos-docker-install.html</a></p>
<h3 id="&#x67E5;&#x770B;hbase&#x955C;&#x50CF;">&#x67E5;&#x770B;hbase&#x955C;&#x50CF;</h3>
<p>&#x9996;&#x5148;&#x67E5;&#x770B;&#x5173;&#x4E8E;hbase&#x7684;&#x955C;&#x50CF;&#x6709;&#x54EA;&#x4E9B;,&#x8FD0;&#x884C; <code>docker search hbase</code></p>
<p><img src="/images/hbase-docker-search-image.png" alt="&#x67E5;&#x770B;&#x955C;&#x50CF;"></p>
<p>&#x6211;&#x4EEC;&#x5C31;&#x4F7F;&#x7528;&#x7B2C;&#x4E00;&#x4E2A;&#x597D;&#x4E86;,&#x6BD5;&#x7ADF;star&#x6700;&#x591A;&#x3002;</p>
<h3 id="&#x62C9;&#x53D6;&#x955C;&#x50CF;">&#x62C9;&#x53D6;&#x955C;&#x50CF;</h3>
<p>&#x4F7F;&#x7528;&#x547D;&#x4EE4; <code>docker pull harisekhon/hbase</code> &#x5C31;&#x4F1A;&#x5C06;&#x955C;&#x50CF;&#x62C9;&#x53D6;&#x5230;&#x672C;&#x5730;&#x3002;&#x7136;&#x540E;&#x67E5;&#x770B;&#x5F53;&#x524D;&#x672C;&#x5730;&#x5B58;&#x5728;&#x54EA;&#x4E9B;&#x955C;&#x50CF;</p>
<p><img src="/images/hbase-docker-list-images.png" alt="&#x5217;&#x51FA;&#x672C;&#x5730;&#x955C;&#x50CF;"></p>
<h3 id="&#x8FD0;&#x884C;hbase&#x5BB9;&#x5668;&#x5E76;&#x8FDB;&#x5165;&#x5BB9;&#x5668;&#x5185;&#x90E8;">&#x8FD0;&#x884C;hbase&#x5BB9;&#x5668;&#x5E76;&#x8FDB;&#x5165;&#x5BB9;&#x5668;&#x5185;&#x90E8;</h3>
<ol>
<li><code>docker run -dit harisekhon/hbase</code></li>
</ol>
<p>&#x542F;&#x52A8;&#x5BB9;&#x5668;,&#x9ED8;&#x8BA4;&#x7684;&#x7248;&#x672C;&#x662F;latest,&#x5982;&#x679C;&#x8FD0;&#x884C;&#x7684;&#x7248;&#x672C;&#x4E0D;&#x662F;&#x9700;&#x8981;&#x52A0;&#x4E0A;&#x7248;&#x672C;,&#x6BD4;&#x5982;<code>docker run -dit harisekhon/hbase:1.0</code>
<img src="/images/hbase-docker-run-image.png" alt="&#x542F;&#x52A8;HBase&#x5BB9;&#x5668;"></p>
<ol start="2">
<li><code>docker exec -it dc0716 bash</code>(&#x8FDB;&#x5165;&#x5BB9;&#x5668;&#x5185;&#x90E8;,&#x8FD9;&#x91CC;&#x7684;dc0716&#x662F;&#x5BB9;&#x5668;id&#x524D;&#x51E0;&#x4F4D;)</li>
</ol>
<p><img src="/images/hbase-docker-exec-bash.png" alt="&#x8FDB;&#x5165;&#x5BB9;&#x5668;&#x5185;&#x90E8;"></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6B64;&#x65F6;&#x5BB9;&#x5668;&#x5185;&#x7684;hbase&#x76EE;&#x5F55;</p>
<h3 id="&#x8FD0;&#x884C;hbase&#x547D;&#x4EE4;">&#x8FD0;&#x884C;hbase&#x547D;&#x4EE4;</h3>
<p><img src="/images/hbase-docker-hbase-shell.png" alt="&#x8FD0;&#x884C;hbase shell"></p>
<p>&#x8FD0;&#x884C;&#x4E86;<code>./hbase shell</code>&#x547D;&#x4EE4;&#x540E;&#x5C31;&#x8FDB;&#x5165;&#x4E86;hbase shell&#x547D;&#x4EE4;&#x884C;&#xFF0C;&#x6B64;&#x65F6;&#x53EF;&#x4EE5;&#x7528;&#x547D;&#x4EE4;&#x7684;&#x65B9;&#x5F0F;&#x67E5;&#x770B;hbase&#x72B6;&#x6001;,&#x65B0;&#x5EFA;&#x8868;&#x7B49;
&#x7531;&#x4E8E;&#x6211;&#x4EEC;&#x5B89;&#x88C5;&#x7684;hbase&#x955C;&#x50CF;&#x662F;&#x4E00;&#x4E2A;&#x4F2A;&#x5206;&#x5E03;&#x5F0F;&#x7684;&#xFF0C;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x6240;&#x4EE5;&#x67E5;&#x770B;&#x72B6;&#x6001;&#x663E;&#x793A;&#x53EA;&#x6709;&#x4E00;&#x4E2A;server</p>
<p><img src="/images/hbase-docker-hbase-status.png" alt="Hbase status"></p>
<p>&#x66F4;&#x591A;&#x7684;hbase&#x547D;&#x4EE4;&#x5C06;&#x5728;&#x4E0B;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x4E2D;&#x8BB2;&#x89E3;</p>
<h3 id="&#x8FDE;&#x63A5;&#x670D;&#x52A1;&#x5668;&#x7684;hbase">&#x8FDE;&#x63A5;&#x670D;&#x52A1;&#x5668;&#x7684;hbase</h3>
<p>hbase&#x9ED8;&#x8BA4;&#x4F7F;&#x7528;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x662F;hbase-site.xml&#x4F4D;&#x4E8E;hbase&#x5B89;&#x88C5;&#x8DEF;&#x5F84;&#x4E0B;&#x7684;conf&#x76EE;&#x5F55;&#xFF0C;&#x6709;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x53EF;&#x80FD;&#x6CA1;&#x6709;&#x6743;&#x9650;&#x8FDE;&#x63A5;&#x8FDC;&#x7A0B;&#x670D;&#x52A1;&#x5668;,&#x4F46;&#x662F;&#x53C8;&#x60F3;&#x8981;&#x770B;hbase&#x7684;&#x6570;&#x636E;&#x600E;&#x4E48;&#x529E;&#x5462;&#xFF1F;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;hbase-site.xml&#x4E2D;&#x7684;&#x914D;&#x7F6E;&#x8FDE;&#x63A5;&#x4E0A;&#x8FDC;&#x7A0B;&#x670D;&#x52A1;&#x5668;&#x3002;&#x5C06;&#x9879;&#x76EE;&#x4E2D;&#x7684;hbase-site.xml&#x66FF;&#x6362;&#x9ED8;&#x8BA4;&#x7684;hbase-site.xml&#x7136;&#x540E;&#x91CD;&#x65B0;&#x8FDB;&#x5165;hbase shell&#x5373;&#x53EF;&#x3002;&#x4F46;&#x662F;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#x7531;&#x4E8E;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x7684;docker&#xFF0C;&#x6240;&#x4EE5;&#x6BCF;&#x6B21;&#x865A;&#x62DF;&#x673A;&#x5173;&#x95ED;&#x4E4B;&#x540E;&#x5BF9;hbase&#x5BB9;&#x5668;&#x7684;&#x4FEE;&#x6539;&#x90FD;&#x4F1A;&#x8FD8;&#x539F;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x60F3;&#x8981;&#x4FEE;&#x6539;&#x4E4B;&#x540E;&#x4E00;&#x76F4;&#x751F;&#x6548;&#x53EF;&#x4EE5;&#x5C06;&#x4FEE;&#x6539;&#x4FDD;&#x5B58;&#x6210;&#x53E6;&#x4E00;&#x4E2A;&#x955C;&#x50CF;&#x3002;</p>
<pre><code>1. &#x66FF;&#x6362;&#x81EA;&#x5E26;&#x7684;hbase-site.xml
2. docker commit containerId  saveImageName:version
    &#x6BD4;&#x5982;&#xFF1A; docker commit 430d centor-tar:1.0
</code></pre>
<p>&#x4E4B;&#x524D;&#x4E5F;&#x63D0;&#x5230;&#x4E86;hbase&#x9700;&#x8981;&#x4F9D;&#x8D56;&#x4E8E;hadoop&#x4EE5;&#x53CA;zookeeper,hbase&#x81EA;&#x5E26;&#x4E86;&#x4E00;&#x4E2A;zookeeper,&#x53EF;&#x4EE5;&#x4E0D;&#x4F7F;&#x7528;&#x5B83;&#xFF0C;&#x800C;&#x4F7F;&#x7528;&#x5DF2;&#x6709;&#x7684;zookeeper&#x3002;&#x6240;&#x4EE5;&#x80FD;&#x8FDE;&#x63A5;&#x8FDC;&#x7A0B;hbase&#x670D;&#x52A1;&#x5668;&#x4E3B;&#x8981;&#x662F;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x5728;hbase-site.xml&#x4E2D;&#x914D;&#x7F6E;&#x4E86;hadoop&#x4EE5;&#x53CA;zookeeper&#x7684;&#x5730;&#x5740;,&#x8FD9;&#x4E24;&#x4E2A;&#x914D;&#x7F6E;&#x9879;&#x7684;&#x5C5E;&#x6027;&#x5982;&#x4E0B;</p>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">name</span>&gt;</span>hbase.rootdir<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">value</span>&gt;</span>hdfs://localhost:9020/hbase<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">name</span>&gt;</span>hbase.zookeeper.quorum<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">value</span>&gt;</span>localhost<span class="tag">&lt;/<span class="title">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">property</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x91CC;&#x7684;localhost:9020&#x9700;&#x8981;&#x66FF;&#x6362;&#x6210;&#x5BF9;&#x5E94;&#x670D;&#x52A1;&#x5668;&#x4E0A;Hadoop&#x7684;&#x5730;&#x5740;&#x4EE5;&#x53CA;&#x7AEF;&#x53E3;,&#x901A;&#x8FC7;&#x5B83;&#x4EEC;&#x7684;&#x914D;&#x7F6E;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x53BB;hbase shell&#x4E0A;&#x6109;&#x5FEB;&#x7684;&#x64CD;&#x4F5C;hbase&#x4E86;&#x3002;</p>
]]></content>
    <summary type="html">
    <![CDATA[我们都知道HBase底层依赖Hadoop，那么在使用HBase的时候必须保证安装Hadoop,而平时我们想要快捷的使用HBase的时候则可以借助docker来使用别人安装好的HBase镜像,这样大大的省时省力,还能更快的对HBase有一个深入的了解。所以本文就介绍如何在Docker中使用Hbase]]>
    
    </summary>
    
      <category term="HBase" scheme="http://yoursite.com/tags/HBase/"/>
    
      <category term="HBase" scheme="http://yoursite.com/categories/HBase/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[深入浅出Hbase]]></title>
    <link href="http://yoursite.com/2018/11/24/hbase-basic/"/>
    <id>http://yoursite.com/2018/11/24/hbase-basic/</id>
    <published>2018-11-24T05:09:28.000Z</published>
    <updated>2018-11-24T06:47:11.441Z</updated>
    <content type="html"><![CDATA[<p>&#x672C;&#x6587;&#x5168;&#x6587;&#x8F6C;&#x8F7D;&#x81EA;:<a href="https://www.ibm.com/developerworks/cn/analytics/library/ba-cn-bigdata-hbase/index.html" target="_blank" rel="external">https://www.ibm.com/developerworks/cn/analytics/library/ba-cn-bigdata-hbase/index.html</a>
&#x539F;&#x6587;&#x4E2D;&#x6709;&#x5173;&#x4E8E;Phoenix&#x7684;&#x90E8;&#x5206;&#x4F7F;&#x7528;&#xFF0C;&#x4E2A;&#x4EBA;&#x89C9;&#x5F97;HBase&#x7684;&#x5185;&#x5BB9;&#x662F;&#x6700;&#x597D;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x53EA;&#x8F6C;&#x8F7D;&#x4E86;&#x5173;&#x4E8E;HBase&#x90E8;&#x5206;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x4E0B;&#x60F3;&#x8981;&#x770B;Phoenix,
&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x539F;&#x6587;&#x3002;</p>
<p>&#x63D0;&#x5230;&#x5927;&#x6570;&#x636E;&#x7684;&#x5B58;&#x50A8;&#xFF0C;&#x5927;&#x591A;&#x6570;&#x4EBA;&#x9996;&#x5148;&#x8054;&#x60F3;&#x5230;&#x7684;&#x662F; Hadoop &#x548C; Hadoop &#x4E2D;&#x7684; HDFS &#x6A21;&#x5757;&#x3002;&#x5927;&#x5BB6;&#x719F;&#x77E5;&#x7684; Spark&#x3001;&#x4EE5;&#x53CA; Hadoop &#x7684; MapReduce&#xFF0C;&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E3A;&#x4E00;&#x79CD;&#x8BA1;&#x7B97;&#x6846;&#x67B6;&#x3002;&#x800C; HDFS&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8BA4;&#x4E3A;&#x662F;&#x4E3A;&#x8BA1;&#x7B97;&#x6846;&#x67B6;&#x670D;&#x52A1;&#x7684;&#x5B58;&#x50A8;&#x5C42;&#x3002;&#x56E0;&#x6B64;&#x4E0D;&#x7BA1;&#x662F; Spark &#x8FD8;&#x662F; MapReduce&#xFF0C;&#x90FD;&#x9700;&#x8981;&#x4F7F;&#x7528; HDFS &#x4F5C;&#x4E3A;&#x9ED8;&#x8BA4;&#x7684;&#x6301;&#x4E45;&#x5316;&#x5B58;&#x50A8;&#x5C42;&#x3002;</p>
<p>&#x90A3;&#x4E48; HBase &#x53C8;&#x662F;&#x4EC0;&#x4E48;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x5728;&#x54EA;&#x91CC;&#xFF0C;&#x89E3;&#x51B3;&#x4EC0;&#x4E48;&#x6837;&#x7684;&#x95EE;&#x9898;&#xFF1F;</p>
<p>&#x7B80;&#x5355;&#x5730;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8BA4;&#x4E3A; HBase &#x662F;&#x4E00;&#x79CD;&#x7C7B;&#x4F3C;&#x4E8E;&#x6570;&#x636E;&#x5E93;&#x7684;&#x5B58;&#x50A8;&#x5C42;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4; HBase &#x9002;&#x7528;&#x4E8E;&#x7ED3;&#x6784;&#x5316;&#x7684;&#x5B58;&#x50A8;&#x3002;&#x5E76;&#x4E14; HBase &#x662F;&#x4E00;&#x79CD;&#x5217;&#x5F0F;&#x7684;&#x5206;&#x5E03;&#x5F0F;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x662F;&#x7531;&#x5F53;&#x5E74;&#x7684; Google &#x516C;&#x5E03;&#x7684; BigTable &#x7684;&#x8BBA;&#x6587;&#x800C;&#x751F;&#x3002;&#x4E0D;&#x8FC7;&#x8FD9;&#x91CC;&#x4E5F;&#x8981;&#x6CE8;&#x610F; HBase &#x5E95;&#x5C42;&#x4F9D;&#x65E7;&#x4F9D;&#x8D56; HDFS &#x6765;&#x4F5C;&#x4E3A;&#x5176;&#x7269;&#x7406;&#x5B58;&#x50A8;&#xFF0C;&#x8FD9;&#x70B9;&#x7C7B;&#x4F3C;&#x4E8E; Hive&#x3002;</p>
<p>&#x53EF;&#x80FD;&#x6709;&#x7684;&#x8BFB;&#x8005;&#x4F1A;&#x597D;&#x5947; HBase &#x4E8E; Hive &#x7684;&#x533A;&#x522B;&#xFF0C;&#x6211;&#x4EEC;&#x7B80;&#x5355;&#x7684;&#x68B3;&#x7406;&#x4E00;&#x4E0B; Hive &#x548C; HBase &#x7684;&#x5E94;&#x7528;&#x573A;&#x666F;&#xFF1A;
Hive &#x9002;&#x5408;&#x7528;&#x6765;&#x5BF9;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x5185;&#x7684;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x5206;&#x6790;&#x67E5;&#x8BE2;&#xFF0C;&#x4F8B;&#x5982;&#xFF0C;&#x7528;&#x6765;&#x8BA1;&#x7B97;&#x8D8B;&#x52BF;&#x6216;&#x8005;&#x7F51;&#x7AD9;&#x7684;&#x65E5;&#x5FD7;&#x3002;Hive &#x4E0D;&#x5E94;&#x8BE5;&#x7528;&#x6765;&#x8FDB;&#x884C;&#x5B9E;&#x65F6;&#x7684;&#x67E5;&#x8BE2;&#xFF08;Hive &#x7684;&#x8BBE;&#x8BA1;&#x76EE;&#x7684;&#xFF0C;&#x4E5F;&#x4E0D;&#x662F;&#x652F;&#x6301;&#x5B9E;&#x65F6;&#x7684;&#x67E5;&#x8BE2;&#xFF09;&#x3002;&#x56E0;&#x4E3A;&#x5B83;&#x9700;&#x8981;&#x5F88;&#x957F;&#x65F6;&#x95F4;&#x624D;&#x53EF;&#x4EE5;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;&#xFF1B;HBase &#x5219;&#x975E;&#x5E38;&#x9002;&#x5408;&#x7528;&#x6765;&#x8FDB;&#x884C;&#x5927;&#x6570;&#x636E;&#x7684;&#x5B9E;&#x65F6;&#x67E5;&#x8BE2;&#xFF0C;&#x4F8B;&#x5982; Facebook &#x7528; HBase &#x8FDB;&#x884C;&#x6D88;&#x606F;&#x548C;&#x5B9E;&#x65F6;&#x7684;&#x5206;&#x6790;&#x3002;</p>
<p>&#x5BF9;&#x4E8E; Hive &#x548C; HBase &#x7684;&#x90E8;&#x7F72;&#x6765;&#x8BF4;&#xFF0C;&#x4E5F;&#x6709;&#x4E00;&#x4E9B;&#x533A;&#x522B;&#xFF0C;Hive &#x4E00;&#x822C;&#x53EA;&#x8981;&#x6709; Hadoop &#x4FBF;&#x53EF;&#x4EE5;&#x5DE5;&#x4F5C;&#x3002;&#x800C; HBase &#x5219;&#x8FD8;&#x9700;&#x8981; Zookeeper &#x7684;&#x5E2E;&#x52A9;&#xFF08;Zookeeper&#xFF0C;&#x662F;&#x4E00;&#x4E2A;&#x7528;&#x6765;&#x8FDB;&#x884C;&#x5206;&#x5E03;&#x5F0F;&#x534F;&#x8C03;&#x7684;&#x670D;&#x52A1;&#xFF0C;&#x8FD9;&#x4E9B;&#x670D;&#x52A1;&#x5305;&#x62EC;&#x914D;&#x7F6E;&#x670D;&#x52A1;&#xFF0C;&#x7EF4;&#x62A4;&#x5143;&#x4FE1;&#x606F;&#x548C;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x670D;&#x52A1;&#xFF09;&#x3002;&#x518D;&#x800C;&#xFF0C;HBase &#x672C;&#x8EAB;&#x53EA;&#x63D0;&#x4F9B;&#x4E86; Java &#x7684; API &#x63A5;&#x53E3;&#xFF0C;&#x5E76;&#x4E0D;&#x76F4;&#x63A5;&#x652F;&#x6301; SQL &#x7684;&#x8BED;&#x53E5;&#x67E5;&#x8BE2;&#xFF0C;&#x800C; Hive &#x5219;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4F7F;&#x7528; HQL&#xFF08;&#x4E00;&#x79CD;&#x7C7B; SQL &#x8BED;&#x8A00;&#xFF09;&#x3002;&#x5982;&#x679C;&#x60F3;&#x8981;&#x5728; HBase &#x4E0A;&#x4F7F;&#x7528; SQL&#xFF0C;&#x5219;&#x9700;&#x8981;&#x8054;&#x5408;&#x4F7F;&#x7528; Apache Phonenix&#xFF0C;&#x6216;&#x8005;&#x8054;&#x5408;&#x4F7F;&#x7528; Hive &#x548C; HBase&#x3002;</p>
<p>&#x4F46;&#x662F;&#x548C;&#x4E0A;&#x9762;&#x63D0;&#x5230;&#x7684;&#x4E00;&#x6837;&#xFF0C;&#x5982;&#x679C;&#x96C6;&#x6210;&#x4F7F;&#x7528; Hive &#x67E5;&#x8BE2; HBase &#x7684;&#x6570;&#x636E;&#xFF0C;&#x5219;&#x65E0;&#x6CD5;&#x7ED5;&#x8FC7; MapReduce&#xFF0C;&#x90A3;&#x4E48;&#x5B9E;&#x65F6;&#x6027;&#x8FD8;&#x662F;&#x6709;&#x4E00;&#x5B9A;&#x7684;&#x635F;&#x5931;&#x3002;Phoenix &#x52A0; HBase &#x7684;&#x7EC4;&#x5408;&#x5219;&#x4E0D;&#x7ECF;&#x8FC7; MapReduce &#x7684;&#x6846;&#x67B6;&#xFF0C;&#x56E0;&#x6B64;&#x5F53;&#x4F7F;&#x7528; Phoneix &#x52A0; HBase &#x7684;&#x7EC4;&#x6210;&#xFF0C;&#x5B9E;&#x65F6;&#x6027;&#x4E0A;&#x4F1A;&#x4F18;&#x4E8E; Hive &#x52A0; HBase &#x7684;&#x7EC4;&#x5408;&#xFF0C;&#x6211;&#x4EEC;&#x540E;&#x7EED;&#x4E5F;&#x4F1A;&#x793A;&#x4F8B;&#x6027;&#x4ECB;&#x7ECD;&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x4E24;&#x8005;&#x3002;&#x6700;&#x540E;&#x6211;&#x4EEC;&#x518D;&#x63D0;&#x4E0B; Hive &#x548C; HBase &#x6240;&#x4F7F;&#x7528;&#x7684;&#x5B58;&#x50A8;&#x5C42;&#xFF0C;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B; Hive &#x548C; HBase &#x7684;&#x5B58;&#x50A8;&#x5C42;&#x90FD;&#x662F; HDFS&#x3002;&#x4F46;&#x662F; HBase &#x5728;&#x4E00;&#x4E9B;&#x7279;&#x6B8A;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x4E5F;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x672C;&#x673A;&#x7684;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x3002;&#x4F8B;&#x5982; Ambari &#x4E2D;&#x7684; AMS &#x670D;&#x52A1;&#x76F4;&#x63A5;&#x5728;&#x672C;&#x5730;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E0A;&#x8FD0;&#x884C; HBase&#x3002;</p>
<h3 id="hbase-&#x4E0E;&#x4F20;&#x7EDF;&#x5173;&#x7CFB;&#x6570;&#x636E;&#x5E93;&#x7684;&#x533A;&#x522B;">HBase &#x4E0E;&#x4F20;&#x7EDF;&#x5173;&#x7CFB;&#x6570;&#x636E;&#x5E93;&#x7684;&#x533A;&#x522B;</h3>
<p>&#x9996;&#x5148;&#x8BA9;&#x6211;&#x4EEC;&#x4E86;&#x89E3;&#x4E0B;&#x4EC0;&#x4E48;&#x662F; ACID&#x3002;ACID &#x662F;&#x6307;&#x6570;&#x636E;&#x5E93;&#x4E8B;&#x52A1;&#x6B63;&#x786E;&#x6267;&#x884C;&#x7684;&#x56DB;&#x4E2A;&#x57FA;&#x672C;&#x8981;&#x7D20;&#x7684;&#x7F29;&#x5199;&#xFF0C;&#x5176;&#x5305;&#x542B;&#xFF1A;&#x539F;&#x5B50;&#x6027;&#xFF08;Atomicity&#xFF09;&#x3001;&#x4E00;&#x81F4;&#x6027;&#xFF08;Consistency&#xFF09;&#x3001;&#x9694;&#x79BB;&#x6027;&#xFF08;Isolation&#xFF09;&#x4EE5;&#x53CA;&#x6301;&#x4E45;&#x6027;&#xFF08;Durability&#xFF09;&#x3002;&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x652F;&#x6301;&#x4E8B;&#x52A1;&#xFF08;Transaction&#xFF09;&#x7684;&#x6570;&#x636E;&#x5E93;&#x7CFB;&#x7EDF;&#xFF0C;&#x5FC5;&#x9700;&#x8981;&#x5177;&#x6709;&#x8FD9;&#x56DB;&#x79CD;&#x7279;&#x6027;&#xFF0C;&#x5426;&#x5219;&#x5728;&#x4E8B;&#x52A1;&#x8FC7;&#x7A0B;&#xFF08;Transaction Processing&#xFF09;&#x5F53;&#x4E2D;&#x65E0;&#x6CD5;&#x4FDD;&#x8BC1;&#x6570;&#x636E;&#x7684;&#x6B63;&#x786E;&#x6027;&#xFF0C;&#x4EA4;&#x6613;&#x8FC7;&#x7A0B;&#x6781;&#x53EF;&#x80FD;&#x8FBE;&#x4E0D;&#x5230;&#x4EA4;&#x6613;&#x65B9;&#x7684;&#x8981;&#x6C42;&#x3002;&#x4E0B;&#x9762;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x7B80;&#x5355;&#x7684;&#x4ECB;&#x7ECD;&#x4E0B;&#x8FD9; 4 &#x4E2A;&#x7279;&#x6027;&#x7684;&#x542B;&#x4E49;&#x3002;</p>
<ul>
<li>
<p>&#x539F;&#x5B50;&#x6027;(Atomicity)&#x662F;&#x6307;&#x4E00;&#x4E2A;&#x4E8B;&#x52A1;&#x8981;&#x4E48;&#x5168;&#x90E8;&#x6267;&#x884C;,&#x8981;&#x4E48;&#x5168;&#x90E8;&#x4E0D;&#x6267;&#x884C;&#x3002;&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x4E00;&#x4E2A;&#x4E8B;&#x52A1;&#x4E0D;&#x53EF;&#x80FD;&#x53EA;&#x6267;&#x884C;&#x4E86;&#x4E00;&#x534A;&#x5C31;&#x505C;&#x6B62;&#x4E86;&#x3002;&#x6BD4;&#x5982;&#x4E00;&#x4E2A;&#x4E8B;&#x60C5;&#x5206;&#x4E3A;&#x4E24;&#x6B65;&#x5B8C;&#x6210;&#x624D;&#x53EF;&#x4EE5;&#x5B8C;&#x6210;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E24;&#x6B65;&#x5FC5;&#x987B;&#x540C;&#x65F6;&#x5B8C;&#x6210;&#xFF0C;&#x8981;&#x4E48;&#x4E00;&#x6B65;&#x4E5F;&#x4E0D;&#x6267;&#x884C;&#xFF0C;&#x7EDD;&#x4E0D;&#x4F1A;&#x505C;&#x7559;&#x5728;&#x67D0;&#x4E00;&#x4E2A;&#x4E2D;&#x95F4;&#x72B6;&#x6001;&#x3002;&#x5982;&#x679C;&#x4E8B;&#x7269;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x53D1;&#x751F;&#x9519;&#x8BEF;&#xFF0C;&#x7CFB;&#x7EDF;&#x4F1A;&#x5C06;&#x4E8B;&#x7269;&#x7684;&#x72B6;&#x6001;&#x56DE;&#x6EDA;&#x5230;&#x6700;&#x5F00;&#x59CB;&#x7684;&#x72B6;&#x6001;&#x3002;</p>
</li>
<li>
<p>&#x4E00;&#x81F4;&#x6027;(Consistency)&#x662F;&#x6307;&#x4E8B;&#x52A1;&#x7684;&#x8FD0;&#x884C;&#x5E76;&#x4E0D;&#x6539;&#x53D8;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x6570;&#x636E;&#x7684;&#x4E00;&#x81F4;&#x6027;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x65E0;&#x8BBA;&#x5E76;&#x53D1;&#x4E8B;&#x52A1;&#x6709;&#x591A;&#x5C11;&#x4E2A;&#xFF0C;&#x4F46;&#x662F;&#x5FC5;&#x987B;&#x4FDD;&#x8BC1;&#x6570;&#x636E;&#x4ECE;&#x4E00;&#x4E2A;&#x4E00;&#x81F4;&#x6027;&#x7684;&#x72B6;&#x6001;&#x8F6C;&#x6362;&#x5230;&#x53E6;&#x4E00;&#x4E2A;&#x4E00;&#x81F4;&#x6027;&#x7684;&#x72B6;&#x6001;&#x3002;&#x4F8B;&#x5982;&#x6709; a&#x3001;b &#x4E24;&#x4E2A;&#x8D26;&#x6237;&#xFF0C;&#x5206;&#x522B;&#x90FD;&#x662F; 10&#x3002;&#x5F53; a &#x589E;&#x52A0; 5 &#x65F6;&#xFF0C;b &#x4E5F;&#x4F1A;&#x968F;&#x7740;&#x6539;&#x53D8;&#xFF0C;&#x603B;&#x503C; 20 &#x662F;&#x4E0D;&#x4F1A;&#x6539;&#x53D8;&#x7684;&#x3002;</p>
</li>
<li>
<p>&#x9694;&#x79BB;&#x6027;&#xFF08;Isolation&#xFF09;&#x662F;&#x6307;&#x4E24;&#x4E2A;&#x4EE5;&#x4E0A;&#x7684;&#x4E8B;&#x52A1;&#x4E0D;&#x4F1A;&#x51FA;&#x73B0;&#x4EA4;&#x9519;&#x6267;&#x884C;&#x7684;&#x72B6;&#x6001;&#x3002;&#x56E0;&#x4E3A;&#x8FD9;&#x6837;&#x53EF;&#x80FD;&#x4F1A;&#x5BFC;&#x81F4;&#x6570;&#x636E;&#x4E0D;&#x4E00;&#x81F4;&#x3002;&#x5982;&#x679C;&#x6709;&#x591A;&#x4E2A;&#x4E8B;&#x52A1;&#xFF0C;&#x8FD0;&#x884C;&#x5728;&#x76F8;&#x540C;&#x7684;&#x65F6;&#x95F4;&#x5185;&#xFF0C;&#x6267;&#x884C;&#x76F8;&#x540C;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x4E8B;&#x52A1;&#x7684;&#x9694;&#x79BB;&#x6027;&#x5C06;&#x786E;&#x4FDD;&#x6BCF;&#x4E00;&#x4E8B;&#x52A1;&#x5728;&#x7CFB;&#x7EDF;&#x4E2D;&#x8BA4;&#x4E3A;&#x53EA;&#x6709;&#x8BE5;&#x4E8B;&#x52A1;&#x5728;&#x4F7F;&#x7528;&#x7CFB;&#x7EDF;&#x3002;&#x8FD9;&#x79CD;&#x5C5E;&#x6027;&#x6709;&#x65F6;&#x79F0;&#x4E3A;&#x4E32;&#x884C;&#x5316;&#xFF0C;&#x4E3A;&#x4E86;&#x9632;&#x6B62;&#x4E8B;&#x52A1;&#x64CD;&#x4F5C;&#x95F4;&#x7684;&#x6DF7;&#x6DC6;&#xFF0C;&#x5FC5;&#x987B;&#x4E32;&#x884C;&#x5316;&#x6216;&#x5E8F;&#x5217;&#x5316;&#x8BF7;&#x6C42;&#xFF0C;&#x4F7F;&#x5F97;&#x5728;&#x540C;&#x4E00;&#x65F6;&#x95F4;&#x4EC5;&#x6709;&#x4E00;&#x4E2A;&#x8BF7;&#x6C42;&#x7528;&#x4E8E;&#x540C;&#x4E00;&#x6570;&#x636E;&#x3002;</p>
</li>
<li>
<p>&#x6301;&#x4E45;&#x6027;(Durability)&#x6307;&#x4E8B;&#x52A1;&#x6267;&#x884C;&#x6210;&#x529F;&#x4EE5;&#x540E;,&#x8BE5;&#x4E8B;&#x52A1;&#x5BF9;&#x6570;&#x636E;&#x5E93;&#x6240;&#x4F5C;&#x7684;&#x66F4;&#x6539;&#x4FBF;&#x662F;&#x6301;&#x4E45;&#x7684;&#x4FDD;&#x5B58;&#x5728;&#x6570;&#x636E;&#x5E93;&#x4E4B;&#x4E2D;&#xFF0C;&#x4E0D;&#x4F1A;&#x65E0;&#x7F18;&#x65E0;&#x6545;&#x7684;&#x56DE;&#x6EDA;&#x3002;</p>
</li>
</ul>
<p>&#x5728;&#x5177;&#x4F53;&#x7684;&#x4ECB;&#x7ECD; HBase &#x4E4B;&#x524D;&#xFF0C;&#x6211;&#x4EEC;&#x5148;&#x7B80;&#x5355;&#x5BF9;&#x6BD4;&#x4E0B; HBase &#x4E0E;&#x4F20;&#x7EDF;&#x5173;&#x7CFB;&#x6570;&#x636E;&#x5E93;&#x7684;&#xFF08;RDBMS&#xFF0C;&#x5168;&#x79F0;&#x4E3A; Relational Database Management System&#xFF09;&#x533A;&#x522B;&#x3002;&#x5982;&#x8868; 1 &#x6240;&#x793A;&#x3002;</p>
<p>&#x8868; 1. HBase &#x4E0E; RDBMS &#x7684;&#x533A;&#x522B;</p>
<table>
<thead>
<tr>
<th></th>
<th>HBase</th>
<th>RDBMS</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x786C;&#x4EF6;&#x67B6;&#x6784;</td>
<td>&#x7C7B;&#x4F3C;&#x4E8E; Hadoop &#x7684;&#x5206;&#x5E03;&#x5F0F;&#x96C6;&#x7FA4;&#xFF0C;&#x786C;&#x4EF6;&#x6210;&#x672C;&#x4F4E;&#x5EC9;</td>
<td>&#x4F20;&#x7EDF;&#x7684;&#x591A;&#x6838;&#x7CFB;&#x7EDF;&#xFF0C;&#x786C;&#x4EF6;&#x6210;&#x672C;&#x6602;&#x8D35;</td>
</tr>
<tr>
<td>&#x5BB9;&#x9519;&#x6027;</td>
<td>&#x7531;&#x8F6F;&#x4EF6;&#x67B6;&#x6784;&#x5B9E;&#x73B0;&#xFF0C;&#x7531;&#x4E8E;&#x7531;&#x591A;&#x4E2A;&#x8282;&#x70B9;&#x7EC4;&#x6210;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x62C5;&#x5FC3;&#x4E00;&#x70B9;&#x6216;&#x51E0;&#x70B9;&#x5B95;&#x673A;</td>
<td>&#x4E00;&#x822C;&#x9700;&#x8981;&#x989D;&#x5916;&#x786C;&#x4EF6;&#x8BBE;&#x5907;&#x5B9E;&#x73B0; HA &#x673A;&#x5236;</td>
</tr>
<tr>
<td>&#x6570;&#x636E;&#x5E93;&#x5927;&#x5C0F;</td>
<td>PB</td>
<td>GB&#x3001;TB</td>
</tr>
<tr>
<td>&#x6570;&#x636E;&#x6392;&#x5E03;&#x65B9;&#x5F0F;</td>
<td>&#x7A00;&#x758F;&#x7684;&#x3001;&#x5206;&#x5E03;&#x7684;&#x591A;&#x7EF4;&#x7684; Map</td>
<td>&#x4EE5;&#x884C;&#x548C;&#x5217;&#x7EC4;&#x7EC7;</td>
</tr>
<tr>
<td>&#x6570;&#x636E;&#x7C7B;&#x578B;</td>
<td>Bytes</td>
<td>&#x4E30;&#x5BCC;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;</td>
</tr>
<tr>
<td>&#x4E8B;&#x7269;&#x652F;&#x6301;</td>
<td>ACID &#x53EA;&#x652F;&#x6301;&#x5355;&#x4E2A; Row &#x7EA7;&#x522B;</td>
<td>&#x5168;&#x9762;&#x7684; ACID &#x652F;&#x6301;&#xFF0C;&#x5BF9; Row &#x548C;&#x8868;</td>
</tr>
<tr>
<td>&#x67E5;&#x8BE2;&#x8BED;&#x8A00;</td>
<td>&#x53EA;&#x652F;&#x6301; Java API &#xFF08;&#x9664;&#x975E;&#x4E0E;&#x5176;&#x4ED6;&#x6846;&#x67B6;&#x4E00;&#x8D77;&#x4F7F;&#x7528;&#xFF0C;&#x5982; Phoenix&#x3001;Hive&#xFF09;</td>
<td>SQL</td>
</tr>
<tr>
<td>&#x7D22;&#x5F15;</td>
<td>&#x53EA;&#x652F;&#x6301; Row-key&#xFF0C;&#x9664;&#x975E;&#x4E0E;&#x5176;&#x4ED6;&#x6280;&#x672F;&#x4E00;&#x8D77;&#x5E94;&#x7528;&#xFF0C;&#x5982; Phoenix&#x3001;Hive</td>
<td>&#x652F;&#x6301;</td>
</tr>
<tr>
<td>&#x541E;&#x5410;&#x91CF;</td>
<td>&#x767E;&#x4E07;&#x67E5;&#x8BE2;/&#x6BCF;&#x79D2;</td>
<td>&#x6570;&#x5343;&#x67E5;&#x8BE2;/&#x6BCF;&#x79D2;</td>
</tr>
</tbody>
</table>
<p>&#x7406;&#x89E3;&#x4E86;&#x4E0A;&#x9762;&#x7684;&#x8868;&#x683C;&#x4E4B;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x5728;&#x770B;&#x770B;&#x6570;&#x636E;&#x662F;&#x5982;&#x4F55;&#x5728; HBase &#x4EE5;&#x53CA; RDBMS &#x4E2D;&#x6392;&#x5E03;&#x7684;&#x3002;&#x9996;&#x5148;&#xFF0C;&#x6570;&#x636E;&#x5728; RDBMS &#x7684;&#x6392;&#x5E03;&#x5927;&#x81F4;&#x5982;&#x8868; 2&#x3002;</p>
<p>&#x8868; 2. &#x6570;&#x636E;&#x5728; RDBMS &#x4E2D;&#x7684;&#x6392;&#x5E03;&#x793A;&#x4F8B;</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>&#x59D3;</th>
<th>&#x540D;</th>
<th>&#x5BC6;&#x7801;</th>
<th>&#x65F6;&#x95F4;&#x6233;</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>&#x5F20;</td>
<td>&#x4E09;</td>
<td>111</td>
<td>20160719</td>
</tr>
<tr>
<td>2</td>
<td>&#x674E;</td>
<td>&#x56DB;</td>
<td>222</td>
<td>20160720</td>
</tr>
</tbody>
</table>
<p>&#x90A3;&#x4E48;&#x6570;&#x636E;&#x5728; HBase &#x4E2D;&#x7684;&#x6392;&#x5E03;&#x4F1A;&#x662F;&#x4EC0;&#x4E48;&#x6837;&#x5B50;&#x5462;&#xFF1F;&#x5982;&#x8868; 3 &#x6240;&#x793A;&#xFF08;&#x8FD9;&#x53EA;&#x662F;&#x903B;&#x8F91;&#x4E0A;&#x7684;&#x6392;&#x5E03;&#xFF09;&#x3002;</p>
<table>
<thead>
<tr>
<th>Row-Key</th>
<th>Value&#xFF08;CF&#x3001;Qualifier&#x3001;Version&#xFF09;</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>info{&apos;&#x59D3;&apos;: &apos;&#x5F20;&apos;&#xFF0C;&apos;&#x540D;&apos;:&apos;&#x4E09;&apos;} pwd{&apos;&#x5BC6;&#x7801;&apos;: &apos;111&apos;}</td>
</tr>
<tr>
<td>2</td>
<td>Info{&apos;&#x59D3;&apos;: &apos;&#x674E;&apos;&#xFF0C;&apos;&#x540D;&apos;:&apos;&#x56DB;&apos;} pwd{&apos;&#x5BC6;&#x7801;&apos;: &apos;222&apos;}</td>
</tr>
</tbody>
</table>
<p>&#x4ECE;&#x4E0A;&#x9762;&#x793A;&#x4F8B;&#x8868;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x5728; HBase &#x4E2D;&#x9996;&#x5148;&#x4F1A;&#x6709; Column Family &#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x7B80;&#x79F0;&#x4E3A; CF&#x3002;CF &#x4E00;&#x822C;&#x7528;&#x4E8E;&#x5C06;&#x76F8;&#x5173;&#x7684;&#x5217;&#xFF08;Column&#xFF09;&#x7EC4;&#x5408;&#x8D77;&#x6765;&#x3002;&#x5728;&#x7269;&#x7406;&#x4E0A; HBase &#x5176;&#x5B9E;&#x662F;&#x6309; CF &#x5B58;&#x50A8;&#x7684;&#xFF0C;&#x53EA;&#x662F;&#x6309;&#x7167; Row-key &#x5C06;&#x76F8;&#x5173; CF &#x4E2D;&#x7684;&#x5217;&#x5173;&#x8054;&#x8D77;&#x6765;&#x3002;&#x7269;&#x7406;&#x4E0A;&#x7684;&#x6570;&#x636E;&#x6392;&#x5E03;&#x5927;&#x81F4;&#x53EF;&#x4EE5;&#x5982;&#x8868; 4 &#x6240;&#x793A;&#x3002;</p>
<table>
<thead>
<tr>
<th>Row-Key</th>
<th>CF:Column-Key</th>
<th>&#x65F6;&#x95F4;&#x6233;</th>
<th>Cell Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>info:fn</td>
<td>123456789</td>
<td>&#x4E09;</td>
</tr>
<tr>
<td>1</td>
<td>info:ln</td>
<td>123456789</td>
<td>&#x5F20;</td>
</tr>
<tr>
<td>2</td>
<td>info:fn</td>
<td>123456789</td>
<td>&#x56DB;</td>
</tr>
<tr>
<td>2</td>
<td>info:ln</td>
<td>123456789</td>
<td>&#x674E;</td>
</tr>
</tbody>
</table>
<p>&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x63D0;&#x5230; HBase &#x662F;&#x6309;&#x7167; CF &#x6765;&#x5B58;&#x50A8;&#x6570;&#x636E;&#x7684;&#x3002;&#x5728;&#x8868; 3 &#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x770B;&#x5230;&#x4E86;&#x4E24;&#x4E2A; CF&#xFF0C;&#x5206;&#x522B;&#x662F; info &#x548C; pwd&#x3002;info &#x5B58;&#x50A8;&#x7740;&#x59D3;&#x540D;&#x76F8;&#x5173;&#x5217;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x800C; pwd &#x5219;&#x662F;&#x5BC6;&#x7801;&#x76F8;&#x5173;&#x7684;&#x6570;&#x636E;&#x3002;&#x4E0A;&#x8868;&#x4FBF;&#x662F; info &#x8FD9;&#x4E2A; CF &#x5B58;&#x50A8;&#x5728; Hbase &#x4E2D;&#x7684;&#x6570;&#x636E;&#x6392;&#x5E03;&#x3002;Pwd &#x7684;&#x6570;&#x636E;&#x6392;&#x5E03;&#x662F;&#x7C7B;&#x4F3C;&#x7684;&#x3002;&#x4E0A;&#x8868;&#x4E2D;&#x7684; fn &#x548C; ln &#x79F0;&#x4E4B;&#x4E3A; Column-key &#x6216;&#x8005; Qulifimer&#x3002;&#x5728; Hbase &#x4E2D;&#xFF0C;Row-key &#x52A0;&#x4E0A; CF &#x52A0;&#x4E0A; Qulifier &#x518D;&#x52A0;&#x4E0A;&#x4E00;&#x4E2A;&#x65F6;&#x95F4;&#x6233;&#x624D;&#x53EF;&#x4EE5;&#x5B9A;&#x4F4D;&#x5230;&#x4E00;&#x4E2A;&#x5355;&#x5143;&#x683C;&#x6570;&#x636E;&#xFF08;Hbase &#x4E2D;&#x6BCF;&#x4E2A;&#x5355;&#x5143;&#x683C;&#x9ED8;&#x8BA4;&#x6709; 3 &#x4E2A;&#x65F6;&#x95F4;&#x6233;&#x7684;&#x7248;&#x672C;&#x6570;&#x636E;&#xFF09;&#x3002;&#x521D;&#x5B66;&#x8005;&#xFF0C;&#x5728;&#x4E00;&#x5F00;&#x59CB;&#x63A5;&#x89E6;&#x8FD9;&#x4E9B;&#x6982;&#x5FF5;&#x662F;&#x5F88;&#x5BB9;&#x6613;&#x6DF7;&#x6DC6;&#x3002;&#x5176;&#x5B9E;&#x4E0D;&#x7BA1;&#x662F; CF &#x8FD8;&#x662F; Qulifier &#x90FD;&#x662F;&#x5BA2;&#x6237;&#x5B9A;&#x4E49;&#x51FA;&#x6765;&#x7684;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x5728; HBase &#x4E2D;&#x521B;&#x5EFA;&#x8868;&#x683C;&#x65F6;&#xFF0C;&#x5C31;&#x9700;&#x8981;&#x6307;&#x5B9A;&#x8868;&#x683C;&#x7684; CF&#x3001;Row-key &#x4EE5;&#x53CA; Qulifier&#x3002;&#x6211;&#x4EEC;&#x4F1A;&#x5728;&#x540E;&#x7EED;&#x7684;&#x4ECB;&#x7ECD;&#x4E2D;&#xFF0C;&#x5C1D;&#x8BD5;&#x6307;&#x5B9A;&#x8FD9;&#x4E9B;&#x76F8;&#x5173;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x4EE5;&#x4FBF;&#x52A0;&#x6DF1;&#x7406;&#x89E3;&#x3002;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x5148;&#x901A;&#x8FC7;&#x4E0B;&#x56FE;&#x7406;&#x89E3;&#x4E0B; HBase &#x4E2D;&#xFF0C;&#x903B;&#x8F91;&#x4E0A;&#x7684;&#x6570;&#x636E;&#x6392;&#x5E03;&#x4E0E;&#x7269;&#x7406;&#x4E0A;&#x7684;&#x6570;&#x636E;&#x6392;&#x5E03;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;&#x3002;</p>
<p>&#x56FE; 1. Hbase &#x4E2D;&#x903B;&#x8F91;&#x4E0A;&#x6570;&#x636E;&#x7684;&#x6392;&#x5E03;&#x4E0E;&#x7269;&#x7406;&#x4E0A;&#x6392;&#x5E03;&#x7684;&#x5173;&#x8054;</p>
<p><img src="/images/hbase-logic-data.png" alt="Hbase&#x6570;&#x636E;&#x5206;&#x5E03;"></p>
<p>&#x4ECE;&#x4E0A;&#x56FE;&#x6211;&#x4EEC;&#x770B;&#x5230; Row1 &#x5230; Row5 &#x7684;&#x6570;&#x636E;&#x5206;&#x5E03;&#x5728;&#x4E24;&#x4E2A; CF &#x4E2D;&#xFF0C;&#x5E76;&#x4E14;&#x6BCF;&#x4E2A; CF &#x5BF9;&#x5E94;&#x4E00;&#x4E2A; HFile&#x3002;&#x5E76;&#x4E14;&#x903B;&#x8F91;&#x4E0A;&#x6BCF;&#x4E00;&#x884C;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x5355;&#x5143;&#x683C;&#x6570;&#x636E;&#xFF0C;&#x5BF9;&#x5E94;&#x4E8E; HFile &#x4E2D;&#x7684;&#x4E00;&#x884C;&#xFF0C;&#x7136;&#x540E;&#x5F53;&#x7528;&#x6237;&#x6309;&#x7167; Row-key &#x67E5;&#x8BE2;&#x6570;&#x636E;&#x7684;&#x65F6;&#x5019;&#xFF0C;HBase &#x4F1A;&#x904D;&#x5386;&#x4E24;&#x4E2A; HFile&#xFF0C;&#x901A;&#x8FC7;&#x76F8;&#x540C;&#x7684; Row-Key &#x6807;&#x8BC6;&#xFF0C;&#x5C06;&#x76F8;&#x5173;&#x7684;&#x5355;&#x5143;&#x683C;&#x7EC4;&#x7EC7;&#x6210;&#x884C;&#x8FD4;&#x56DE;&#xFF0C;&#x8FD9;&#x6837;&#x4FBF;&#x6709;&#x4E86;&#x903B;&#x8F91;&#x4E0A;&#x7684;&#x884C;&#x6570;&#x636E;&#x3002;&#x8BB2;&#x89E3;&#x5230;&#x8FD9;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x5927;&#x81F4;&#x4E86;&#x89E3; HBase &#x4E2D;&#x7684;&#x6570;&#x636E;&#x6392;&#x5E03;&#x683C;&#x5F0F;&#xFF0C;&#x4EE5;&#x53CA;&#x4E0E; RDBMS &#x7684;&#x4E00;&#x4E9B;&#x533A;&#x522B;&#x3002;</p>
<p>&#x5BF9;&#x4E8E; RDBMS &#x6765;&#x8BF4;&#xFF0C;&#x4E00;&#x822C;&#x90FD;&#x662F;&#x4EE5; SQL &#x4F5C;&#x4E3A;&#x4E3A;&#x4E3B;&#x8981;&#x7684;&#x8BBF;&#x95EE;&#x65B9;&#x5F0F;&#x3002;&#x800C; HBase &#x662F;&#x4E00;&#x79CD;&quot;NoSQL&quot;&#x6570;&#x636E;&#x5E93;&#x3002;&quot;NoSQL&quot;&#x662F;&#x4E00;&#x4E2A;&#x901A;&#x7528;&#x8BCD;&#x8868;&#x793A;&#x8BE5;&#x6570;&#x636E;&#x5E93;&#x5E76;&#x4E0D;&#x662F; RDBMS &#x3002;&#x73B0;&#x5728;&#x7684;&#x5E02;&#x9762;&#x4E0A;&#x6709;&#x8BB8;&#x591A;&#x79CD; NoSQL &#x6570;&#x636E;&#x5E93;&#xFF0C;&#x5982; BerkeleyDB &#x662F;&#x672C;&#x5730; NoSQL &#x6570;&#x636E;&#x5E93;&#x7684;&#x4F8B;&#x5B50;, HBase &#x5219;&#x4E3A;&#x5927;&#x578B;&#x5206;&#x5E03;&#x5F0F; NoSql &#x6570;&#x636E;&#x5E93;&#x3002;&#x4ECE;&#x6280;&#x672F;&#x4E0A;&#x6765;&#x8BF4;&#xFF0C;Hbase &#x66F4;&#x50CF;&#x662F;&quot;&#x6570;&#x636E;&#x5B58;&#x50A8;&quot;&#x800C;&#x975E;&quot;&#x6570;&#x636E;&#x5E93;&quot;&#xFF08;HBase &#x548C; HDFS &#x90FD;&#x5C5E;&#x4E8E;&#x5927;&#x6570;&#x636E;&#x7684;&#x5B58;&#x50A8;&#x5C42;&#xFF09;&#x3002;&#x56E0;&#x6B64;&#xFF0C;HBase &#x7F3A;&#x5C11;&#x5F88;&#x591A; RDBMS &#x7279;&#x6027;&#xFF0C;&#x5982;&#x5217;&#x7C7B;&#x578B;&#xFF0C;&#x4E8C;&#x7EA7;&#x7D22;&#x5F15;&#xFF0C;&#x89E6;&#x53D1;&#x5668;&#x548C;&#x9AD8;&#x7EA7;&#x67E5;&#x8BE2;&#x8BED;&#x8A00;&#x7B49;&#x3002;&#x7136;&#x800C;, HBase &#x4E5F;&#x5177;&#x6709;&#x8BB8;&#x591A;&#x5176;&#x4ED6;&#x7279;&#x5F81;&#x540C;&#x65F6;&#x652F;&#x6301;&#x7EBF;&#x6027;&#x5316;&#x548C;&#x6A21;&#x5757;&#x5316;&#x6269;&#x5145;&#x3002;&#x6700;&#x660E;&#x663E;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x589E;&#x52A0; Region Server &#x7684;&#x6570;&#x91CF;&#x6269;&#x5C55; HBase&#x3002;&#x5E76;&#x4E14; HBase &#x53EF;&#x4EE5;&#x653E;&#x5728;&#x666E;&#x901A;&#x7684;&#x670D;&#x52A1;&#x5668;&#x4E2D;&#xFF0C;&#x4F8B;&#x5982;&#x5C06;&#x96C6;&#x7FA4;&#x4ECE; 5 &#x4E2A;&#x6269;&#x5145;&#x5230; 10 &#x4E2A; Region Server &#x65F6;&#xFF0C;&#x5B58;&#x50A8;&#x7A7A;&#x95F4;&#x548C;&#x5904;&#x7406;&#x5BB9;&#x91CF;&#x90FD;&#x53EF;&#x4EE5;&#x540C;&#x65F6;&#x7FFB;&#x500D;&#x3002;&#x5F53;&#x7136; RDBMS &#x4E5F;&#x80FD;&#x5F88;&#x597D;&#x7684;&#x6269;&#x5145;&#xFF0C;&#x4F46;&#x4EC5;&#x5BF9;&#x4E00;&#x4E2A;&#x70B9;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x5BF9;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x6570;&#x636E;&#x5E93;&#x670D;&#x52A1;&#x5668;&#x800C;&#x8A00;&#xFF0C;&#x4E3A;&#x4E86;&#x66F4;&#x597D;&#x7684;&#x6027;&#x80FD;&#xFF0C;&#x5F80;&#x5F80;&#x9700;&#x8981;&#x7279;&#x6B8A;&#x7684;&#x786C;&#x4EF6;&#x548C;&#x5B58;&#x50A8;&#x8BBE;&#x5907;&#xFF08;&#x5F80;&#x5F80;&#x4EF7;&#x683C;&#x4E5F;&#x975E;&#x5E38;&#x6602;&#x8D35;&#xFF09;&#x3002;</p>
<h3 id="hbase-&#x76F8;&#x5173;&#x7684;&#x6A21;&#x5757;&#x4EE5;&#x53CA;-hbase-&#x8868;&#x683C;&#x7684;&#x7279;&#x6027;">HBase &#x76F8;&#x5173;&#x7684;&#x6A21;&#x5757;&#x4EE5;&#x53CA; HBase &#x8868;&#x683C;&#x7684;&#x7279;&#x6027;</h3>
<p>&#x5728;&#x8FD9;&#x91CC;&#xFF0C;&#x8BA9;&#x6211;&#x4EEC;&#x4E86;&#x89E3;&#x4E0B; HBase &#x90FD;&#x6709;&#x54EA;&#x4E9B;&#x6A21;&#x5757;&#xFF0C;&#x4EE5;&#x53CA;&#x5927;&#x81F4;&#x7684;&#x5DE5;&#x4F5C;&#x6D41;&#x7A0B;&#x3002;&#x524D;&#x9762;&#x6211;&#x4EEC;&#x63D0;&#x5230;&#x8FC7; HBase &#x4E5F;&#x662F;&#x6784;&#x5EFA;&#x4E8E; HDFS &#x4E4B;&#x4E0A;&#xFF0C;&#x8FD9;&#x662F;&#x6B63;&#x786E;&#x7684;&#xFF0C;&#x4F46;&#x4E5F;&#x4E0D;&#x662F;&#x5B8C;&#x5168;&#x6B63;&#x786E;&#x3002;HBase &#x5176;&#x5B9E;&#x4E5F;&#x652F;&#x6301;&#x76F4;&#x63A5;&#x5728;&#x672C;&#x5730;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E4B;&#x4E0A;&#x8FD0;&#x884C;&#xFF0C;&#x4E0D;&#x8FC7;&#x8FD9;&#x6837;&#x7684; HBase &#x53EA;&#x80FD;&#x8FD0;&#x884C;&#x5728;&#x4E00;&#x53F0;&#x673A;&#x5668;&#x4E0A;&#xFF0C;&#x90A3;&#x4E48;&#x5BF9;&#x4E8E;&#x5206;&#x5E03;&#x5F0F;&#x5927;&#x6570;&#x636E;&#x7684;&#x73AF;&#x5883;&#x662F;&#x6CA1;&#x6709;&#x610F;&#x4E49;&#x7684;&#xFF08;&#x8FD9;&#x4E5F;&#x662F;&#x6240;&#x8C13;&#x7684; HBase &#x7684;&#x5355;&#x673A;&#x6A21;&#x5F0F;&#xFF09;&#x3002;&#x4E00;&#x822C;&#x53EA;&#x7528;&#x4E8E;&#x6D4B;&#x8BD5;&#x6216;&#x8005;&#x9A8C;&#x8BC1;&#x67D0;&#x4E00;&#x4E2A; HBase &#x7684;&#x529F;&#x80FD;&#xFF0C;&#x540E;&#x9762;&#x6211;&#x4EEC;&#x5728;&#x8BE6;&#x7EC6;&#x7684;&#x4ECB;&#x7ECD; HBase &#x7684;&#x51E0;&#x79CD;&#x8FD0;&#x884C;&#x6A21;&#x5F0F;&#x3002;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x53EA;&#x8981;&#x8BB0;&#x5F97;&#x5728;&#x5206;&#x5E03;&#x5F0F;&#x7684;&#x751F;&#x4EA7;&#x73AF;&#x5883;&#x4E2D;&#xFF0C;HBase &#x9700;&#x8981;&#x8FD0;&#x884C;&#x5728; HDFS &#x4E4B;&#x4E0A;&#xFF0C;&#x4EE5; HDFS &#x4F5C;&#x4E3A;&#x5176;&#x57FA;&#x7840;&#x7684;&#x5B58;&#x50A8;&#x8BBE;&#x65BD;&#x3002;HBase &#x4E0A;&#x5C42;&#x63D0;&#x4F9B;&#x4E86;&#x8BBF;&#x95EE;&#x7684;&#x6570;&#x636E;&#x7684; Java API &#x5C42;&#xFF0C;&#x4F9B;&#x5E94;&#x7528;&#x8BBF;&#x95EE;&#x5B58;&#x50A8;&#x5728; HBase &#x7684;&#x6570;&#x636E;&#x3002;&#x5728; HBase &#x7684;&#x96C6;&#x7FA4;&#x4E2D;&#x4E3B;&#x8981;&#x7531; Master &#x548C; Region Server &#x7EC4;&#x6210;&#xFF0C;&#x4EE5;&#x53CA; Zookeeper&#xFF0C;&#x5177;&#x4F53;&#x6A21;&#x5757;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#x3002;</p>
<p><img src="/images/hbase-module.png" alt="&#x7EC4;&#x6210;Hbase&#x6A21;&#x5757;"></p>
<p>&#x63A5;&#x4E0B;&#x6765;&#xFF0C;&#x6211;&#x4EEC;&#x7B80;&#x5355;&#x7684;&#x4E00;&#x4E00;&#x4ECB;&#x7ECD;&#x4E0B; HBase &#x4E2D;&#x76F8;&#x5173;&#x6A21;&#x5757;&#x7684;&#x4F5C;&#x7528;&#x3002;</p>
<ol>
<li>
<p>Master</p>
<p>HBase Master &#x7528;&#x4E8E;&#x534F;&#x8C03;&#x591A;&#x4E2A; Region Server&#xFF0C;&#x4FA6;&#x6D4B;&#x5404;&#x4E2A; Region Server &#x4E4B;&#x95F4;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x5E76;&#x5E73;&#x8861; Region Server &#x4E4B;&#x95F4;&#x7684;&#x8D1F;&#x8F7D;&#x3002;HBase Master &#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x804C;&#x8D23;&#x5C31;&#x662F;&#x8D1F;&#x8D23;&#x5206;&#x914D; Region &#x7ED9; Region Server&#x3002;HBase &#x5141;&#x8BB8;&#x591A;&#x4E2A; Master &#x8282;&#x70B9;&#x5171;&#x5B58;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x9700;&#x8981; Zookeeper &#x7684;&#x5E2E;&#x52A9;&#x3002;&#x4E0D;&#x8FC7;&#x5F53;&#x591A;&#x4E2A; Master &#x8282;&#x70B9;&#x5171;&#x5B58;&#x65F6;&#xFF0C;&#x53EA;&#x6709;&#x4E00;&#x4E2A; Master &#x662F;&#x63D0;&#x4F9B;&#x670D;&#x52A1;&#x7684;&#xFF0C;&#x5176;&#x4ED6;&#x7684; Master &#x8282;&#x70B9;&#x5904;&#x4E8E;&#x5F85;&#x547D;&#x7684;&#x72B6;&#x6001;&#x3002;&#x5F53;&#x6B63;&#x5728;&#x5DE5;&#x4F5C;&#x7684; Master &#x8282;&#x70B9;&#x5B95;&#x673A;&#x65F6;&#xFF0C;&#x5176;&#x4ED6;&#x7684; Master &#x5219;&#x4F1A;&#x63A5;&#x7BA1; HBase &#x7684;&#x96C6;&#x7FA4;&#x3002;</p>
</li>
<li>
<p>Region Server</p>
<p>&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A; Region Server &#x800C;&#x8A00;&#xFF0C;&#x5176;&#x5305;&#x62EC;&#x4E86;&#x591A;&#x4E2A; Region&#x3002;Region Server &#x7684;&#x4F5C;&#x7528;&#x53EA;&#x662F;&#x7BA1;&#x7406;&#x8868;&#x683C;&#xFF0C;&#x4EE5;&#x53CA;&#x5B9E;&#x73B0;&#x8BFB;&#x5199;&#x64CD;&#x4F5C;&#x3002;Client &#x76F4;&#x63A5;&#x8FDE;&#x63A5; Region Server&#xFF0C;&#x5E76;&#x901A;&#x4FE1;&#x83B7;&#x53D6; HBase &#x4E2D;&#x7684;&#x6570;&#x636E;&#x3002;&#x5BF9;&#x4E8E; Region &#x800C;&#x8A00;&#xFF0C;&#x5219;&#x662F;&#x771F;&#x5B9E;&#x5B58;&#x653E; HBase &#x6570;&#x636E;&#x7684;&#x5730;&#x65B9;&#xFF0C;&#x4E5F;&#x5C31;&#x8BF4; Region &#x662F; HBase &#x53EF;&#x7528;&#x6027;&#x548C;&#x5206;&#x5E03;&#x5F0F;&#x7684;&#x57FA;&#x672C;&#x5355;&#x4F4D;&#x3002;&#x5982;&#x679C;&#x5F53;&#x4E00;&#x4E2A;&#x8868;&#x683C;&#x5F88;&#x5927;&#xFF0C;&#x5E76;&#x7531;&#x591A;&#x4E2A; CF &#x7EC4;&#x6210;&#x65F6;&#xFF0C;&#x90A3;&#x4E48;&#x8868;&#x7684;&#x6570;&#x636E;&#x5C06;&#x5B58;&#x653E;&#x5728;&#x591A;&#x4E2A; Region &#x4E4B;&#x95F4;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x6BCF;&#x4E2A; Region &#x4E2D;&#x4F1A;&#x5173;&#x8054;&#x591A;&#x4E2A;&#x5B58;&#x50A8;&#x7684;&#x5355;&#x5143;&#xFF08;Store&#xFF09;&#x3002;</p>
</li>
<li>
<p>Zookeeper</p>
<p>&#x5BF9;&#x4E8E; HBase &#x800C;&#x8A00;&#xFF0C;Zookeeper &#x7684;&#x4F5C;&#x7528;&#x662F;&#x81F3;&#x5173;&#x91CD;&#x8981;&#x7684;&#x3002;&#x9996;&#x5148; Zookeeper &#x662F;&#x4F5C;&#x4E3A; HBase Master &#x7684; HA &#x89E3;&#x51B3;&#x65B9;&#x6848;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x662F; Zookeeper &#x4FDD;&#x8BC1;&#x4E86;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A; HBase Master &#x5904;&#x4E8E;&#x8FD0;&#x884C;&#x72B6;&#x6001;&#x3002;&#x5E76;&#x4E14; Zookeeper &#x8D1F;&#x8D23; Region &#x548C; Region Server &#x7684;&#x6CE8;&#x518C;&#x3002;&#x5176;&#x5B9E; Zookeeper &#x53D1;&#x5C55;&#x5230;&#x76EE;&#x524D;&#x4E3A;&#x6B62;&#xFF0C;&#x5DF2;&#x7ECF;&#x6210;&#x4E3A;&#x4E86;&#x5206;&#x5E03;&#x5F0F;&#x5927;&#x6570;&#x636E;&#x6846;&#x67B6;&#x4E2D;&#x5BB9;&#x9519;&#x6027;&#x7684;&#x6807;&#x51C6;&#x6846;&#x67B6;&#x3002;&#x4E0D;&#x5149;&#x662F; HBase&#xFF0C;&#x51E0;&#x4E4E;&#x6240;&#x6709;&#x7684;&#x5206;&#x5E03;&#x5F0F;&#x5927;&#x6570;&#x636E;&#x76F8;&#x5173;&#x7684;&#x5F00;&#x6E90;&#x6846;&#x67B6;&#xFF0C;&#x90FD;&#x4F9D;&#x8D56;&#x4E8E; Zookeeper &#x5B9E;&#x73B0; HA&#x3002;</p>
</li>
</ol>
<p>&#x4E00;&#x4E2A;&#x5B8C;&#x6574;&#x5206;&#x5E03;&#x5F0F;&#x7684; HBase &#x7684;&#x5DE5;&#x4F5C;&#x539F;&#x7406;&#x793A;&#x610F;&#x56FE;&#x5982;&#x4E0B;&#xFF1A;
<img src="/images/hbase-work-process.png" alt="Hbase&#x5DE5;&#x4F5C;&#x539F;&#x7406;&#x56FE;"></p>
<p>&#x5728;&#x4E0A;&#x9762;&#x7684;&#x56FE;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x51E0;&#x4E2A;&#x6211;&#x4EEC;&#x4E4B;&#x524D;&#x6CA1;&#x6709;&#x63D0;&#x5230;&#x7684;&#x6982;&#x5FF5;&#xFF1A;Store&#x3001;MemStore&#x3001;StoreFile &#x4EE5;&#x53CA; HFile&#x3002;&#x5E26;&#x7740;&#x8FD9;&#x51E0;&#x4E2A;&#x65B0;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x6211;&#x4EEC;&#x5B8C;&#x6574;&#x7684;&#x68B3;&#x7406;&#x4E0B;&#x6574;&#x4E2A; HBase &#x7684;&#x5DE5;&#x4F5C;&#x6D41;&#x7A0B;&#x3002;</p>
<p>&#x9996;&#x5148;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x77E5;&#x9053; HBase &#x7684;&#x96C6;&#x7FA4;&#x662F;&#x901A;&#x8FC7; Zookeeper &#x6765;&#x8FDB;&#x884C;&#x673A;&#x5668;&#x4E4B;&#x524D;&#x7684;&#x534F;&#x8C03;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4; HBase Master &#x4E0E; Region Server &#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;&#x662F;&#x4F9D;&#x8D56; Zookeeper &#x6765;&#x7EF4;&#x62A4;&#x3002;&#x5F53;&#x4E00;&#x4E2A; Client &#x9700;&#x8981;&#x8BBF;&#x95EE; HBase &#x96C6;&#x7FA4;&#x65F6;&#xFF0C;Client &#x9700;&#x8981;&#x5148;&#x548C; Zookeeper &#x6765;&#x901A;&#x4FE1;&#xFF0C;&#x7136;&#x540E;&#x624D;&#x4F1A;&#x627E;&#x5230;&#x5BF9;&#x5E94;&#x7684; Region Server&#x3002;&#x6BCF;&#x4E00;&#x4E2A; Region Server &#x7BA1;&#x7406;&#x7740;&#x5F88;&#x591A;&#x4E2A; Region&#x3002;&#x5BF9;&#x4E8E; HBase &#x6765;&#x8BF4;&#xFF0C;Region &#x662F; HBase &#x5E76;&#x884C;&#x5316;&#x7684;&#x57FA;&#x672C;&#x5355;&#x5143;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x6570;&#x636E;&#x4E5F;&#x90FD;&#x5B58;&#x50A8;&#x5728; Region &#x4E2D;&#x3002;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x7279;&#x522B;&#x6CE8;&#x610F;&#xFF0C;&#x6BCF;&#x4E00;&#x4E2A; Region &#x90FD;&#x53EA;&#x5B58;&#x50A8;&#x4E00;&#x4E2A; Column Family &#x7684;&#x6570;&#x636E;&#xFF0C;&#x5E76;&#x4E14;&#x662F;&#x8BE5; CF &#x4E2D;&#x7684;&#x4E00;&#x6BB5;&#xFF08;&#x6309; Row &#x7684;&#x533A;&#x95F4;&#x5206;&#x6210;&#x591A;&#x4E2A; Region&#xFF09;&#x3002;Region &#x6240;&#x80FD;&#x5B58;&#x50A8;&#x7684;&#x6570;&#x636E;&#x5927;&#x5C0F;&#x662F;&#x6709;&#x4E0A;&#x9650;&#x7684;&#xFF0C;&#x5F53;&#x8FBE;&#x5230;&#x8BE5;&#x4E0A;&#x9650;&#x65F6;&#xFF08;Threshold&#xFF09;&#xFF0C;Region &#x4F1A;&#x8FDB;&#x884C;&#x5206;&#x88C2;&#xFF0C;&#x6570;&#x636E;&#x4E5F;&#x4F1A;&#x5206;&#x88C2;&#x5230;&#x591A;&#x4E2A; Region &#x4E2D;&#xFF0C;&#x8FD9;&#x6837;&#x4FBF;&#x53EF;&#x4EE5;&#x63D0;&#x9AD8;&#x6570;&#x636E;&#x7684;&#x5E76;&#x884C;&#x5316;&#xFF0C;&#x4EE5;&#x53CA;&#x63D0;&#x9AD8;&#x6570;&#x636E;&#x7684;&#x5BB9;&#x91CF;&#x3002;&#x6BCF;&#x4E2A; Region &#x5305;&#x542B;&#x7740;&#x591A;&#x4E2A; Store &#x5BF9;&#x8C61;&#x3002;&#x6BCF;&#x4E2A; Store &#x5305;&#x542B;&#x4E00;&#x4E2A; MemStore&#xFF0C;&#x548C;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A; HFile&#x3002;MemStore &#x4FBF;&#x662F;&#x6570;&#x636E;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x5B9E;&#x4F53;&#xFF0C;&#x5E76;&#x4E14;&#x4E00;&#x822C;&#x90FD;&#x662F;&#x6709;&#x5E8F;&#x7684;&#x3002;&#x5F53;&#x6570;&#x636E;&#x5411; Region &#x5199;&#x5165;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x5148;&#x5199;&#x5165; MemStore&#x3002;&#x5F53; MemStore &#x4E2D;&#x7684;&#x6570;&#x636E;&#x9700;&#x8981;&#x5411;&#x5E95;&#x5C42;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x503E;&#x5012;&#xFF08;Dump&#xFF09;&#x65F6;&#xFF08;&#x4F8B;&#x5982; MemStore &#x4E2D;&#x7684;&#x6570;&#x636E;&#x4F53;&#x79EF;&#x5230;&#x8FBE; MemStore &#x914D;&#x7F6E;&#x7684;&#x6700;&#x5927;&#x503C;&#xFF09;&#xFF0C;Store &#x4FBF;&#x4F1A;&#x521B;&#x5EFA; StoreFile&#xFF0C;&#x800C; StoreFile &#x5C31;&#x662F;&#x5BF9; HFile &#x4E00;&#x5C42;&#x5C01;&#x88C5;&#x3002;&#x6240;&#x4EE5; MemStore &#x4E2D;&#x7684;&#x6570;&#x636E;&#x4F1A;&#x6700;&#x7EC8;&#x5199;&#x5165;&#x5230; HFile &#x4E2D;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x78C1;&#x76D8; IO&#x3002;&#x7531;&#x4E8E; HBase &#x5E95;&#x5C42;&#x4F9D;&#x9760; HDFS&#xFF0C;&#x56E0;&#x6B64; HFile &#x90FD;&#x5B58;&#x50A8;&#x5728; HDFS &#x4E4B;&#x4E2D;&#x3002;&#x8FD9;&#x4FBF;&#x662F;&#x6574;&#x4E2A; HBase &#x5DE5;&#x4F5C;&#x7684;&#x539F;&#x7406;&#x7B80;&#x8FF0;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x4E86;&#x89E3;&#x4E86; HBase &#x5927;&#x81F4;&#x7684;&#x5DE5;&#x4F5C;&#x539F;&#x7406;&#xFF0C;&#x90A3;&#x4E48;&#x5728; HBase &#x7684;&#x5DE5;&#x4F5C;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x5982;&#x4F55;&#x4FDD;&#x8BC1;&#x6570;&#x636E;&#x7684;&#x53EF;&#x9760;&#x6027;&#x5462;&#xFF1F;&#x5E26;&#x7740;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x6211;&#x4EEC;&#x7406;&#x89E3;&#x4E0B; HLog &#x7684;&#x4F5C;&#x7528;&#x3002;HBase &#x4E2D;&#x7684; HLog &#x673A;&#x5236;&#x662F; WAL &#x7684;&#x4E00;&#x79CD;&#x5B9E;&#x73B0;&#xFF0C;&#x800C; WAL&#xFF08;&#x4E00;&#x822C;&#x7FFB;&#x8BD1;&#x4E3A;&#x9884;&#x5199;&#x65E5;&#x5FD7;&#xFF09;&#x662F;&#x4E8B;&#x52A1;&#x673A;&#x5236;&#x4E2D;&#x5E38;&#x89C1;&#x7684;&#x4E00;&#x81F4;&#x6027;&#x7684;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;&#x3002;&#x6BCF;&#x4E2A; Region Server &#x4E2D;&#x90FD;&#x4F1A;&#x6709;&#x4E00;&#x4E2A; HLog &#x7684;&#x5B9E;&#x4F8B;&#xFF0C;Region Server &#x4F1A;&#x5C06;&#x66F4;&#x65B0;&#x64CD;&#x4F5C;&#xFF08;&#x5982; Put&#xFF0C;Delete&#xFF09;&#x5148;&#x8BB0;&#x5F55;&#x5230; WAL&#xFF08;&#x4E5F;&#x5C31;&#x662F; HLog&#xFF09;&#x4E2D;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x5176;&#x5199;&#x5165;&#x5230; Store &#x7684; MemStore&#xFF0C;&#x6700;&#x7EC8; MemStore &#x4F1A;&#x5C06;&#x6570;&#x636E;&#x5199;&#x5165;&#x5230;&#x6301;&#x4E45;&#x5316;&#x7684; HFile &#x4E2D;&#xFF08;MemStore &#x5230;&#x8FBE;&#x914D;&#x7F6E;&#x7684;&#x5185;&#x5B58;&#x9600;&#x503C;&#xFF09;&#x3002;&#x8FD9;&#x6837;&#x5C31;&#x4FDD;&#x8BC1;&#x4E86; HBase &#x7684;&#x5199;&#x7684;&#x53EF;&#x9760;&#x6027;&#x3002;&#x5982;&#x679C;&#x6CA1;&#x6709; WAL&#xFF0C;&#x5F53; Region Server &#x5B95;&#x6389;&#x7684;&#x65F6;&#x5019;&#xFF0C;MemStore &#x8FD8;&#x6CA1;&#x6709;&#x5199;&#x5165;&#x5230; HFile&#xFF0C;&#x6216;&#x8005; StoreFile &#x8FD8;&#x6CA1;&#x6709;&#x4FDD;&#x5B58;&#xFF0C;&#x6570;&#x636E;&#x5C31;&#x4F1A;&#x4E22;&#x5931;&#x3002;&#x6216;&#x8BB8;&#x6709;&#x7684;&#x8BFB;&#x8005;&#x4F1A;&#x62C5;&#x5FC3; HFile &#x672C;&#x8EAB;&#x4F1A;&#x4E0D;&#x4F1A;&#x4E22;&#x5931;&#xFF0C;&#x8FD9;&#x662F;&#x7531; HDFS &#x6765;&#x4FDD;&#x8BC1;&#x7684;&#x3002;&#x5728; HDFS &#x4E2D;&#x7684;&#x6570;&#x636E;&#x9ED8;&#x8BA4;&#x4F1A;&#x6709; 3 &#x4EFD;&#x3002;&#x56E0;&#x6B64;&#x8FD9;&#x91CC;&#x5E76;&#x4E0D;&#x8003;&#x8651; HFile &#x672C;&#x8EAB;&#x7684;&#x53EF;&#x9760;&#x6027;&#x3002;</p>
<p>&#x524D;&#x9762;&#xFF0C;&#x6211;&#x4EEC;&#x5F88;&#x591A;&#x6B21;&#x63D0;&#x5230;&#x4E86; HFile&#xFF0C;&#x4E5F;&#x5C31;&#x662F; HBase &#x6301;&#x4E45;&#x5316;&#x7684;&#x5B58;&#x50A8;&#x6587;&#x4EF6;&#x3002;&#x4E5F;&#x8BB8;&#x6709;&#x7684;&#x8BFB;&#x8005;&#x8FD8;&#x4E0D;&#x80FD;&#x5B8C;&#x5168;&#x7406;&#x89E3; HFile&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x4FBF;&#x8BE6;&#x7EC6;&#x7684;&#x770B;&#x770B; HFile &#x7684;&#x7ED3;&#x6784;&#xFF0C;&#x5982;&#x4E0B;&#x56FE;&#x3002;</p>
<p><img src="/images/hbase-hfile.png" alt="HFile&#x7ED3;&#x6784;&#x56FE;"></p>
<p>&#x4ECE;&#x56FE;&#x4E2D;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230; HFile &#x7531;&#x5F88;&#x591A;&#x4E2A;&#x6570;&#x636E;&#x5757;&#xFF08;Block&#xFF09;&#x7EC4;&#x6210;&#xFF0C;&#x5E76;&#x4E14;&#x6709;&#x4E00;&#x4E2A;&#x56FA;&#x5B9A;&#x7684;&#x7ED3;&#x5C3E;&#x5757;&#x3002;&#x5176;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x5757;&#x662F;&#x7531;&#x4E00;&#x4E2A; Header &#x548C;&#x591A;&#x4E2A; Key-Value &#x7684;&#x952E;&#x503C;&#x5BF9;&#x7EC4;&#x6210;&#x3002;&#x5728;&#x7ED3;&#x5C3E;&#x7684;&#x6570;&#x636E;&#x5757;&#x4E2D;&#x5305;&#x542B;&#x4E86;&#x6570;&#x636E;&#x76F8;&#x5173;&#x7684;&#x7D22;&#x5F15;&#x4FE1;&#x606F;&#xFF0C;&#x7CFB;&#x7EDF;&#x4E5F;&#x662F;&#x901A;&#x8FC7;&#x7ED3;&#x5C3E;&#x7684;&#x7D22;&#x5F15;&#x4FE1;&#x606F;&#x627E;&#x5230; HFile &#x4E2D;&#x7684;&#x6570;&#x636E;&#x3002;HFile &#x4E2D;&#x7684;&#x6570;&#x636E;&#x5757;&#x5927;&#x5C0F;&#x9ED8;&#x8BA4;&#x4E3A; 64KB&#x3002;&#x5982;&#x679C;&#x8BBF;&#x95EE; HBase &#x6570;&#x636E;&#x5E93;&#x7684;&#x573A;&#x666F;&#x591A;&#x4E3A;&#x6709;&#x5E8F;&#x7684;&#x8BBF;&#x95EE;&#xFF0C;&#x90A3;&#x4E48;&#x5EFA;&#x8BAE;&#x5C06;&#x8BE5;&#x503C;&#x8BBE;&#x7F6E;&#x7684;&#x5927;&#x4E00;&#x4E9B;&#x3002;&#x5982;&#x679C;&#x573A;&#x666F;&#x591A;&#x4E3A;&#x968F;&#x673A;&#x8BBF;&#x95EE;&#xFF0C;&#x90A3;&#x4E48;&#x5EFA;&#x8BAE;&#x5C06;&#x8BE5;&#x503C;&#x8BBE;&#x7F6E;&#x7684;&#x5C0F;&#x4E00;&#x4E9B;&#x3002;&#x4E00;&#x822C;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x901A;&#x8FC7;&#x8C03;&#x6574;&#x8BE5;&#x503C;&#x53EF;&#x4EE5;&#x63D0;&#x9AD8; HBase &#x7684;&#x6027;&#x80FD;&#x3002;</p>
<p>&#x5982;&#x679C;&#x8981;&#x7528;&#x5F88;&#x77ED;&#x7684;&#x4E00;&#x53E5;&#x8BDD;&#x603B;&#x7ED3; HBase&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8BA4;&#x4E3A; HBase &#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x6709;&#x5E8F;&#x7684;&#x591A;&#x7EF4; Map&#xFF0C;&#x5176;&#x4E2D;&#x6BCF;&#x4E00;&#x4E2A; Row-key &#x6620;&#x5C04;&#x4E86;&#x8BB8;&#x591A;&#x6570;&#x636E;&#xFF0C;&#x8FD9;&#x4E9B;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x5728; CF &#x4E2D;&#x7684; Column&#x3002;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7528;&#x4E0B;&#x56FE;&#x6765;&#x8868;&#x793A;&#x8FD9;&#x53E5;&#x8BDD;&#x3002;</p>
<p><img src="/images/hbase-data-reflect.png" alt="Hbase&#x6570;&#x636E;&#x6620;&#x5C04;"></p>
<h3 id="hbase-&#x7684;&#x4F7F;&#x7528;&#x5EFA;&#x8BAE;">HBase &#x7684;&#x4F7F;&#x7528;&#x5EFA;&#x8BAE;</h3>
<p>&#x4E4B;&#x524D;&#x6211;&#x4ECB;&#x7ECD;&#x4E86;&#x5F88;&#x591A; HBase &#x4E0E; RDBMS &#x7684;&#x533A;&#x522B;&#xFF0C;&#x4EE5;&#x53CA;&#x4E00;&#x4E9B;&#x4F18;&#x52BF;&#x7684;&#x5730;&#x65B9;&#x3002;&#x90A3;&#x4E48;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x6700;&#x9700;&#x8981; HBase&#xFF0C;&#x6216;&#x8005;&#x8BF4; HBase &#x662F;&#x5426;&#x53EF;&#x4EE5;&#x66FF;&#x4EE3;&#x539F;&#x6709;&#x7684; RDBMS&#xFF1F;&#x5BF9;&#x4E8E;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x6211;&#x4EEC;&#x5FC5;&#x987B;&#x65F6;&#x523B;&#x8C28;&#x8BB0;&#x2014;&#x2014;HBase &#x5E76;&#x4E0D;&#x9002;&#x5408;&#x6240;&#x6709;&#x95EE;&#x9898;&#xFF0C;&#x5176;&#x8BBE;&#x8BA1;&#x76EE;&#x6807;&#x5E76;&#x4E0D;&#x662F;&#x66FF;&#x4EE3; RDBMS&#xFF0C;&#x800C;&#x662F;&#x5BF9; RDBMS &#x7684;&#x4E00;&#x4E2A;&#x91CD;&#x8981;&#x8865;&#x5145;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x5BF9;&#x5927;&#x6570;&#x636E;&#x7684;&#x573A;&#x666F;&#x3002;&#x5F53;&#x9700;&#x8981;&#x8003;&#x91CF; HBase &#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x5907;&#x9009;&#x9879;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x5982;&#x4E0B;&#x7684;&#x8C03;&#x7814;&#x5DE5;&#x4F5C;&#x3002;</p>
<p>&#x9996;&#x5148;&#xFF0C;&#x8981;&#x786E;&#x4FE1;&#x6709;&#x8DB3;&#x591F;&#x591A;&#x6570;&#x636E;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x4E0A;&#x4EBF;&#x6216;&#x4E0A;&#x5343;&#x4EBF;&#x884C;&#x6570;&#x636E;&#xFF0C;HBase &#x624D;&#x4F1A;&#x662F;&#x4E00;&#x4E2A;&#x5F88;&#x597D;&#x7684;&#x5907;&#x9009;&#x3002;&#x5176;&#x6B21;&#xFF0C;&#x9700;&#x8981;&#x786E;&#x4FE1;&#x4E1A;&#x52A1;&#x4E0A;&#x53EF;&#x4EE5;&#x4E0D;&#x4F9D;&#x8D56; RDBMS &#x7684;&#x989D;&#x5916;&#x7279;&#x6027;&#xFF0C;&#x4F8B;&#x5982;&#xFF0C;&#x5217;&#x6570;&#x636E;&#x7C7B;&#x578B;, &#x4E8C;&#x7EA7;&#x7D22;&#x5F15;&#xFF0C;SQL &#x67E5;&#x8BE2;&#x8BED;&#x8A00;&#x7B49;&#x3002;&#x518D;&#x800C;&#xFF0C;&#x9700;&#x8981;&#x786E;&#x4FDD;&#x6709;&#x8DB3;&#x591F;&#x786C;&#x4EF6;&#x3002;&#x4E14;&#x4E0D;&#x8BF4; HBase&#xFF0C;&#x4E00;&#x822C;&#x60C5;&#x51B5;&#x4E0B;&#x5F53; HDFS &#x7684;&#x96C6;&#x7FA4;&#x5C0F;&#x4E8E; 5 &#x4E2A;&#x6570;&#x636E;&#x8282;&#x70B9;&#x65F6;&#xFF0C;&#x4E5F;&#x5E72;&#x4E0D;&#x597D;&#x4EC0;&#x4E48;&#x4E8B;&#x60C5; (HDFS &#x9ED8;&#x8BA4;&#x4F1A;&#x5C06;&#x6BCF;&#x4E00;&#x4E2A; Block &#x6570;&#x636E;&#x5907;&#x4EFD; 3 &#x5206;)&#xFF0C;&#x8FD8;&#x8981;&#x52A0;&#x4E0A;&#x4E00;&#x4E2A; NameNode&#x3002;</p>
<p>&#x4EE5;&#x4E0B;&#x6211;&#x7ED9;&#x4E86;&#x4E00;&#x4E9B;&#x4F7F;&#x7528; HBase &#x65F6;&#x5019;&#x5BF9;&#x8868;&#x683C;&#x8BBE;&#x8BA1;&#x7684;&#x4E00;&#x4E9B;&#x5EFA;&#x8BAE;&#xFF0C;&#x8BFB;&#x8005;&#x4E5F;&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x80CC;&#x540E;&#x7684;&#x542B;&#x4E49;&#x3002;&#x4E0D;&#x8FC7;&#x6211;&#x5E76;&#x4E0D;&#x5E0C;&#x671B;&#x8FD9;&#x4E9B;&#x5EFA;&#x8BAE;&#x6210;&#x4E3A;&#x4F7F;&#x7528; HBase &#x7684;&#x6559;&#x6761;&#xFF0C;&#x6BD5;&#x7ADF;&#x4E5F;&#x6709;&#x4E0D;&#x5C3D;&#x5408;&#x7406;&#x7684;&#x5730;&#x65B9;&#x3002;&#x9996;&#x5148;&#xFF0C;&#x4E00;&#x4E2A; HBase &#x6570;&#x636E;&#x5E93;&#x662F;&#x5426;&#x9AD8;&#x6548;&#xFF0C;&#x5F88;&#x5927;&#x7A0B;&#x5EA6;&#x4F1A;&#x548C; Row-Key &#x7684;&#x8BBE;&#x8BA1;&#x6709;&#x5173;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x5982;&#x4F55;&#x8BBE;&#x8BA1; Row-key &#x662F;&#x4F7F;&#x7528; HBase &#x65F6;&#xFF0C;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x91CD;&#x8981;&#x7684;&#x8BDD;&#x9898;&#x3002;&#x968F;&#x7740;&#x6570;&#x636E;&#x8BBF;&#x95EE;&#x65B9;&#x5F0F;&#x7684;&#x4E0D;&#x540C;&#xFF0C;Row-Key &#x7684;&#x8BBE;&#x8BA1;&#x4E5F;&#x4F1A;&#x6709;&#x6240;&#x4E0D;&#x540C;&#x3002;&#x4E0D;&#x8FC7;&#x6982;&#x62EC;&#x8D77;&#x6765;&#x7684;&#x5B97;&#x65E8;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#xFF0C;&#x90A3;&#x5C31;&#x662F;&#x5C3D;&#x53EF;&#x80FD;&#x9009;&#x62E9;&#x4E00;&#x4E2A; Row-Key&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x4F60;&#x7684;&#x6570;&#x636E;&#x5747;&#x5300;&#x7684;&#x5206;&#x5E03;&#x5728;&#x96C6;&#x7FA4;&#x4E2D;&#x3002;&#x8FD9;&#x4E5F;&#x5F88;&#x5BB9;&#x6613;&#x7406;&#x89E3;&#xFF0C;&#x56E0;&#x4E3A; HBase &#x662F;&#x4E00;&#x4E2A;&#x5206;&#x5E03;&#x5F0F;&#x73AF;&#x5883;&#xFF0C;Client &#x4F1A;&#x8BBF;&#x95EE;&#x4E0D;&#x540C; Region Server &#x83B7;&#x53D6;&#x6570;&#x636E;&#x3002;&#x5982;&#x679C;&#x6570;&#x636E;&#x6392;&#x5E03;&#x5747;&#x5300;&#x5728;&#x4E0D;&#x540C;&#x7684;&#x591A;&#x4E2A;&#x8282;&#x70B9;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x6279;&#x91CF;&#x7684; Client &#x4FBF;&#x53EF;&#x4EE5;&#x4ECE;&#x4E0D;&#x540C;&#x7684; Region Server &#x4E0A;&#x83B7;&#x53D6;&#x6570;&#x636E;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x74F6;&#x9888;&#x5728;&#x67D0;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#xFF0C;&#x6027;&#x80FD;&#x81EA;&#x7136;&#x4F1A;&#x6709;&#x6240;&#x63D0;&#x5347;&#x3002;&#x5BF9;&#x4E8E;&#x5177;&#x4F53;&#x7684;&#x5EFA;&#x8BAE;&#x6211;&#x4EEC;&#x4E00;&#x822C;&#x6709;&#x51E0;&#x6761;&#xFF1A;</p>
<ol>
<li>&#x5F53;&#x5BA2;&#x6237;&#x7AEF;&#x9700;&#x8981;&#x9891;&#x7E41;&#x7684;&#x5199;&#x4E00;&#x5F20;&#x8868;&#xFF0C;&#x968F;&#x673A;&#x7684; RowKey &#x4F1A;&#x83B7;&#x5F97;&#x66F4;&#x597D;&#x7684;&#x6027;&#x80FD;&#x3002;</li>
<li>&#x5F53;&#x5BA2;&#x6237;&#x7AEF;&#x9700;&#x8981;&#x9891;&#x7E41;&#x7684;&#x8BFB;&#x4E00;&#x5F20;&#x8868;&#xFF0C;&#x6709;&#x5E8F;&#x7684; RowKey &#x5219;&#x4F1A;&#x83B7;&#x5F97;&#x66F4;&#x597D;&#x7684;&#x6027;&#x80FD;&#x3002;</li>
<li>&#x5BF9;&#x4E8E;&#x65F6;&#x95F4;&#x8FDE;&#x7EED;&#x7684;&#x6570;&#x636E;&#xFF08;&#x4F8B;&#x5982; log&#xFF09;&#xFF0C;&#x6709;&#x5E8F;&#x7684; RowKey &#x4F1A;&#x5F88;&#x65B9;&#x4FBF;&#x67E5;&#x8BE2;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x7684;&#x6570;&#x636E;&#xFF08;Scan &#x64CD;&#x4F5C;&#xFF09;&#x3002;</li>
</ol>
<p>&#x4E0A;&#x9762;&#x6211;&#x4EEC;&#x8C08;&#x53CA;&#x4E86;&#x5BF9; Row-Key &#x7684;&#x8BBE;&#x8BA1;&#xFF0C;&#x63A5;&#x7740;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x60F3;&#x60F3;&#x662F;&#x5426; Column Family &#x4E5F;&#x4F1A;&#x5728;&#x4E0D;&#x540C;&#x7684;&#x573A;&#x666F;&#x9700;&#x8981;&#x4E0D;&#x540C;&#x7684;&#x8BBE;&#x8BA1;&#x65B9;&#x6848;&#x5462;&#x3002;&#x7B54;&#x6848;&#x662F;&#x80AF;&#x5B9A;&#x7684;&#xFF0C;&#x4E0D;&#x8FC7; CF &#x8DDF; Row-key &#x6BD4;&#x8F83;&#x7684;&#x8BDD;&#xFF0C;&#x786E;&#x5B9E;&#x4E5F;&#x7B80;&#x5355;&#x4E00;&#x4E9B;&#xFF0C;&#x4F46;&#x8FD9;&#x5E76;&#x4E0D;&#x610F;&#x5473;&#x7740; CF &#x7684;&#x8BBE;&#x8BA1;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x7410;&#x788E;&#x7684;&#x8BDD;&#x9898;&#x3002;&#x5728; RDBMS&#xFF08;&#x4F20;&#x7EDF;&#x5173;&#x7CFB;&#x6570;&#x636E;&#x5E93;&#xFF09;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x77E5;&#x9053;&#x5982;&#x679C;&#x5F53;&#x7528;&#x6237;&#x7684;&#x4FE1;&#x606F;&#x5206;&#x6563;&#x5728;&#x4E0D;&#x540C;&#x7684;&#x8868;&#x4E2D;&#xFF0C;&#x4FBF;&#x9700;&#x8981;&#x6839;&#x636E;&#x4E00;&#x4E2A; Key &#x8FDB;&#x884C; Join &#x64CD;&#x4F5C;&#x3002;&#x800C;&#x5728; HBase &#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x8BBE;&#x8BA1; CF &#x6765;&#x805A;&#x5408;&#x7528;&#x6237;&#x6240;&#x6709;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#x3002;&#x7B80;&#x5355;&#x6765;&#x8BF4;&#xFF0C;&#x5C31;&#x662F;&#x9700;&#x8981;&#x5C06;&#x6570;&#x636E;&#x6309;&#x7C7B;&#x522B;&#xFF08;&#x6216;&#x8005;&#x4E00;&#x4E2A;&#x7279;&#x6027;&#xFF09;&#x805A;&#x5408;&#x5728;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A; CF &#x4E2D;&#x3002;&#x8FD9;&#x6837;&#xFF0C;&#x4FBF;&#x53EF;&#x4EE5;&#x6839;&#x636E; CF &#x83B7;&#x53D6;&#x8FD9;&#x7C7B;&#x4FE1;&#x606F;&#x3002;&#x4E0A;&#x9762;&#xFF0C;&#x6211;&#x4EEC;&#x8BB2;&#x89E3;&#x8FC7;&#x4E00;&#x4E2A; Region &#x5BF9;&#x5E94;&#x4E8E;&#x4E00;&#x4E2A; CF&#x3002;&#x90A3;&#x4E48;&#x8BBE;&#x60F3;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x4E00;&#x4E2A;&#x8868;&#x4E2D;&#x5B9A;&#x4E49;&#x4E86;&#x591A;&#x4E2A; CF &#x65F6;&#xFF0C;&#x5C31;&#x5FC5;&#x7136;&#x4F1A;&#x6709;&#x591A;&#x4E2A; Region&#x3002;&#x5F53; Client &#x67E5;&#x8BE2;&#x6570;&#x636E;&#x65F6;&#xFF0C;&#x5C31;&#x4E0D;&#x5F97;&#x4E0D;&#x67E5;&#x8BE2;&#x591A;&#x4E2A; Region&#x3002;&#x8FD9;&#x6837;&#x6027;&#x80FD;&#x81EA;&#x7136;&#x4F1A;&#x6709;&#x6240;&#x4E0B;&#x964D;&#xFF0C;&#x5C24;&#x5176;&#x5F53; Region &#x5938;&#x673A;&#x5668;&#x7684;&#x65F6;&#x5019;&#x3002;&#x56E0;&#x6B64;&#x5728;&#x5927;&#x591A;&#x6570;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4E00;&#x4E2A;&#x8868;&#x683C;&#x4E0D;&#x4F1A;&#x8D85;&#x8FC7; 2 &#x5230; 3 &#x4E2A; CF&#xFF0C;&#x800C;&#x4E14;&#x5F88;&#x591A;&#x60C5;&#x51B5;&#x4E0B;&#x90FD;&#x662F; 1 &#x4E2A; CF &#x5C31;&#x8DB3;&#x591F;&#x4E86;&#x3002;</p>
]]></content>
    <summary type="html">
    <![CDATA[提到大数据的存储，大多数人首先联想到的是 Hadoop 和 Hadoop 中的 HDFS 模块。大家熟知的 Spark、以及 Hadoop 的 MapReduce，可以理解为一种计算框架。而 HDFS，我们可以认为是为计算框架服务的存储层。因此不管是 Spark 还是 MapReduce，都需要使用 HDFS 作为默认的持久化存储层。那么 HBase 又是什么，可以用在哪里，解决什么样的问题？]]>
    
    </summary>
    
      <category term="HBase" scheme="http://yoursite.com/tags/HBase/"/>
    
      <category term="HBase" scheme="http://yoursite.com/categories/HBase/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[JVM日志分析]]></title>
    <link href="http://yoursite.com/2018/11/13/jvm-log-analysis/"/>
    <id>http://yoursite.com/2018/11/13/jvm-log-analysis/</id>
    <published>2018-11-13T13:39:44.000Z</published>
    <updated>2018-11-14T14:07:59.971Z</updated>
    <content type="html"><![CDATA[<p>&#x4ECA;&#x5929;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x4E3B;&#x8981;&#x662F;&#x5BF9;&#x751F;&#x4EA7;&#x73AF;&#x5883;&#x4E2D;&#xFF08;Java7&#xFF09;&#x5E38;&#x7528;&#x7684;&#x4E24;&#x79CD;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#xFF08;ParNew&#xFF1A;&#x5E74;&#x8F7B;&#x4EE3;&#xFF0C;CMS&#xFF1A;&#x8001;&#x5E74;&#x4EE3;&#xFF09;&#x4ECE;&#x65E5;&#x5FD7;&#x4FE1;&#x606F;&#x4E0A;&#x8FDB;&#x884C;&#x5206;&#x6790;&#xFF0C;&#x505A;&#x4E00;&#x4E0B;&#x603B;&#x7ED3;&#xFF0C;&#x8FD9;&#x6837;&#x5F53;&#x6211;&#x4EEC;&#x5728;&#x6392;&#x67E5;&#x76F8;&#x5E94;&#x7684;&#x95EE;&#x9898;&#x65F6;&#xFF0C;&#x770B;&#x5230; GC &#x7684;&#x65E5;&#x5FD7;&#x4FE1;&#x606F;&#xFF0C;&#x4E0D;&#x4F1A;&#x518D;&#x90A3;&#x4E48;&#x964C;&#x751F;&#xFF0C;&#x80FD;&#x6E05;&#x695A;&#x5730;&#x77E5;&#x9053;&#x8FD9;&#x4E9B;&#x65E5;&#x5FD7;&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;&#xFF0C;GC &#x7EBF;&#x7A0B;&#x5F53;&#x524D;&#x5904;&#x5728;&#x54EA;&#x4E2A;&#x9636;&#x6BB5;&#xFF0C;&#x6B63;&#x5728;&#x505A;&#x4EC0;&#x4E48;&#x4E8B;&#x60C5;&#x7B49;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E00;&#x822C;&#x662F;&#x8FD0;&#x884C;&#x5728;tomcat&#x4E2D;,&#x901A;&#x8FC7;&#x5728;tomcat&#x4E2D;&#x914D;&#x7F6E;&#x5BF9;&#x5E94;&#x7684;&#x53C2;&#x6570;&#x53EF;&#x4EE5;&#x53EF;&#x4EE5;&#x751F;&#x4EA7;gc&#x65E5;&#x5FD7;&#x4FE1;&#x606F;:</p>
<ul>
<li>-verbose.gc&#x5F00;&#x5173;&#x53EF;&#x663E;&#x793A;GC&#x7684;&#x64CD;&#x4F5C;&#x5185;&#x5BB9;&#x3002;&#x6253;&#x5F00;&#x5B83;&#xFF0C;&#x53EF;&#x4EE5;&#x663E;&#x793A;&#x6700;&#x5FD9;&#x548C;&#x6700;&#x7A7A;&#x95F2;&#x6536;&#x96C6;&#x884C;&#x4E3A;&#x53D1;&#x751F;&#x7684;&#x65F6;&#x95F4;&#x3001;&#x6536;&#x96C6;&#x524D;&#x540E;&#x7684;&#x5185;&#x5B58;&#x5927;&#x5C0F;&#x3001;&#x6536;&#x96C6;&#x9700;&#x8981;&#x7684;&#x65F6;&#x95F4;&#x7B49;&#x3002;</li>
<li>&#x6253;&#x5F00;-xx:+printGCdetails&#x5F00;&#x5173;&#xFF0C;&#x53EF;&#x4EE5;&#x8BE6;&#x7EC6;&#x4E86;&#x89E3;GC&#x4E2D;&#x7684;&#x53D8;&#x5316;&#x3002;</li>
<li>&#x6253;&#x5F00;-XX:+PrintGCTimeStamps&#x5F00;&#x5173;&#xFF0C;&#x53EF;&#x4EE5;&#x4E86;&#x89E3;&#x8FD9;&#x4E9B;&#x5783;&#x573E;&#x6536;&#x96C6;&#x53D1;&#x751F;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x81EA;JVM&#x542F;&#x52A8;&#x4EE5;&#x540E;&#x4EE5;&#x79D2;&#x8BA1;&#x91CF;&#x3002;</li>
<li>&#x6700;&#x540E;&#xFF0C;&#x901A;&#x8FC7;-xx:+PrintHeapAtGC&#x5F00;&#x5173;&#x4E86;&#x89E3;&#x5806;&#x7684;&#x66F4;&#x8BE6;&#x7EC6;&#x7684;&#x4FE1;&#x606F;&#x3002;</li>
<li>&#x4E3A;&#x4E86;&#x4E86;&#x89E3;&#x65B0;&#x57DF;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;-XX:+PrintTenuringDistribution&#x5F00;&#x5173;&#x4E86;&#x89E3;&#x83B7;&#x5F97;&#x4F7F;&#x7528;&#x671F;&#x7684;&#x5BF9;&#x8C61;&#x6743;&#x3002;</li>
<li>-Xloggc:$CATALINA_BASE/logs/gc.log gc&#x65E5;&#x5FD7;&#x4EA7;&#x751F;&#x7684;&#x8DEF;&#x5F84;</li>
<li>-XX:+PrintGCApplicationStoppedTime &#x8F93;&#x51FA;GC&#x9020;&#x6210;&#x5E94;&#x7528;&#x6682;&#x505C;&#x7684;&#x65F6;&#x95F4;</li>
<li>-XX:+PrintGCDateStamps GC&#x53D1;&#x751F;&#x7684;&#x65F6;&#x95F4;&#x4FE1;&#x606F;</li>
</ul>
<p>&#x8FD8;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x7B28;&#x795E;&#x7684;JVM&#x5E73;&#x53F0;&#x6765;&#x6839;&#x636E;&#x9700;&#x6C42;&#x751F;&#x6210;&#x548C;&#x89E3;&#x6790;JVM&#x53C2;&#x6570;<a href="http://xxfox.perfma.com/jvm/generate" target="_blank" rel="external">http://xxfox.perfma.com/jvm/generate</a></p>
<h3 id="gc&#x65E5;&#x5FD7;&#x683C;&#x5F0F;">GC&#x65E5;&#x5FD7;&#x683C;&#x5F0F;</h3>
<p><img src="/images/jvm-log-gc.png" alt="GC&#x65E5;&#x5FD7;&#x683C;&#x5F0F;&#x603B;&#x89C8;"></p>
<h3 id="parnew&#x6536;&#x96C6;&#x5668;&#x65E5;&#x5FD7;&#x5206;&#x6790;">ParNew&#x6536;&#x96C6;&#x5668;&#x65E5;&#x5FD7;&#x5206;&#x6790;</h3>
<p>ParNew &#x6536;&#x96C6;&#x5668;&#x662F;&#x5E74;&#x8F7B;&#x4EE3;&#x5E38;&#x7528;&#x7684;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#xFF0C;&#x5B83;&#x91C7;&#x7528;&#x7684;&#x662F;&#x590D;&#x5236;&#x7B97;&#x6CD5;&#xFF0C;youngGC &#x65F6;&#x4E00;&#x4E2A;&#x5178;&#x578B;&#x7684;&#x65E5;&#x5FD7;&#x4FE1;&#x606F;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</p>
<p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">26.134</span>+<span class="number">0800</span>: <span class="number">15578.050</span>: [GC2018-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">26.135</span>+<span class="number">0800</span>: <span class="number">15578.050</span>: [ParNew: <span class="number">3412467</span>K-&gt;<span class="number">59681</span>K(<span class="number">3774912</span>K), <span class="number">0.0971990</span> secs] <span class="number">9702786</span>K-&gt;<span class="number">6354533</span>K(<span class="number">24746432</span>K), <span class="number">0.0974940</span> secs][Times: user=<span class="number">0.95</span> sys=<span class="number">0.00</span>, real=<span class="number">0.09</span> secs]</span><br></pre></td></tr></table></figure></p>
<p>GC&#x65E5;&#x5FD7;&#x5F00;&#x5934;&#x7684;&quot;[GC&quot;&#x548C;&#x201C;[Full GC&quot;&#x8BF4;&#x660E;&#x4E86;&#x8FD9;&#x6B21;&#x5783;&#x573E;&#x6536;&#x96C6;&#x7684;&#x505C;&#x987F;&#x7C7B;&#x578B;&#x3002;&quot;[DefNew&quot;&#x3001;&#x201D;[Tenured&quot;&#x3001;&#x201C;[Perm&quot;&#x8868;&#x793A;GC&#x53D1;&#x751F;&#x7684;&#x533A;&#x57DF;&#xFF0C;&#x548C;GC&#x6536;&#x96C6;&#x5668;&#x5BC6;&#x5207;&#x76F8;&#x5173;&#x3002;&#x6BD4;&#x5982;&#x4F7F;&#x7528;Serial&#x6536;&#x96C6;&#x5668;&#x4E2D;&#x7684;&#x65B0;&#x751F;&#x4EE3;&#x540D;&#x4E3A;&#x201D;Default New Generation&quot;,&#x6240;&#x4EE5;&#x663E;&#x793A;&#x4E3A;&#x201C;[DefNew&quot;.&#x5982;&#x679C;&#x662F;ParNew&#x6536;&#x96C6;&#x5668;&#xFF0C;&#x65B0;&#x751F;&#x4EE3;&#x540D;&#x79F0;&#x4F1A;&#x53D8;&#x4E3A;&#x201D;[ParaNew&quot;,&#x610F;&#x601D;&#x662F;Parallel New Generation.&#x5982;&#x679C;&#x91C7;&#x7528;Parallel Scavenge&#x6536;&#x96C6;&#x5668;&#xFF0C;&#x90A3;&#x5B83;&#x914D;&#x5957;&#x7684;&#x65B0;&#x751F;&#x4EE3;&#x540D;&#x79F0;&#x4E3A;&#x201C;[PSYoungGen&quot;,&#x8001;&#x5E74;&#x4EE3;&#x548C;&#x6C38;&#x4E45;&#x4EE3;&#x540C;&#x7406;&#x3002;</p>
<p>&#x4F9D;&#x6B21;&#x5206;&#x6790;&#x4E00;&#x4E0B;&#x4E0A;&#x9762;&#x65E5;&#x5FD7;&#x4FE1;&#x606F;&#x7684;&#x542B;&#x4E49;&#xFF1A;</p>
<ul>
<li>2018-04-12T13:48:26.134+0800&#xFF1A; Mirror GC &#x53D1;&#x751F;&#x7684;&#x65F6;&#x95F4;</li>
<li>15578.050&#xFF1A;GC &#x5F00;&#x59CB;&#x65F6;&#xFF0C;&#x76F8;&#x5BF9; JVM &#x542F;&#x52A8;&#x7684;&#x76F8;&#x5BF9;&#x65F6;&#x95F4;&#xFF0C;&#x5355;&#x4F4D;&#x65F6;&#x79D2;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;4h+&#xFF1B;</li>
<li>ParNew&#xFF1A;&#x6536;&#x96C6;&#x5668;&#x540D;&#x79F0;&#xFF0C;&#x8FD9;&#x91CC;&#x662F; ParNew &#x6536;&#x96C6;&#x5668;&#xFF0C;&#x5B83;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x5E76;&#x884C;&#x7684; mark-copy &#x7B97;&#x6CD5;&#xFF0C;GC &#x8FC7;&#x7A0B;&#x4E5F;&#x4F1A; Stop the World&#xFF1B;</li>
<li>3412467K-&gt;59681K&#xFF1A;&#x6536;&#x96C6;&#x524D;&#x540E;&#x5E74;&#x8F7B;&#x4EE3;&#x7684;&#x4F7F;&#x7528;&#x60C5;&#x51B5;&#xFF0C;&#x8FD9;&#x91CC;&#x662F; 3.25G-&gt;58.28M&#xFF1B;</li>
<li>3774912K&#xFF1A;&#x6574;&#x4E2A;&#x5E74;&#x8F7B;&#x4EE3;&#x7684;&#x5BB9;&#x91CF;&#xFF0C;&#x8FD9;&#x91CC;&#x662F; 3.6G&#xFF1B;</li>
<li>0.0971990 secs&#xFF1A;Duration for the collection w/o final cleanup.</li>
<li>9702786K-&gt;6354533K&#xFF1A;&#x6536;&#x96C6;&#x524D;&#x540E;&#x6574;&#x4E2A;&#x5806;&#x7684;&#x4F7F;&#x7528;&#x60C5;&#x51B5;&#xFF0C;&#x8FD9;&#x91CC;&#x662F; 9.25G-&gt;6.06G;</li>
<li>24746432K&#xFF1A;&#x6574;&#x4E2A;&#x5806;&#x7684;&#x5BB9;&#x91CF;&#xFF0C;&#x8FD9;&#x91CC;&#x662F; 23.6G&#xFF1B;</li>
<li>0.0974940 secs&#xFF1A;ParNew &#x6536;&#x96C6;&#x5668;&#x6807;&#x8BB0;&#x548C;&#x590D;&#x5236;&#x5E74;&#x8F7B;&#x4EE3;&#x6D3B;&#x7740;&#x7684;&#x5BF9;&#x8C61;&#x6240;&#x82B1;&#x8D39;&#x7684;&#x65F6;&#x95F4;&#xFF08;&#x5305;&#x62EC;&#x548C;&#x8001;&#x5E74;&#x4EE3;&#x901A;&#x4FE1;&#x7684;&#x5F00;&#x9500;&#x3001;&#x5BF9;&#x8C61;&#x664B;&#x5347;&#x5230;&#x8001;&#x5E74;&#x4EE3;&#x5F00;&#x9500;&#x3001;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5468;&#x671F;&#x7ED3;&#x675F;&#x4E00;&#x4E9B;&#x6700;&#x540E;&#x7684;&#x6E05;&#x7406;&#x5BF9;&#x8C61;&#x7B49;&#x7684;&#x82B1;&#x9500;&#xFF09;&#xFF1B;</li>
</ul>
<p>&#x66F4;&#x5168;&#x4E00;&#x70B9;&#x7684;&#x53C2;&#x6570;&#x8BF4;&#x660E;:</p>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[GC [<span class="tag">&lt;<span class="title">collector</span>&gt;</span>: <span class="tag">&lt;<span class="title">starting</span> <span class="attribute">occupancy1</span>&gt;</span> -&gt; <span class="tag">&lt;<span class="title">ending</span> <span class="attribute">occupancy1</span>&gt;</span>, <span class="tag">&lt;<span class="title">pause</span> <span class="attribute">time1</span>&gt;</span> secs] <span class="tag">&lt;<span class="title">starting</span> <span class="attribute">occupancy3</span>&gt;</span> -&gt; <span class="tag">&lt;<span class="title">ending</span> <span class="attribute">occupancy3</span>&gt;</span>, <span class="tag">&lt;<span class="title">pause</span> <span class="attribute">time3</span>&gt;</span> secs]</span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="title">collector</span>&gt;</span>              GC&#x6536;&#x96C6;&#x5668;&#x7684;&#x540D;&#x79F0;</span><br><span class="line"><span class="tag">&lt;<span class="title">starting</span> <span class="attribute">occupancy1</span>&gt;</span>    &#x65B0;&#x751F;&#x4EE3;&#x5728;GC&#x524D;&#x5360;&#x7528;&#x7684;&#x5185;&#x5B58;</span><br><span class="line"><span class="tag">&lt;<span class="title">ending</span> <span class="attribute">occupancy1</span>&gt;</span>      &#x65B0;&#x751F;&#x4EE3;&#x5728;GC&#x540E;&#x5360;&#x7528;&#x7684;&#x5185;&#x5B58;</span><br><span class="line"><span class="tag">&lt;<span class="title">pause</span> <span class="attribute">time1</span>&gt;</span>            &#x65B0;&#x751F;&#x4EE3;&#x5C40;&#x90E8;&#x6536;&#x96C6;&#x65F6;jvm&#x6682;&#x505C;&#x5904;&#x7406;&#x7684;&#x65F6;&#x95F4;</span><br><span class="line"><span class="tag">&lt;<span class="title">starting</span> <span class="attribute">occupancy3</span>&gt;</span>    JVM Heap &#x5728;GC&#x524D;&#x5360;&#x7528;&#x7684;&#x5185;&#x5B58;</span><br><span class="line"><span class="tag">&lt;<span class="title">ending</span> <span class="attribute">occupancy3</span>&gt;</span>      JVM Heap &#x5728;GC&#x540E;&#x5360;&#x7528;&#x7684;&#x5185;&#x5B58;</span><br><span class="line"><span class="tag">&lt;<span class="title">pause</span> <span class="attribute">time3</span>&gt;</span>            GC&#x8FC7;&#x7A0B;&#x4E2D;jvm&#x6682;&#x505C;&#x5904;&#x7406;&#x7684;&#x603B;&#x65F6;&#x95F4;</span><br></pre></td></tr></table></figure></p>
<p>&#x5BF9;&#x4E8E; [Times: user=0.95 sys=0.00, real=0.09 secs]&#xFF0C;&#x8FD9;&#x91CC;&#x9762;&#x6D89;&#x53CA;&#x5230;&#x4E09;&#x79CD;&#x65F6;&#x95F4;&#x7C7B;&#x578B;&#xFF0C;&#x542B;&#x4E49;&#x5982;&#x4E0B;&#xFF1A;</p>
<ul>
<li>user&#xFF1A;GC &#x7EBF;&#x7A0B;&#x5728;&#x5783;&#x573E;&#x6536;&#x96C6;&#x671F;&#x95F4;&#x6240;&#x4F7F;&#x7528;&#x7684; CPU &#x603B;&#x65F6;&#x95F4;&#xFF1B;</li>
<li>sys&#xFF1A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6216;&#x8005;&#x7B49;&#x5F85;&#x7CFB;&#x7EDF;&#x4E8B;&#x4EF6;&#x82B1;&#x8D39;&#x7684;&#x65F6;&#x95F4;&#xFF1B;</li>
<li>real&#xFF1A;&#x5E94;&#x7528;&#x88AB;&#x6682;&#x505C;&#x7684;&#x65F6;&#x949F;&#x65F6;&#x95F4;&#xFF0C;&#x7531;&#x4E8E; GC &#x7EBF;&#x7A0B;&#x662F;&#x591A;&#x7EBF;&#x7A0B;&#x7684;&#xFF0C;&#x5BFC;&#x81F4;&#x4E86; real &#x5C0F;&#x4E8E; (user+real)&#xFF0C;&#x5982;&#x679C;&#x662F; gc &#x7EBF;&#x7A0B;&#x662F;&#x5355;&#x7EBF;&#x7A0B;&#x7684;&#x8BDD;&#xFF0C;real &#x662F;&#x63A5;&#x8FD1;&#x4E8E; (user+real) &#x65F6;&#x95F4;&#x3002;</li>
</ul>
<h3 id="cms&#x6536;&#x96C6;&#x5668;&#x65E5;&#x5FD7;&#x5206;&#x6790;">CMS&#x6536;&#x96C6;&#x5668;&#x65E5;&#x5FD7;&#x5206;&#x6790;</h3>
<p>CMS &#x6536;&#x96C6;&#x5668;&#x662F;&#x8001;&#x5E74;&#x4EE3;&#x7ECF;&#x5E38;&#x4F7F;&#x7528;&#x7684;&#x6536;&#x96C6;&#x5668;&#xFF0C;&#x5B83;&#x91C7;&#x7528;&#x7684;&#x662F;&#x6807;&#x8BB0;-&#x6E05;&#x695A;&#x7B97;&#x6CD5;&#xFF0C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5728;&#x53D1;&#x751F;&#x4E00;&#x6B21; Full GC &#x65F6;&#xFF0C;&#x5178;&#x578B;&#x7684; GC &#x65E5;&#x5FD7;&#x4FE1;&#x606F;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">26.233</span>+<span class="number">0800</span>: <span class="number">15578.148</span>: [GC [<span class="number">1</span> CMS-initial-mark: <span class="number">6294851</span>K(<span class="number">20971520</span>K)] <span class="number">6354687</span>K(<span class="number">24746432</span>K), <span class="number">0.0466580</span> secs] [Times: user=<span class="number">0.04</span> sys=<span class="number">0.00</span>, real=<span class="number">0.04</span> secs]</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">26.280</span>+<span class="number">0800</span>: <span class="number">15578.195</span>: [CMS-concurrent-mark-start]</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">26.418</span>+<span class="number">0800</span>: <span class="number">15578.333</span>: [CMS-concurrent-mark: <span class="number">0.138</span>/<span class="number">0.138</span> secs] [Times: user=<span class="number">1.01</span> sys=<span class="number">0.21</span>, real=<span class="number">0.14</span> secs]</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">26.418</span>+<span class="number">0800</span>: <span class="number">15578.334</span>: [CMS-concurrent-preclean-start]</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">26.476</span>+<span class="number">0800</span>: <span class="number">15578.391</span>: [CMS-concurrent-preclean: <span class="number">0.056</span>/<span class="number">0.057</span> secs] [Times: user=<span class="number">0.20</span> sys=<span class="number">0.12</span>, real=<span class="number">0.06</span> secs]</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">26.476</span>+<span class="number">0800</span>: <span class="number">15578.391</span>: [CMS-concurrent-abortable-preclean-start]</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">29.989</span>+<span class="number">0800</span>: <span class="number">15581.905</span>: [CMS-concurrent-abortable-preclean: <span class="number">3.506</span>/<span class="number">3.514</span> secs] [Times: user=<span class="number">11.93</span> sys=<span class="number">6.77</span>, real=<span class="number">3.51</span> secs]</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">29.991</span>+<span class="number">0800</span>: <span class="number">15581.906</span>: [GC[YG occupancy: <span class="number">1805641</span> K (<span class="number">3774912</span> K)]<span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">29.991</span>+<span class="number">0800</span>: <span class="number">15581.906</span>: [GC2018-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">29.991</span>+<span class="number">0800</span>: <span class="number">15581.906</span>: [ParNew: <span class="number">1805641</span>K-&gt;<span class="number">48395</span>K(<span class="number">3774912</span>K), <span class="number">0.0826620</span> secs] <span class="number">8100493</span>K-&gt;<span class="number">6348225</span>K(<span class="number">24746432</span>K), <span class="number">0.0829480</span> secs] [Times: user=<span class="number">0.81</span> sys=<span class="number">0.00</span>, real=<span class="number">0.09</span> secs]<span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">30.074</span>+<span class="number">0800</span>: <span class="number">15581.989</span>: [Rescan (parallel) , <span class="number">0.0429390</span> secs]<span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">30.117</span>+<span class="number">0800</span>: <span class="number">15582.032</span>: [weak refs processing, <span class="number">0.0027800</span> secs]<span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">30.119</span>+<span class="number">0800</span>: <span class="number">15582.035</span>: [<span class="keyword">class</span> unloading, <span class="number">0.0033120</span> secs]<span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">30.123</span>+<span class="number">0800</span>: <span class="number">15582.038</span>: [scrub symbol table, <span class="number">0.0016780</span> secs]<span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">30.124</span>+<span class="number">0800</span>: <span class="number">15582.040</span>: [scrub <span class="built_in">string</span> table, <span class="number">0.0004780</span> secs] [<span class="number">1</span> CMS-remark: <span class="number">6299829</span>K(<span class="number">20971520</span>K)] <span class="number">6348225</span>K(<span class="number">24746432</span>K), <span class="number">0.1365130</span> secs] [Times: user=<span class="number">1.24</span> sys=<span class="number">0.00</span>, real=<span class="number">0.14</span> secs]</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">30.128</span>+<span class="number">0800</span>: <span class="number">15582.043</span>: [CMS-concurrent-sweep-start]</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">36.638</span>+<span class="number">0800</span>: <span class="number">15588.553</span>: [GC2018-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">36.638</span>+<span class="number">0800</span>: <span class="number">15588.554</span>: [ParNew: <span class="number">3403915</span>K-&gt;<span class="number">52142</span>K(<span class="number">3774912</span>K), <span class="number">0.0874610</span> secs] <span class="number">4836483</span>K-&gt;<span class="number">1489601</span>K(<span class="number">24746432</span>K), <span class="number">0.0877490</span> secs] [Times: user=<span class="number">0.84</span> sys=<span class="number">0.00</span>, real=<span class="number">0.09</span> secs]</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">38.412</span>+<span class="number">0800</span>: <span class="number">15590.327</span>: [CMS-concurrent-sweep: <span class="number">8.193</span>/<span class="number">8.284</span> secs] [Times: user=<span class="number">30.34</span> sys=<span class="number">16.44</span>, real=<span class="number">8.28</span> secs]</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">38.419</span>+<span class="number">0800</span>: <span class="number">15590.334</span>: [CMS-concurrent-reset-start]</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">38.462</span>+<span class="number">0800</span>: <span class="number">15590.377</span>: [CMS-concurrent-reset: <span class="number">0.044</span>/<span class="number">0.044</span> secs] [Times: user=<span class="number">0.15</span> sys=<span class="number">0.10</span>, real=<span class="number">0.04</span> secs]</span><br></pre></td></tr></table></figure></p>
<p>CMS Full GC &#x62C6;&#x5206;&#x5F00;&#x6765;&#xFF0C;&#x6D89;&#x53CA;&#x7684;&#x9636;&#x6BB5;&#x6BD4;&#x8F83;&#x591A;&#xFF0C;&#x4E0B;&#x9762;&#x5206;&#x522B;&#x6765;&#x4ECB;&#x7ECD;&#x5404;&#x4E2A;&#x9636;&#x6BB5;&#x7684;&#x60C5;&#x51B5;&#x3002;</p>
<h4 id="&#x9636;&#x6BB5;1initial-mark">&#x9636;&#x6BB5;1&#xFF1A;Initial Mark</h4>
<p>&#x8FD9;&#x4E2A;&#x662F; CMS &#x4E24;&#x6B21; stop-the-wolrd &#x4E8B;&#x4EF6;&#x7684;&#x5176;&#x4E2D;&#x4E00;&#x6B21;&#xFF0C;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x7684;&#x76EE;&#x6807;&#x662F;&#xFF1A;&#x6807;&#x8BB0;&#x90A3;&#x4E9B;&#x76F4;&#x63A5;&#x88AB; GC root &#x5F15;&#x7528;&#x6216;&#x8005;&#x88AB;&#x5E74;&#x8F7B;&#x4EE3;&#x5B58;&#x6D3B;&#x5BF9;&#x8C61;&#x6240;&#x5F15;&#x7528;&#x7684;&#x6240;&#x6709;&#x5BF9;&#x8C61;&#xFF0C;&#x6807;&#x8BB0;&#x540E;&#x793A;&#x4F8B;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF08;&#x63D2;&#x56FE;&#x6765;&#x81EA;&#xFF1A;GC Algorithms&#xFF1A;Implementations &#x2014;&#x2014; Concurrent Mark and Sweep &#x2014;&#x2014; Full GC&#xFF09;&#xFF1A;</p>
<p><img src="/images/jvm-log-cms-init.png" alt="CMS&#x521D;&#x59CB;&#x6807;&#x8BB0;&#x9636;&#x6BB5;"></p>
<p>&#x4E0A;&#x8FF0;&#x4F8B;&#x5B50;&#x5BF9;&#x5E94;&#x7684;&#x65E5;&#x5FD7;&#x4FE1;&#x606F;&#x4E3A;&#xFF1A;</p>
<p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">26.233</span>+<span class="number">0800</span>: <span class="number">15578.148</span>: [GC [<span class="number">1</span> CMS-initial-mark: <span class="number">6294851</span>K(<span class="number">20971520</span>K)] <span class="number">6354687</span>K(<span class="number">24746432</span>K), <span class="number">0.0466580</span> secs] [Times: user=<span class="number">0.04</span> sys=<span class="number">0.00</span>, real=<span class="number">0.04</span> secs]</span><br></pre></td></tr></table></figure></p>
<p>&#x9010;&#x884C;&#x4ECB;&#x7ECD;&#x4E0A;&#x9762;&#x65E5;&#x5FD7;&#x7684;&#x542B;&#x4E49;&#xFF1A;</p>
<ol>
<li>2018-04-12T13:48:26.233+0800: 15578.148&#xFF1A;GC &#x5F00;&#x59CB;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x4EE5;&#x53CA;&#x76F8;&#x5BF9;&#x4E8E; JVM &#x542F;&#x52A8;&#x7684;&#x76F8;&#x5BF9;&#x65F6;&#x95F4;&#xFF08;&#x5355;&#x4F4D;&#x662F;&#x79D2;&#xFF0C;&#x8FD9;&#x91CC;&#x5927;&#x6982;&#x662F;4.33h&#xFF09;&#xFF0C;&#x4E0E;&#x524D;&#x9762; ParNew &#x7C7B;&#x4F3C;&#xFF0C;&#x4E0B;&#x9762;&#x7684;&#x5206;&#x6790;&#x4E2D;&#x5C31;&#x76F4;&#x63A5;&#x8DF3;&#x8FC7;&#x8FD9;&#x4E2A;&#x4E86;&#xFF1B;</li>
<li>CMS-initial-mark&#xFF1A;&#x521D;&#x59CB;&#x6807;&#x8BB0;&#x9636;&#x6BB5;&#xFF0C;&#x5B83;&#x4F1A;&#x6536;&#x96C6;&#x6240;&#x6709; GC Roots &#x4EE5;&#x53CA;&#x5176;&#x76F4;&#x63A5;&#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61;&#xFF1B;</li>
<li>6294851K&#xFF1A;&#x5F53;&#x524D;&#x8001;&#x5E74;&#x4EE3;&#x4F7F;&#x7528;&#x7684;&#x5BB9;&#x91CF;&#xFF0C;&#x8FD9;&#x91CC;&#x662F; 6G&#xFF1B;</li>
<li>(20971520K)&#xFF1A;&#x8001;&#x5E74;&#x4EE3;&#x53EF;&#x7528;&#x7684;&#x6700;&#x5927;&#x5BB9;&#x91CF;&#xFF0C;&#x8FD9;&#x91CC;&#x662F; 20G&#xFF1B;</li>
<li>6354687K&#xFF1A;&#x6574;&#x4E2A;&#x5806;&#x76EE;&#x524D;&#x4F7F;&#x7528;&#x7684;&#x5BB9;&#x91CF;&#xFF0C;&#x8FD9;&#x91CC;&#x662F; 6.06G&#xFF1B;</li>
<li>(24746432K)&#xFF1A;&#x5806;&#x53EF;&#x7528;&#x7684;&#x5BB9;&#x91CF;&#xFF0C;&#x8FD9;&#x91CC;&#x662F; 23.6G&#xFF1B;</li>
<li>0.0466580 secs&#xFF1A;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x7684;&#x6301;&#x7EED;&#x65F6;&#x95F4;&#xFF1B;</li>
<li>[Times: user=0.04 sys=0.00, real=0.04 secs]&#xFF1A;&#x4E0E;&#x524D;&#x9762;&#x7684;&#x7C7B;&#x4F3C;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;&#x76F8;&#x5E94; user&#x3001;system and real &#x7684;&#x65F6;&#x95F4;&#x7EDF;&#x8BA1;&#x3002;</li>
</ol>
<h4 id="&#x9636;&#x6BB5;2">&#x9636;&#x6BB5;2</h4>
<p>&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#x5728;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5; Garbage Collector &#x4F1A;&#x904D;&#x5386;&#x8001;&#x5E74;&#x4EE3;&#xFF0C;&#x7136;&#x540E;&#x6807;&#x8BB0;&#x6240;&#x6709;&#x5B58;&#x6D3B;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x5B83;&#x4F1A;&#x6839;&#x636E;&#x4E0A;&#x4E2A;&#x9636;&#x6BB5;&#x627E;&#x5230;&#x7684; GC Roots &#x904D;&#x5386;&#x67E5;&#x627E;&#x3002;&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#x9636;&#x6BB5;&#xFF0C;&#x5B83;&#x4F1A;&#x4E0E;&#x7528;&#x6237;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5E76;&#x53D1;&#x8FD0;&#x884C;&#x3002;&#x5E76;&#x4E0D;&#x662F;&#x8001;&#x5E74;&#x4EE3;&#x6240;&#x6709;&#x7684;&#x5B58;&#x6D3B;&#x5BF9;&#x8C61;&#x90FD;&#x4F1A;&#x88AB;&#x6807;&#x8BB0;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x6807;&#x8BB0;&#x671F;&#x95F4;&#x7528;&#x6237;&#x7684;&#x7A0B;&#x5E8F;&#x53EF;&#x80FD;&#x4F1A;&#x6539;&#x53D8;&#x4E00;&#x4E9B;&#x5F15;&#x7528;&#xFF0C;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF08;&#x63D2;&#x56FE;&#x6765;&#x81EA;&#xFF1A;GC Algorithms&#xFF1A;Implementations &#x2014;&#x2014; Concurrent Mark and Sweep &#x2014;&#x2014; Full GC&#xFF09;&#xFF1A;</p>
<p><img src="/images/jvm-log-cms-mark-sweep.png" alt="CMS&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#x9636;&#x6BB5;"></p>
<p>&#x5728;&#x4E0A;&#x9762;&#x7684;&#x56FE;&#x4E2D;&#xFF0C;&#x4E0E;&#x9636;&#x6BB5;1&#x7684;&#x56FE;&#x8FDB;&#x884C;&#x5BF9;&#x6BD4;&#xFF0C;&#x5C31;&#x4F1A;&#x53D1;&#x73B0;&#x6709;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#x5DF2;&#x7ECF;&#x53D1;&#x751F;&#x4E86;&#x53D8;&#x5316;&#xFF0C;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x76F8;&#x5E94;&#x7684;&#x65E5;&#x5FD7;&#x4FE1;&#x606F;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">26.280</span>+<span class="number">0800</span>: <span class="number">15578.195</span>: [CMS-concurrent-mark-start]</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">26.418</span>+<span class="number">0800</span>: <span class="number">15578.333</span>: [CMS-concurrent-mark: <span class="number">0.138</span>/<span class="number">0.138</span> secs] [Times: user=<span class="number">1.01</span> sys=<span class="number">0.21</span>, real=<span class="number">0.14</span> secs]</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x91CC;&#x8BE6;&#x7EC6;&#x5BF9;&#x4E0A;&#x9762;&#x7684;&#x65E5;&#x5FD7;&#x89E3;&#x91CA;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</p>
<ol>
<li>CMS-concurrent-mark&#xFF1A;&#x5E76;&#x53D1;&#x6536;&#x96C6;&#x9636;&#x6BB5;&#xFF0C;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x4F1A;&#x904D;&#x5386;&#x8001;&#x5E74;&#x4EE3;&#xFF0C;&#x5E76;&#x6807;&#x8BB0;&#x6240;&#x6709;&#x5B58;&#x6D3B;&#x7684;&#x5BF9;&#x8C61;&#xFF1B;</li>
<li>0.138/0.138 secs&#xFF1A;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x7684;&#x6301;&#x7EED;&#x65F6;&#x95F4;&#x4E0E;&#x65F6;&#x949F;&#x65F6;&#x95F4;&#xFF1B;</li>
<li>[Times: user=1.01 sys=0.21, real=0.14 secs]&#xFF1A;&#x5982;&#x524D;&#x9762;&#x6240;&#x793A;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x90E8;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x5176;&#x5B9E;&#x610F;&#x4E49;&#x4E0D;&#x5927;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x662F;&#x4ECE;&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#x7684;&#x5F00;&#x59CB;&#x65F6;&#x95F4;&#x5F00;&#x59CB;&#x8BA1;&#x7B97;&#xFF0C;&#x8FD9;&#x671F;&#x95F4;&#x56E0;&#x4E3A;&#x662F;&#x5E76;&#x53D1;&#x8FDB;&#x884C;&#xFF0C;&#x4E0D;&#x4EC5;&#x4EC5;&#x5305;&#x542B; GC &#x7EBF;&#x7A0B;&#x7684;&#x5DE5;&#x4F5C;&#x3002;</li>
</ol>
<h4 id="&#x9636;&#x6BB5;3concurrent-preclean">&#x9636;&#x6BB5;3&#xFF1A;Concurrent Preclean</h4>
<p>Concurrent Preclean&#xFF1A;&#x8FD9;&#x4E5F;&#x662F;&#x4E00;&#x4E2A;&#x5E76;&#x53D1;&#x9636;&#x6BB5;&#xFF0C;&#x4E0E;&#x5E94;&#x7528;&#x7684;&#x7EBF;&#x7A0B;&#x5E76;&#x53D1;&#x8FD0;&#x884C;&#xFF0C;&#x5E76;&#x4E0D;&#x4F1A; stop &#x5E94;&#x7528;&#x7684;&#x7EBF;&#x7A0B;&#x3002;&#x5728;&#x5E76;&#x53D1;&#x8FD0;&#x884C;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x4E00;&#x4E9B;&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#x53EF;&#x80FD;&#x4F1A;&#x53D1;&#x751F;&#x53D8;&#x5316;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x53D1;&#x751F;&#x65F6;&#xFF0C;JVM &#x4F1A;&#x5C06;&#x5305;&#x542B;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x533A;&#x57DF;&#xFF08;Card&#xFF09;&#x6807;&#x8BB0;&#x4E3A; Dirty&#xFF0C;&#x8FD9;&#x4E5F;&#x5C31;&#x662F; Card Marking&#x3002;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF08;&#x63D2;&#x56FE;&#x6765;&#x81EA;&#xFF1A;GC Algorithms&#xFF1A;Implementations &#x2014;&#x2014; Concurrent Mark and Sweep &#x2014;&#x2014; Full GC&#xFF1A;</p>
<p><img src="/images/jvm-log-cms-concurrent-clean.png" alt="Concurrent preclean 1"></p>
<p>&#x5728;pre-clean&#x9636;&#x6BB5;&#xFF0C;&#x90A3;&#x4E9B;&#x80FD;&#x591F;&#x4ECE; Dirty &#x5BF9;&#x8C61;&#x5230;&#x8FBE;&#x7684;&#x5BF9;&#x8C61;&#x4E5F;&#x4F1A;&#x88AB;&#x6807;&#x8BB0;&#xFF0C;&#x8FD9;&#x4E2A;&#x6807;&#x8BB0;&#x505A;&#x5B8C;&#x4E4B;&#x540E;&#xFF0C;dirty card &#x6807;&#x8BB0;&#x5C31;&#x4F1A;&#x88AB;&#x6E05;&#x9664;&#x4E86;&#xFF0C;&#x5982;&#x4E0B;&#xFF08;&#x63D2;&#x56FE;&#x6765;&#x81EA;&#xFF1A;GC Algorithms&#xFF1A;Implementations &#x2014;&#x2014; Concurrent Mark and Sweep &#x2014;&#x2014; Full GC)</p>
<p><img src="/images/jvm-log-cms-concurrent-clean2.png" alt="Concurrent preclean 2"></p>
<p>&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x76F8;&#x5E94;&#x7684;&#x65E5;&#x5FD7;&#x4FE1;&#x606F;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">26.418</span>+<span class="number">0800</span>: <span class="number">15578.334</span>: [CMS-concurrent-preclean-start]</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">26.476</span>+<span class="number">0800</span>: <span class="number">15578.391</span>: [CMS-concurrent-preclean: <span class="number">0.056</span>/<span class="number">0.057</span> secs] [Times: user=<span class="number">0.20</span> sys=<span class="number">0.12</span>, real=<span class="number">0.06</span> secs]</span><br></pre></td></tr></table></figure></p>
<p>&#x5176;&#x542B;&#x4E49;&#x4E3A;&#xFF1A;</p>
<ol>
<li>CMS-concurrent-preclean&#xFF1A;Concurrent Preclean &#x9636;&#x6BB5;&#xFF0C;&#x5BF9;&#x5728;&#x524D;&#x9762;&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#x9636;&#x6BB5;&#x4E2D;&#x5F15;&#x7528;&#x53D1;&#x751F;&#x53D8;&#x5316;&#x7684;&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x6807;&#x8BB0;&#xFF1B;</li>
<li>0.056/0.057 secs&#xFF1A;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x7684;&#x6301;&#x7EED;&#x65F6;&#x95F4;&#x4E0E;&#x65F6;&#x949F;&#x65F6;&#x95F4;&#xFF1B;</li>
<li>[Times: user=0.20 sys=0.12, real=0.06 secs]&#xFF1A;&#x540C;&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#x9636;&#x6BB5;&#x4E2D;&#x7684;&#x542B;&#x4E49;&#x3002;</li>
</ol>
<h4 id="&#x9636;&#x6BB5;4concurrent-abortable-preclean">&#x9636;&#x6BB5;4&#xFF1A;Concurrent Abortable Preclean</h4>
<p>&#x8FD9;&#x4E5F;&#x662F;&#x4E00;&#x4E2A;&#x5E76;&#x53D1;&#x9636;&#x6BB5;&#xFF0C;&#x4F46;&#x662F;&#x540C;&#x6837;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x5F71;&#x54CD;&#x7528;&#x6237;&#x7684;&#x5E94;&#x7528;&#x7EBF;&#x7A0B;&#xFF0C;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x662F;&#x4E3A;&#x4E86;&#x5C3D;&#x91CF;&#x627F;&#x62C5; STW&#xFF08;stop-the-world&#xFF09;&#x4E2D;&#x6700;&#x7EC8;&#x6807;&#x8BB0;&#x9636;&#x6BB5;&#x7684;&#x5DE5;&#x4F5C;&#x3002;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x6301;&#x7EED;&#x65F6;&#x95F4;&#x4F9D;&#x8D56;&#x4E8E;&#x5F88;&#x591A;&#x7684;&#x56E0;&#x7D20;&#xFF0C;&#x7531;&#x4E8E;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x662F;&#x5728;&#x91CD;&#x590D;&#x505A;&#x5F88;&#x591A;&#x76F8;&#x540C;&#x7684;&#x5DE5;&#x4F5C;&#xFF0C;&#x76F4;&#x63A5;&#x6EE1;&#x8DB3;&#x4E00;&#x4E9B;&#x6761;&#x4EF6;&#xFF08;&#x6BD4;&#x5982;&#xFF1A;&#x91CD;&#x590D;&#x8FED;&#x4EE3;&#x7684;&#x6B21;&#x6570;&#x3001;&#x5B8C;&#x6210;&#x7684;&#x5DE5;&#x4F5C;&#x91CF;&#x6216;&#x8005;&#x65F6;&#x949F;&#x65F6;&#x95F4;&#x7B49;&#xFF09;&#x3002;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x7684;&#x65E5;&#x5FD7;&#x4FE1;&#x606F;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">26.476</span>+<span class="number">0800</span>: <span class="number">15578.391</span>: [CMS-concurrent-abortable-preclean-start]</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">29.989</span>+<span class="number">0800</span>: <span class="number">15581.905</span>: [CMS-concurrent-abortable-preclean: <span class="number">3.506</span>/<span class="number">3.514</span> secs] [Times: user=<span class="number">11.93</span> sys=<span class="number">6.77</span>, real=<span class="number">3.51</span> secs]</span><br></pre></td></tr></table></figure></p>
<ol>
<li>CMS-concurrent-abortable-preclean&#xFF1A;Concurrent Abortable Preclean &#x9636;&#x6BB5;&#xFF1B;</li>
<li>3.506/3.514 secs&#xFF1A;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x7684;&#x6301;&#x7EED;&#x65F6;&#x95F4;&#x4E0E;&#x65F6;&#x949F;&#x65F6;&#x95F4;&#xFF0C;&#x672C;&#x8D28;&#x4E0A;&#xFF0C;&#x8FD9;&#x91CC;&#x7684; gc &#x7EBF;&#x7A0B;&#x4F1A;&#x5728; STW &#x4E4B;&#x524D;&#x505A;&#x66F4;&#x591A;&#x7684;&#x5DE5;&#x4F5C;&#xFF0C;&#x901A;&#x5E38;&#x4F1A;&#x6301;&#x7EED; 5s &#x5DE6;&#x53F3;&#xFF1B;</li>
<li>[Times: user=11.93 sys=6.77, real=3.51 secs]&#xFF1A;&#x540C;&#x524D;&#x9762;&#x3002;</li>
</ol>
<h4 id="&#x9636;&#x6BB5;5final-remark">&#x9636;&#x6BB5;5&#xFF1A;Final Remark</h4>
<p>&#x8FD9;&#x662F;&#x7B2C;&#x4E8C;&#x4E2A;STW&#x9636;&#x6BB5;&#xFF0C;&#x4E5F;&#x662F;CMS&#x4E2D;&#x7684;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#xFF0C;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x7684;&#x76EE;&#x6807;&#x662F;&#x6807;&#x8BB0;&#x6240;&#x6709;&#x8001;&#x5E74;&#x4EE3;&#x6240;&#x6709;&#x7684;&#x5B58;&#x6D3B;&#x5BF9;&#x8C61;&#xFF0C;&#x7531;&#x4E8E;&#x4E4B;&#x524D;&#x7684;&#x9636;&#x6BB5;&#x662F;&#x5E76;&#x53D1;&#x6267;&#x884C;&#x7684;&#xFF0C;gc &#x7EBF;&#x7A0B;&#x53EF;&#x80FD;&#x8DDF;&#x4E0D;&#x4E0A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x53D8;&#x5316;&#xFF0C;&#x4E3A;&#x4E86;&#x5B8C;&#x6210;&#x6807;&#x8BB0;&#x8001;&#x5E74;&#x4EE3;&#x6240;&#x6709;&#x5B58;&#x6D3B;&#x5BF9;&#x8C61;&#x7684;&#x76EE;&#x6807;&#xFF0C;STW &#x5C31;&#x975E;&#x5E38;&#x6709;&#x5FC5;&#x8981;&#x4E86;&#x3002;&#x901A;&#x5E38; CMS &#x7684; Final Remark &#x9636;&#x6BB5;&#x4F1A;&#x5728;&#x5E74;&#x8F7B;&#x4EE3;&#x5C3D;&#x53EF;&#x80FD;&#x5E72;&#x51C0;&#x7684;&#x65F6;&#x5019;&#x8FD0;&#x884C;&#xFF0C;&#x76EE;&#x7684;&#x662F;&#x4E3A;&#x4E86;&#x51CF;&#x5C11;&#x8FDE;&#x7EED; STW &#x53D1;&#x751F;&#x7684;&#x53EF;&#x80FD;&#x6027;&#xFF08;&#x5E74;&#x8F7B;&#x4EE3;&#x5B58;&#x6D3B;&#x5BF9;&#x8C61;&#x8FC7;&#x591A;&#x7684;&#x8BDD;&#xFF0C;&#x4E5F;&#x4F1A;&#x5BFC;&#x81F4;&#x8001;&#x5E74;&#x4EE3;&#x6D89;&#x53CA;&#x7684;&#x5B58;&#x6D3B;&#x5BF9;&#x8C61;&#x4F1A;&#x5F88;&#x591A;&#xFF09;&#x3002;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x4F1A;&#x6BD4;&#x524D;&#x9762;&#x7684;&#x51E0;&#x4E2A;&#x9636;&#x6BB5;&#x66F4;&#x590D;&#x6742;&#x4E00;&#x4E9B;&#xFF0C;&#x76F8;&#x5173;&#x65E5;&#x5FD7;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">29.991</span>+<span class="number">0800</span>: <span class="number">15581.906</span>: [GC[YG occupancy: <span class="number">1805641</span> K (<span class="number">3774912</span> K)]<span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">29.991</span>+<span class="number">0800</span>: <span class="number">15581.906</span>: [GC2018-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">29.991</span>+<span class="number">0800</span>: <span class="number">15581.906</span>:</span><br><span class="line">[ParNew: <span class="number">1805641</span>K-&gt;<span class="number">48395</span>K(<span class="number">3774912</span>K), <span class="number">0.0826620</span> secs] <span class="number">8100493</span>K-&gt;<span class="number">6348225</span>K(<span class="number">24746432</span>K), <span class="number">0.0829480</span> secs]</span><br><span class="line">[Times: user=<span class="number">0.81</span> sys=<span class="number">0.00</span>, real=<span class="number">0.09</span> secs]<span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">30.074</span>+<span class="number">0800</span>: <span class="number">15581.989</span>: [Rescan (parallel) , <span class="number">0.0429390</span> secs]</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">30.117</span>+<span class="number">0800</span>: <span class="number">15582.032</span>: [weak refs processing, <span class="number">0.0027800</span> secs]<span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">30.119</span>+<span class="number">0800</span>: <span class="number">15582.035</span>: [<span class="keyword">class</span> unloading, <span class="number">0.0033120</span> secs]</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">30.123</span>+<span class="number">0800</span>: <span class="number">15582.038</span>: [scrub symbol table, <span class="number">0.0016780</span> secs]<span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">30.124</span>+<span class="number">0800</span>: <span class="number">15582.040</span>: [scrub <span class="built_in">string</span> table, <span class="number">0.0004780</span> secs]</span><br><span class="line">[<span class="number">1</span> CMS-remark: <span class="number">6299829</span>K(<span class="number">20971520</span>K)] <span class="number">6348225</span>K(<span class="number">24746432</span>K), <span class="number">0.1365130</span> secs] [Times: user=<span class="number">1.24</span> sys=<span class="number">0.00</span>, real=<span class="number">0.14</span> secs]</span><br></pre></td></tr></table></figure></p>
<p>&#x5BF9;&#x4E0A;&#x9762;&#x7684;&#x65E5;&#x5FD7;&#x8FDB;&#x884C;&#x5206;&#x6790;&#xFF1A;</p>
<ol>
<li>YG occupancy: 1805641 K (3774912 K)&#xFF1A;&#x5E74;&#x8F7B;&#x4EE3;&#x5F53;&#x524D;&#x5360;&#x7528;&#x91CF;&#x53CA;&#x5BB9;&#x91CF;&#xFF0C;&#x8FD9;&#x91CC;&#x5206;&#x522B;&#x662F; 1.71G &#x548C; 3.6G&#xFF1B;</li>
<li>ParNew:...&#xFF1A;&#x89E6;&#x53D1;&#x4E86;&#x4E00;&#x6B21; young GC&#xFF0C;&#x8FD9;&#x91CC;&#x89E6;&#x53D1;&#x7684;&#x539F;&#x56E0;&#x662F;&#x4E3A;&#x4E86;&#x51CF;&#x5C11;&#x5E74;&#x8F7B;&#x4EE3;&#x7684;&#x5B58;&#x6D3B;&#x5BF9;&#x8C61;&#xFF0C;&#x5C3D;&#x91CF;&#x4F7F;&#x5E74;&#x8F7B;&#x4EE3;&#x66F4;&#x5E72;&#x51C0;&#x4E00;&#x4E9B;&#xFF1B;</li>
<li>[Rescan (parallel) , 0.0429390 secs]&#xFF1A;&#x8FD9;&#x4E2A; Rescan &#x662F;&#x5F53;&#x5E94;&#x7528;&#x6682;&#x505C;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x5B8C;&#x6210;&#x5BF9;&#x6240;&#x6709;&#x5B58;&#x6D3B;&#x5BF9;&#x8C61;&#x7684;&#x6807;&#x8BB0;&#xFF0C;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x662F;&#x5E76;&#x884C;&#x5904;&#x7406;&#x7684;&#xFF0C;&#x8FD9;&#x91CC;&#x82B1;&#x8D39;&#x4E86; 0.0429390s&#xFF1B;</li>
<li>[weak refs processing, 0.0027800 secs]&#xFF1A;&#x7B2C;&#x4E00;&#x4E2A;&#x5B50;&#x9636;&#x6BB5;&#xFF0C;&#x5B83;&#x7684;&#x5DE5;&#x4F5C;&#x662F;&#x5904;&#x7406;&#x5F31;&#x5F15;&#x7528;&#xFF1B;</li>
<li>[class unloading, 0.0033120 secs]&#xFF1A;&#x7B2C;&#x4E8C;&#x4E2A;&#x5B50;&#x9636;&#x6BB5;&#xFF0C;&#x5B83;&#x7684;&#x5DE5;&#x4F5C;&#x662F;&#xFF1A;unloading the unused classes&#xFF1B;</li>
<li>[scrub symbol table, 0.0016780 secs] ... [scrub string table, 0.0004780 secs]&#xFF1A;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5B50;&#x9636;&#x6BB5;&#xFF0C;&#x5B83;&#x7684;&#x76EE;&#x7684;&#x662F;&#xFF1A;cleaning up symbol and string tables which hold class-level metadata and internalized string respectively&#xFF0C;&#x65F6;&#x949F;&#x7684;&#x6682;&#x505C;&#x4E5F;&#x5305;&#x542B;&#x5728;&#x8FD9;&#x91CC;&#xFF1B;</li>
<li>6299829K(20971520K)&#xFF1A;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x4E4B;&#x540E;&#xFF0C;&#x8001;&#x5E74;&#x4EE3;&#x7684;&#x4F7F;&#x7528;&#x91CF;&#x4E0E;&#x603B;&#x91CF;&#xFF0C;&#x8FD9;&#x91CC;&#x5206;&#x522B;&#x662F; 6G &#x548C; 20G&#xFF1B;</li>
<li>6348225K(24746432K)&#xFF1A;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x4E4B;&#x540E;&#xFF0C;&#x5806;&#x7684;&#x4F7F;&#x7528;&#x91CF;&#x4E0E;&#x603B;&#x91CF;&#xFF08;&#x5305;&#x62EC;&#x5E74;&#x8F7B;&#x4EE3;&#xFF0C;&#x5E74;&#x8F7B;&#x4EE3;&#x5728;&#x524D;&#x9762;&#x53D1;&#x751F;&#x8FC7; GC&#xFF09;&#xFF0C;&#x8FD9;&#x91CC;&#x5206;&#x522B;&#x662F; 6.05G &#x548C; 23.6G&#xFF1B;</li>
<li>0.1365130 secs&#xFF1A;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x7684;&#x6301;&#x7EED;&#x65F6;&#x95F4;&#xFF1B;</li>
<li>[Times: user=1.24 sys=0.00, real=0.14 secs]&#xFF1A;&#x5BF9;&#x5E94;&#x7684;&#x65F6;&#x95F4;&#x4FE1;&#x606F;&#x3002;</li>
</ol>
<p>&#x7ECF;&#x5386;&#x8FC7;&#x8FD9;&#x4E94;&#x4E2A;&#x9636;&#x6BB5;&#x4E4B;&#x540E;&#xFF0C;&#x8001;&#x5E74;&#x4EE3;&#x6240;&#x6709;&#x5B58;&#x6D3B;&#x7684;&#x5BF9;&#x8C61;&#x90FD;&#x88AB;&#x6807;&#x8BB0;&#x8FC7;&#x4E86;&#xFF0C;&#x73B0;&#x5728;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x6E05;&#x9664;&#x7B97;&#x6CD5;&#x53BB;&#x6E05;&#x7406;&#x90A3;&#x4E9B;&#x8001;&#x5E74;&#x4EE3;&#x4E0D;&#x518D;&#x4F7F;&#x7528;&#x7684;&#x5BF9;&#x8C61;&#x3002;</p>
<h4 id="&#x9636;&#x6BB5;6concurrent-sweep">&#x9636;&#x6BB5;6&#xFF1A;Concurrent Sweep</h4>
<p>&#x8FD9;&#x91CC;&#x4E0D;&#x9700;&#x8981; STW&#xFF0C;&#x5B83;&#x662F;&#x4E0E;&#x7528;&#x6237;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5E76;&#x53D1;&#x8FD0;&#x884C;&#xFF0C;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x662F;&#xFF1A;&#x6E05;&#x9664;&#x90A3;&#x4E9B;&#x4E0D;&#x518D;&#x4F7F;&#x7528;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x56DE;&#x6536;&#x5B83;&#x4EEC;&#x7684;&#x5360;&#x7528;&#x7A7A;&#x95F4;&#x4E3A;&#x5C06;&#x6765;&#x4F7F;&#x7528;&#x3002;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF08;&#x63D2;&#x56FE;&#x6765;&#x81EA;&#xFF1A;GC Algorithms&#xFF1A;Implementations &#x2014;&#x2014; Concurrent Mark and Sweep &#x2014;&#x2014; Full GC)</p>
<p><img src="/images/jvm-log-cms-concurrent-clean.png" alt="CMS Concurrent Sweep&#x9636;&#x6BB5;"></p>
<p>&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x5BF9;&#x5E94;&#x7684;&#x65E5;&#x5FD7;&#x4FE1;&#x606F;&#x5982;&#x4E0B;&#xFF08;&#x8FD9;&#x4E2D;&#x95F4;&#x53C8;&#x53D1;&#x751F;&#x4E86;&#x4E00;&#x6B21; Young GC&#xFF09;&#xFF1A;</p>
<p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">30.128</span>+<span class="number">0800</span>: <span class="number">15582.043</span>: [CMS-concurrent-sweep-start]</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">36.638</span>+<span class="number">0800</span>: <span class="number">15588.553</span>: [GC2018-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">36.638</span>+<span class="number">0800</span>: <span class="number">15588.554</span>: [ParNew: <span class="number">3403915</span>K-&gt;<span class="number">52142</span>K(<span class="number">3774912</span>K), <span class="number">0.0874610</span> secs] <span class="number">4836483</span>K-&gt;<span class="number">1489601</span>K(<span class="number">24746432</span>K), <span class="number">0.0877490</span> secs] [Times: user=<span class="number">0.84</span> sys=<span class="number">0.00</span>, real=<span class="number">0.09</span> secs]</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">38.412</span>+<span class="number">0800</span>: <span class="number">15590.327</span>: [CMS-concurrent-sweep: <span class="number">8.193</span>/<span class="number">8.284</span> secs] [Times: user=<span class="number">30.34</span> sys=<span class="number">16.44</span>, real=<span class="number">8.28</span> secs]</span><br></pre></td></tr></table></figure></p>
<p>&#x5206;&#x522B;&#x4ECB;&#x7ECD;&#x4E00;&#x4E0B;&#xFF1A;</p>
<ol>
<li>CMS-concurrent-sweep&#xFF1A;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x4E3B;&#x8981;&#x662F;&#x6E05;&#x9664;&#x90A3;&#x4E9B;&#x6CA1;&#x6709;&#x88AB;&#x6807;&#x8BB0;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x56DE;&#x6536;&#x5B83;&#x4EEC;&#x7684;&#x5360;&#x7528;&#x7A7A;&#x95F4;&#xFF1B;</li>
<li>8.193/8.284 secs&#xFF1A;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x7684;&#x6301;&#x7EED;&#x65F6;&#x95F4;&#x4E0E;&#x65F6;&#x949F;&#x65F6;&#x95F4;&#xFF1B;</li>
<li>[Times: user=30.34 sys=16.44, real=8.28 secs]&#xFF1A;&#x540C;&#x524D;&#x9762;&#xFF1B;</li>
</ol>
<h4 id="&#x9636;&#x6BB5;7concurrent-reset">&#x9636;&#x6BB5;7&#xFF1A;Concurrent Reset</h4>
<p>&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x4E5F;&#x662F;&#x5E76;&#x53D1;&#x6267;&#x884C;&#x7684;&#xFF0C;&#x5B83;&#x4F1A;&#x91CD;&#x8BBE; CMS &#x5185;&#x90E8;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#xFF0C;&#x4E3A;&#x4E0B;&#x6B21;&#x7684; GC &#x505A;&#x51C6;&#x5907;&#xFF0C;&#x5BF9;&#x5E94;&#x7684;&#x65E5;&#x5FD7;&#x4FE1;&#x606F;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">38.419</span>+<span class="number">0800</span>: <span class="number">15590.334</span>: [CMS-concurrent-reset-start]</span><br><span class="line"></span><br><span class="line"><span class="number">2018</span>-<span class="number">04</span>-<span class="number">12</span>T13:<span class="number">48</span>:<span class="number">38.462</span>+<span class="number">0800</span>: <span class="number">15590.377</span>: [CMS-concurrent-reset: <span class="number">0.044</span>/<span class="number">0.044</span> secs] [Times: user=<span class="number">0.15</span> sys=<span class="number">0.10</span>, real=<span class="number">0.04</span> secs]</span><br></pre></td></tr></table></figure></p>
<p>&#x65E5;&#x5FD7;&#x8BE6;&#x60C5;&#x5206;&#x522B;&#x5982;&#x4E0B;&#xFF1A;</p>
<ol>
<li>CMS-concurrent-reset&#xFF1A;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x7684;&#x5F00;&#x59CB;&#xFF0C;&#x76EE;&#x7684;&#x5982;&#x524D;&#x9762;&#x6240;&#x8FF0;&#xFF1B;</li>
<li>0.044/0.044 secs&#xFF1A;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x7684;&#x6301;&#x7EED;&#x65F6;&#x95F4;&#x4E0E;&#x65F6;&#x949F;&#x65F6;&#x95F4;&#xFF1B;</li>
<li>[Times: user=0.15 sys=0.10, real=0.04 secs]&#xFF1A;&#x540C;&#x524D;&#x9762;&#x3002;</li>
</ol>
<h3 id="&#x603B;&#x7ED3;">&#x603B;&#x7ED3;</h3>
<p>CMS &#x901A;&#x8FC7;&#x5C06;&#x5927;&#x91CF;&#x5DE5;&#x4F5C;&#x5206;&#x6563;&#x5230;&#x5E76;&#x53D1;&#x5904;&#x7406;&#x9636;&#x6BB5;&#x6765;&#x5728;&#x51CF;&#x5C11; STW &#x65F6;&#x95F4;&#xFF0C;&#x5728;&#x8FD9;&#x5757;&#x505A;&#x5F97;&#x975E;&#x5E38;&#x4F18;&#x79C0;&#xFF0C;&#x4F46;&#x662F; CMS &#x4E5F;&#x6709;&#x4E00;&#x4E9B;&#x5176;&#x4ED6;&#x7684;&#x95EE;&#x9898;&#xFF1A;</p>
<ol>
<li>CMS &#x6536;&#x96C6;&#x5668;&#x65E0;&#x6CD5;&#x5904;&#x7406;&#x6D6E;&#x52A8;&#x5783;&#x573E;&#xFF08; Floating Garbage&#xFF09;&#xFF0C;&#x53EF;&#x80FD;&#x51FA;&#x73B0; &#x201C;Concurrnet Mode Failure&#x201D; &#x5931;&#x8D25;&#x800C;&#x5BFC;&#x81F4;&#x53E6;&#x4E00;&#x6B21; Full GC &#x7684;&#x4EA7;&#x751F;&#xFF0C;&#x53EF;&#x80FD;&#x5F15;&#x53D1;&#x4E32;&#x884C; Full GC&#xFF1B;</li>
<li>&#x7A7A;&#x95F4;&#x788E;&#x7247;&#xFF0C;&#x5BFC;&#x81F4;&#x65E0;&#x6CD5;&#x5206;&#x914D;&#x5927;&#x5BF9;&#x8C61;&#xFF0C;CMS &#x6536;&#x96C6;&#x5668;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A; -XX:+UseCMSCompactAtFullCollection &#x5F00;&#x5173;&#x53C2;&#x6570;&#xFF08;&#x9ED8;&#x8BA4;&#x5C31;&#x662F;&#x5F00;&#x542F;&#x7684;&#xFF09;&#xFF0C;&#x7528;&#x4E8E;&#x5728; CMS &#x6536;&#x96C6;&#x5668;&#x9876;&#x4E0D;&#x4F4F;&#x8981;&#x8FDB;&#x884C; Full GC &#x65F6;&#x5F00;&#x542F;&#x5185;&#x5B58;&#x788E;&#x7247;&#x7684;&#x5408;&#x5E76;&#x6574;&#x7406;&#x8FC7;&#x7A0B;&#xFF0C;&#x5185;&#x5B58;&#x6574;&#x7406;&#x7684;&#x8FC7;&#x7A0B;&#x662F;&#x65E0;&#x6CD5;&#x5E76;&#x53D1;&#x7684;&#xFF0C;&#x7A7A;&#x95F4;&#x788E;&#x7247;&#x95EE;&#x9898;&#x6CA1;&#x6709;&#x4E86;&#xFF0C;&#x4F46;&#x505C;&#x987F;&#x65F6;&#x95F4;&#x4E0D;&#x5F97;&#x4E0D;&#x53D8;&#x957F;&#xFF1B;</li>
<li>&#x5BF9;&#x4E8E;&#x5806;&#x6BD4;&#x8F83;&#x5927;&#x7684;&#x5E94;&#x7528;&#x4E0A;&#xFF0C;GC &#x7684;&#x65F6;&#x95F4;&#x96BE;&#x4EE5;&#x9884;&#x4F30;&#x3002;</li>
</ol>
<p>CMS &#x7684;&#x4E00;&#x4E9B;&#x7F3A;&#x9677;&#x4E5F;&#x662F; G1 &#x6536;&#x96C6;&#x5668;&#x5174;&#x8D77;&#x7684;&#x539F;&#x56E0;&#x3002;&#x5173;&#x4E8E;G1&#x6536;&#x96C6;&#x5668;&#x7684;&#x65E5;&#x5FD7;&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x8FD9;&#x91CC;<a href="https://tech.meituan.com/g1.html" target="_blank" rel="external">https://tech.meituan.com/g1.html</a></p>
<h3 id="&#x53C2;&#x8003;&#x6587;&#x6863;">&#x53C2;&#x8003;&#x6587;&#x6863;</h3>
<ol>
<li><a href="https://plumbr.io/handbook/garbage-collection-algorithms-implementations#concurrent-mark-and-sweep" target="_blank" rel="external">https://plumbr.io/handbook/garbage-collection-algorithms-implementations#concurrent-mark-and-sweep</a></li>
<li><a href="http://matt33.com/2018/07/28/jvm-cms/" target="_blank" rel="external">http://matt33.com/2018/07/28/jvm-cms/</a></li>
</ol>
]]></content>
    <summary type="html">
    <![CDATA[线上经常会遇到服务器繁忙,请求响应缓慢，这个时候大多是在进行大量的gc或者full gc，为了排查这方面的问题我们就要清楚的知道]]>
    
    </summary>
    
      <category term="java" scheme="http://yoursite.com/tags/java/"/>
    
      <category term="jvm" scheme="http://yoursite.com/tags/jvm/"/>
    
      <category term="jvm" scheme="http://yoursite.com/categories/jvm/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Java中的垃圾回收算法以及垃圾回收器]]></title>
    <link href="http://yoursite.com/2018/11/04/garbage-collection/"/>
    <id>http://yoursite.com/2018/11/04/garbage-collection/</id>
    <published>2018-11-04T06:45:40.000Z</published>
    <updated>2018-11-14T13:55:53.774Z</updated>
    <content type="html"><![CDATA[<p>&#x6700;&#x65B0;&#x51FA;&#x6765;&#x7684;ZGC&#x5BF9;JVM&#x7684;&#x5783;&#x573E;&#x56DE;&#x6536;&#x6709;&#x4E86;&#x4E00;&#x4E2A;&#x5F88;&#x5927;&#x7684;&#x98A0;&#x8986;,&#x90A3;&#x5C31;&#x662F;&#x5185;&#x5B58;&#x4E0D;&#x5728;&#x5206;&#x533A;&#x4E86;&#xFF0C;&#x76F4;&#x63A5;&#x4E00;&#x4E2A;&#x5927;&#x5806;&#x641E;&#x5B9A;&#xFF0C;&#x800C;&#x4E14;&#x8FD8;&#x80FD;&#x4FDD;&#x8BC1;&#x56DE;&#x6536;&#x901F;&#x7387;&#xFF0C;&#x867D;&#x7136;&#x73B0;&#x5728;&#x8FD8;&#x662F;&#x5B9E;&#x9A8C;&#x7248;&#x672C;&#x4F46;&#x662F;&#x53EF;&#x4EE5;&#x9047;&#x89C1;&#xFF0C;&#x4EE5;&#x540E;&#x5347;&#x7EA7;JDK,ZGC&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x5DE8;&#x5927;&#x7684;&#x8BF1;&#x60D1;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x90FD;&#x77E5;&#x9053;,JVM&#x5C06;&#x5185;&#x5B58;&#x5728;&#x903B;&#x8F91;&#x4E0A;&#x5212;&#x5206;&#x4E3A;&#x4E86;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x533A;&#x57DF;,&#x800C;&#x65B0;&#x521B;&#x5EFA;&#x7684;&#x5BF9;&#x8C61;&#x90FD;&#x662F;&#x5728;&#x5806;&#x4E0A;&#x5206;&#x914D;&#x5185;&#x5B58;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x7684;&#x5783;&#x573E;&#x6536;&#x96C6;&#x4E5F;&#x662F;&#x5728;&#x5806;&#x4E0A;&#x9762;&#x3002;</p>
<p><img src="/images/thread-java-running-data-area.png" alt="JVM&#x5185;&#x5B58;&#x533A;&#x57DF;"></p>
<p>&#x73B0;&#x5728;&#x5927;&#x91CF;&#x7684;&#x5E94;&#x7528;&#x4F7F;&#x7528;JDK6-JDK8&#x4ECD;&#x7136;&#x662F;&#x4E3B;&#x6D41;,&#x4E86;&#x89E3;&#x5783;&#x573E;&#x56DE;&#x6536;&#x53EF;&#x4EE5;&#x5E2E;&#x52A9;&#x6211;&#x4EEC;&#x8C03;&#x4F18;JVM&#xFF0C;&#x9047;&#x5230;JVM&#x65B9;&#x9762;&#x7684;&#x95EE;&#x9898;&#x4E0D;&#x81F3;&#x4E8E;&#x675F;&#x624B;&#x65E0;&#x7B56;.&#x6240;&#x4EE5;&#x7814;&#x7A76;JVM&#x7684;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5F88;&#x6709;&#x5FC5;&#x8981;&#xFF0C;&#x6211;&#x4EEC;&#x5148;&#x4ECB;&#x7ECD;&#x4E0B;&#x5783;&#x573E;&#x641C;&#x96C6;&#x7B97;&#x6CD5;.</p>
<h2 id="&#x6536;&#x96C6;&#x7B97;&#x6CD5;">&#x6536;&#x96C6;&#x7B97;&#x6CD5;</h2>
<h3 id="&#x6807;&#x8BB0;-&#x6E05;&#x9664;&#x7B97;&#x6CD5;">&#x6807;&#x8BB0;-&#x6E05;&#x9664;&#x7B97;&#x6CD5;</h3>
<p>&#x8FD9;&#x662F;&#x6700;&#x57FA;&#x672C;&#x7684;&#x6536;&#x96C6;&#x7B97;&#x6CD5;&#xFF0C;&#x5206;&#x4E3A;&#x201C;&#x6807;&#x8BB0;&quot;&#x548C;&#x201D;&#x6E05;&#x9664;&#x201C;&#x4E24;&#x4E2A;&#x9636;&#x6BB5;&#xFF0C;&#x9996;&#x5148;&#x6807;&#x8BB0;&#x51FA;&#x6240;&#x6709;&#x9700;&#x8981;&#x56DE;&#x6536;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x5728;&#x6807;&#x8BB0;&#x5B8C;&#x6210;&#x540E;&#x7EDF;&#x4E00;&#x56DE;&#x6536;&#x6240;&#x6709;&#x88AB;&#x6807;&#x8BB0;&#x7684;&#x5BF9;&#x8C61;,&#x6807;&#x8BB0;&#x662F;&#x901A;&#x8FC7;&#x201D;&#x53EF;&#x8FBE;&#x6027;&#x5206;&#x6790;&#x7B97;&#x6CD5;&#x201C;&#xFF0C;&#x8FD9;&#x91CC;&#x4E0D;&#x505A;&#x8FC7;&#x591A;&#x5C55;&#x5F00;&#x3002;
&#x8FD9;&#x4E2A;&#x7B97;&#x6CD5;&#x5B58;&#x5728;&#x4E24;&#x4E2A;&#x95EE;&#x9898;,&#x4E00;&#x4E2A;&#x662F;&#x6548;&#x7387;&#x95EE;&#x9898;&#xFF0C;&#x6807;&#x8BB0;&#x548C;&#x6E05;&#x9664;&#x4E24;&#x4E2A;&#x8FC7;&#x7A0B;&#x7684;&#x6548;&#x7387;&#x90FD;&#x4E0D;&#x9AD8;;&#x53E6;&#x4E00;&#x4E2A;&#x662F;&#x6807;&#x8BB0;&#x6E05;&#x9664;&#x4E4B;&#x540E;&#x4F1A;&#x4EA7;&#x751F;&#x5927;&#x91CF;&#x7684;&#x5185;&#x5B58;&#x788E;&#x7247;&#xFF0C;&#x7ECF;&#x8FC7;&#x51E0;&#x6B21;&#x7684;GC&#x4E4B;&#x540E;&#x8FD9;&#x4E9B;&#x788E;&#x7247;&#x53EF;&#x80FD;&#x5DF2;&#x7ECF;&#x5C0F;&#x5230;&#x4E0D;&#x8DB3;&#x4EE5;&#x5206;&#x914D;&#x4EFB;&#x4F55;&#x5BF9;&#x8C61;&#x4E86;&#x3002;</p>
<p><img src="/images/garbage-collection-mark-sweep.jpg" alt="&#x6807;&#x8BB0;&#x6E05;&#x9664;&#x7B97;&#x6CD5;"></p>
<h3 id="&#x590D;&#x5236;&#x7B97;&#x6CD5;">&#x590D;&#x5236;&#x7B97;&#x6CD5;</h3>
<p>&#x4E3A;&#x4E86;&#x89E3;&#x51B3;&#x6548;&#x7387;&#x95EE;&#x9898;,&#x590D;&#x5236;&#x7B97;&#x6CD5;&#x51FA;&#x73B0;&#x4E86;&#xFF0C;&#x5B83;&#x662F;&#x5C06;&#x53EF;&#x7528;&#x5185;&#x5B58;&#x6309;&#x7167;&#x5BB9;&#x91CF;&#x5212;&#x5206;&#x4E3A;&#x5927;&#x5C0F;&#x76F8;&#x7B49;&#x7684;&#x4E24;&#x5757;&#xFF0C;&#x6BCF;&#x6B21;&#x53EA;&#x4F7F;&#x7528;&#x5176;&#x4E2D;&#x7684;&#x4E00;&#x5757;&#xFF0C;&#x5F53;&#x8FD9;&#x4E00;&#x5757;&#x7684;&#x5185;&#x5B58;&#x4F7F;&#x7528;&#x5B8C;&#x4E86;,&#x5C31;&#x5C06;&#x8FD8;&#x5B58;&#x6D3B;&#x7740;&#x7684;&#x5BF9;&#x8C61;&#x590D;&#x5236;&#x5230;&#x53E6;&#x4E00;&#x5757;&#x4E0A;&#x9762;,&#x7136;&#x540E;&#x5728;&#x5C06;&#x4F7F;&#x7528;&#x8FC7;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x6E05;&#x7406;&#x6389;&#x3002;</p>
<p>&#x8FD9;&#x79CD;&#x7B97;&#x6CD5;&#x4E0D;&#x8981;&#x8003;&#x8651;&#x5185;&#x5B58;&#x788E;&#x7247;&#x7B49;&#x590D;&#x6742;&#x60C5;&#x51B5;,&#x53EA;&#x9700;&#x8981;&#x6309;&#x7167;&#x987A;&#x5E8F;&#x5206;&#x914D;&#x5373;&#x53EF;&#xFF0C;&#x5B9E;&#x73B0;&#x7B80;&#x5355;&#xFF0C;&#x8FD0;&#x884C;&#x9AD8;&#x6548;&#x3002;&#x4F46;&#x662F;&#x4EE3;&#x4EF7;&#x5C31;&#x662F;&#x5C06;&#x5185;&#x5B58;&#x7F29;&#x5C0F;&#x4E3A;&#x4E86;&#x539F;&#x6765;&#x7684;&#x4E00;&#x534A;&#xFF0C;&#x4EE3;&#x4EF7;&#x592A;&#x9AD8;&#x4E86;&#x3002;</p>
<p>&#x73B0;&#x5728;&#x7684;&#x5546;&#x4E1A;&#x865A;&#x62DF;&#x673A;&#x90FD;&#x91C7;&#x7528;&#x8FD9;&#x79CD;&#x6536;&#x96C6;&#x7B97;&#x6CD5;&#x6765;&#x56DE;&#x6536;&#x65B0;&#x751F;&#x4EE3;,&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x7684;HotSpot&#x4E5F;&#x662F;&#x3002;IBM&#x516C;&#x53F8;&#x7684;&#x4E13;&#x95E8;&#x7814;&#x7A76;&#x53D1;&#x73B0;&#xFF0C;98%&#x7684;&#x5BF9;&#x8C61;&#x57FA;&#x672C;&#x4E0A;&#x90FD;&#x662F;&#x671D;&#x751F;&#x5915;&#x6B7B;&#x7684;,&#x6240;&#x4EE5;&#x4E0D;&#x9700;&#x8981;&#x6309;&#x7167;1:1&#x7684;&#x6BD4;&#x4F8B;&#x6765;&#x5212;&#x5206;&#x5185;&#x5B58;&#x7A7A;&#x95F4;,&#x800C;&#x662F;&#x5C06;&#x5185;&#x5B58;&#x5212;&#x5206;&#x4E3A;&#x4E00;&#x5757;&#x8F83;&#x5927;&#x7684;Eden&#x7A7A;&#x95F4;&#x548C;&#x4E24;&#x5757;&#x8F83;&#x5C0F;&#x7684;Survivor&#x7A7A;&#x95F4;&#xFF0C;&#x6BCF;&#x6B21;&#x4F7F;&#x7528;Eden&#x548C;&#x4E00;&#x5757;Survivor,&#x5F53;&#x56DE;&#x6536;&#x7684;&#x65F6;&#x5019;&#x5C06;Eden&#x548C;Survivor&#x4E2D;&#x8FD8;&#x5B58;&#x6D3B;&#x7740;&#x7684;&#x5BF9;&#x8C61;&#x4E00;&#x6B21;&#x6027;&#x590D;&#x5236;&#x5230;&#x53E6;&#x4E00;&#x5757;&#x7A7A;&#x95F4;&#x4E0A;,&#x6700;&#x540E;&#x6E05;&#x7406;Eden&#x548C;&#x521A;&#x624D;Survivor&#x7528;&#x8FC7;&#x7684;&#x7A7A;&#x95F4;&#x3002;HotSpot&#x865A;&#x62DF;&#x673A;&#x9ED8;&#x8BA4;Eden&#x548C;&#x4E24;&#x5757;Survivor&#x7684;&#x5206;&#x914D;&#x6BD4;&#x4F8B;&#x662F;8:1:1.&#x5F53;&#x7136;&#x6211;&#x4EEC;&#x6CA1;&#x6709;&#x529E;&#x6CD5;&#x4FDD;&#x8BC1;&#x6BCF;&#x6B21;&#x56DE;&#x6536;&#x90FD;&#x53EA;&#x6709;&#x4E0D;&#x591A;&#x4E8E;10%&#x7684;&#x5BF9;&#x8C61;&#x5B58;&#x6D3B;,&#x5F53;Survivor&#x7A7A;&#x95F4;&#x4E0D;&#x591F;&#x65F6;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x4F1A;&#x8FDB;&#x884C;&#x62C5;&#x4FDD;&#x5206;&#x914D;,&#x76F4;&#x63A5;&#x5C06;&#x5BF9;&#x8C61;&#x653E;&#x5230;&#x8001;&#x5E74;&#x4EE3;&#x3002;</p>
<p><img src="/images/garbage-collection-copy.jpg" alt="&#x590D;&#x5236;&#x7B97;&#x6CD5;"></p>
<h3 id="&#x6807;&#x8BB0;&#x6574;&#x7406;&#x7B97;&#x6CD5;">&#x6807;&#x8BB0;&#x6574;&#x7406;&#x7B97;&#x6CD5;</h3>
<p>&#x6807;&#x8BB0;&#x6574;&#x7406;&#x7B97;&#x6CD5;&#x4E8E;&#x201C;&#x6807;&#x8BB0;-&#x6E05;&#x9664;&#x201D;&#x7B97;&#x6CD5;&#x4E00;&#x6837;&#xFF0C;&#x4F46;&#x662F;&#x540E;&#x7EED;&#x6B65;&#x9AA4;&#x4E0D;&#x662F;&#x76F4;&#x63A5;&#x5BF9;&#x53EF;&#x56DE;&#x6536;&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x6E05;&#x7406;&#xFF0C;&#x800C;&#x662F;&#x8BA9;&#x6240;&#x6709;&#x5B58;&#x6D3B;&#x7684;&#x5BF9;&#x8C61;&#x90FD;&#x5411;&#x4E00;&#x7AEF;&#x79FB;&#x52A8;&#xFF0C;&#x7136;&#x540E;&#x76F4;&#x63A5;&#x6E05;&#x7406;&#x6389;&#x8FB9;&#x754C;&#x4EE5;&#x5916;&#x7684;&#x5185;&#x5B58;&#x3002;</p>
<p><img src="/images/garbage-collection-mark-tidy.jpg" alt="&#x6807;&#x8BB0;&#x6574;&#x7406;&#x7B97;&#x6CD5;"></p>
<h3 id="&#x5206;&#x4EE3;&#x6536;&#x96C6;&#x7B97;&#x6CD5;">&#x5206;&#x4EE3;&#x6536;&#x96C6;&#x7B97;&#x6CD5;</h3>
<p>&#x73B0;&#x5728;&#x5546;&#x4E1A;&#x865A;&#x62DF;&#x673A;&#x7684;&#x5783;&#x573E;&#x6536;&#x96C6;&#x90FD;&#x91C7;&#x7528;&#x201C;&#x5206;&#x4EE3;&#x6536;&#x96C6;&#x201D;&#x7B97;&#x6CD5;&#xFF0C;&#x8FD9;&#x79CD;&#x7B97;&#x6CD5;&#x53EA;&#x662F;&#x6839;&#x636E;&#x5BF9;&#x8C61;&#x5B58;&#x6D3B;&#x5468;&#x671F;&#x7684;&#x4E0D;&#x540C;&#x5C06;&#x5185;&#x5B58;&#x5212;&#x5206;&#x4E3A;&#x51E0;&#x5757;&#xFF0C;&#x4E00;&#x822C;&#x662F;&#x628A;&#x5BF9;&#x5185;&#x5B58;&#x5206;&#x4E3A;&#x65B0;&#x751F;&#x4EE3;&#x548C;&#x8001;&#x5E74;&#x4EE3;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x5404;&#x4E2A;&#x5E74;&#x4EE3;&#x7684;&#x7279;&#x70B9;&#x91C7;&#x7528;&#x6700;&#x9002;&#x5F53;&#x7684;&#x6536;&#x96C6;&#x7B97;&#x6CD5;&#x3002;&#x5728;&#x65B0;&#x751F;&#x4EE3;&#x4E2D;&#x6BCF;&#x6B21;&#x5783;&#x573E;&#x6536;&#x96C6;&#x65F6;&#x90FD;&#x6709;&#x5927;&#x91CF;&#x5BF9;&#x8C61;&#x6B7B;&#x53BB;&#xFF0C;&#x53EA;&#x6709;&#x5C11;&#x91CF;&#x5B58;&#x6D3B;&#x3002;&#x90A3;&#x5C31;&#x9009;&#x7528;&#x590D;&#x5236;&#x7B97;&#x6CD5;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x4ED8;&#x51FA;&#x5C11;&#x91CF;&#x5B58;&#x6D3B;&#x5BF9;&#x8C61;&#x7684;&#x590D;&#x5236;&#x6210;&#x672C;&#x5C31;&#x53EF;&#x4EE5;&#x5B8C;&#x6210;&#x6536;&#x96C6;&#x3002;
&#x800C;&#x8001;&#x5E74;&#x4EE3;&#x56E0;&#x4E3A;&#x5BF9;&#x8C61;&#x5B58;&#x6D3B;&#x7387;&#x9AD8;&#xFF0C;&#x6CA1;&#x6709;&#x989D;&#x5916;&#x7A7A;&#x95F4;&#x5BF9;&#x4ED6;&#x8FDB;&#x884C;&#x62C5;&#x4FDD;&#x5206;&#x914D;&#xFF0C;&#x5219;&#x5FC5;&#x987B;&#x4F7F;&#x7528;&#x201C;&#x6807;&#x8BB0;-&#x6E05;&#x9664;&#x201D;&#x6216;&#x8005;&#x201C;&#x6807;&#x8BB0;-&#x6574;&#x7406;&#x201D;&#x7B97;&#x6CD5;&#x6765;&#x8FDB;&#x884C;&#x56DE;&#x6536;&#x3002;
&#x800C;&#x8001;&#x5E74;&#x4EE3;&#x56E0;&#x4E3A;&#x5BF9;&#x8C61;&#x5B58;&#x6D3B;&#x7387;&#x9AD8;&#xFF0C;&#x6CA1;&#x6709;&#x989D;&#x5916;&#x7A7A;&#x95F4;&#x5BF9;&#x4ED6;&#x8FDB;&#x884C;&#x62C5;&#x4FDD;&#x5206;&#x914D;&#xFF0C;&#x5219;&#x5FC5;&#x987B;&#x4F7F;&#x7528;&#x201C;&#x6807;&#x8BB0;-&#x6E05;&#x9664;&#x201D;&#x6216;&#x8005;&#x201C;&#x6807;&#x8BB0;-&#x6574;&#x7406;&#x201D;&#x7B97;&#x6CD5;&#x6765;&#x8FDB;&#x884C;&#x56DE;&#x6536;&#x3002;</p>
<h2 id="&#x5806;&#x7684;&#x5206;&#x4EE3;">&#x5806;&#x7684;&#x5206;&#x4EE3;</h2>
<p><img src="/images/garbage-collection-heap-generation.jpg" alt="&#x5806;&#x7684;&#x5206;&#x4EE3;"></p>
<p>Perm&#x533A;&#x88AB;&#x79F0;&#x4E3A;&#x6C38;&#x4E45;&#x4EE3;,&#x5176;&#x5B9E;&#x5B83;&#x53EA;&#x662F;&#x65B9;&#x6CD5;&#x533A;&#x7684;&#x4E00;&#x79CD;&#x5B9E;&#x73B0;&#xFF0C;JVM&#x89C4;&#x8303;&#x4E2D;&#x8FD9;&#x4E00;&#x5757;&#x88AB;&#x79F0;&#x4E3A;&#x65B9;&#x6CD5;&#x533A;&#xFF0C;&#x53EA;&#x662F;&#x5BF9;&#x4E8E;HotSpot&#x865A;&#x62DF;&#x673A;&#x4E0A;&#x5F00;&#x53D1;&#x8005;&#x6765;&#x8BF4;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x5176;&#x4ED6;&#x865A;&#x62DF;&#x673A;(BEA JRockit,IBM J9)&#x6765;&#x8BF4;&#x662F;&#x4E0D;&#x5B58;&#x5728;&#x6C38;&#x4E45;&#x4EE3;&#x6982;&#x5FF5;&#x7684;&#x3002;</p>
<p>JDK8&#x4E4B;&#x540E;&#x65B9;&#x6CD5;&#x533A;&#x88AB;MetaSpace&#x53D6;&#x4EE3;&#x4E86;,&#x5BF9;&#x5E94;&#x7684;JVM&#x914D;&#x7F6E;&#x53C2;&#x6570;&#x4E5F;&#x4FEE;&#x6539;&#x4E86;(-XX:MetaspaceSize,-XX:MaxMetaspaceSize).</p>
<p>Minor GC&#x53C8;&#x88AB;&#x79F0;&#x4E3A;Young GC,&#x53EA;&#x6536;&#x96C6;young gen&#x7684;GC
Major GC(old gc)&#x4E3B;&#x8981;&#x6307;&#x5BF9;&#x8001;&#x5E74;&#x4EE3;&#x7684;&#x56DE;&#x6536;,&#x53EA;&#x6709;CMS&#x7684;concurrent collection&#x662F;&#x8FD9;&#x4E2A;&#x6A21;&#x5F0F;
Full GC &#x6536;&#x96C6;&#x6574;&#x4E2A;&#x5806;&#xFF0C;&#x5305;&#x542B;young gen,old gen,perm gen(metaspace)&#x7B49;&#x6240;&#x6709;&#x90E8;&#x5206;&#x7684;&#x6A21;&#x5F0F;&#x3002;
Mixed GC: &#x6536;&#x96C6;&#x771F;&#x4E2A;young gen&#x4EE5;&#x53CA;&#x90E8;&#x5206;old gen &#x7684;GC&#xFF0C;&#x53EA;&#x6709;G1&#x53C8;&#x8FD9;&#x79CD;&#x6A21;&#x5F0F;</p>
<h2 id="&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;">&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;</h2>
<p><img src="/images/garbage-collection-collector.jpg" alt="&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;"></p>
<p>&#x4EE5;&#x4E0A;&#x662F; HotSpot &#x865A;&#x62DF;&#x673A;&#x4E2D;&#x7684; 7 &#x4E2A;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#xFF0C;&#x8FDE;&#x7EBF;&#x8868;&#x793A;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x53EF;&#x4EE5;&#x914D;&#x5408;&#x4F7F;&#x7528;&#x3002;</p>
<ul>
<li>&#x5355;&#x7EBF;&#x7A0B;&#x4E0E;&#x591A;&#x7EBF;&#x7A0B;&#xFF1A;&#x5355;&#x7EBF;&#x7A0B;&#x6307;&#x7684;&#x662F;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x53EA;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x8FDB;&#x884C;&#x6536;&#x96C6;&#xFF0C;&#x800C;&#x591A;&#x7EBF;&#x7A0B;&#x4F7F;&#x7528;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF1B;</li>
<li>&#x4E32;&#x884C;&#x4E0E;&#x5E76;&#x884C;&#xFF1A;&#x4E32;&#x884C;&#x6307;&#x7684;&#x662F;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x4E0E;&#x7528;&#x6237;&#x7A0B;&#x5E8F;&#x4EA4;&#x66FF;&#x6267;&#x884C;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5728;&#x6267;&#x884C;&#x5783;&#x573E;&#x6536;&#x96C6;&#x7684;&#x65F6;&#x5019;&#x9700;&#x8981;&#x505C;&#x987F;&#x7528;&#x6237;&#x7A0B;&#x5E8F;&#xFF1B;&#x5E76;&#x884C;&#x6307;&#x7684;&#x662F;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x548C;&#x7528;&#x6237;&#x7A0B;&#x5E8F;&#x540C;&#x65F6;&#x6267;&#x884C;&#x3002;&#x9664;&#x4E86; CMS &#x548C; G1 &#x4E4B;&#x5916;&#xFF0C;&#x5176;&#x5B83;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x90FD;&#x662F;&#x4EE5;&#x4E32;&#x884C;&#x7684;&#x65B9;&#x5F0F;&#x6267;&#x884C;&#x3002;</li>
</ul>
<h3 id="&#x5E74;&#x8F7B;&#x4EE3;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;">&#x5E74;&#x8F7B;&#x4EE3;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;</h3>
<h4 id="serial&#x6536;&#x96C6;&#x5668;">Serial&#x6536;&#x96C6;&#x5668;</h4>
<p>&#x5355;&#x7EBF;&#x7A0B;&#x6536;&#x96C6;&#x5668;,&#x53EA;&#x4F1A;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;CPU&#x6216;&#x4E00;&#x6761;&#x6536;&#x96C6;&#x7EBF;&#x7A0B;&#x53BB;&#x5B8C;&#x6210;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5DE5;&#x4F5C;,&#x5728;&#x8FDB;&#x884C;&#x5783;&#x573E;&#x6536;&#x96C6;&#x65F6;&#x5FC5;&#x987B;&#x6682;&#x505C;&#x5176;&#x4ED6;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#x3002;&#x91C7;&#x7528;&#x4E86;&#x590D;&#x5236;&#x7B97;&#x6CD5;&#x6765;&#x8FDB;&#x884C;&#x5783;&#x573E;&#x6536;&#x96C6;&#xFF0C;&#x5B83;&#x662F;&#x865A;&#x62DF;&#x673A;&#x8FD0;&#x884C;&#x5728;Client&#x6A21;&#x5F0F;&#x4E0B;&#x7684;&#x9ED8;&#x8BA4;&#x65B0;&#x751F;&#x4EE3;&#x6536;&#x96C6;&#x5668;</p>
<h4 id="parnew&#x6536;&#x96C6;&#x5668;">ParNew&#x6536;&#x96C6;&#x5668;</h4>
<p>ParNew&#x6536;&#x96C6;&#x5668;&#x662F;Serial&#x6536;&#x96C6;&#x5668;&#x7684;&#x591A;&#x7EBF;&#x7A0B;&#x7248;&#x672C;&#xFF0C;&#x9664;&#x4E86;&#x4F7F;&#x7528; &#x591A;&#x6761;&#x7EBF;&#x7A0B;&#x8FDB;&#x884C;&#x5783;&#x573E;&#x6536;&#x96C6;&#x4E4B;&#x5916;&#xFF0C;&#x5176;&#x4F59;&#x884C;&#x4E3A;(JVM&#x53C2;&#x6570;&#x3001;&#x6536;&#x96C6;&#x7B97;&#x6CD5;&#x3001;&#x5BF9;&#x8C61;&#x5206;&#x914D;&#x89C4;&#x5219;&#x3001;&#x56DE;&#x6536;&#x7B56;&#x7565;&#x3001;Stop The World&#x7B49;)&#x548C;Serial&#x6536;&#x96C6;&#x5668;&#x5B8C;&#x5168;&#x4E00;&#x6837;&#x3002;&#x4F46;&#x662F;&#x5B83;&#x662F;&#x8BB8;&#x591A;&#x8FD0;&#x884C;&#x5728;Server&#x6A21;&#x5F0F;&#x4E0B;&#x7684;&#x865A;&#x62DF;&#x673A;&#x4E2D;&#x9996;&#x9009;&#x7684;&#x65B0;&#x751F;&#x4EE3;&#x6536;&#x96C6;&#x5668;&#xFF0C;&#x56E0;&#x4E3A;&#x53EA;&#x6709;&#x5B83;&#x80FD;&#x4E0E;CMS&#x6536;&#x96C6;&#x5668;&#x914D;&#x5408;&#x5DE5;&#x4F5C;&#x3002;&#x9ED8;&#x8BA4;&#x5F00;&#x542F;&#x7684;&#x7EBF;&#x7A0B;&#x6570;&#x91CF;&#x4E0E; CPU &#x6570;&#x91CF;&#x76F8;&#x540C;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; -XX:ParallelGCThreads &#x53C2;&#x6570;&#x6765;&#x8BBE;&#x7F6E;&#x7EBF;&#x7A0B;&#x6570;&#x3002;</p>
<h4 id="parallel-scavenge&#x6536;&#x96C6;&#x5668;">Parallel Scavenge&#x6536;&#x96C6;&#x5668;</h4>
<p>&#x4F7F;&#x7528;&#x4E86;&#x590D;&#x5236;&#x7B97;&#x6CD5;&#xFF0C;&#x8BE5;&#x6536;&#x96C6;&#x5668;&#x7684;&#x5173;&#x6CE8;&#x70B9;&#x662F;&#x5728;&#x541E;&#x5410;&#x91CF;&#x4E0A;&#x9762;,&#x4E3B;&#x8981;&#x9002;&#x5408;&#x5728;&#x540E;&#x53F0;&#x8FD0;&#x7B97;&#x800C;&#x4E0D;&#x9700;&#x8981;&#x592A;&#x591A;&#x4EA4;&#x4E92;&#x7684;&#x4EFB;&#x52A1;&#x3002;&#x56E0;&#x6B64;&#x4E5F;&#x88AB;&#x5E38;&#x79F0;&#x4E3A;&#x201C;&#x541E;&#x5410;&#x91CF;&#x4F18;&#x5148;&#x201C;&#x6536;&#x96C6;&#x5668;&#x3002;&#x5B83;&#x6709;&#x4E00;&#x4E2A;&#x53C2;&#x6570;-XX:UseAdaptiveSizePolicy&#x53C2;&#x6570;&#x503C;&#x5F97;&#x5173;&#x6CE8;,&#x5F53;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x6253;&#x5F00;&#x540E;&#xFF0C;&#x5C31;&#x4E0D;&#x9700;&#x8981;&#x624B;&#x5DE5;&#x6307;&#x5B9A;&#x65B0;&#x751F;&#x4EE3;&#x7684;&#x5927;&#x5C0F;(-Xmn)&#x3001;Eden&#x4E0E;Survivor&#x533A;&#x7684;&#x6BD4;&#x4F8B;(-XX:SurvivorRatio)&#x3001;&#x664B;&#x5347;&#x8001;&#x5E74;&#x4EE3;&#x5BF9;&#x8C61;&#x5E74;&#x9F84;(-XX:PretenureSizeThreshold)&#x7B49;&#x7EC6;&#x8282;&#x53C2;&#x6570;&#x4E86;&#x3002;&#x7CFB;&#x7EDF;&#x4F1A;&#x52A8;&#x6001;&#x8C03;&#x6574;&#x8FD9;&#x4E9B;&#x53C2;&#x6570;&#x4EE5;&#x63D0;&#x4F9B;&#x6700;&#x5408;&#x9002;&#x7684;&#x505C;&#x987F;&#x4E8B;&#x4EF6;&#x6216;&#x8005;&#x6700;&#x5927;&#x7684;&#x541E;&#x5410;&#x91CF;,&#x8FD9;&#x79CD;&#x8C03;&#x8282;&#x65B9;&#x5F0F;&#x88AB;&#x6210;&#x4E3A;GC&#x7684;&#x81EA;&#x9002;&#x5E94;&#x8C03;&#x8282;&#x7B56;&#x7565;&#x3002;</p>
<p>&#x541E;&#x5410;&#x91CF; = &#x8FD0;&#x884C;&#x7528;&#x6237;&#x4EE3;&#x7801;&#x65F6;&#x95F4; / (&#x8FD0;&#x884C;&#x7528;&#x6237;&#x4EE3;&#x7801;&#x65F6;&#x95F4; + &#x5783;&#x573E;&#x6536;&#x96C6;&#x65F6;&#x95F4;),&#x5783;&#x573E;&#x6536;&#x96C6;&#x65F6;&#x95F4;&#x8D8A;&#x77ED;,&#x541E;&#x5410;&#x91CF;&#x5C31;&#x8D8A;&#x9AD8;&#x3002;</p>
<h3 id="&#x8001;&#x5E74;&#x4EE3;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;">&#x8001;&#x5E74;&#x4EE3;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;</h3>
<h4 id="serial-old&#x6536;&#x96C6;&#x5668;">Serial Old&#x6536;&#x96C6;&#x5668;</h4>
<p>Serial Old&#x662F;Serial&#x6536;&#x96C6;&#x5668;&#x7684;&#x8001;&#x5E74;&#x4EE3;&#x7248;&#x672C;,&#x5B83;&#x540C;&#x6837;&#x662F;&#x4E00;&#x4E2A;&#x5355;&#x7EBF;&#x7A0B;&#x6536;&#x96C6;&#x5668;&#x4F7F;&#x7528;&#x201D;&#x6807;&#x8BB0;-&#x6574;&#x7406;&#x201C;&#x7B97;&#x6CD5;&#x3002;&#x4E3B;&#x8981;&#x4E5F;&#x662F;&#x5728;client&#x6A21;&#x5F0F;&#x4E0B;&#x4F7F;&#x7528;&#xFF0C;&#x9664;&#x6B64;&#x4E4B;&#x5916;&#x8FD8;&#x6709;&#x4E24;&#x5927;&#x7528;&#x9014;&#x3002;&#x4E00;&#x79CD;&#x662F;&#x5728;JDK1.5&#x4EE5;&#x53CA;&#x4E4B;&#x524D;&#x7684;&#x7248;&#x672C;&#x4E2D;&#x4E8E;Parallel Scavenge&#x6536;&#x96C6;&#x5668;&#x642D;&#x914D;&#x4F7F;&#x7528;(&#x73B0;&#x5728;&#x5F88;&#x5C11;JDK1.5&#x4E4B;&#x524D;&#x7684;&#x7248;&#x672C;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x4E2A;&#x4F5C;&#x7528;&#x5C31;&#x57FA;&#x672C;&#x5E9F;&#x5F03;&#x4E86;&#xFF09;,&#x53E6;&#x5916;&#x4E00;&#x79CD;&#x662F;&#x4F5C;&#x4E3A;CMS&#x6536;&#x96C6;&#x5668;&#x7684;&#x540E;&#x5907;&#x9884;&#x6848;&#xFF0C;&#x5728;&#x5E76;&#x53D1;&#x6536;&#x96C6;&#x53D1;&#x6210;Concurrent Mode Failure&#x65F6;&#x4F7F;&#x7528;&#x3002;</p>
<h4 id="parallel-old&#x6536;&#x96C6;&#x5668;">Parallel Old&#x6536;&#x96C6;&#x5668;</h4>
<p>Parallel Old&#x662F;Parallel Scavenge&#x6536;&#x96C6;&#x5668;&#x7684;&#x8001;&#x5E74;&#x4EE3;&#x7248;&#x672C;,&#x4F7F;&#x7528;&#x591A;&#x7EBF;&#x7A0B;&#x7684;&#x201D;&#x6807;&#x8BB0;-&#x6574;&#x7406;&#x201C;&#x7B97;&#x6CD5;&#x3002;&#x8BE5;&#x6536;&#x96C6;&#x5668;&#x662F;&#x5728;JDK6&#x53CA;&#x4E4B;&#x540E;&#x624D;&#x51FA;&#x73B0;&#x7684;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x5982;&#x679C;&#x4E4B;&#x524D;&#x5E74;&#x8F7B;&#x4EE3;&#x9009;&#x600E;&#x4E86;Parallel Scavenge&#xFF0C;&#x90A3;&#x4E48;&#x8001;&#x5E74;&#x4EE3;&#x53EA;&#x80FD;&#x9009;&#x62E9;Serial Old.&#x4F46;&#x662F;&#x73B0;&#x5728;&#x7EC8;&#x4E8E;&#x6709;&#x4E86;&#x5BF9;&#x5E94;&#x7684;&#x5E94;&#x7528;&#x7EC4;&#x5408;&#x4E86;&#xFF0C;&#x5728;&#x6CE8;&#x91CD;&#x541E;&#x5410;&#x91CF;&#x4EE5;&#x53CA;CPU&#x8D44;&#x6E90;&#x654F;&#x611F;&#x7684;&#x573A;&#x5408;&#xFF0C;&#x90FD;&#x53EF;&#x4EE5;&#x4F18;&#x5148;&#x8003;&#x8651;Parallel Scavenge + Parallel Old&#x6536;&#x96C6;&#x5668;&#x3002;</p>
<h4 id="cms&#x6536;&#x96C6;&#x5668;">CMS&#x6536;&#x96C6;&#x5668;</h4>
<p>CMS(Concurrent Mark Sweep)&#x6536;&#x96C6;&#x5668;&#x662F;&#x4E00;&#x79CD;&#x4EE5;&#x83B7;&#x53D6;&#x6700;&#x77ED;&#x56DE;&#x6536;&#x505C;&#x987F;&#x65F6;&#x95F4;&#x4E3A;&#x76EE;&#x6807;&#x7684;&#x6536;&#x96C6;&#x5668;&#x3002;&#x662F;&#x57FA;&#x4E8E;&#x201D;&#x6807;&#x8BB0;-&#x6E05;&#x9664;&#x201C;&#x7B97;&#x6CD5;&#x5B9E;&#x73B0;&#x7684;&#x3002;
CMS&#x6536;&#x96C6;&#x5668;&#x5206;&#x4E3A;&#x56DB;&#x4E2A;&#x6B65;&#x9AA4;&#xFF1A;</p>
<ol>
<li>&#x521D;&#x59CB;&#x6807;&#x8BB0;(CMS initial mark):&#x4EC5;&#x4EC5;&#x53EA;&#x662F;&#x6807;&#x8BB0;&#x4E00;&#x4E0B; GC Roots &#x80FD;&#x76F4;&#x63A5;&#x5173;&#x8054;&#x5230;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x901F;&#x5EA6;&#x5F88;&#x5FEB;&#xFF0C;&#x4F1A;stop the world</li>
<li>&#x5E76;&#x53D1;&#x6807;&#x8BB0;(CMS concurrent mark):&#x8FDB;&#x884C; GC Roots Tracing &#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x5B83;&#x5728;&#x6574;&#x4E2A;&#x56DE;&#x6536;&#x8FC7;&#x7A0B;&#x4E2D;&#x8017;&#x65F6;&#x6700;&#x957F;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x505C;&#x987F;</li>
<li>&#x91CD;&#x65B0;&#x6807;&#x8BB0;(CMS remark):&#x4E3A;&#x4E86;&#x4FEE;&#x6B63;&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#x671F;&#x95F4;&#x56E0;&#x7528;&#x6237;&#x7A0B;&#x5E8F;&#x7EE7;&#x7EED;&#x8FD0;&#x4F5C;&#x800C;&#x5BFC;&#x81F4;&#x6807;&#x8BB0;&#x4EA7;&#x751F;&#x53D8;&#x52A8;&#x7684;&#x90A3;&#x4E00;&#x90E8;&#x5206;&#x5BF9;&#x8C61;&#x7684;&#x6807;&#x8BB0;&#x8BB0;&#x5F55;,&#x4F1A;stop the world</li>
<li>&#x5E76;&#x53D1;&#x6E05;&#x9664;(CMS concurrent sweep):&#x4E0D;&#x9700;&#x8981;&#x505C;&#x987F;</li>
</ol>
<p>CMS&#x4E2D;&#x4E2D;&#x7684;&#x521D;&#x59CB;&#x6807;&#x8BB0;&#x548C;&#x91CD;&#x65B0;&#x6807;&#x8BB0;&#x90FD;&#x4F1A;&#x4EA7;&#x751F;stop the world&#x7684;&#x884C;&#x5916;,&#x4F46;&#x662F;&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#x548C;&#x5E76;&#x53D1;&#x6E05;&#x9664;&#x6536;&#x96C6;&#x5668;&#x7EBF;&#x7A0B;&#x90FD;&#x53EF;&#x4EE5;&#x548C;&#x7528;&#x6237;&#x7EBF;&#x7A0B;&#x4E00;&#x8D77;&#x8FD0;&#x884C;&#xFF0C;&#x6240;&#x4EE5;&#x4ECE;&#x603B;&#x4F53;&#x4E0A;&#x6765;&#x8BF4;&#xFF0C;CMS&#x6536;&#x96C6;&#x5668;&#x7684;&#x5185;&#x5B58;&#x56DE;&#x6536;&#x8FC7;&#x7A0B;&#x662F;&#x4E0E;&#x7528;&#x6237;&#x7EBF;&#x7A0B;&#x4E00;&#x8D77;&#x5E76;&#x53D1;&#x6267;&#x884C;&#x7684;&#x3002;</p>
<p>CMS&#x9ED8;&#x8BA4;&#x542F;&#x52A8;&#x7684;&#x56DE;&#x6536;&#x7EBF;&#x7A0B;&#x6570;&#x662F;(CPU&#x6570;&#x91CF;+3)/4,&#x4E5F;&#x5C31;&#x662F;&#x5F53;CPU&#x5728;&#x56DB;&#x4E2A;&#x4EE5;&#x4E0A;&#x65F6;&#xFF0C;&#x5E76;&#x53D1;&#x56DE;&#x6536;&#x65F6;&#x5783;&#x573E;&#x6536;&#x96C6;&#x7EBF;&#x7A0B;&#x4E0D;&#x5C11;&#x4E8E;25%&#x7684;CPU&#x8D44;&#x6E90;&#xFF0C;&#x5E76;&#x4E14;&#x968F;&#x7740;CPU&#x6570;&#x91CF;&#x7684;&#x589E;&#x52A0;&#x800C;&#x4E0B;&#x964D;&#x3002;&#x4F46;&#x662F;&#x5F53;CPU&#x4E0D;&#x8DB3;4&#x4E2A;(&#x8B6C;&#x5982;2&#x4E2A;)&#x65F6;&#xFF0C;&#x5BF9;&#x7528;&#x6237;&#x7A0B;&#x5E8F;&#x7684;&#x5F71;&#x54CD;&#x5C31;&#x6BD4;&#x8F83;&#x5927;&#x4E86;&#xFF0C;&#x6B64;&#x65F6;&#x56DE;&#x6536;&#x7EBF;&#x7A0B;&#x6570;&#x4E3A;1,&#x672C;&#x6765;CPU&#x8D1F;&#x8F7D;&#x5C31;&#x6BD4;&#x8F83;&#x5927;&#xFF0C;&#x8FD8;&#x5206;&#x51FA;&#x4E00;&#x534A;&#x7684;&#x8FD0;&#x7B97;&#x80FD;&#x529B;&#x53BB;&#x6267;&#x884C;&#x6536;&#x96C6;&#x5668;&#x7EBF;&#x7A0B;&#xFF0C;&#x5C31;&#x53EF;&#x80FD;&#x5BFC;&#x81F4;&#x7528;&#x6237;&#x7684;&#x6267;&#x884C;&#x901F;&#x5EA6;&#x964D;&#x4F4E;&#x4E86;50%,&#x4EE4;&#x4EBA;&#x96BE;&#x4EE5;&#x63A5;&#x53D7;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C;CPU&#x6570;&#x91CF;&#x8FC7;&#x5C11;,&#x5C31;&#x4E0D;&#x592A;&#x9002;&#x5408;&#x4F7F;&#x7528;CMS&#x6536;&#x96C6;&#x5668;&#x3002;</p>
<p>CMS&#x6536;&#x96C6;&#x5668;&#x65E0;&#x6CD5;&#x5904;&#x7406;&#x6D6E;&#x52A8;&#x5783;&#x573E;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x51FA;&#x73B0;&#x201C;Concurrent Mode Failure&#xFF08;&#x5E76;&#x53D1;&#x6A21;&#x5F0F;&#x6545;&#x969C;&#xFF09;&#x201D;&#x5931;&#x8D25;&#x800C;&#x5BFC;&#x81F4;Full GC&#x4EA7;&#x751F;&#x3002;
&#x6D6E;&#x52A8;&#x5783;&#x573E;&#xFF1A;&#x7531;&#x4E8E;CMS&#x5E76;&#x53D1;&#x6E05;&#x7406;&#x9636;&#x6BB5;&#x7528;&#x6237;&#x7EBF;&#x7A0B;&#x8FD8;&#x5728;&#x8FD0;&#x884C;&#x7740;&#xFF0C;&#x4F34;&#x968F;&#x7740;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x81EA;&#x7136;&#x5C31;&#x4F1A;&#x6709;&#x65B0;&#x7684;&#x5783;&#x573E;&#x4E0D;&#x65AD;&#x4EA7;&#x751F;&#xFF0C;&#x8FD9;&#x90E8;&#x5206;&#x5783;&#x573E;&#x51FA;&#x73B0;&#x7684;&#x6807;&#x8BB0;&#x8FC7;&#x7A0B;&#x4E4B;&#x540E;&#xFF0C;CMS&#x65E0;&#x6CD5;&#x5728;&#x5F53;&#x6B21;&#x6536;&#x96C6;&#x4E2D;&#x5904;&#x7406;&#x6389;&#x5B83;&#x4EEC;&#xFF0C;&#x53EA;&#x597D;&#x7559;&#x5F85;&#x4E0B;&#x4E00;&#x6B21;GC&#x4E2D;&#x518D;&#x6E05;&#x7406;&#x3002;&#x8FD9;&#x4E9B;&#x5783;&#x573E;&#x5C31;&#x662F;&#x201C;&#x6D6E;&#x52A8;&#x5783;&#x573E;&#x201D;&#x3002;</p>
<p>&#x7531;&#x4E8E;&#x5783;&#x573E;&#x6536;&#x96C6;&#x9636;&#x6BB5;&#x7528;&#x6237;&#x7EBF;&#x7A0B;&#x8FD8;&#x9700;&#x8981;&#x8FD0;&#x884C;&#xFF0C;&#x5C31;&#x9700;&#x8981;&#x6709;&#x8DB3;&#x591F;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x7ED9;&#x7528;&#x6237;&#x7EBF;&#x7A0B;&#x4F7F;&#x7528;&#xFF0C;&#x56E0;&#x6B64;CMS&#x6536;&#x96C6;&#x5668;&#x4E0D;&#x80FD;&#x50CF;&#x5176;&#x4ED6;&#x6536;&#x96C6;&#x5668;&#x90A3;&#x6837;&#x7B49;&#x5230;&#x8001;&#x5E74;&#x4EE3;&#x51E0;&#x4E4E;&#x5B8C;&#x5168;&#x88AB;&#x586B;&#x6EE1;&#x4E86;&#x5728;&#x8FDB;&#x884C;&#x6536;&#x96C6;&#xFF0C;&#x9700;&#x8981;&#x9884;&#x7559;&#x4E00;&#x90E8;&#x5206;&#x7A7A;&#x95F4;&#x63D0;&#x4F9B;&#x5E76;&#x53D1;&#x6536;&#x96C6;&#x65F6;&#x7684;&#x7A0B;&#x5E8F;&#x8FD0;&#x4F5C;&#x4F7F;&#x7528;&#xFF0C;&#x6240;&#x4EE5;CMS&#x7684;&#x8FD0;&#x884C;&#x65F6;&#x673A;&#x5C31;&#x9700;&#x8981;&#x597D;&#x597D;&#x628A;&#x63E1;&#x3002;JDK1.5&#x4E2D;&#x5F53;&#x8001;&#x5E74;&#x4EE3;&#x4F7F;&#x7528;&#x4E86;68%&#x7684;&#x7A7A;&#x95F4;&#x4E4B;&#x540E;CMS&#x6536;&#x96C6;&#x5668;&#x4F1A;&#x88AB;&#x6FC0;&#x6D3B;&#xFF0C;&#x800C;&#x8FD9;&#x4E2A;&#x503C;&#x5728;JDK6&#x4E2D;&#x662F;92%&#xFF0C;&#x5F53;&#x7136;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x53C2;&#x6570;&#x53C2;&#x6570;-XX:CMSInitiatingOccupancyFraction&#x7684;&#x503C;&#x6765;&#x8BBE;&#x7F6E;&#x89E6;&#x53D1;&#x767E;&#x5206;&#x6BD4;&#x3002;
&#x8981;&#x662F;CMS&#x8FD0;&#x884C;&#x671F;&#x95F4;&#x9884;&#x7559;&#x7684;&#x5185;&#x5B58;&#x65E0;&#x6CD5;&#x6EE1;&#x8DB3;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#xFF0C;&#x5C31;&#x4F1A;&#x51FA;&#x73B0;&#x4E00;&#x6B21;&#x201D;Concurrent Mode Failure&quot;&#x5931;&#x8D25;&#xFF0C;&#x8FD9;&#x65F6;&#x865A;&#x62DF;&#x673A;&#x5C06;&#x542F;&#x52A8;&#x540E;&#x9884;&#x6848;&#xFF1A;&#x4E34;&#x65F6;&#x4F7F;&#x7528;Serial Old&#x6536;&#x96C6;&#x5668;&#x6765;&#x91CD;&#x65B0;&#x8FDB;&#x884C;&#x8001;&#x5E74;&#x4EE3;&#x7684;&#x5783;&#x573E;&#x6536;&#x96C6;&#xFF0C;&#x8FD9;&#x6837;&#x505C;&#x987F;&#x65F6;&#x95F4;&#x5C31;&#x66F4;&#x957F;&#x4E86;&#x3002;&#x6240;&#x4EE5;-XX:CMSInitiatingOccupancyFraction&#x53C2;&#x6570;&#x8981;&#x662F;&#x8BBE;&#x7F6E;&#x5F97;&#x592A;&#x9AD8;&#x5F88;&#x5BB9;&#x6613;&#x5BFC;&#x81F4;&#x5927;&#x91CF;&#x201C;Concurrent Mode Failure&quot;&#x5931;&#x8D25;&#xFF0C;&#x6027;&#x80FD;&#x53CD;&#x800C;&#x964D;&#x4F4E;&#x3002;</p>
<p>&#x4E0A;&#x9762;&#x4E5F;&#x63D0;&#x5230;&#x4E86;CMS&#x91C7;&#x7528;&#x5F97;&#x7B97;&#x6CD5;&#x662F;&#x201D;&#x6807;&#x8BB0;-&#x6E05;&#x9664;&#x201C;&#xFF0C;&#x90A3;&#x4E48;&#x4E5F;&#x610F;&#x5473;&#x8005;&#x6536;&#x96C6;&#x7ED3;&#x675F;&#x65F6;&#x4F1A;&#x6709;&#x5927;&#x91CF;&#x7A7A;&#x95F4;&#x788E;&#x7247;&#x4EA7;&#x751F;&#xFF0C;&#x5F53;&#x7A7A;&#x95F4;&#x788E;&#x7247;&#x8FC7;&#x591A;&#xFF0C;&#x5C06;&#x4F1A;&#x7ED9;&#x5927;&#x5BF9;&#x8C61;&#x5206;&#x914D;&#x5E26;&#x6765;&#x5F88;&#x5927;&#x7684;&#x9EBB;&#x70E6;&#xFF0C;&#x5F80;&#x5F80;&#x4F1A;&#x51FA;&#x73B0;&#x8001;&#x5E74;&#x4EE3;&#x8FD8;&#x6709;&#x5F88;&#x5927;&#x7A7A;&#x95F4;&#x5269;&#x4F59;&#xFF0C;&#x4F46;&#x662F;&#x65E0;&#x6CD5;&#x627E;&#x5230;&#x8DB3;&#x591F;&#x5927;&#x7684;&#x8FDE;&#x7EED;&#x7A7A;&#x95F4;&#x6765;&#x5206;&#x914D;&#x5F53;&#x524D;&#x5BF9;&#x8C61;&#xFF0C;&#x4E0D;&#x5F97;&#x4E0D;&#x63D0;&#x524D;&#x89E6;&#x53D1;&#x4E00;&#x6B21;Full GC&#x3002;&#x4E3A;&#x4E86;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;CMS&#x6536;&#x96C6;&#x5668;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;-XX:+UseCMSCompactAtFullCollection&#x5F00;&#x5173;&#x53C2;&#x6570;(&#x9ED8;&#x8BA4;&#x5F00;&#x542F;)&#x7528;&#x4E8E;&#x5728;CMS&#x6536;&#x96C6;&#x5668;&#x9876;&#x4E0D;&#x4F4F;&#x8981;&#x8FDB;&#x884C;FullGC&#x65F6;&#x5F00;&#x542F;&#x5185;&#x5B58;&#x788E;&#x7247;&#x7684;&#x5408;&#x5E76;&#x6574;&#x7406;&#x8FC7;&#x7A0B;&#xFF0C;&#x5185;&#x5B58;&#x6574;&#x7406;&#x7684;&#x8FC7;&#x7A0B;&#x662F;&#x65E0;&#x6CD5;&#x5E76;&#x53D1;&#x6267;&#x884C;&#x7684;,&#x7A7A;&#x95F4;&#x788E;&#x7247;&#x95EE;&#x9898;&#x6CA1;&#x6709;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x505C;&#x987F;&#x65F6;&#x95F4;&#x4E0D;&#x5F97;&#x4E0D;&#x53D8;&#x957F;&#x3002;&#x865A;&#x62DF;&#x673A;&#x8BBE;&#x8BA1;&#x8005;&#x8FD8;&#x63D0;&#x4F9B;&#x4E86;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x53C2;&#x6570;-XX:CMSFullGCsBeforeCompaction,&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x7528;&#x4E8E;&#x8BBE;&#x7F6E;&#x6267;&#x884C;&#x591A;&#x5C11;&#x6B21;&#x4E0D;&#x538B;&#x7F29;&#x7684;Full GC&#x540E;&#xFF0C;&#x8DDF;&#x7740;&#x6765;&#x4E00;&#x6B21;&#x5E26;&#x538B;&#x7F29;&#x7684;(&#x9ED8;&#x8BA4;&#x4E3A;0,&#x8868;&#x793A;&#x6BCF;&#x6B21;&#x8FDB;&#x5165;Full GC&#x65F6;&#x90FD;&#x8FDB;&#x884C;&#x788E;&#x7247;&#x6574;&#x7406;)&#xFF0C;&#x8FD9;&#x4E5F;&#x7B97;&#x662F;&#x4E00;&#x4E2A;&#x6298;&#x4E2D;&#x65B9;&#x6848;&#x4E86;&#x3002;</p>
<p>CMS&#x6536;&#x96C6;&#x5668;&#x7531;&#x4E8E;&#x5E76;&#x53D1;&#x6536;&#x96C6;&#x3001;&#x4F4E;&#x505C;&#x987F;,&#x5728;&#x73B0;&#x5728;&#x5927;&#x91CF;&#x7684;&#x5E94;&#x7528;&#x4E2D;&#x8FD8;&#x662F;&#x5904;&#x7406;&#x4E3B;&#x6D41;&#x5730;&#x4F4D;&#x7684;&#x3002;</p>
<h4 id="g1&#x6536;&#x96C6;&#x5668;">G1&#x6536;&#x96C6;&#x5668;</h4>
<p>G1&#xFF08;Garbage-First&#xFF09;&#xFF0C;&#x5B83;&#x662F;&#x4E00;&#x6B3E;&#x9762;&#x5411;&#x670D;&#x52A1;&#x7AEF;&#x5E94;&#x7528;&#x7684;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#xFF0C;&#x5728;&#x591A; CPU &#x548C;&#x5927;&#x5185;&#x5B58;&#x7684;&#x573A;&#x666F;&#x4E0B;&#x6709;&#x5F88;&#x597D;&#x7684;&#x6027;&#x80FD;&#x3002;HotSpot &#x5F00;&#x53D1;&#x56E2;&#x961F;&#x8D4B;&#x4E88;&#x5B83;&#x7684;&#x4F7F;&#x547D;&#x662F;&#x672A;&#x6765;&#x53EF;&#x4EE5;&#x66FF;&#x6362;&#x6389; CMS &#x6536;&#x96C6;&#x5668;&#x3002;
&#x5806;&#x88AB;&#x5206;&#x4E3A;&#x65B0;&#x751F;&#x4EE3;&#x548C;&#x8001;&#x5E74;&#x4EE3;&#xFF0C;&#x5176;&#x5B83;&#x6536;&#x96C6;&#x5668;&#x8FDB;&#x884C;&#x6536;&#x96C6;&#x7684;&#x8303;&#x56F4;&#x90FD;&#x662F;&#x6574;&#x4E2A;&#x65B0;&#x751F;&#x4EE3;&#x6216;&#x8005;&#x8001;&#x5E74;&#x4EE3;&#xFF0C;&#x800C; G1 &#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5BF9;&#x65B0;&#x751F;&#x4EE3;&#x548C;&#x8001;&#x5E74;&#x4EE3;&#x4E00;&#x8D77;&#x56DE;&#x6536;&#x3002;
G1 &#x628A;&#x5806;&#x5212;&#x5206;&#x6210;&#x591A;&#x4E2A;&#x5927;&#x5C0F;&#x76F8;&#x7B49;&#x7684;&#x72EC;&#x7ACB;&#x533A;&#x57DF;&#xFF08;Region&#xFF09;&#xFF0C;&#x65B0;&#x751F;&#x4EE3;&#x548C;&#x8001;&#x5E74;&#x4EE3;&#x4E0D;&#x518D;&#x7269;&#x7406;&#x9694;&#x79BB;&#x3002;</p>
<p><img src="/images/garbage-collection-g1.png" alt="G1&#x6536;&#x96C6;&#x5668;&#x5212;&#x5206;"></p>
<p>&#x901A;&#x8FC7;&#x5F15;&#x5165; Region &#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x4ECE;&#x800C;&#x5C06;&#x539F;&#x6765;&#x7684;&#x4E00;&#x6574;&#x5757;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x5212;&#x5206;&#x6210;&#x591A;&#x4E2A;&#x7684;&#x5C0F;&#x7A7A;&#x95F4;&#xFF0C;&#x4F7F;&#x5F97;&#x6BCF;&#x4E2A;&#x5C0F;&#x7A7A;&#x95F4;&#x53EF;&#x4EE5;&#x5355;&#x72EC;&#x8FDB;&#x884C;&#x5783;&#x573E;&#x56DE;&#x6536;&#x3002;&#x8FD9;&#x79CD;&#x5212;&#x5206;&#x65B9;&#x6CD5;&#x5E26;&#x6765;&#x4E86;&#x5F88;&#x5927;&#x7684;&#x7075;&#x6D3B;&#x6027;&#xFF0C;&#x4F7F;&#x5F97;&#x53EF;&#x9884;&#x6D4B;&#x7684;&#x505C;&#x987F;&#x65F6;&#x95F4;&#x6A21;&#x578B;&#x6210;&#x4E3A;&#x53EF;&#x80FD;&#x3002;&#x901A;&#x8FC7;&#x8BB0;&#x5F55;&#x6BCF;&#x4E2A; Region &#x5783;&#x573E;&#x56DE;&#x6536;&#x65F6;&#x95F4;&#x4EE5;&#x53CA;&#x56DE;&#x6536;&#x6240;&#x83B7;&#x5F97;&#x7684;&#x7A7A;&#x95F4;&#xFF08;&#x8FD9;&#x4E24;&#x4E2A;&#x503C;&#x662F;&#x901A;&#x8FC7;&#x8FC7;&#x53BB;&#x56DE;&#x6536;&#x7684;&#x7ECF;&#x9A8C;&#x83B7;&#x5F97;&#xFF09;&#xFF0C;&#x5E76;&#x7EF4;&#x62A4;&#x4E00;&#x4E2A;&#x4F18;&#x5148;&#x5217;&#x8868;&#xFF0C;&#x6BCF;&#x6B21;&#x6839;&#x636E;&#x5141;&#x8BB8;&#x7684;&#x6536;&#x96C6;&#x65F6;&#x95F4;&#xFF0C;&#x4F18;&#x5148;&#x56DE;&#x6536;&#x4EF7;&#x503C;&#x6700;&#x5927;&#x7684; Region&#x3002;
&#x6BCF;&#x4E2A; Region &#x90FD;&#x6709;&#x4E00;&#x4E2A; Remembered Set&#xFF0C;&#x7528;&#x6765;&#x8BB0;&#x5F55;&#x8BE5; Region &#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#x5BF9;&#x8C61;&#x6240;&#x5728;&#x7684; Region&#x3002;&#x901A;&#x8FC7;&#x4F7F;&#x7528; Remembered Set&#xFF0C;&#x5728;&#x505A;&#x53EF;&#x8FBE;&#x6027;&#x5206;&#x6790;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x5168;&#x5806;&#x626B;&#x63CF;&#x3002;
<img src="/images/garbase-collection-g1-safepoint.jpg" alt="g1-safepoint"></p>
<p>&#x5982;&#x679C;&#x4E0D;&#x8BA1;&#x7B97;&#x7EF4;&#x62A4; Remembered Set &#x7684;&#x64CD;&#x4F5C;&#xFF0C;G1 &#x6536;&#x96C6;&#x5668;&#x7684;&#x8FD0;&#x4F5C;&#x5927;&#x81F4;&#x53EF;&#x5212;&#x5206;&#x4E3A;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x6B65;&#x9AA4;&#xFF1A;* &#x521D;&#x59CB;&#x6807;&#x8BB0;* &#x5E76;&#x53D1;&#x6807;&#x8BB0;* &#x6700;&#x7EC8;&#x6807;&#x8BB0;&#xFF1A;&#x4E3A;&#x4E86;&#x4FEE;&#x6B63;&#x5728;&#x5E76;&#x53D1;&#x6807;&#x8BB0;&#x671F;&#x95F4;&#x56E0;&#x7528;&#x6237;&#x7A0B;&#x5E8F;&#x7EE7;&#x7EED;&#x8FD0;&#x4F5C;&#x800C;&#x5BFC;&#x81F4;&#x6807;&#x8BB0;&#x4EA7;&#x751F;&#x53D8;&#x52A8;&#x7684;&#x90A3;&#x4E00;&#x90E8;&#x5206;&#x6807;&#x8BB0;&#x8BB0;&#x5F55;&#xFF0C;&#x865A;&#x62DF;&#x673A;&#x5C06;&#x8FD9;&#x6BB5;&#x65F6;&#x95F4;&#x5BF9;&#x8C61;&#x53D8;&#x5316;&#x8BB0;&#x5F55;&#x5728;&#x7EBF;&#x7A0B;&#x7684; Remembered Set Logs &#x91CC;&#x9762;&#xFF0C;&#x6700;&#x7EC8;&#x6807;&#x8BB0;&#x9636;&#x6BB5;&#x9700;&#x8981;&#x628A; Remembered Set Logs &#x7684;&#x6570;&#x636E;&#x5408;&#x5E76;&#x5230; Remembered Set &#x4E2D;&#x3002;&#x8FD9;&#x9636;&#x6BB5;&#x9700;&#x8981;&#x505C;&#x987F;&#x7EBF;&#x7A0B;&#xFF0C;&#x4F46;&#x662F;&#x53EF;&#x5E76;&#x884C;&#x6267;&#x884C;&#x3002;* &#x7B5B;&#x9009;&#x56DE;&#x6536;&#xFF1A;&#x9996;&#x5148;&#x5BF9;&#x5404;&#x4E2A; Region &#x4E2D;&#x7684;&#x56DE;&#x6536;&#x4EF7;&#x503C;&#x548C;&#x6210;&#x672C;&#x8FDB;&#x884C;&#x6392;&#x5E8F;&#xFF0C;&#x6839;&#x636E;&#x7528;&#x6237;&#x6240;&#x671F;&#x671B;&#x7684; GC &#x505C;&#x987F;&#x65F6;&#x95F4;&#x6765;&#x5236;&#x5B9A;&#x56DE;&#x6536;&#x8BA1;&#x5212;&#x3002;&#x6B64;&#x9636;&#x6BB5;&#x5176;&#x5B9E;&#x4E5F;&#x53EF;&#x4EE5;&#x505A;&#x5230;&#x4E0E;&#x7528;&#x6237;&#x7A0B;&#x5E8F;&#x4E00;&#x8D77;&#x5E76;&#x53D1;&#x6267;&#x884C;&#xFF0C;&#x4F46;&#x662F;&#x56E0;&#x4E3A;&#x53EA;&#x56DE;&#x6536;&#x4E00;&#x90E8;&#x5206; Region&#xFF0C;&#x65F6;&#x95F4;&#x662F;&#x7528;&#x6237;&#x53EF;&#x63A7;&#x5236;&#x7684;&#xFF0C;&#x800C;&#x4E14;&#x505C;&#x987F;&#x7528;&#x6237;&#x7EBF;&#x7A0B;&#x5C06;&#x5927;&#x5E45;&#x5EA6;&#x63D0;&#x9AD8;&#x6536;&#x96C6;&#x6548;&#x7387;&#x3002;&#x5177;&#x5907;&#x5982;&#x4E0B;&#x7279;&#x70B9;&#xFF1A;* &#x7A7A;&#x95F4;&#x6574;&#x5408;&#xFF1A;&#x6574;&#x4F53;&#x6765;&#x770B;&#x662F;&#x57FA;&#x4E8E;&#x201C;&#x6807;&#x8BB0; - &#x6574;&#x7406;&#x201D;&#x7B97;&#x6CD5;&#x5B9E;&#x73B0;&#x7684;&#x6536;&#x96C6;&#x5668;&#xFF0C;&#x4ECE;&#x5C40;&#x90E8;&#xFF08;&#x4E24;&#x4E2A; Region &#x4E4B;&#x95F4;&#xFF09;&#x4E0A;&#x6765;&#x770B;&#x662F;&#x57FA;&#x4E8E;&#x201C;&#x590D;&#x5236;&#x201D;&#x7B97;&#x6CD5;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x8FD0;&#x884C;&#x671F;&#x95F4;&#x4E0D;&#x4F1A;&#x4EA7;&#x751F;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x788E;&#x7247;&#x3002;* &#x53EF;&#x9884;&#x6D4B;&#x7684;&#x505C;&#x987F;&#xFF1A;&#x80FD;&#x8BA9;&#x4F7F;&#x7528;&#x8005;&#x660E;&#x786E;&#x6307;&#x5B9A;&#x5728;&#x4E00;&#x4E2A;&#x957F;&#x5EA6;&#x4E3A; M &#x6BEB;&#x79D2;&#x7684;&#x65F6;&#x95F4;&#x7247;&#x6BB5;&#x5185;&#xFF0C;&#x6D88;&#x8017;&#x5728; GC &#x4E0A;&#x7684;&#x65F6;&#x95F4;&#x4E0D;&#x5F97;&#x8D85;&#x8FC7; N &#x6BEB;&#x79D2;&#x3002;
&#x5173;&#x4E8E;G1&#x6536;&#x96C6;&#x5668;&#x7684;&#x5176;&#x4ED6;&#x53C2;&#x8003;&#x6587;&#x7AE0;&#xFF1A;<a href="https://tech.meituan.com/g1.html" target="_blank" rel="external">G1&#x6536;&#x96C6;&#x5668;</a></p>
<h2 id="&#x56DE;&#x6536;&#x65B9;&#x5F0F;&#x7684;&#x9009;&#x62E9;">&#x56DE;&#x6536;&#x65B9;&#x5F0F;&#x7684;&#x9009;&#x62E9;</h2>
<p>jvm&#x6709;client&#x548C;server&#x4E24;&#x79CD;&#x6A21;&#x5F0F;&#xFF0C;&#x8FD9;&#x4E24;&#x79CD;&#x6A21;&#x5F0F;&#x7684;gc&#x9ED8;&#x8BA4;&#x65B9;&#x5F0F;&#x662F;&#x4E0D;&#x540C;&#x7684;&#xFF1A;</p>
<p>client&#x6A21;&#x5F0F;&#x4E0B;&#xFF0C;&#x65B0;&#x751F;&#x4EE3;&#x9009;&#x62E9;&#x7684;&#x662F;&#x4E32;&#x884C;gc&#xFF0C;&#x65E7;&#x751F;&#x4EE3;&#x9009;&#x62E9;&#x7684;&#x662F;&#x4E32;&#x884C;gc</p>
<p>server&#x6A21;&#x5F0F;&#x4E0B;&#xFF0C;&#x65B0;&#x751F;&#x4EE3;&#x9009;&#x62E9;&#x7684;&#x662F;&#x5E76;&#x884C;&#x56DE;&#x6536;gc&#xFF0C;&#x65E7;&#x751F;&#x4EE3;&#x9009;&#x62E9;&#x7684;&#x662F;&#x5E76;&#x884C;gc</p>
<p>&#x4E00;&#x822C;&#x6765;&#x8BF4;&#x6211;&#x4EEC;&#x7CFB;&#x7EDF;&#x5E94;&#x7528;&#x9009;&#x62E9;&#x6709;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#xFF1A;&#x541E;&#x5410;&#x91CF;&#x4F18;&#x5148;&#x548C;&#x6682;&#x505C;&#x65F6;&#x95F4;&#x4F18;&#x5148;&#xFF0C;&#x5BF9;&#x4E8E;&#x541E;&#x5410;&#x91CF;&#x4F18;&#x5148;&#x7684;&#x91C7;&#x7528;server&#x9ED8;&#x8BA4;&#x7684;&#x5E76;&#x884C;gc&#x65B9;&#x5F0F;&#xFF0C;&#x5BF9;&#x4E8E;&#x6682;&#x505C;&#x65F6;&#x95F4;&#x4F18;&#x5148;&#x7684;&#x9009;&#x7528;&#x5E76;&#x53D1;gc&#xFF08;CMS&#xFF09;&#x65B9;&#x5F0F;&#x3002;</p>
<h2 id="&#x603B;&#x7ED3;">&#x603B;&#x7ED3;</h2>
<p>&#x8BB0;&#x4F4F;&#x5404;&#x4E2A;&#x6536;&#x96C6;&#x5668;&#x4E4B;&#x95F4;&#x5982;&#x4F55;&#x642D;&#x914D;&#x6709;&#x52A9;&#x4E8E;&#x67E5;&#x770B;&#x7EBF;&#x4E0A;GC&#x65E5;&#x5FD7;&#x7684;&#x65F6;&#x5019;&#x5E2E;&#x52A9;&#x5B9A;&#x4F4D;&#x95EE;&#x9898;&#xFF0C;&#x4E5F;&#x662F;&#x5BF9;JVM&#x7684;&#x4E00;&#x6B21;&#x6DF1;&#x5165;&#x4E86;&#x89E3;&#x3002;&#x4E86;&#x89E3;&#x5404;&#x4E2A;&#x6536;&#x96C6;&#x5668;&#x7684;&#x7279;&#x6027;&#x4EE5;&#x53CA;&#x4F7F;&#x7528;&#x573A;&#x666F;&#x66F4;&#x6709;&#x52A9;&#x4E8E;&#x4F18;&#x5316;JVM&#x3002;</p>
]]></content>
    <summary type="html">
    <![CDATA[Java中垃圾回收不用我们操心,但是知道有哪些垃圾回收算法,以及各种垃圾回收器的组合应用对于JVM调优有着巨大的帮助,这篇博客就是为了总结一下垃圾回收算法以及垃圾回收器。]]>
    
    </summary>
    
      <category term="jvm" scheme="http://yoursite.com/tags/jvm/"/>
    
      <category term="jvm" scheme="http://yoursite.com/categories/jvm/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Graphql在项目中的使用(二)]]></title>
    <link href="http://yoursite.com/2018/10/30/how-to-use-graphql2/"/>
    <id>http://yoursite.com/2018/10/30/how-to-use-graphql2/</id>
    <published>2018-10-30T12:56:08.000Z</published>
    <updated>2018-10-30T13:18:54.307Z</updated>
    <content type="html"><![CDATA[<p>&#x5728;&#x4E0A;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x4E2D;&#x6211;&#x4EEC;&#x4ECB;&#x7ECD;&#x4E86;Graphql&#x96C6;&#x6210;SpringMVC&#xFF0C;&#x4ECA;&#x5929;&#x5C31;&#x6765;&#x4ECB;&#x7ECD;&#x4E0B;GraphQLResolver&#x7684;&#x4F7F;&#x7528;&#x3002;
&#x5047;&#x8BBE;&#x6211;&#x4EEC;&#x60F3;&#x8981;Book&#x8FD9;&#x4E2A;API&#x8FD4;&#x56DE;desc&#x8FD9;&#x4E2A;&#x5B57;&#x6BB5;,desc&#x53EF;&#x80FD;&#x5E76;&#x4E0D;&#x5728;&#x6570;&#x636E;&#x5E93;&#x4E2D;,&#x6216;&#x8005;&#x662F;&#x4F60;&#x60F3;&#x4E2A;&#x6027;&#x5316;&#x5B9A;&#x5236;&#x4F60;&#x7684;&#x8FD4;&#x56DE;&#x6570;&#x636E;,&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x5C31;&#x8F6E;&#x5230;GraphQLResolver&#x4E86;&#x3002;</p>
<h3 id="graphqlresolver&#x7684;&#x4F7F;&#x7528;">GraphQLResolver&#x7684;&#x4F7F;&#x7528;</h3>
<ol>
<li>&#x9996;&#x5148;&#x5C06;schema.graphqls&#x4E2D;&#x5173;&#x4E8E;book&#x7684;&#x58F0;&#x660E;&#x53D8;&#x66F4;&#x5982;&#x4E0B;&#xFF1A;</li>
</ol>
<p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="typedef"><span class="keyword">type</span> <span class="type">Book</span> <span class="container">{</span><br><span class="line">id: <span class="type">Long</span></span><br><span class="line">name: <span class="type">String</span></span><br><span class="line">url: <span class="type">String</span></span><br><span class="line">person: <span class="type">Person</span></span><br><span class="line">desc: <span class="type">String</span></span><br><span class="line">}</span></span></span><br></pre></td></tr></table></figure></p>
<p>&#x4F46;&#x662F;Book&#x7C7B;&#x7684;&#x58F0;&#x660E;&#x4ECD;&#x7136;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x53D8;&#x5316;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Data</span></span><br><span class="line"><span class="annotation">@AllArgsConstructor</span></span><br><span class="line"><span class="annotation">@NoArgsConstructor</span></span><br><span class="line"><span class="annotation">@Builder</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span> </span>{    </span><br><span class="line">	<span class="keyword">private</span> Long id;    </span><br><span class="line">	<span class="keyword">private</span> String name;    </span><br><span class="line">	<span class="keyword">private</span> String url;   </span><br><span class="line">	<span class="keyword">private</span> Person person;</span><br><span class="line"> }</span><br></pre></td></tr></table></figure></p>
<p>&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x7684;&#x58F0;&#x660E;&#x4E2D;&#x662F;&#x6DFB;&#x52A0;&#x4E86;desc&#x8FD9;&#x4E2A;&#x5B57;&#x6BB5;&#x7684;,&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x600E;&#x4E48;&#x5904;&#x7406;&#x8FD9;&#x4E2A;&#x5B57;&#x6BB5;&#x5462;&#xFF1F;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.coxautodev.graphql.tools.GraphQLResolver;</span><br><span class="line"><span class="keyword">import</span> com.generalthink.graphql.com.generalthink.graphql.bean.Book;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="annotation">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookResolver</span> <span class="keyword">implements</span> <span class="title">GraphQLResolver</span>&lt;<span class="title">Book</span>&gt; </span>{</span><br><span class="line">    <span class="comment">//&#x83B7;&#x53D6;desc&#x5B57;&#x6BB5;&#x7684;&#x5904;&#x7406;&#x65B9;&#x5F0F;&#xFF0C;getUpperFieldName</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDesc</span><span class="params">(Book book)</span> </span>{</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;Java&quot;</span>.equals(book.getName())) {</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;great book&quot;</span>;</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;unrecommened book&quot;</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<ol start="2">
<li>&#x5728;GraphqlEndopoint&#x4E2D;&#x58F0;&#x660E;&#x9700;&#x8981;&#x5904;&#x7406;&#x7684;resolver:</li>
</ol>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="annotation">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GraphqlEndpoint</span> <span class="keyword">extends</span> <span class="title">SimpleGraphQLServlet</span> </span>{</span><br><span class="line"></span><br><span class="line"><span class="annotation">@Autowired</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">GraphqlEndpoint</span><span class="params">(Query query, Mutation mutation, BookResolver bookResolver)</span> </span>{</span><br><span class="line"><span class="keyword">super</span>(SchemaParser.newParser()</span><br><span class="line">.file(<span class="string">&quot;schema.graphqls&quot;</span>)</span><br><span class="line">.resolvers(query,mutation,bookResolver)</span><br><span class="line">.scalars(Scalars.JAVA_LONG)</span><br><span class="line">.build()</span><br><span class="line">.makeExecutableSchema());</span><br><span class="line">}</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x6B64;&#x65F6;&#x4F7F;&#x7528;grapqhql playgound&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#xFF1A;
<img src="/images/graphql2-playground-post.png" alt="grapqhl palyground"></p>
<h3 id="graphql-playground&#x7684;&#x4F7F;&#x7528;">Graphql Playground&#x7684;&#x4F7F;&#x7528;</h3>
<p>playground&#x5DE5;&#x5177;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;chome&#x63D2;&#x4EF6;&#x7248;,&#x53EF;&#x4EE5;&#x5728;&#x5E94;&#x7528;&#x5546;&#x5E97;&#x641C;&#x7D22;graphiql&#x5B89;&#x88C5;,&#x540C;&#x6837;&#x53EF;&#x4EE5;&#x63D0;&#x4F9B;&#x4E00;&#x6837;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x4E0A;&#x9762;&#x770B;&#x4E86;&#x77E5;&#x9053;&#x5982;&#x4F55;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x6211;&#x4EEC;&#x524D;&#x7AEF;&#x4E2D;&#x5982;&#x4F55;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#x5462;&#xFF1F;</p>
<p>&#x9996;&#x5148;&#x6253;&#x5F00;chrome&#x8C03;&#x8BD5;&#x5DE5;&#x5177;
<img src="/images/graphql2-playground-open-console.png" alt="&#x6253;&#x5F00;dev Tool"></p>
<p>&#x53D1;&#x8D77;graphql&#x8BF7;&#x6C42;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;dev tools&#x4E2D;&#x770B;&#x5230;&#x5177;&#x4F53;&#x7684;&#x8BF7;&#x6C42;&#xFF0C;&#x6B64;&#x65F6;&#x53EF;&#x4EE5;&#x5C06;&#x8BF7;&#x6C42;&#x590D;&#x5236;&#x4E3A;cURL&#x6216;&#x8005;&#x67E5;&#x770B;&#x5177;&#x4F53;&#x7684;&#x53D1;&#x8D77;&#x7684;&#x8BF7;&#x6C42;&#x4F53;
<img src="/images/graphql2-devtool-copy2curl.png" alt="&#x8BF7;&#x6C42;&#x62F7;&#x8D1D;&#x4E3A;cURL"></p>
<p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x628A;&#x5177;&#x4F53;&#x8BF7;&#x6C42;&#x5BFC;&#x51FA;&#x4E3A;cURL&#xFF0C;&#x7136;&#x540E;&#x5BFC;&#x5165;&#x5230;postman&#x4E2D;
<img src="/images/graphql2-curl-postman.png" alt="&#x5BFC;&#x5165;&#x8BF7;&#x6C42;&#x5230;postman"></p>
<p>&#x67E5;&#x770B;&#x8BF7;&#x6C42;&#x7ED3;&#x679C;
<img src="/images/graphql2-get-request-in-postman.png" alt="&#x5728;postman&#x4E2D;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;"></p>
<p>&#x4F1A;&#x53D1;&#x73B0;&#x5728;web&#x8BF7;&#x6C42;&#x4E2D;&#xFF0C;&#x662F;&#x5C06;&#x8BF7;&#x6C42;&#x53C2;&#x6570;&#x5168;&#x90E8;&#x653E;&#x5230;body&#x4F53;&#x4E2D;&#x53D1;&#x9001;&#x5230;&#x540E;&#x7AEF;&#x7684;&#x3002;&#x5728;&#x8FD9;&#x6B21;&#x4F7F;&#x7528;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x53D1;&#x73B0;graphql&#x6240;&#x6709;&#x8FD4;&#x56DE;&#x7684;&#x53C2;&#x6570;&#x90FD;&#x662F;&#x53EF;&#x4EE5;&#x7531;&#x524D;&#x7AEF;&#x81EA;&#x5DF1;&#x5B9A;&#x5236;&#x7684;,&#x800C;&#x4E14;&#x4F7F;&#x7528;graphql playground&#x7684;&#x8FC7;&#x7A0B;&#x53EF;&#x4EE5;&#x8BA9;&#x6211;&#x4EEC;&#x77E5;&#x9053;&#x8BF7;&#x6C42;&#x9700;&#x8981;&#x54EA;&#x4E9B;&#x53C2;&#x6570;&#xFF0C;&#x8FD4;&#x56DE;&#x53EF;&#x4EE5;&#x7531;&#x54EA;&#x4E9B;&#x503C;&#xFF0C;&#x4F7F;&#x7528;&#x8FD8;&#x662F;&#x6781;&#x4E3A;&#x65B9;&#x4FBF;&#x7684;&#x3002;</p>
]]></content>
    <summary type="html">
    <![CDATA[GraphQLResolver的使用,使用GraphQLResolver自定义接口数据的返回]]>
    
    </summary>
    
      <category term="Graphql" scheme="http://yoursite.com/tags/Graphql/"/>
    
      <category term="Graphql" scheme="http://yoursite.com/categories/Graphql/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Graphql在项目中的使用]]></title>
    <link href="http://yoursite.com/2018/09/27/how-to-use-graphql/"/>
    <id>http://yoursite.com/2018/09/27/how-to-use-graphql/</id>
    <published>2018-09-27T13:59:04.000Z</published>
    <updated>2018-10-28T13:11:18.377Z</updated>
    <content type="html"><![CDATA[<h3 id="&#x4EC0;&#x4E48;&#x662F;graphql">&#x4EC0;&#x4E48;&#x662F;GraphQL</h3>
<p>GraphQL &#x662F;&#x4E00;&#x79CD;&#x7528;&#x4E8E; API &#x7684;&#x67E5;&#x8BE2;&#x8BED;&#x8A00;&#x3002; GraphQL &#x5BF9;&#x4F60;&#x7684; API &#x4E2D;&#x7684;&#x6570;&#x636E;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x5957;&#x6613;&#x4E8E;&#x7406;&#x89E3;&#x7684;&#x5B8C;&#x6574;&#x63CF;&#x8FF0;&#xFF0C;&#x4F7F;&#x5F97;&#x5BA2;&#x6237;&#x7AEF;&#x80FD;&#x591F;&#x51C6;&#x786E;&#x5730;&#x83B7;&#x5F97;&#x5B83;&#x9700;&#x8981;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x800C;&#x4E14;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x5197;&#x4F59;&#xFF0C;&#x4E5F;&#x8BA9; API &#x66F4;&#x5BB9;&#x6613;&#x5730;&#x968F;&#x7740;&#x65F6;&#x95F4;&#x63A8;&#x79FB;&#x800C;&#x6F14;&#x8FDB;&#xFF0C;&#x8FD8;&#x80FD;&#x7528;&#x4E8E;&#x6784;&#x5EFA;&#x5F3A;&#x5927;&#x7684;&#x5F00;&#x53D1;&#x8005;&#x5DE5;&#x5177;&#x3002;GraphQL &#x67E5;&#x8BE2;&#x4E0D;&#x4EC5;&#x80FD;&#x591F;&#x83B7;&#x5F97;&#x8D44;&#x6E90;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x8FD8;&#x80FD;&#x6CBF;&#x7740;&#x8D44;&#x6E90;&#x95F4;&#x5F15;&#x7528;&#x8FDB;&#x4E00;&#x6B65;&#x67E5;&#x8BE2;&#x3002;&#x5178;&#x578B;&#x7684; REST API &#x8BF7;&#x6C42;&#x591A;&#x4E2A;&#x8D44;&#x6E90;&#x65F6;&#x5F97;&#x8F7D;&#x5165;&#x591A;&#x4E2A; URL&#xFF0C;&#x800C; GraphQL &#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E00;&#x6B21;&#x8BF7;&#x6C42;&#x5C31;&#x83B7;&#x53D6;&#x4F60;&#x5E94;&#x7528;&#x6240;&#x9700;&#x7684;&#x6240;&#x6709;&#x6570;&#x636E;&#x3002;GraphQL API &#x57FA;&#x4E8E;&#x7C7B;&#x578B;&#x548C;&#x5B57;&#x6BB5;&#x7684;&#x65B9;&#x5F0F;&#x8FDB;&#x884C;&#x7EC4;&#x7EC7;&#xFF0C;&#x800C;&#x975E;&#x5165;&#x53E3;&#x7AEF;&#x70B9;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x5355;&#x4E00;&#x5165;&#x53E3;&#x7AEF;&#x70B9;&#x5F97;&#x5230;&#x4F60;&#x6240;&#x6709;&#x7684;&#x6570;&#x636E;&#x80FD;&#x529B;&#x3002;</p>
<p>Facebook &#x7684;&#x79FB;&#x52A8;&#x5E94;&#x7528;&#x4ECE; 2012 &#x5E74;&#x5C31;&#x5F00;&#x59CB;&#x4F7F;&#x7528; GraphQL&#x3002;GraphQL &#x89C4;&#x8303;&#x4E8E; 2015 &#x5E74;&#x5F00;&#x6E90;&#xFF0C;&#x73B0;&#x5DF2;&#x7ECF;&#x5728;&#x591A;&#x79CD;&#x73AF;&#x5883;&#x4E0B;&#x53EF;&#x7528;&#xFF0C;&#x5E76;&#x88AB;&#x5404;&#x79CD;&#x4F53;&#x91CF;&#x7684;&#x56E2;&#x961F;&#x6240;&#x4F7F;&#x7528;&#x3002;</p>
<h3 id="&#x6700;&#x597D;&#x7684;&#x5165;&#x95E8;&#x6587;&#x6863;">&#x6700;&#x597D;&#x7684;&#x5165;&#x95E8;&#x6587;&#x6863;</h3>
<p>&#x6700;&#x597D;&#x7684;&#x6587;&#x6863;&#x5F53;&#x7136;&#x662F;<a href="https://www.howtographql.com/graphql-java/1-getting-started/" target="_blank" rel="external">&#x5B98;&#x65B9;&#x6587;&#x6863;</a></p>
<h3 id="springmvc&#x96C6;&#x6210;graphql">SpringMVC&#x96C6;&#x6210;GraphQL</h3>
<h4 id="&#x5F15;&#x5165;java&#x5305;">&#x5F15;&#x5165;Java&#x5305;</h4>
<p>&#x8FD9;&#x91CC;&#x4E3A;&#x4E86;&#x5C3D;&#x91CF;&#x7684;&#x5C55;&#x793A;&#x6574;&#x4E2A;&#x96C6;&#x6210;&#x6D41;&#x7A0B;&#xFF0C;&#x6240;&#x4EE5;&#x4F1A;&#x4F7F;&#x7528;SpringBoot&#x6765;&#x8FDB;&#x884C;&#x6574;&#x4F53;&#x6846;&#x67B6;&#x642D;&#x5EFA;&#x3002;&#x4F46;&#x662F;&#x4F1A;&#x5C06;&#x66F4;&#x591A;&#x7684;&#x6D41;&#x7A0B;&#x805A;&#x7126;&#x5728;GraphQL&#x4E2D;&#x3002;&#x6240;&#x4EE5;&#x7B2C;&#x4E00;&#x6B65;&#x662F;&#x5F15;&#x5165;GraphQL&#x7684;jar&#x5305;&#xFF0C;&#x5173;&#x4E8E;SpringBoot&#x7684;&#x642D;&#x5EFA;,&#x53EF;&#x4EE5;&#x501F;&#x52A9;<a href="http://start.spring.io/" target="_blank" rel="external">http://start.spring.io/</a>&#x6765;&#x5FEB;&#x901F;&#x642D;&#x5EFA;&#x3002;&#x8FD9;&#x91CC;&#x4E0D;&#x505A;&#x8FC7;&#x591A;&#x53D9;&#x8FF0;&#x3002;</p>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-boot-starter-data-mongodb<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="title">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="title">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">version</span>&gt;</span>3.0.1<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="title">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--&#x96C6;&#x6210;GraphQL--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>com.graphql-java<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>graphql-java<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">version</span>&gt;</span>9.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>com.graphql-java<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>graphql-java-tools<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">version</span>&gt;</span>5.2.3<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>com.graphql-java<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>graphql-java-servlet<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">version</span>&gt;</span>5.2.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="title">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="&#x5F00;&#x59CB;&#x5F00;&#x53D1;">&#x5F00;&#x59CB;&#x5F00;&#x53D1;</h3>
<p>&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x8003;&#x8651;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x5177;&#x4F53;&#x7684;&#x573A;&#x666F;,&#x5C31;&#x4EE5;&#x4E8C;&#x624B;&#x4E66;&#x7F51;&#x7AD9;&#x5356;&#x4E66;&#x4E3E;&#x4F8B;&#x597D;&#x4E86;&#x3002;&#x5728;GraphQL&#x4E2D;&#x67E5;&#x8BE2;&#x548C;&#x4FEE;&#x6539;(&#x589E;&#x52A0;,&#x5220;&#x9664;,&#x66F4;&#x65B0;)&#x90FD;&#x662F;&#x5206;&#x522B;&#x5BF9;&#x5E94;Query&#x548C;Mutation.GraphQL&#x652F;&#x6301;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x53EA;&#x6709;Int(Java&#x4E2D;&#x7684;Integer),Float,String,Enum&#x4EE5;&#x53CA;Type(&#x76F8;&#x5F53;&#x4E8E;Java&#x4E2D;&#x7684;Class),&#x6240;&#x4EE5;&#x5BF9;&#x4E8E;&#x5176;&#x4ED6;&#x4E0D;&#x652F;&#x6301;&#x7684;&#x7C7B;&#x578B;&#x9700;&#x8981;&#x4F7F;&#x7528;scalars&#x81EA;&#x5B9A;&#x4E49;&#x3002;</p>
<h4 id="&#x5B9A;&#x4E49;&#x63A5;&#x53E3;&#x63CF;&#x8FF0;schemagraphqls">&#x5B9A;&#x4E49;&#x63A5;&#x53E3;&#x63CF;&#x8FF0;(schema.graphqls)</h4>
<p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="typedef"><span class="keyword">type</span> <span class="type">Book</span> <span class="container">{</span><br><span class="line">    <span class="title">id</span>: <span class="type">Long</span></span><br><span class="line">    <span class="title">name</span>: <span class="type">String</span></span><br><span class="line">    <span class="title">url</span>: <span class="type">String</span></span><br><span class="line">    <span class="title">person</span>: <span class="type">Person</span></span><br><span class="line">}</span></span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor"># &#x6CE8;&#x610F;&#x8FD9;&#x91CC;&#x5F97;&#x5173;&#x952E;&#x5B57;&#x662F; input</span></span><br><span class="line"><span class="title">input</span> <span class="type">PersonParam</span> {</span><br><span class="line">    name: <span class="type">String</span></span><br><span class="line">    age: <span class="type">Int</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="typedef"><span class="keyword">type</span> <span class="type">Person</span> <span class="container">{</span><br><span class="line">    <span class="title">name</span>: <span class="type">String</span></span><br><span class="line">    <span class="title">age</span>: <span class="type">Int</span></span><br><span class="line">}</span></span></span><br><span class="line"></span><br><span class="line"><span class="typedef"><span class="keyword">type</span> <span class="type">Query</span> <span class="container">{</span><br><span class="line">   <span class="title">books</span>(<span class="title">name</span>: <span class="type">String</span>, <span class="title">size</span>: <span class="type">Int</span>): [<span class="type">Book</span>]</span><br><span class="line">}</span></span></span><br><span class="line"></span><br><span class="line"><span class="typedef"><span class="keyword">type</span> <span class="type">Mutation</span> <span class="container">{</span><br><span class="line">    <span class="title">newBook</span>(<span class="title">name</span>: <span class="type">String</span>, <span class="title">url</span>: <span class="type">String</span>, <span class="title">person</span>: <span class="type">PersonParam</span>): <span class="type">Long</span></span><br><span class="line">}</span></span></span><br><span class="line"></span><br><span class="line"><span class="title">schema</span> {</span><br><span class="line">    query: <span class="type">Query</span></span><br><span class="line">    mutation: <span class="type">Mutation</span></span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line"><span class="title">scalar</span> <span class="type">Long</span></span><br></pre></td></tr></table></figure></p>
<p>&#x5728;GraphQL&#x4E2D;&#x5982;&#x679C;&#x53C2;&#x6570;&#x662F;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x800C;&#x4E0D;&#x662F;&#x6807;&#x91CF;&#x503C;(Float,Int,String,Enum)&#x7684;&#x8BDD;&#xFF0C;&#x90A3;&#x4E48;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x9700;&#x8981;&#x7533;&#x660E;&#x4E3A;input.&#x4E0A;&#x9762;&#x53EF;&#x4EE5;&#x770B;&#x5230;PersonParam&#x548C;Person&#x7684;&#x5B57;&#x6BB5;&#x90FD;&#x662F;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x4E24;&#x4E2A;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E3A;&#x540C;&#x4E00;&#x4E2A;&#x5417;&#xFF1F;
&#x6211;&#x544A;&#x8BC9;&#x4F60;&#x4E0D;&#x884C;&#xFF0C;&#x56E0;&#x4E3A;PersonParam&#x662F;&#x8F93;&#x5165;&#x53C2;&#x6570;,&#x800C;Person&#x662F;&#x8F93;&#x51FA;&#x53C2;&#x6570;&#xFF0C;&#x4E24;&#x8005;&#x5728;GraphQL&#x4E2D;&#x4E0D;&#x80FD;&#x6DF7;&#x4E3A;&#x4E00;&#x8C08;,&#x5982;&#x679C;&#x4F60;&#x8FD9;&#x6837;&#x505A;&#x4E86;&#xFF0C;&#x7A0B;&#x5E8F;&#x4F1A;&#x62A5;&#x9519;&#x3002;</p>
<h4 id="&#x5B9A;&#x4E49;&#x63A5;&#x53E3;&#x5B9E;&#x73B0;">&#x5B9A;&#x4E49;&#x63A5;&#x53E3;&#x5B9E;&#x73B0;</h4>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="annotation">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Query</span> <span class="keyword">implements</span> <span class="title">GraphQLQueryResolver</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BookRespository bookRespository;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&#x65B9;&#x6CD5;&#x540D;&#x79F0;,&#x53C2;&#x6570;&#x4EE5;&#x53CA;&#x8FD4;&#x56DE;&#x7C7B;&#x578B;&#x8981;&#x548C;schema.graphqls&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x5B9A;&#x4E49;&#x4FDD;&#x6301;&#x4E00;&#x81F4;.DataFetchingEnvironment&#x662F;GraphQL&#x63D0;&#x4F9B;&#x7684;&#x4E0A;&#x4E0B;&#x6587;,&#x5176;&#x4E2D;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x5230;request,response</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Book&gt; <span class="title">books</span><span class="params">(String name,Integer size,DataFetchingEnvironment env)</span> </span>{</span><br><span class="line">        <span class="comment">//AuthContext context = env.getContext()   &#x7528;&#x4E8E;&#x6743;&#x9650;&#x8FC7;&#x6EE4;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> bookRespository.getBooks(name,size);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"><span class="annotation">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mutation</span> <span class="keyword">implements</span> <span class="title">GraphQLMutationResolver</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BookRespository bookRespository;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&#x63A5;&#x53E3;&#x9700;&#x8981;&#x548C;schema.graphqls&#x4E2D;&#x4FDD;&#x6301;&#x4E00;&#x81F4;</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Long <span class="title">newBook</span><span class="params">(String name, String url, PersonParam personParam)</span> </span>{</span><br><span class="line">        Person person = <span class="keyword">new</span> Person(personParam.getName(),personParam.getAge());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> bookRespository.saveBook(name,url,person);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x91CC;&#x7684;&#x63A5;&#x53E3;&#x5B9E;&#x9645;&#x4E0A;&#x4E5F;&#x662F;&#x8BF7;&#x6C42;&#x7684;&#x6700;&#x7EC8;&#x843D;&#x5730;&#x70B9;&#xFF0C;&#x53EF;&#x4EE5;&#x60F3;&#x6210;SpringMVC&#x4E2D;&#x7684;Controller&#xFF0C;&#x6700;&#x7EC8;&#x7684;&#x6267;&#x884C;&#x903B;&#x8F91;&#x5C31;&#x4F1A;&#x4ECE;&#x8FD9;&#x91CC;&#x5F00;&#x59CB;&#x3002;</p>
<h4 id="&#x96C6;&#x6210;mongodb">&#x96C6;&#x6210;MongoDB</h4>
<h5 id="applicationproperties&#x4E2D;&#x8BBE;&#x7F6E;mongodb&#x53C2;&#x6570;">application.properties&#x4E2D;&#x8BBE;&#x7F6E;mongodb&#x53C2;&#x6570;</h5>
<p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring<span class="class">.data</span><span class="class">.mongodb</span><span class="class">.uri</span>=mongodb:<span class="comment">//localhost:27017/gln-local-test</span></span><br></pre></td></tr></table></figure></p>
<h5 id="&#x6DFB;&#x52A0;&#x5BF9;mongodb&#x7684;&#x8BBF;&#x95EE;">&#x6DFB;&#x52A0;&#x5BF9;MongoDB&#x7684;&#x8BBF;&#x95EE;</h5>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookRespository</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MongoTemplate mongoTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Book&gt; <span class="title">getBooks</span><span class="params">(String name, Integer size)</span> </span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">null</span> == size) {</span><br><span class="line">            size = <span class="number">10</span>;</span><br><span class="line">        }</span><br><span class="line">        Query query = <span class="keyword">new</span> Query();</span><br><span class="line">        query.addCriteria(Criteria.where(<span class="string">&quot;name&quot;</span>).alike(Example.of(name))).limit(size);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> mongoTemplate.findAll(Book.class, <span class="string">&quot;book&quot;</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> Long <span class="title">saveBook</span><span class="params">(String name, String url, Person person)</span> </span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">long</span> id = <span class="keyword">new</span> Random().nextLong();</span><br><span class="line"></span><br><span class="line">        Book book = Book.builder().id(id).name(name).url(url).person(person).build();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        mongoTemplate.save(book,<span class="string">&quot;book&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">   }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x6DFB;&#x52A0;scalar">&#x6DFB;&#x52A0;Scalar</h4>
<p>&#x521A;&#x624D;&#x63D0;&#x5230;&#x4E86;GraphQL,&#x5B83;&#x53EA;&#x63D0;&#x4F9B;&#x4E86;Int,Float,String,Enum&#x4EE5;&#x53CA;&#x81EA;&#x5B9A;&#x4E49;Type(class)&#x7C7B;&#x578B;,&#x5BF9;&#x4E8E;&#x5176;&#x4ED6;&#x7684;&#x9700;&#x8981;&#x81EA;&#x5B9A;&#x4E49;,&#x5B9E;&#x9645;&#x4E0A;&#x4E5F;&#x5C31;&#x662F;&#x5B9A;&#x4E49;&#x5982;&#x4F55;&#x5E8F;&#x5217;&#x5316;&#x4EE5;&#x53CA;&#x53CD;&#x5E8F;&#x5217;&#x5316;,&#x8FD9;&#x79CD;&#x81EA;&#x5B9A;&#x4E49;&#x7C7B;&#x578B;&#x88AB;&#x79F0;&#x4E3A;scalar.&#x521A;&#x624D;&#x63A5;&#x53E3;&#x4E2D;&#x5B9A;&#x4E49;&#x4E86;Long,&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5199;&#x4E00;&#x4E2A;Long&#x7684;scalar.&#x5B9E;&#x9645;&#x4E0A;&#x5C31;&#x662F;&#x81EA;&#x5B9A;&#x4E49;&#x5E8F;&#x5217;&#x5316;&#x4EE5;&#x53CA;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x89C4;&#x5219;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Scalars</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> GraphQLScalarType JAVA_LONG = <span class="keyword">new</span> GraphQLScalarType(<span class="string">&quot;Long&quot;</span>, <span class="string">&quot;Java Long scalar&quot;</span>,</span><br><span class="line">            <span class="keyword">new</span> Coercing() {</span><br><span class="line">                <span class="annotation">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> Long <span class="title">serialize</span><span class="params">(Object dataFetcherResult)</span> <span class="keyword">throws</span> CoercingSerializeException </span>{</span><br><span class="line">                    <span class="keyword">return</span> Long.parseLong(dataFetcherResult.toString());</span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line">                <span class="annotation">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> Object <span class="title">parseValue</span><span class="params">(Object input)</span> <span class="keyword">throws</span> CoercingParseValueException </span>{</span><br><span class="line">                    <span class="keyword">return</span> serialize(input);</span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line">                <span class="annotation">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> Long <span class="title">parseLiteral</span><span class="params">(Object input)</span> <span class="keyword">throws</span> CoercingParseLiteralException </span>{</span><br><span class="line">                    <span class="keyword">if</span>(input <span class="keyword">instanceof</span> StringValue) {</span><br><span class="line">                        <span class="keyword">return</span> Long.parseLong(((StringValue) input).getValue());</span><br><span class="line">                    } <span class="keyword">else</span> <span class="keyword">if</span>(input <span class="keyword">instanceof</span> IntValue) {</span><br><span class="line">                        <span class="keyword">return</span> ((IntValue) input).getValue().longValue();</span><br><span class="line">                    }</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">                }</span><br><span class="line">            });</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x6DFB;&#x52A0;springmvc&#x652F;&#x6301;">&#x6DFB;&#x52A0;SpringMVC&#x652F;&#x6301;</h4>
<p>&#x4E4B;&#x524D;&#x7684;&#x914D;&#x7F6E;&#x53EA;&#x662F;&#x5BF9;&#x63A5;&#x53E3;&#x5B9A;&#x4E49;&#x7684;&#x8BE0;&#x91CA;&#xFF0C;&#x4F46;&#x662F;&#x8981;&#x8C08;&#x5230;&#x548C;SpringMVC&#x5BF9;&#x63A5;&#x5176;&#x5B9E;&#x8FD8;&#x6CA1;&#x6709;&#xFF0C;&#x90A3;&#x4E48;&#x63A5;&#x4E0B;&#x6765;&#x7684;&#x914D;&#x7F6E;&#x5C31;&#x662F;&#x548C;SpringMVC&#x8FDB;&#x884C;&#x5BF9;&#x63A5;&#x4E86;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GraphqlEndpoint</span> <span class="keyword">extends</span> <span class="title">SimpleGraphQLServlet</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Autowired</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GraphqlEndpoint</span><span class="params">(Query query, Mutation mutation)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>(SchemaParser.newParser()</span><br><span class="line">                .file(<span class="string">&quot;schema.graphqls&quot;</span>)</span><br><span class="line">                .resolvers(query,mutation)      <span class="comment">//&#x5F15;&#x5982;resovler</span></span><br><span class="line">                .scalars(Scalars.JAVA_LONG)  <span class="comment">//&#x5F15;&#x5165;&#x521A;&#x624D;&#x5B9A;&#x4E49;&#x7684;scalar</span></span><br><span class="line">                .build()</span><br><span class="line">                .makeExecutableSchema());</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//&#x7EDF;&#x4E00;&#x7684;&#x5165;&#x53E3;,graphQL&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x7EDF;&#x4E00;&#x5165;&#x53E3;&#x5C06;&#x8BF7;&#x6C42;&#x8FDB;&#x884C;&#x5206;&#x53D1;&#x7ED9;&#x5404;&#x4E2A;resolver</span></span><br><span class="line"><span class="annotation">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GraphqlController</span> </span>{</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> GraphQLServlet graphQLServlet;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@RequestMapping</span>(<span class="string">&quot;/graphql&quot;</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">graphql</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>{</span><br><span class="line"></span><br><span class="line">        graphQLServlet.service(request,response);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x6DFB;&#x52A0;&#x5BF9;&#x5E94;&#x7684;&#x5B9E;&#x4F53;&#x7C7B;">&#x6DFB;&#x52A0;&#x5BF9;&#x5E94;&#x7684;&#x5B9E;&#x4F53;&#x7C7B;</h4>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="annotation">@Data</span></span><br><span class="line"><span class="annotation">@AllArgsConstructor</span></span><br><span class="line"><span class="annotation">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String age;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="annotation">@Data</span></span><br><span class="line"><span class="annotation">@AllArgsConstructor</span></span><br><span class="line"><span class="annotation">@NoArgsConstructor</span></span><br><span class="line"><span class="annotation">@Builder</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String url;</span><br><span class="line">    <span class="keyword">private</span> Person person;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="annotation">@Data</span></span><br><span class="line"><span class="annotation">@AllArgsConstructor</span></span><br><span class="line"><span class="annotation">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonParam</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String age;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x5F00;&#x59CB;&#x771F;&#x6B63;&#x7684;&#x8868;&#x6F14;&#x4E86;">&#x5F00;&#x59CB;&#x771F;&#x6B63;&#x7684;&#x8868;&#x6F14;&#x4E86;</h4>
<p>&#x63A5;&#x4E0B;&#x6765;&#x5C31;&#x8981;&#x5F00;&#x59CB;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#x4E86;,&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;GraphQL Playground(&#x6216;&#x8005;google graphiql&#x63D2;&#x4EF6;)&#x6216;&#x8005;post man&#x6765;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;,&#x8FD9;&#x91CC;&#x6211;&#x4E24;&#x4E2A;&#x90FD;&#x4F7F;&#x7528;</p>
<p><img src="/images/graphql-postman-get.png" alt="postman get&#x6D4B;&#x8BD5;"></p>
<p><img src="/images/graphql-test-background.png" alt="graphql background&#x6D4B;&#x8BD5;"></p>
<p>query&#x540E;&#x9762;&#x90A3;&#x4E00;&#x4E32;&#x5176;&#x5B9E;&#x662F;
query {
books(name:&quot;MongoDB&quot;,size:10) {
name
url
person {
name
age
}
}
}
&#x7684;url&#x8F6C;&#x4E49;&#x3002;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x4F7F;&#x7528;get&#x65B9;&#x6CD5;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#xFF0C;&#x5C06;&#x67E5;&#x8BE2;&#x53C2;&#x6570;&#x653E;&#x5230;url&#x540E;&#x9762;&#xFF0C;&#x9700;&#x8981;&#x5C06;&#x53C2;&#x6570;&#x8F6C;&#x4E49;&#x4E4B;&#x540E;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#x3002;&#x5982;&#x679C;&#x4F7F;&#x7528;post&#x65B9;&#x6CD5;&#x5219;&#x503C;&#x9700;&#x8981;&#x5C06;&#x8BF7;&#x6C42;&#x4F53;&#x653E;&#x5230;body&#x4E2D;&#x5373;&#x53EF;</p>
<h4 id="&#x5173;&#x4E8E;&#x6743;&#x9650;&#x7684;&#x9A8C;&#x8BC1;">&#x5173;&#x4E8E;&#x6743;&#x9650;&#x7684;&#x9A8C;&#x8BC1;</h4>
<p>&#x8FD9;&#x91CC;&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x5B9E;&#x73B0;,&#x5728;GraphqlEndpoint&#x590D;&#x5199;&#x4E0B;&#x9762;&#x7684;&#x65B9;&#x6CD5;,&#x7136;&#x540E;&#x5728;Query&#x6216;&#x8005;Mutation&#x4E2D;&#x5C31;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;DataFetchingEnvironment&#x83B7;&#x53D6;&#x5230;&#x81EA;&#x5B9A;&#x4E49;&#x7684;context,&#x901A;&#x8FC7;&#x5176;&#x4E2D;&#x7684;request&#x6765;&#x8FDB;&#x884C;&#x6743;&#x9650;&#x9A8C;&#x8BC1;&#x4E86;&#x3002;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">protected</span> GraphQLContext <span class="title">createContext</span><span class="params">(Optional&lt;HttpServletRequest&gt; request, Optional&lt;HttpServletResponse&gt; response)</span> </span>{</span><br><span class="line">            </span><br><span class="line">        <span class="comment">//&#x4ECE;request&#x83B7;&#x53D6;&#x5230;cookie token&#x7B49;&#x80FD;&#x8BC1;&#x660E;&#x7528;&#x4E8E;&#x8EAB;&#x4EFD;&#x7684;&#x6570;&#x636E;,&#x89E3;&#x6790;&#x51FA;user</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> AuthContext(user,request,response);</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AuthContext</span> <span class="keyword">extends</span> <span class="title">GraphQLContext</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AuthUser authUser;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AuthContext</span><span class="params">(AuthUser user, Optional&lt;HttpServletRequest&gt; request, Optional&lt;HttpServletResponse&gt; response)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>(request, response);</span><br><span class="line">        <span class="keyword">this</span>.authUser = user;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AuthUser <span class="title">getAuthUser</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> authUser;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<h3 id="&#x53C2;&#x8003;&#x6587;&#x6863;">&#x53C2;&#x8003;&#x6587;&#x6863;</h3>
<p>http://graphql.github.io/learn/schema/</p>
<p>https://www.howtographql.com/graphql-java/1-getting-started/</p>
]]></content>
    <summary type="html">
    <![CDATA[Graphql是一种API的查询语言,由Facebook开源，旨在替代Restful,最近公司刚好有使用就研究了一下，顺便总结出来]]>
    
    </summary>
    
      <category term="Graphql" scheme="http://yoursite.com/tags/Graphql/"/>
    
      <category term="Graphql" scheme="http://yoursite.com/categories/Graphql/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[SpringMVC源码分析]]></title>
    <link href="http://yoursite.com/2018/08/13/springmvc-sourcecode-analysis/"/>
    <id>http://yoursite.com/2018/08/13/springmvc-sourcecode-analysis/</id>
    <published>2018-08-13T13:43:56.000Z</published>
    <updated>2018-10-28T13:14:36.270Z</updated>
    <content type="html"><![CDATA[<h3 id="&#x5F3A;&#x5927;&#x7684;dispatcherservlet">&#x5F3A;&#x5927;&#x7684;DispatcherServlet</h3>
<p>&#x8FD8;&#x8BB0;&#x5F97;&#x5728;web.xml&#x4E2D;&#x914D;&#x7F6E;&#x7684;DispatcherServlet&#x5417;?&#x5176;&#x5B9E;&#x90A3;&#x4E2A;&#x5C31;&#x662F;SpringMVC&#x6846;&#x67B6;&#x7684;&#x5165;&#x53E3;&#xFF0C;&#x8FD9;&#x4E5F;&#x662F;struts2&#x548C;springmvc&#x4E0D;&#x540C;&#x70B9;&#x4E4B;&#x4E00;&#xFF0C;struts2&#x662F;&#x901A;&#x8FC7;filter&#x7684;&#xFF0C;&#x800C;springmvc&#x662F;&#x901A;&#x8FC7;servlet&#x7684;&#x3002;&#x770B;&#x4E0B;servlet&#x7684;&#x7ED3;&#x6784;&#x56FE;
<img src="/images/dispatcherServlet_in_Spring.png" alt="&#x7ED3;&#x6784;&#x56FE;">
<img src="/images/dispatcherServetl_diagram_in_spring.png" alt="&#x7C7B;&#x56FE;"></p>
<p>&#x4ECE;&#x4E0A;&#x9762;&#x8FD9;&#x5F20;&#x56FE;&#x5F88;&#x660E;&#x663E;&#x53EF;&#x4EE5;&#x770B;&#x51FA;DispatcherServlet&#x548C;Servlet&#x4EE5;&#x53CA;Spring&#x7684;&#x5173;&#x7CFB;&#x3002;&#x800C;&#x6211;&#x4EEC;&#x4ECA;&#x5929;&#x7684;&#x91CD;&#x70B9;&#x5C31;&#x4ECE;DispatchServlet&#x8BF4;&#x8D77;&#x3002;</p>
<p>&#x5728;&#x5206;&#x6790;&#x4E4B;&#x524D;&#x6211;&#x7528;SpringBoot&#x642D;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x5F88;&#x7B80;&#x5355;&#x7684;&#x540E;&#x53F0;&#x9879;&#x76EE;&#xFF0C;&#x7528;&#x4E8E;&#x5206;&#x6790;&#x3002;&#x4EE3;&#x7801;&#x5982;&#x4E0B;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Builder;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="annotation">@Data</span></span><br><span class="line"><span class="annotation">@Builder</span></span><br><span class="line"><span class="annotation">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>{</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> Integer id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>{</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line">* <span class="doctag">@author</span> generalthink</span><br><span class="line">*/</span></span><br><span class="line"><span class="annotation">@RestController</span></span><br><span class="line"><span class="annotation">@RequestMapping</span>(<span class="string">&quot;/user&quot;</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>{</span><br><span class="line"></span><br><span class="line"><span class="annotation">@RequestMapping</span>(value = <span class="string">&quot;/{id}&quot;</span>,method = RequestMethod.GET)</span><br><span class="line"><span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">(HttpServletRequest request,@PathVariable Integer id)</span> </span>{</span><br><span class="line"></span><br><span class="line"><span class="comment">//&#x521B;&#x5EFA;&#x4E00;&#x4E2A;user,&#x4E0D;&#x8D70;&#x6570;&#x636E;&#x5E93;&#x53EA;&#x662F;&#x4E3A;&#x4E86;&#x5206;&#x6790;springmvc&#x6E90;&#x7801;</span></span><br><span class="line">User user = User.builder()</span><br><span class="line">.id(id)</span><br><span class="line">.age(ThreadLocalRandom.current().nextInt(<span class="number">30</span>))</span><br><span class="line">.name(<span class="string">&quot;zzz&quot;</span> + id)</span><br><span class="line">.address(<span class="string">&quot;&#x6210;&#x90FD;&#x5E02;&quot;</span>).build();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> user;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="annotation">@RequestMapping</span>(value = <span class="string">&quot;/condition&quot;</span>,method = RequestMethod.GET)</span><br><span class="line"><span class="function"><span class="keyword">public</span> User <span class="title">getByNameOrAge</span><span class="params">(@RequestParam String name,@RequestParam Integer age)</span> </span>{</span><br><span class="line">User user = User.builder().name(name).age(age).address(<span class="string">&quot;&#x6210;&#x90FD;&#x5E02;&quot;</span>).id(<span class="number">2</span>).build();</span><br><span class="line"><span class="keyword">return</span> user;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="annotation">@PostMapping</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Integer <span class="title">saveUser</span><span class="params">(@RequestBody User user)</span> </span>{</span><br><span class="line"></span><br><span class="line">Integer id = user.getName().hashCode() - user.getAge().hashCode();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> id &gt; <span class="number">0</span> ? id : -id;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x91CC;&#x4E3A;&#x4E86;&#x65B9;&#x4FBF;&#x8C03;&#x8BD5;&#x628A;&#x5173;&#x6CE8;&#x70B9;&#x66F4;&#x591A;&#x96C6;&#x4E2D;&#x5728;SpringMVC&#x6E90;&#x7801;&#x4E2D;,&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x7684;&#x6570;&#x636E;&#x90FD;&#x662F;&#x4F2A;&#x9020;&#x7684;&#x3002;&#x800C;&#x4E14;&#x8FD9;&#x91CC;&#x7684;&#x5173;&#x6CE8;&#x70B9;&#x4E5F;&#x96C6;&#x4E2D;&#x5230;&#x4F7F;&#x7528;&#x6CE8;&#x89E3;&#x7684;Controller(org.springframework.stereotype.Controller)&#xFF0C;&#x800C;&#x4E0D;&#x662F;Controller&#x63A5;&#x53E3;(org.springframework.web.servlet.mvc.Controller),&#x8FD9;&#x4E24;&#x8005;&#x7684;&#x533A;&#x522B;&#x4E3B;&#x8981;&#x5728;&#x610F;&#x4E00;&#x4E2A;&#x53EA;&#x7528;&#x6807;&#x6CE8;&#x6CE8;&#x89E3;&#xFF0C;&#x4E00;&#x4E2A;&#x9700;&#x8981;&#x5B9E;&#x73B0;&#x63A5;&#x53E3;&#xFF0C;&#x4F46;&#x662F;&#x5B83;&#x4EEC;&#x90FD;&#x80FD;&#x5B8C;&#x6210;&#x5904;&#x7406;&#x8BF7;&#x6C42;&#x7684;&#x57FA;&#x672C;&#x529F;&#x80FD;&#x3002;&#x6211;&#x4EEC;&#x90FD;&#x77E5;&#x9053;&#x8BBF;&#x95EE;servlet&#x7684;&#x65F6;&#x5019;&#x9ED8;&#x8BA4;&#x662F;&#x8BBF;&#x95EE;service&#x65B9;&#x6CD5;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x5C06;&#x65AD;&#x70B9;&#x6253;&#x5728;HttpServlet&#x7684;service&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x6B64;&#x65F6;&#x67E5;&#x770B;&#x6574;&#x4E2A;&#x8C03;&#x7528;&#x6808;&#x5982;&#x4E0B;
<img src="/images/dispatcherServlet_invoke_stack.png" alt="&#x8C03;&#x7528;&#x6808;"></p>
<p>&#x4ECE;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x4E5F;&#x77E5;&#x9053;&#x4E86;&#x8BF7;&#x6C42;&#x65F6;&#x5982;&#x4F55;&#x4ECE;servlet&#x5230;&#x4E86;DispatcherServlet&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x5148;&#x6765;&#x770B;&#x4E00;&#x4E0B;DispatcherServlet&#x7684;doDiapatch&#x7684;&#x65B9;&#x6CD5;&#x903B;&#x8F91;&#xFF0C;&#x8FD9;&#x91CC;&#x628A;&#x6838;&#x5FC3;&#x903B;&#x8F91;&#x5217;&#x51FA;&#x6765;&#x4E86;&#xFF0C;&#x628A;&#x5176;&#x4ED6;&#x7684;&#x4E00;&#x4E9B;&#x975E;&#x6838;&#x5FC3;&#x903B;&#x8F91;&#x79FB;&#x9664;&#x4E86;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doDispatch</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        HttpServletRequest processedRequest = request;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//&#x6CE8;&#x610F;&#x8FD9;&#x91CC;&#x653E;&#x56DE;&#x7684;&#x662F;HandlerExecutionChain&#x5BF9;&#x8C61;</span></span><br><span class="line">        HandlerExecutionChain mappedHandler = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">boolean</span> multipartRequestParsed = <span class="keyword">false</span>;</span><br><span class="line">        </span><br><span class="line">            ModelAndView mv = <span class="keyword">null</span>;</span><br><span class="line">            Exception dispatchException = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//&#x68C0;&#x67E5;&#x662F;&#x5426;&#x5B58;&#x5728;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;</span></span><br><span class="line">            processedRequest = checkMultipart(request);</span><br><span class="line">            multipartRequestParsed = (processedRequest != request);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// &#x6839;&#x636E;&#x5F53;&#x524D;request&#x83B7;&#x53D6;handler,handler&#x4E2D;&#x5305;&#x542B;&#x4E86;&#x8BF7;&#x6C42;url,&#x4EE5;&#x53CA;&#x6700;&#x7EC8;&#x5B9A;&#x4F4D;&#x5230;&#x7684;controller&#x4EE5;&#x53CA;controller&#x4E2D;&#x7684;&#x65B9;&#x6CD5;</span></span><br><span class="line">            mappedHandler = getHandler(processedRequest);</span><br><span class="line">            <span class="keyword">if</span> (mappedHandler == <span class="keyword">null</span>) {</span><br><span class="line">                noHandlerFound(processedRequest, response);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="comment">// &#x901A;&#x8FC7;handler&#x83B7;&#x53D6;&#x5BF9;&#x5E94;&#x7684;&#x9002;&#x914D;&#x5668;,&#x4E3B;&#x8981;&#x5B8C;&#x6210;&#x53C2;&#x6570;&#x89E3;&#x6790;</span></span><br><span class="line">            HandlerAdapter ha = getHandlerAdapter(mappedHandler.getHandler());</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (!mappedHandler.applyPreHandle(processedRequest, response)) {</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="comment">// &#x8C03;&#x7528;Controller&#x4E2D;&#x7684;&#x65B9;&#x6CD5;</span></span><br><span class="line">            mv = ha.handle(processedRequest, response, mappedHandler.getHandler());</span><br><span class="line"></span><br><span class="line">            applyDefaultViewName(processedRequest, mv);</span><br><span class="line">            mappedHandler.applyPostHandle(processedRequest, response, mv);</span><br><span class="line">        </span><br><span class="line">            processDispatchResult(processedRequest, response, mappedHandler, mv, dispatchException);</span><br><span class="line">        </span><br><span class="line">    }</span><br></pre></td></tr></table></figure></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6838;&#x5FC3;&#x903B;&#x8F91;&#x5176;&#x5B9E;&#x975E;&#x5E38;&#x7B80;&#x5355;&#xFF0C;&#x9996;&#x5148;&#x68C0;&#x67E5;&#x662F;&#x4E0D;&#x662F;multipart request&#xFF0C;&#x5982;&#x679C;&#x662F;&#x5219;&#x5BF9;&#x5F53;&#x524D;&#x7684;request&#x8FDB;&#x884C;&#x4E00;&#x5B9A;&#x7684;&#x5C01;&#x88C5;(&#x63D0;&#x53D6;&#x6587;&#x4EF6;&#x7B49;&#xFF09;&#xFF0C;&#x7136;&#x540E;&#x83B7;&#x53D6;&#x5BF9;&#x5E94;&#x7684;handler(&#x4FDD;&#x5B58;&#x4E86;&#x8BF7;&#x6C42;url&#x5BF9;&#x5E94;&#x7684;controller&#x4EE5;&#x53CA;method&#x4EE5;&#x53CA;&#x4E00;&#x7CFB;&#x5217;&#x7684;Interceptor),&#x7136;&#x540E;&#x5728;&#x901A;&#x8FC7;handler&#x83B7;&#x53D6;&#x5230;&#x5BF9;&#x5E94;&#x7684;handlerAdapter(&#x53C2;&#x6570;&#x7EC4;&#x88C5;)&#xFF0C;&#x901A;&#x8FC7;&#x5B83;&#x6765;&#x8FDB;&#x884C;&#x6700;&#x7EC8;&#x65B9;&#x6CD5;&#x7684;&#x8C03;&#x7528;</p>
<h3 id="&#x89E3;&#x6790;multipart">&#x89E3;&#x6790;multipart</h3>
<p>&#x90A3;&#x4E48;&#x662F;&#x5982;&#x4F55;&#x89E3;&#x6790;&#x5F53;&#x524D;&#x8BF7;&#x6C42;&#x662F;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x8BF7;&#x6C42;&#x5462;&#xFF1F;&#x8FD9;&#x91CC;&#x76F4;&#x63A5;&#x8FDB;&#x5165;&#x5230;checkMultipart&#x65B9;&#x6CD5;&#x770B;&#x770B;&#x662F;&#x5982;&#x4F55;&#x89E3;&#x6790;&#x7684;&#xFF1A;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//&#x6211;&#x7CBE;&#x7B80;&#x4E86;&#x4E0B;&#x4EE3;&#x7801;&#xFF0C;&#x53EA;&#x63D0;&#x53D6;&#x4E86;&#x6838;&#x5FC3;&#x903B;&#x8F91;</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> HttpServletRequest <span class="title">checkMultipart</span><span class="params">(HttpServletRequest request)</span> <span class="keyword">throws</span> MultipartException </span>{</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.multipartResolver != <span class="keyword">null</span> &amp;&amp; <span class="keyword">this</span>.multipartResolver.isMultipart(request)) {        </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.multipartResolver.resolveMultipart(request);    </span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> request;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x4ECE;&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x901A;&#x8FC7;multipartResolver&#x5224;&#x65AD;&#x5F53;&#x524D;&#x8BF7;&#x6C42;&#x662F;&#x5426;&#x662F;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x8BF7;&#x6C42;,&#x5982;&#x679C;&#x662F;&#x5219;&#x8FD4;&#x56DE;MultipartHttpServletRequest(&#x7EE7;&#x627F;&#x81EA;HttpServletRequest).&#x4E0D;&#x662F;&#x5219;&#x8FD4;&#x56DE;&#x539F;&#x672C;request&#x5BF9;&#x8C61;&#x3002;
&#x90A3;&#x4E48;&#x95EE;&#x9898;&#x6765;&#x4E86;multipartResolver&#x662F;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x521D;&#x59CB;&#x5316;&#x7684;&#x5462;&#xFF1F;</p>
<p>&#x6211;&#x4EEC;&#x5728;idea&#x4E2D;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5C06;&#x65AD;&#x70B9;&#x5B9A;&#x4F4D;&#x5230;multipartResolver&#x5C5E;&#x6027;&#x4E0A;&#xFF0C;&#x8FDB;&#x884C;&#x8BF7;&#x6C42;&#x8BBF;&#x95EE;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x4F1A;&#x53D1;&#x73B0;&#x65AD;&#x70B9;&#x76F4;&#x63A5;&#x8FDB;&#x5165;&#x5230;&#x4E86;initMultipartResolver&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x63A5;&#x7740;&#x8DDF;&#x8E2A;&#x6574;&#x4E2A;&#x8C03;&#x7528;&#x6808;&#xFF0C;&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x8C03;&#x7528;&#x5173;&#x7CFB;&#x5982;&#x4E0B;&#xFF1A;
<img src="/images/init_mulitpartResovler_in_SpringMVC.png" alt="&#x521D;&#x59CB;&#x5316;multipartResovler"></p>
<p>&#x56FE;&#x4E0A;&#x8868;&#x660E;&#x4E86;&#x662F;&#x5728;&#x521D;&#x59CB;&#x5316;servlet&#x7684;&#x65F6;&#x5019;&#x5BF9;multipartResolver&#x8FDB;&#x884C;&#x4E86;&#x521D;&#x59CB;&#x5316;&#x7684;&#x3002;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initMultipartResolver</span><span class="params">(ApplicationContext context)</span> </span>{</span><br><span class="line"></span><br><span class="line"><span class="comment">//&#x4ECE;Spring&#x4E2D;&#x83B7;&#x53D6;id&#x4E3A;multipartResolver&#x7684;&#x7C7B;</span></span><br><span class="line">    <span class="keyword">this</span>.multipartResolver = context.getBean(<span class="string">&quot;multipartResolver&quot;</span>, MultipartResolver.class);</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>MultipartResolver&#x63A5;&#x53E3;&#x6709;CommonsMultipartResolver&#x4EE5;&#x53CA;StandardServletMultipartResolver2&#x79CD;&#x5B9E;&#x73B0;&#xFF0C;CommonsMultipartResolver&#x63A5;&#x53E3;&#x662F;&#x4F9D;&#x8D56;&#x4E8E;commons-upload&#x7EC4;&#x4EF6;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x800C; StandardServletMultipartResolver&#x662F;&#x4F9D;&#x8D56;&#x4E8E;Servlet&#x7684;part(servlet3&#x624D;&#x5B58;&#x5728;)&#x5B9E;&#x73B0;&#x7684;.&#x4E24;&#x8005;&#x5224;&#x65AD;&#x662F;&#x5426;&#x662F;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x8BF7;&#x6C42;&#x7684;&#x65B9;&#x6CD5;isMultipart&#x5747;&#x662F;&#x901A;&#x8FC7;&#x5224;&#x5B9A;&#x8BF7;&#x6C42;&#x65B9;&#x6CD5;&#x662F;&#x5426;&#x4E3A;post&#x4EE5;&#x53CA;content-type&#x5934;&#x662F;&#x5426;&#x5305;&#x542B;multipart/&#x6765;&#x8FDB;&#x884C;&#x5224;&#x5B9A;&#x7684;&#x3002;</p>
<h3 id="dispatchservlet&#x521D;&#x59CB;&#x5316;&#x4E86;&#x54EA;&#x4E9B;&#x5185;&#x5BB9;">DispatchServlet&#x521D;&#x59CB;&#x5316;&#x4E86;&#x54EA;&#x4E9B;&#x5185;&#x5BB9;</h3>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">initStrategies</span><span class="params">(ApplicationContext context)</span> </span>{</span><br><span class="line">   initMultipartResolver(context);  <span class="comment">//&#x521D;&#x59CB;&#x5316;multipartResolver</span></span><br><span class="line">   initLocaleResolver(context);<span class="comment">//&#x521D;&#x59CB;&#x5316;localeResolver</span></span><br><span class="line">   initThemeResolver(context);<span class="comment">//&#x521D;&#x59CB;&#x5316;themResolver</span></span><br><span class="line">   initHandlerMappings(context);<span class="comment">//&#x521D;&#x59CB;&#x5316;handerMappings</span></span><br><span class="line">   initHandlerAdapters(context);<span class="comment">//&#x521D;&#x59CB;&#x5316;handlerAdapters</span></span><br><span class="line">   initHandlerExceptionResolvers(context);</span><br><span class="line">   initRequestToViewNameTranslator(context);</span><br><span class="line">   initViewResolvers(context);<span class="comment">//&#x521D;&#x59CB;&#x5316;&#x8BD5;&#x56FE;&#x89E3;&#x6790;&#x5668;</span></span><br><span class="line">   initFlashMapManager(context);</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x4E9B;&#x521D;&#x59CB;&#x5316;&#x7684;&#x5185;&#x5BB9;&#x90FD;&#x4F1A;&#x5728;&#x540E;&#x9762;&#x88AB;&#x9010;&#x4E00;&#x4F7F;&#x7528;&#xFF0C;&#x8FD9;&#x91CC;&#x5148;&#x6709;&#x4E00;&#x4E2A;&#x5370;&#x8C61;&#x3002;</p>
<h3 id="&#x6839;&#x636E;&#x8BF7;&#x6C42;&#x83B7;&#x53D6;mapperhandler">&#x6839;&#x636E;&#x8BF7;&#x6C42;&#x83B7;&#x53D6;mapperHandler</h3>
<p>&#x8FD8;&#x662F;&#x8FDB;&#x5165;&#x5230;getHander&#x65B9;&#x6CD5;&#x4E2D;&#x770B;&#x770B;&#x5230;&#x5E95;&#x505A;&#x4E86;&#x4EC0;&#x4E48;&#xFF1F;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Nullable</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> HandlerExecutionChain <span class="title">getHandler</span><span class="params">(HttpServletRequest request)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>.handlerMappings != <span class="keyword">null</span>) {</span><br><span class="line">    <span class="keyword">for</span> (HandlerMapping hm : <span class="keyword">this</span>.handlerMappings) {</span><br><span class="line">        HandlerExecutionChain handler = hm.getHandler(request);</span><br><span class="line">        <span class="keyword">if</span> (handler != <span class="keyword">null</span>) {</span><br><span class="line">            <span class="keyword">return</span> handler;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x6839;&#x636E;HandlerMapping&#x6765;&#x67E5;&#x770B;&#x5BF9;&#x5E94;&#x7684;handler,&#x90A3;&#x4E48;&#x8FDB;&#x5165;&#x5230;initHandlerMappings&#x65B9;&#x6CD5;&#x4E2D;&#x67E5;&#x770B;&#x5982;&#x4F55;&#x521D;&#x59CB;&#x5316;handlerMappings</p>
<p><img src="/images/init_handlerMapping_in_springmvc.png" alt="&#x521D;&#x59CB;&#x5316;handlerMappings"></p>
<p>&#x5176;&#x4E2D;&#x83B7;&#x53D6;&#x9ED8;&#x8BA4;&#x7684;handlerMappings&#x662F;&#x53BB;spring-webmvc&#x7684;org.springframework.web.servlet&#x4E2D;&#x7684;DispatcherServlet.properties&#x4E2D;&#x67E5;&#x627E;&#xFF0C;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x662F;&#x8FD9;&#x6837;&#x7684;</p>
<p><img src="/images/DispatcherServlet.properties.png" alt="DispatcherServlet.properties">
&#x56E0;&#x4E3A;detechAllhanderMappings&#x9ED8;&#x8BA4;&#x4E3A;true&#xFF0C;&#x6240;&#x4EE5;&#x4F1A;&#x83B7;&#x53D6;&#x5230;&#x6240;&#x6709;HanderMapping&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#xFF0C;&#x6765;&#x770B;&#x770B;&#x5B83;&#x7684;&#x7C7B;&#x56FE;&#x7ED3;&#x6784;&#x662F;&#x600E;&#x6837;&#x7684;
<img src="/images/handlerMapping_interface_structure_in_springmvc.png" alt="HandlerMapping&#x7C7B;&#x56FE;"></p>
<p><img src="/images/this.handlerMappings_in_springmvc.png" alt="this.handlerMappings&#x7684;&#x503C;"></p>
<p>&#x8FD9;&#x51E0;&#x4E2A;HandlerMapping&#x7684;&#x4F5C;&#x7528;&#x5982;&#x4E0B;&#xFF1A;
SimpleUrlHandlerMapping : &#x5141;&#x8BB8;&#x660E;&#x786E;&#x6307;&#x5B9A;URL&#x6A21;&#x5F0F;&#x548C;Handler&#x7684;&#x6620;&#x5C04;&#x5173;&#x7CFB;&#xFF0C;&#x5185;&#x90E8;&#x7EF4;&#x62A4;&#x4E86;&#x4E00;&#x4E2A;urlMap&#x6765;&#x786E;&#x5B9A;url&#x548C;handler&#x7684;&#x5173;&#x7CFB;
BeanNameUrlHandlerMapping:  &#x6307;&#x5B9A;URL&#x548C;bean&#x540D;&#x79F0;&#x7684;&#x6620;&#x5C04;&#x5173;&#x7CFB;&#xFF0C;&#x4E0D;&#x5E38;&#x7528;&#xFF0C;&#x6211;&#x4EEC;&#x7684;&#x5173;&#x6CE8;&#x70B9;&#x4E5F;&#x4E3B;&#x8981;&#x96C6;&#x4E2D;&#x5728;RequestMappingHandlerMapping&#x4E2D;</p>
<p>&#x8FD9;&#x91CC;&#x4E5F;&#x57FA;&#x672C;&#x660E;&#x786E;&#x4E86;HandlerMapping&#x7684;&#x4F5C;&#x7528;:&#x5E2E;&#x52A9;DispatcherServlet&#x8FDB;&#x884C;Web&#x8BF7;&#x6C42;&#x7684;URL&#x5230;&#x5177;&#x4F53;&#x7C7B;&#x7684;&#x5339;&#x914D;,&#x4E4B;&#x6240;&#x4EE5;&#x79F0;&#x4E3A;HandlerMapping&#x662F;&#x56E0;&#x4E3A;&#x5728;SpringMVC&#x4E2D;&#x5E76;&#x4E0D;&#x5C40;&#x9650;&#x4E8E;
&#x5FC5;&#x987B;&#x4F7F;&#x7528;&#x6CE8;&#x89E3;&#x7684;Controller&#x6211;&#x4EEC;&#x4E5F;&#x53EF;&#x4EE5;&#x7EE7;&#x627F;Controller&#x63A5;&#x53E3;&#xFF0C;&#x4E5F;&#x540C;&#x6837;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7B2C;&#x4E09;&#x65B9;&#x63A5;&#x53E3;&#xFF0C;&#x6BD4;&#x5982;Struts2&#x4E2D;&#x7684;Action
<img src="/images/RequestMappingHandlerMapping.png" alt="RequestMappingHandlerMapping"></p>
<p>&#x63A5;&#x7740;&#x770B;&#x4E0B;getHandler&#x7684;&#x5B9E;&#x73B0;&#xFF1A;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Nullable</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> HandlerExecutionChain <span class="title">getHandler</span><span class="params">(HttpServletRequest request)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">   <span class="keyword">if</span> (<span class="keyword">this</span>.handlerMappings != <span class="keyword">null</span>) {</span><br><span class="line">      <span class="keyword">for</span> (HandlerMapping hm : <span class="keyword">this</span>.handlerMappings) {</span><br><span class="line">         HandlerExecutionChain handler = hm.getHandler(request);</span><br><span class="line">         <span class="keyword">if</span> (handler != <span class="keyword">null</span>) {</span><br><span class="line">            <span class="keyword">return</span> handler;</span><br><span class="line">         }</span><br><span class="line">      }</span><br><span class="line">   }</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD4;&#x56DE;&#x7684;handler&#x662F;HandlerExecutionChain,&#x8FD9;&#x5176;&#x4E2D;&#x5305;&#x542B;&#x4E86;&#x771F;&#x5B9E;&#x7684;handler&#x4EE5;&#x53CA;&#x62E6;&#x51FB;&#x5668;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x6267;&#x884C;&#x524D;,&#x6267;&#x884C;&#x540E;&#xFF0C;&#x6267;&#x884C;&#x5B8C;&#x6210;&#x8FD9;&#x4E09;&#x4E2A;&#x9636;&#x6BB5;&#x5904;&#x7406;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x3002;
RequestMappingHandlerMapping&#x7684;getHandler&#x7684;&#x8C03;&#x7528;&#x903B;&#x8F91;&#x5982;&#x4E0B;&#xFF1A;
<img src="/images/handlerMapping_invoke_logic_in_springmvc.png" alt="&#x8C03;&#x7528;&#x903B;&#x8F91;"></p>
<p>&#x4F1A;&#x904D;&#x5386;&#x6240;&#x6709;Controller&#x7684;url&#x67E5;&#x770B;&#x662F;&#x5426;&#x6709;&#x7B26;&#x5408;&#x6761;&#x4EF6;&#x7684;match(head,url,produce,consume&#xFF0C;method&#x90FD;&#x8981;&#x6EE1;&#x8DB3;&#x8981;&#x6C42;),&#x91C7;&#x7528;antMatcher&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x8FDB;&#x884C;url&#x5339;&#x914D;&#xFF0C;&#x5982;&#x679C;&#x5339;&#x914D;&#x4E0A;&#x4E86;&#x5219;&#x8FD4;&#x56DE;&#x5BF9;&#x5E94;&#x7684;handler&#xFF0C;&#x5426;&#x5219;&#x8FD4;&#x56DE;null,&#x5982;&#x679C;&#x6620;&#x5C04;&#x53D1;&#x73B0;&#x6709;&#x91CD;&#x590D;&#x7684;&#x6620;&#x5C04;&#xFF08;url&#x6620;&#x5C04;&#x76F8;&#x540C;&#xFF0C;&#x8BF7;&#x6C42;&#x65B9;&#x6CD5;&#x76F8;&#x540C;&#xFF0C;&#x53C2;&#x6570;&#x76F8;&#x540C;&#xFF0C;&#x8BF7;&#x6C42;&#x5934;&#x76F8;&#x540C;&#xFF0C;consume&#x76F8;&#x540C;&#xFF0C;produce&#x76F8;&#x540C;&#xFF0C;&#x81EA;&#x5B9A;&#x4E49;&#x53C2;&#x6570;&#x76F8;&#x540C;&#xFF09;&#xFF0C;&#x5219;&#x4F1A;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x3002;</p>
<p>&#x800C;SimpleUrlHandlerMapping&#x7684;&#x8C03;&#x7528;&#x903B;&#x8F91;&#x5982;&#x4E0B;&#xFF1A;
<img src="/images/simple_url_handlerMapping_invoke_logic.png" alt="SimpleUrlHandlerMapping&#x8C03;&#x7528;&#x903B;&#x8F91;"></p>
<p>&#x5176;&#x4E2D;&#x7EF4;&#x62A4;&#x4E86;url&#x5230;handler&#x7684;&#x6620;&#x5C04;&#xFF0C;&#x5148;&#x901A;&#x8FC7;url&#x5230;urlMap&#x4E2D;&#x627E;&#x5BF9;&#x5E94;&#x7684;handler&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x627E;&#x5230;&#x5219;&#x5C1D;&#x8BD5;pattenMatch&#xFF0C;&#x6210;&#x529F;&#x5219;&#x8FD4;&#x56DE;&#x5BF9;&#x5E94;&#x7684;handler,&#x672A;&#x5339;&#x914D;&#x5219;&#x8FD4;&#x56DE;null&#x3002;</p>
<p>&#x4F1A;&#x53D1;&#x73B0;&#x5904;&#x7406;HandlerMapping&#x8FD9;&#x91CC;&#x8FD0;&#x7528;&#x4E86;&#x6A21;&#x677F;&#x65B9;&#x6CD5;&#xFF0C;&#x5728;&#x62BD;&#x8C61;&#x7C7B;&#x4E2D;&#x5B9A;&#x4E49;&#x597D;&#x4E86;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#xFF0C;&#x5177;&#x4F53;&#x5B9E;&#x73B0;&#x53EA;&#x9700;&#x8981;&#x5B9E;&#x73B0;&#x81EA;&#x5DF1;&#x7684;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x5373;&#x53EF;&#x3002;&#x540C;&#x65F6;&#x4E5F;&#x7B26;&#x5408;&#x5F00;&#x95ED;&#x539F;&#x5219;&#xFF0C;&#x5B8C;&#x5168;&#x662F;&#x9762;&#x5411;&#x63A5;&#x53E3;&#x7F16;&#x7A0B;&#xFF0C;&#x4E0D;&#x5F97;&#x4E0D;&#x8BA9;&#x4EBA;&#x53F9;&#x670D;&#x8FD9;&#x91CC;&#x7684;&#x6D89;&#x53CA;&#x903B;&#x8F91;&#x3002;</p>
<p>&#x5206;&#x6790;&#x5230;&#x8FD9;&#x91CC;&#x7684;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x4F1A;&#x53D1;&#x73B0;&#x6211;&#x4EEC;&#x4E4B;&#x524D;&#x5B9A;&#x4E49;&#x7684;Controller&#x660E;&#x663E;&#x662F;&#x7B26;&#x5408;RequestMappingHandlerMapping&#x7684;&#x7B56;&#x7565;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x8FD4;&#x56DE;&#x7684;HandlerExecutionChain&#x5DF2;&#x7ECF;&#x5305;&#x542B;&#x4E86;&#x9700;&#x8981;&#x8BBF;&#x95EE;&#x7684;&#x65B9;&#x6CD5;&#x7684;&#x5168;&#x8DEF;&#x5F84;&#x4E86;&#x3002;</p>
<h3 id="&#x5173;&#x4E8E;handleradapter">&#x5173;&#x4E8E;HandlerAdapter</h3>
<p>HandlerMapping&#x4F1A;&#x901A;&#x8FC7;HandlerExecutionChain&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;Object&#x7C7B;&#x578B;&#x7684;Handler&#x5BF9;&#x8C61;&#xFF0C;&#x7528;&#x4E8E;Web&#x8BF7;&#x6C42;&#x5904;&#x7406;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;Handler&#x5E76;&#x6CA1;&#x6709;&#x9650;&#x5236;&#x5177;&#x4F53;&#x662F;&#x4EC0;&#x4E48;&#x7C7B;&#x578B;&#xFF0C;&#x4E00;&#x822C;&#x6765;&#x8BF4;&#x4EFB;&#x4F55;&#x7C7B;&#x578B;&#x7684;Handler&#x90FD;&#x53EF;&#x4EE5;&#x5728;
SpringMVC&#x4E2D;&#x4F7F;&#x7528;&#xFF0C;&#x53EA;&#x8981;&#x5B83;&#x662F;&#x7528;&#x4E8E;&#x5904;&#x7406;Web&#x8BF7;&#x6C42;&#x7684;&#x5904;&#x7406;&#x5BF9;&#x8C61;&#x5C31;&#x884C;&#x3002;</p>
<p>&#x4E0D;&#x8FC7;&#x5BF9;&#x4E8E;DispatcherServlet&#x6765;&#x8BF4;&#x5C31;&#x5B58;&#x5728;&#x95EE;&#x9898;&#x4E86;&#xFF0C;&#x5B83;&#x65E0;&#x6CD5;&#x5224;&#x65AD;&#x5230;&#x5E95;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x4EC0;&#x4E48;&#x7C7B;&#x578B;&#x7684;Handler&#xFF0C;&#x4E5F;&#x65E0;&#x6CD5;&#x77E5;&#x9053;&#x662F;&#x8C03;&#x7528;Handler&#x7684;&#x54EA;&#x4E2A;&#x65B9;&#x6CD5;&#x6765;&#x5904;&#x7406;&#x8BF7;&#x6C42;&#xFF0C;&#x4E3A;&#x4E86;&#x4EE5;&#x540C;&#x610F;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x8C03;&#x7528;&#x5404;&#x79CD;&#x7C7B;&#x578B;&#x7684;Handler,
DispatcherServlet&#x5C06;&#x4E0D;&#x540C;Handler&#x7684;&#x8C03;&#x7528;&#x804C;&#x8D23;&#x8F6C;&#x4EA4;&#x7ED9;&#x4E86;&#x4E00;&#x4E2A;&#x6210;&#x4E3A;HandlerAdapter&#x7684;&#x89D2;&#x8272;&#x3002;</p>
<p>&#x5148;&#x770B;&#x4E00;&#x4E0B;HandlerAdpter&#x63A5;&#x53E3;&#x7684;&#x5B9A;&#x4E49;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">HandlerAdapter</span> </span>{</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(Object handler)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="annotation">@Nullable</span></span><br><span class="line"><span class="function">ModelAndView <span class="title">handle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">getLastModified</span><span class="params">(HttpServletRequest request, Object handler)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x4E3B;&#x8981;&#x5173;&#x6CE8;supports&#x548C;handle&#x65B9;&#x6CD5;&#x3002;&#x5148;&#x770B;&#x4E0B;DispatcherServlet&#x4E2D;handlerAdapters&#x7684;&#x521D;&#x59CB;&#x5316;&#x8FC7;&#x7A0B;&#xFF0C;&#x548C;handlerMappings&#x7684;&#x521D;&#x59CB;&#x5316;&#x8FC7;&#x7A0B;&#x662F;&#x7C7B;&#x4F3C;&#x7684;
<img src="/images/init_handlerAdapters_in_springmvc.png" alt="&#x521D;&#x59CB;&#x5316;HandlerAdapters"></p>
<p>&#x63A5;&#x7740;&#x5728;&#x770B;&#x4E00;&#x4E0B;HandlerAdapter&#x7684;&#x7C7B;&#x5173;&#x7CFB;
<img src="/images/handlerAdpater_class_diagram.png" alt="HandlerAdapter&#x7C7B;&#x56FE;"></p>
<p>&#x540C;&#x6837;&#x7684;&#xFF0C;&#x4ECD;&#x7136;&#x901A;&#x8FC7;&#x5408;&#x9002;&#x7684;&#x7B56;&#x7565;&#x5BFB;&#x627E;&#x5BF9;&#x5E94;&#x7684;Adapter&#xFF0C;&#x6211;&#x4EEC;&#x4E3B;&#x8981;&#x5173;&#x6CE8;&#x7684;&#x662F;RequestMappingHandlerAdapter(&#x5176;&#x4ED6;&#x7684;&#x7528;&#x5F97;&#x5F88;&#x5C11;)&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x5C31;&#x4E3B;&#x8981;&#x8BB2;&#x89E3;&#x5B83;&#x3002;&#x67E5;&#x770B;&#x5B83;support&#x7684;&#x5B9E;&#x73B0;&#x4EE3;&#x7801;&#xFF1A;
<img src="/images/handler_adapter_supports_method.png" alt="supports&#x65B9;&#x6CD5;"></p>
<p>&#x5728;&#x4E0A;&#x9762;&#x5173;&#x4E8E;handler&#x7684;&#x8BF4;&#x660E;&#x4E2D;&#x8BF4;&#x4E86;&#x5176;&#x5B9E;Object handler&#x5B9E;&#x9645;&#x4E0A;&#x662F;HandlerMethod&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x5BF9;&#x5E94;&#x7684;HandlerAdapter&#x5C31;&#x662F;RequestMappingHandlerAdapter&#x3002;</p>
<p>&#x627E;&#x5230;&#x5BF9;&#x5E94;&#x7684;&#x9002;&#x914D;&#x5668;&#x4E4B;&#x540E;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x5C31;&#x53EF;&#x4EE5;&#x8C03;&#x7528;&#x771F;&#x6B63;&#x7684;&#x903B;&#x8F91;&#x4E86;&#x3002;&#x5728;&#x8FD9;&#x4E4B;&#x524D;&#x4F7F;&#x7528;&#x8005;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x62E6;&#x622A;&#x5668;&#x505A;&#x4E00;&#x4E9B;&#x4E8B;&#x513F;&#xFF0C;&#x6BD4;&#x5982;&#x8BB0;&#x5F55;&#x65E5;&#x5FD7;&#xFF0C;&#x6253;&#x5370;&#x6267;&#x884C;&#x65F6;&#x95F4;&#x7B49;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x60F3;&#x8981;&#x5728;&#x6267;&#x884C;&#x7684;&#x65B9;&#x6CD5;&#x4E4B;&#x524D;&#x6DFB;&#x52A0;&#x4E00;&#x6761;&#x8BED;&#x53E5;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x914D;&#x7F6E;&#x81EA;&#x5DF1;&#x7684;&#x62E6;&#x51FB;&#x5668;&#x5373;&#x53EF;&#x3002;
<img src="/images/handlerInterceptors_invoke.png" alt="&#x6267;&#x884C;&#x62E6;&#x622A;&#x5668;&#x65B9;&#x6CD5;"></p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x91CD;&#x70B9;&#x5206;&#x6790;handle&#x65B9;&#x6CD5;&#xFF0C;&#x770B;&#x770B;&#x5B83;&#x5230;&#x5E95;&#x4F1A;&#x505A;&#x4EC0;&#x4E48;&#xFF1F;&#xFF0C;&#x5148;&#x770B;&#x4E00;&#x4E0B;handle&#x65B9;&#x6CD5;&#x7684;&#x6267;&#x884C;&#x6D41;&#x7A0B;&#xFF0C;&#x540C;&#x6837;&#x7684;adapter&#x540C;&#x6837;&#x4F7F;&#x7528;&#x4E86;&#x6A21;&#x677F;&#x65B9;&#x6CD5;&#xFF0C;&#x5148;&#x5728;&#x7236;&#x7C7B;&#x91CC;&#x9762;&#x5B9A;&#x4E49;&#x6D41;&#x7A0B;&#xFF0C;&#x5B50;&#x7C7B;&#x53EA;&#x9700;&#x8981;&#x5B9E;&#x73B0;&#x903B;&#x8F91;&#x5373;&#x53EF;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x9996;&#x5148;&#x4F1A;&#x8C03;&#x7528;AbstracthandlerMethodAdapter&#x7684;invokeHadlerMethod&#x65B9;&#x6CD5;&#xFF0C;&#x5176;&#x4E2D;&#x5BF9;HandlerMethod&#x8FDB;&#x884C;&#x4E86;&#x5C01;&#x88C5;&#x3002;
<img src="/images/invoke_handle_method.png" alt="invokeHandle">
<img src="/images/invoke_and_handle.png" alt="invokeAndHandle"></p>
<p>&#x6211;&#x4EEC;&#x8FDB;&#x5165;&#x5230;&#x7B2C;&#x4E00;&#x6B65;&#xFF0C;&#x770B;&#x770B;invokeForRequest&#x65B9;&#x6CD5;&#x4E2D;&#x4E3B;&#x8981;&#x505A;&#x4E86;&#x4EC0;&#x4E48;
<img src="/images/invoke_for_request.png" alt="invokeForRequest"></p>
<p>&#x53D1;&#x73B0;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x7684;&#x8C03;&#x7528;&#x903B;&#x8F91;&#x5B9E;&#x9645;&#x4E0A;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x5C31;&#x662F;&#x89E3;&#x6790;&#x53C2;&#x6570;&#xFF0C;&#x7136;&#x540E;&#x8C03;&#x7528;&#x65B9;&#x6CD5;&#x3002;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x4E00;&#x4E0B;&#x5982;&#x4F55;&#x8FDB;&#x884C;&#x53C2;&#x6570;&#x89E3;&#x6790;&#x7684;&#x5462;&#xFF1F;
<img src="/images/arguementResolver_resolve.png" alt="&#x53C2;&#x6570;&#x89E3;&#x6790;"></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x51E0;&#x4E4E;&#x6240;&#x6709;&#x7684;&#x6838;&#x5FC3;&#x903B;&#x8F91;&#x90FD;&#x96C6;&#x4E2D;&#x5230;&#x4E86;argumentResovlers&#x4E2D;&#x53BB;&#xFF0C;&#x90A3;&#x4E48;&#x652F;&#x6301;&#x7684;arguementResolver&#x6709;&#x54EA;&#x4E9B;&#xFF1F;&#x53C8;&#x662F;&#x5728;&#x54EA;&#x91CC;&#x521D;&#x59CB;&#x5316;&#x7684;&#x5462;&#xFF1F;</p>
<p>&#x9996;&#x5148;&#x9700;&#x8981;&#x5B9A;&#x4F4D;&#x5230;&#x8FD9;&#x4E2A;&#x5C5E;&#x6027;&#x662F;&#x4ECE;&#x54EA;&#x91CC;&#x8FC7;&#x6765;&#x7684;&#xFF0C;RequestMappingHandlerAdapter&#x5B9E;&#x73B0;&#x4E86;InitializingBean&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x521D;&#x59CB;&#x5316;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x6267;&#x884C;afterPropertiesSet&#x65B9;&#x6CD5;&#xFF0C;&#x5728;&#x8FD9;&#x5176;&#x4E2D;&#x5BF9;arguementResolvers&#x4EE5;&#x53CA;returnValueHandlers&#x8FDB;&#x884C;&#x4E86;&#x521D;&#x59CB;&#x5316;&#x3002;
&#x4E0D;&#x540C;&#x7684;resovler&#x652F;&#x6301;&#x7684;&#x53C2;&#x6570;&#x89E3;&#x6790;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;&#x6BD4;&#x5982;&#x8BF4;&#x6709;&#x652F;&#x6301;HttpServletRequest&#x6CE8;&#x5165;&#x7684;&#xFF0C;&#x6709;&#x652F;&#x6301;HttpServletREsponse&#x6CE8;&#x5165;&#x7684;&#x8FD8;&#x6709;&#x652F;&#x6301;body&#x4F53;&#x6CE8;&#x5165;&#x7684;&#x7B49;&#x7B49;&#x3002;
<img src="/images/getDefaultArgumentResolver.png" alt="arguementResovler&#x521D;&#x59CB;&#x5316;"></p>
<p><img src="/images/init_return_value_handlers.png" alt="returnValueHandlers&#x521D;&#x59CB;&#x5316;"></p>
<p>&#x7ECF;&#x8FC7;&#x53C2;&#x6570;&#x89E3;&#x6790;&#x4E4B;&#x540E;&#x5C31;&#x5F97;&#x5230;&#x4E86;&#x53CD;&#x5C04;&#x9700;&#x8981;&#x7684;&#x6570;&#x636E;&#x4E86;,class,method&#x4EE5;&#x53CA;&#x53C2;&#x6570;&#xFF0C;&#x6700;&#x540E;&#x901A;&#x8FC7;java&#x7684;&#x53CD;&#x5C04;api&#x8C03;&#x7528;&#x5373;&#x53EF;&#x3002;
<img src="/images/invoke_true_method.png" alt="&#x53CD;&#x5C04;&#x8C03;&#x7528;"></p>
<p>&#x81F3;&#x6B64;&#xFF0C;springmvc&#x7684;&#x6574;&#x4E2A;&#x8C03;&#x7528;&#x6D41;&#x7A0B;&#x57FA;&#x672C;&#x5C31;&#x6E05;&#x6670;&#x4E86;&#x3002;</p>
<p>&#x4F46;&#x662F;&#x5230;&#x4E86;&#x8FD9;&#x91CC;&#x95EE;&#x9898;&#x4ECD;&#x7136;&#x6CA1;&#x6709;&#x7ED3;&#x675F;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x8FD8;&#x4E0D;&#x77E5;&#x9053;&#x53C2;&#x6570;&#x5177;&#x4F53;&#x662F;&#x5982;&#x4F55;&#x89E3;&#x6790;&#x7684;&#x3002;&#x6BD4;&#x5982;get&#x65B9;&#x5F0F;&#x63D0;&#x4EA4;&#x7684;&#x6570;&#x636E;&#xFF1F;post&#x65B9;&#x5F0F;&#x63D0;&#x4EA4;&#x7684;&#x6570;&#x636E;&#xFF1F;&#x5982;&#x4F55;&#x8F6C;&#x6362;&#x6210;&#x5BF9;&#x8C61;&#x7684;&#xFF1F;&#x8FD9;&#x5199;&#x95EE;&#x9898;&#x90FD;&#x8FD8;&#x5B58;&#x5728;&#xFF0C;&#x90A3;&#x6211;&#x4EEC;&#x7EE7;&#x7EED;&#x7814;&#x7A76;&#x3002;
&#x8FD9;&#x91CC;&#x6211;&#x4F7F;&#x7528;postman&#x5DE5;&#x5177;&#x6765;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#xFF0C;&#x9996;&#x5148;&#x8BBF;&#x95EE; Get http://localhost:8080/user/condition?name=zhangsan&amp;age=25,&#x5B9A;&#x4F4D;&#x5230;resolveArgument&#x65B9;&#x6CD5;
<img src="/images/arguementResovler_resolve.png" alt="&#x5982;&#x4F55;&#x83B7;&#x53D6;&#x5177;&#x4F53;&#x7684;arguementResolver"></p>
<p>&#x63A5;&#x7740;&#x53C8;&#x6267;&#x884C;revolver.resolveArgument&#x65B9;&#x6CD5;&#xFF0C;&#x540C;&#x6837;&#x7684;&#x8FD9;&#x91CC;&#x8FD8;&#x662F;&#x4F7F;&#x7528;&#x7684;&#x6A21;&#x677F;&#x65B9;&#x6CD5;&#xFF0C;&#x5728;&#x62BD;&#x8C61;&#x7C7B;AbstractNamedValueMethodArgumentResolver&#x4E2D;&#x5B9A;&#x4E49;&#x6D41;&#x7A0B;&#xFF0C;&#x5404;&#x4E2A;&#x5B50;&#x7C7B;&#x53EA;&#x9700;&#x8981;&#x5B9E;&#x73B0;&#x81EA;&#x5DF1;&#x7684;&#x903B;&#x8F91;&#x5373;&#x53EF;&#x3002;RequestParamMethodArgumentResolver&#x7684;&#x53C2;&#x6570;&#x5C31;&#x662F;&#x901A;&#x8FC7;request.getParameter&#x6765;&#x83B7;&#x53D6;&#x5230;&#x7684;&#x3002;&#x83B7;&#x53D6;&#x5230;&#x4E86;&#x53C2;&#x6570;&#x4E4B;&#x540E;&#x5C31;&#x6267;&#x884C;&#x53CD;&#x5C04;&#x8C03;&#x7528;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x5C31;&#x6267;&#x884C;&#x4E86;&#x6211;&#x4EEC;&#x5199;&#x7684;UserController&#x7684;&#x5BF9;&#x5E94;&#x65B9;&#x6CD5;&#xFF0C;&#x83B7;&#x53D6;&#x5230;&#x4E86;User&#x5BF9;&#x8C61;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x5C31;&#x662F;&#x5904;&#x7406;&#x8FD4;&#x56DE;&#x503C;&#x4E86;&#xFF0C;&#x901A;&#x8FC7;returnValueHandlers&#x8FDB;&#x884C;&#x5904;&#x7406;
<img src="/images/handler_return_value.png" alt="&#x5904;&#x7406;&#x8FD4;&#x56DE;&#x503C;"></p>
<p>handler&#x4F1A;&#x6839;&#x636E;&#x8FD4;&#x56DE;&#x7684;&#x7C7B;&#x578B;&#x5BF9;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x6BD4;&#x5982;&#x8BF4;&#x8FD9;&#x91CC;&#x5C31;&#x901A;&#x8FC7;response&#x5411;&#x8BF7;&#x6C42;&#x65B9;&#x8F93;&#x51FA;&#x6570;&#x636E;&#xFF0C;&#x8F93;&#x51FA;&#x6570;&#x636E;&#x4E5F;&#x662F;&#x901A;&#x8FC7;messageConverter&#x6765;&#x5B9E;&#x73B0;&#x7684;
<img src="/images/deal_result.png" alt="&#x5904;&#x7406;&#x6570;&#x636E;&#x8F93;&#x51FA;"></p>
<p>&#x6700;&#x540E;&#x83B7;&#x53D6;ModalAndView&#x5BF9;&#x8C61;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x91CC;&#x7531;&#x4E8E;&#x6CA1;&#x6709;modalAndView&#x6240;&#x4EE5;&#x8FD4;&#x56DE;&#x7684;null.&#x6700;&#x540E;&#x5728;DispatcherServlet&#x7684;processDispatchResult&#x65B9;&#x6CD5;&#x7684;&#x8C03;&#x7528;&#x903B;&#x8F91;&#x5982;&#x4E0B;
<img src="/images/process_dispatcher_result.png" alt="&#x6700;&#x540E;&#x7684;&#x5904;&#x7406;"></p>
<p>&#x90A3;&#x4E48;&#x5BF9;&#x4E8E;&#x8FD9;&#x6837;&#x7684;&#x8BF7;&#x6C42;&#x53C8;&#x65F6;&#x5982;&#x4F55;&#x89E3;&#x6790;&#x7684;&#x5462;&#xFF1F;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@PostMapping</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Integer <span class="title">saveUser</span><span class="params">(@RequestBody User user)</span> </span>{</span><br><span class="line"></span><br><span class="line">Integer id = user.getName().hashCode() - user.getAge().hashCode();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> id &gt; <span class="number">0</span> ? id : -id;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x540C;&#x6837;&#x6211;&#x4EEC;&#x805A;&#x7126;&#x5728;&#x89E3;&#x6790;&#x53C2;&#x6570;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5728;&#x4E0A;&#x4E00;&#x4E2A;get&#x8BF7;&#x6C42;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#x6211;&#x8BF4;&#x4E86;&#x4F1A;&#x5148;&#x8BBF;&#x95EE;AbstractNamedValueMethodArgumentResolver&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x5904;&#x7406;@RequestBody&#x7684;&#x53C2;&#x6570;&#x4E2D;&#x5B83;&#x4F7F;&#x7528;&#x7684;&#x662F;RequestResponseBodyMethodProcessor,&#x5B83;&#x590D;&#x5199;&#x4E86;resolveArgument&#x65B9;&#x6CD5;&#x3002;&#x6240;&#x4EE5;&#x4E0D;&#x4F1A;&#x53BB;&#x6267;&#x884C;&#x7236;&#x7C7B;&#x7684;&#x903B;&#x8F91;&#x3002;
<img src="/images/resolve_arguement_with_post_method.png" alt="&#x53C2;&#x6570;&#x89E3;&#x6790;"></p>
<p>&#x8FD9;&#x91CC;&#x6700;&#x540E;&#x4F1A;&#x5B9A;&#x4F4D;&#x5230;jakson&#x7684;objectMapper&#x4E2D;&#xFF0C; &#x5728;spring boot&#x4E2D;&#xFF0C;&#x9ED8;&#x8BA4;&#x4F7F;&#x7528;Jackson&#x6765;&#x5B9E;&#x73B0;java&#x5BF9;&#x8C61;&#x5230;json&#x683C;&#x5F0F;&#x7684;&#x5E8F;&#x5217;&#x5316;&#x4E0E;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x3002;&#x5F53;&#x7136;&#x662F;&#x53EF;&#x4EE5;&#x914D;&#x7F6E;messageConvert&#x7684;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x5B9E;&#x73B0;Spring&#x7684;HttpMessageConverter&#x5373;&#x53EF;&#x3002;</p>
<p>&#x6E90;&#x7801;&#x5206;&#x6790;&#x5230;&#x8FD9;&#x91CC;&#x5C31;&#x7ED3;&#x675F;&#x4E86;&#xFF0C;&#x5F53;&#x7136;&#x5176;&#x4E2D;&#x8FD8;&#x5B58;&#x5728;&#x4E00;&#x4E9B;&#x6CA1;&#x6709;&#x8BB2;&#x7684;&#x5730;&#x65B9;&#xFF0C;&#x6BD4;&#x5982;View&#x7684;&#x6E32;&#x67D3;&#x5440;&#xFF0C;&#x4E00;&#x822C;&#x89C6;&#x56FE;&#x662F;&#x591A;&#x79CD;&#x591A;&#x6837;&#x7684;&#xFF0C;&#x53C8;html,xml,jsp&#x7B49;&#x7B49;&#xFF0C;&#x6240;&#x4EE5;springmvc&#x4E5F;&#x63D0;&#x4F9B;&#x4E86;&#x63A5;&#x53E3;&#x4F9B;&#x7528;&#x6237;&#x9009;&#x62E9;&#x81EA;&#x5DF1;&#x9700;&#x8981;&#x7684;&#x6A21;&#x677F;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x5B9E;&#x73B0;ViewResolver&#x63A5;&#x53E3;&#x5373;&#x53EF;&#x3002;&#x8FD8;&#x6709;&#x5173;&#x4E8E;Theme,MessageResource&#xFF0C;Exception&#x7684;&#x5904;&#x7406;&#x7B49;&#x7B49;&#xFF0C;&#x5982;&#x679C;&#x94FA;&#x5F00;&#x6765;&#x8BB2;&#x7BC7;&#x5E45;&#x5B9E;&#x5728;&#x662F;&#x592A;&#x957F;&#x4E86;&#xFF0C;&#x6211;&#x66F4;&#x76F8;&#x4FE1;&#x638C;&#x63E1;&#x4E86;&#x6838;&#x5FC3;&#x6D41;&#x7A0B;&#x770B;&#x5176;&#x4ED6;&#x7684;&#x5904;&#x7406;&#x5C31;&#x4F1A;&#x5F88;&#x7B80;&#x5355;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x4E5F;&#x5C31;&#x4E0D;&#x5BF9;&#x5176;&#x4ED6;&#x679D;&#x8282;&#x5185;&#x5BB9;&#x505A;&#x5206;&#x6790;&#x4E86;&#x3002;</p>
<h3 id="&#x4E00;&#x56FE;&#x80DC;&#x5343;&#x8A00;">&#x4E00;&#x56FE;&#x80DC;&#x5343;&#x8A00;</h3>
<p><img src="/images/springmvc_process.png" alt="SpringMVC&#x6D41;&#x7A0B;&#x56FE;"></p>
]]></content>
    <summary type="html">
    <![CDATA[SpringMVC是常用的MVC框架,Spring的代码中也用到了大量的设计模式,分析源码不仅可以让你更加熟练的使用，还能让你更有信心的使用，本文就是基于这一原则进行源码分析。]]>
    
    </summary>
    
      <category term="Spring" scheme="http://yoursite.com/tags/Spring/"/>
    
      <category term="java" scheme="http://yoursite.com/tags/java/"/>
    
      <category term="java" scheme="http://yoursite.com/categories/java/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[一篇文章讲懂Java内存模型]]></title>
    <link href="http://yoursite.com/2018/08/12/what-is-java-memory-model/"/>
    <id>http://yoursite.com/2018/08/12/what-is-java-memory-model/</id>
    <published>2018-08-12T12:53:42.000Z</published>
    <updated>2018-10-28T13:15:07.458Z</updated>
    <content type="html"><![CDATA[<h3 id="java&#x8FD0;&#x884C;&#x65F6;&#x6570;&#x636E;&#x533A;&#x57DF;">Java&#x8FD0;&#x884C;&#x65F6;&#x6570;&#x636E;&#x533A;&#x57DF;</h3>
<p>&#x5728;Java&#x4E2D;&#xFF0C;&#x6240;&#x6709;&#x5B9E;&#x4F8B;&#x57DF;&#x3001;&#x9759;&#x6001;&#x57DF;&#x548C;&#x6570;&#x7EC4;&#x5143;&#x7D20;&#x5B58;&#x50A8;&#x5728;&#x5806;&#x5185;&#x5B58;&#x4E2D;&#xFF0C;&#x5806;&#x5185;&#x5B58;&#x5728;&#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;&#x5171;&#x4EAB;&#xFF08;&#x672C;&#x6587;&#x4F7F;&#x7528;&#x201C;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x201D;&#x8FD9;&#x4E2A;&#x672F;&#x8BED;&#x4EE3;&#x6307;&#x5B9E;&#x4F8B;&#x57DF;&#xFF0C;&#x9759;&#x6001;&#x57DF;&#x548C;&#x6570;&#x7EC4;&#x5143;&#x7D20;&#xFF09;&#x3002;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#xFF08;Local variables&#xFF09;&#xFF0C;&#x65B9;&#x6CD5;&#x5B9A;&#x4E49;&#x53C2;&#x6570;&#xFF08;Java&#x8BED;&#x8A00;&#x89C4;&#x8303;&#x79F0;&#x4E4B;&#x4E3A;formal method parameters&#xFF09;&#x548C;&#x5F02;&#x5E38;&#x5904;&#x7406;&#x5668;&#x53C2;&#x6570;&#xFF08;exception handler parameters&#xFF09;&#x4E0D;&#x4F1A;&#x5728;&#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;&#x5171;&#x4EAB;&#xFF0C;&#x5B83;&#x4EEC;&#x4E0D;&#x4F1A;&#x6709;&#x5185;&#x5B58;&#x53EF;&#x89C1;&#x6027;&#x95EE;&#x9898;&#xFF0C;&#x4E5F;&#x4E0D;&#x53D7;&#x5185;&#x5B58;&#x6A21;&#x578B;&#x7684;&#x5F71;&#x54CD;
<img src="/images/thread-java-running-data-area.png" alt="Java&#x8FD0;&#x884C;&#x65F6;&#x6570;&#x636E;&#x533A;"></p>
<h3 id="&#x591A;&#x7EBF;&#x7A0B;&#x4E0B;&#x7F16;&#x7801;&#x95EE;&#x9898;">&#x591A;&#x7EBF;&#x7A0B;&#x4E0B;&#x7F16;&#x7801;&#x95EE;&#x9898;</h3>
<p>&#x5728;Java&#x591A;&#x7EBF;&#x7A0B;&#x7F16;&#x7A0B;&#x4E2D;&#xFF0C;&#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x901A;&#x4FE1;&#x673A;&#x5236;&#x662F;&#x901A;&#x8FC7;&#x8BFB;&#x5199;&#x5171;&#x4EAB;&#x5185;&#x5B58;(&#x5806;&#x5185;&#x5B58;)&#x4E2D;&#x7684;&#x516C;&#x5171;&#x6570;&#x636E;&#x6765;&#x9690;&#x5F0F;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x7684;&#xFF0C;&#x800C;&#x540C;&#x6B65;&#x662F;&#x6307;&#x7A0B;&#x5E8F;&#x7528;&#x4E8E;&#x63A7;&#x5236;&#x4E0D;&#x540C;&#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;&#x64CD;&#x4F5C;&#x53D1;&#x751F;&#x76F8;&#x5BF9;&#x987A;&#x5E8F;&#x7684;&#x673A;&#x5236;&#xFF0C;&#x540C;&#x6B65;&#x662F;&#x663E;&#x5F0F;&#x8FDB;&#x884C;&#x7684;&#xFF0C;&#x9700;&#x8981;&#x7A0B;&#x5E8F;&#x5458; &#x663E;&#x5F0F;&#x6307;&#x5B9A;&#x67D0;&#x4E2A;&#x65B9;&#x6CD5;&#x6216;&#x67D0;&#x6BB5;&#x4EE3;&#x7801;&#x9700;&#x8981;&#x5728;&#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;&#x4E92;&#x65A5;&#x6267;&#x884C;&#x3002;&#x7531;&#x4E8E;&#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x901A;&#x4FE1;&#x662F;&#x9690;&#x5F0F;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x4E86;&#x89E3;&#x8FD9;&#x4E4B;&#x95F4;&#x7684;&#x901A;&#x4FE1;&#x673A;&#x5236;&#xFF0C;&#x90A3;&#x4E48;&#x53EF;&#x80FD;&#x4F1A;&#x9047;&#x5230;&#x5404;&#x79CD;&#x5947;&#x602A;&#x7684;&#x5185;&#x5B58;&#x53EF;&#x89C1;&#x6027;&#x95EE;&#x9898;&#xFF0C;&#x5BFC;&#x81F4;&#x5728;&#x591A;&#x7EBF;&#x7A0B;&#x7F16;&#x7801;&#x4E2D;&#x5F97;&#x5230;&#x5F88;&#x591A;&#x4F60;&#x4E0D;&#x60F3;&#x8981;&#x7684;&#x7ED3;&#x679C;&#x3002;</p>
<p>&#x5728;&#x5904;&#x7406;&#x5668;&#x7EA7;&#x522B;&#xFF0C;&#x7531;&#x4E8E;&#x73B0;&#x5728;&#x8BA1;&#x7B97;&#x673A;&#x57FA;&#x672C;&#x4E0A;&#x90FD;&#x662F;&#x591A;CPU&#x7684;,&#x5B58;&#x50A8;&#x5668;&#x6A21;&#x578B;&#x4E5F;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x5B9A;&#x7684;&#x6761;&#x4EF6;&#xFF0C;&#x7528;&#x4E8E;&#x77E5;&#x9053;&#x5F53;&#x524D;&#x5904;&#x7406;&#x5668;&#x5BF9;&#x5176;&#x4ED6;&#x5904;&#x7406;&#x5668;&#x7684;&#x5B58;&#x50A8;&#x5668;&#x5199;&#x5165;&#x662F;&#x53EF;&#x89C1;&#x7684;&#x3002;&#x67D0;&#x4E9B;&#x5904;&#x7406;&#x5668;&#x8868;&#x73B0;&#x51FA;&#x5F3A;&#x5927;&#x7684;&#x5185;&#x5B58;&#x6A21;&#x578B;&#xFF0C;&#x5176;&#x4E2D;&#x6240;&#x6709;&#x5904;&#x7406;&#x5668;&#x59CB;&#x7EC8;&#x770B;&#x5230;&#x4EFB;&#x4F55;&#x7ED9;&#x5B9A;&#x5185;&#x5B58;&#x4F4D;&#x7F6E;&#x7684;&#x5B8C;&#x5168;&#x76F8;&#x540C;&#x7684;&#x503C;&#x3002;&#x5176;&#x4ED6;&#x5904;&#x7406;&#x5668;&#x8868;&#x73B0;&#x51FA;&#x8F83;&#x5F31;&#x7684;&#x5185;&#x5B58;&#x6A21;&#x578B;&#xFF0C;&#x5176;&#x4E2D;&#x9700;&#x8981;&#x7279;&#x6B8A;&#x6307;&#x4EE4;&#xFF08;&#x79F0;&#x4E3A;&#x5185;&#x5B58;&#x5C4F;&#x969C;&#xFF0C;memory barriers&#xFF0C;intel&#x79F0;&#x4E4B;&#x4E3A;memory fence&#xFF09;&#x6765;&#x5237;&#x65B0;&#x6216;&#x4F7F;&#x672C;&#x5730;&#x5904;&#x7406;&#x5668;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#x65E0;&#x6548;&#xFF0C;&#x4EE5;&#x4FBF;&#x67E5;&#x770B;&#x5176;&#x4ED6;&#x5904;&#x7406;&#x5668;&#x8FDB;&#x884C;&#x7684;&#x5199;&#x5165;&#x6216;&#x4F7F;&#x8BE5;&#x5904;&#x7406;&#x5668;&#x7684;&#x5199;&#x5165;&#x5BF9;&#x5176;&#x4ED6;&#x5904;&#x7406;&#x5668;&#x53EF;&#x89C1;&#x3002;&#x4F46;&#x662F;&#x5373;&#x4F7F;&#x5728;&#x4E00;&#x4E9B;&#x6700;&#x5F3A;&#x5927;&#x7684;&#x5185;&#x5B58;&#x6A21;&#x578B;&#x4E0A;&#xFF0C;&#x901A;&#x5E38;&#x4E5F;&#x9700;&#x8981;&#x5185;&#x5B58;&#x5C4F;&#x969C;&#x3002;&#x5904;&#x7406;&#x5668;&#x5927;&#x591A;&#x6570;&#x4F7F;&#x7528;&#x8F83;&#x5F31;&#x7684;&#x5185;&#x5B58;&#x6A21;&#x578B;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x6837;&#x53EF;&#x4EE5;&#x5BB9;&#x8BB8;&#x66F4;&#x5927;&#x7684;&#x6269;&#x5C55;&#x6027;&#x3002;</p>
<p>&#x7F16;&#x8BD1;&#x5668;&#x91CD;&#x65B0;&#x6392;&#x5E8F;&#x4EE3;&#x7801;&#x65F6;&#xFF0C;&#x5199;&#x5165;&#x5BF9;&#x53E6;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x53EF;&#x89C1;&#x7684;&#x95EE;&#x9898;&#x66F4;&#x52A0;&#x590D;&#x6742;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x53EF;&#x80FD;&#x4F1A;&#x51B3;&#x5B9A;&#x7A0D;&#x540E;&#x5728;&#x7A0B;&#x5E8F;&#x4E2D;&#x79FB;&#x52A8;&#x5199;&#x64CD;&#x4F5C;&#x66F4;&#x6709;&#x6548;;&#x53EA;&#x8981;&#x6B64;&#x4EE3;&#x7801;&#x52A8;&#x4F5C;&#x4E0D;&#x4F1A;&#x6539;&#x53D8;&#x7A0B;&#x5E8F;&#x7684;&#x8BED;&#x4E49;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x81EA;&#x7531;&#x5730;&#x6267;&#x884C;&#x6B64;&#x64CD;&#x4F5C;&#x3002;&#x5982;&#x679C;&#x7F16;&#x8BD1;&#x5668;&#x63A8;&#x8FDF;&#x64CD;&#x4F5C;&#xFF0C;&#x5219;&#x53E6;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x5728;&#x6267;&#x884C;&#x4E4B;&#x524D;&#x4E0D;&#x4F1A;&#x770B;&#x5230;&#x5B83;;&#x8FD9;&#x53CD;&#x6620;&#x4E86;&#x7F13;&#x5B58;&#x7684;&#x6548;&#x679C;&#x3002;</p>
<p>&#x5728;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#x65F6;&#x4E3A;&#x4E86;&#x63D0;&#x9AD8;&#x6027;&#x80FD;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x548C;&#x5904;&#x7406;&#x5668;&#x5E38;&#x5E38;&#x4F1A;&#x5BF9;&#x6307;&#x4EE4;&#x505A;&#x91CD;&#x6392;&#x5E8F;&#x3002;&#x91CD;&#x6392;&#x5E8F;&#x5206;&#x4E09;&#x79CD;&#x7C7B;&#x578B;</p>
<ol>
<li>
<p>&#x7F16;&#x8BD1;&#x5668;&#x4F18;&#x5316;&#x7684;&#x91CD;&#x6392;&#x5E8F;&#x3002;&#x7F16;&#x8BD1;&#x5668;&#x5728;&#x4E0D;&#x6539;&#x53D8;&#x5355;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x8BED;&#x4E49;&#x7684;&#x524D;&#x63D0;&#x4E0B;&#xFF0C;&#x53EF;&#x4EE5;&#x91CD;&#x65B0;&#x5B89;&#x6392;&#x8BED;&#x53E5;&#x7684;&#x6267;&#x884C;&#x987A;&#x5E8F;&#x3002;</p>
</li>
<li>
<p>&#x6307;&#x4EE4;&#x7EA7;&#x5E76;&#x884C;&#x7684;&#x91CD;&#x6392;&#x5E8F;&#x3002;&#x73B0;&#x4EE3;&#x5904;&#x7406;&#x5668;&#x91C7;&#x7528;&#x4E86;&#x6307;&#x4EE4;&#x7EA7;&#x5E76;&#x884C;&#x6280;&#x672F;&#xFF08;Instruction-Level Parallelism&#xFF0C; ILP&#xFF09;&#x6765;&#x5C06;&#x591A;&#x6761;&#x6307;&#x4EE4;&#x91CD;&#x53E0;&#x6267;&#x884C;&#x3002;&#x5982;&#x679C;&#x4E0D;&#x5B58;&#x5728;&#x6570;&#x636E;&#x4F9D;&#x8D56;&#x6027;&#xFF0C;&#x5904;&#x7406;&#x5668;&#x53EF;&#x4EE5;&#x6539;&#x53D8;&#x8BED;&#x53E5;&#x5BF9;&#x5E94;&#x673A;&#x5668;&#x6307;&#x4EE4;&#x7684;&#x6267;&#x884C;&#x987A;&#x5E8F;&#x3002;</p>
</li>
<li>
<p>&#x5185;&#x5B58;&#x7CFB;&#x7EDF;&#x7684;&#x91CD;&#x6392;&#x5E8F;&#x3002;&#x7531;&#x4E8E;&#x5904;&#x7406;&#x5668;&#x4F7F;&#x7528;&#x7F13;&#x5B58;&#x548C;&#x8BFB;/&#x5199;&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x8FD9;&#x4F7F;&#x5F97;&#x52A0;&#x8F7D;&#x548C;&#x5B58;&#x50A8;&#x64CD;&#x4F5C;&#x770B;&#x4E0A;&#x53BB;&#x53EF;&#x80FD;&#x662F;&#x5728;&#x4E71;&#x5E8F;&#x6267;&#x884C;&#x3002;</p>
</li>
</ol>
<p>java&#x4EE3;&#x7801;&#x5230;&#x6700;&#x7EC8;&#x6267;&#x884C;&#x7684;&#x6307;&#x4EE4;&#x4F1A;&#x5206;&#x522B;&#x7ECF;&#x5386;&#x4E0B;&#x9762;&#x4E09;&#x79CD;&#x6392;&#x5E8F;
<img src="/images/code_sort_in_jmm.jpg" alt="&#x6307;&#x4EE4;&#x91CD;&#x6392;&#x5E8F;"></p>
<h3 id="&#x4EC0;&#x4E48;&#x662F;java&#x5185;&#x5B58;&#x6A21;&#x578B;">&#x4EC0;&#x4E48;&#x662F;Java&#x5185;&#x5B58;&#x6A21;&#x578B;</h3>
<p>Java&#x865A;&#x62DF;&#x673A;&#x89C4;&#x8303;&#x4E2D;&#x8BD5;&#x56FE;&#x5B9A;&#x4E49;&#x4E00;&#x79CD;Java&#x5185;&#x5B58;&#x6A21;&#x578B;(JMM,Java Memory Model)&#x6765;&#x5C4F;&#x853D;&#x5404;&#x79CD;&#x786C;&#x4EF6;&#x548C;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x5185;&#x5B58;&#x8BBF;&#x95EE;&#x5DEE;&#x5F02;&#xFF0C;&#x4EE5;&#x5B9E;&#x73B0;Java&#x7A0B;&#x5E8F;&#x5728;&#x5404;&#x79CD;&#x5E73;&#x53F0;&#x4E0B;&#x90FD;&#x80FD;&#x8FBE;&#x5230;&#x4E00;&#x81F4;&#x7684;&#x8BBF;&#x95EE;&#x6548;&#x679C;&#x3002;</p>
<p>&#x4E0A;&#x8FF0;&#x7684;&#x7F16;&#x8BD1;&#x5668;&#x91CD;&#x6392;&#x5E8F;&#xFF0C;&#x5904;&#x7406;&#x5668;&#x91CD;&#x6392;&#x5E8F;(&#x5305;&#x62EC;&#x6307;&#x4EE4;&#x96C6;&#x91CD;&#x6392;&#x5E8F;&#x548C;&#x5185;&#x5B58;&#x7CFB;&#x7EDF;&#x91CD;&#x6392;&#x5E8F;)&#x8FD9;&#x4E9B;&#x91CD;&#x6392;&#x5E8F;&#x90FD;&#x53EF;&#x80FD;&#x4F1A;&#x5BFC;&#x81F4;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x51FA;&#x73B0;&#x5185;&#x5B58;&#x53EF;&#x89C1;&#x6027;&#x95EE;&#x9898;&#x3002;&#x5BF9;&#x4E8E;&#x7F16;&#x8BD1;&#x5668;&#xFF0C;JMM&#x7684;&#x7F16;&#x8BD1;&#x5668;&#x91CD;&#x6392;&#x5E8F;&#x89C4;&#x5219;&#x4F1A;&#x7981;&#x6B62;&#x7279;&#x5B9A;&#x7C7B;&#x578B;&#x7684;&#x7F16;&#x8BD1;&#x5668;&#x91CD;&#x6392;&#x5E8F;&#xFF08;&#x4E0D;&#x662F;&#x6240;&#x6709;&#x7684;&#x7F16;&#x8BD1;&#x5668;&#x91CD;&#x6392;&#x5E8F;&#x90FD;&#x8981;&#x7981;&#x6B62;&#xFF09;&#x3002;&#x5BF9;&#x4E8E;&#x5904;&#x7406;&#x5668;&#x91CD;&#x6392;&#x5E8F;&#xFF0C;JMM&#x7684;&#x5904;&#x7406;&#x5668;&#x91CD;&#x6392;&#x5E8F;&#x89C4;&#x5219;&#x4F1A;&#x8981;&#x6C42;java&#x7F16;&#x8BD1;&#x5668;&#x5728;&#x751F;&#x6210;&#x6307;&#x4EE4;&#x5E8F;&#x5217;&#x65F6;&#xFF0C;&#x63D2;&#x5165;&#x7279;&#x5B9A;&#x7C7B;&#x578B;&#x7684;&#x5185;&#x5B58;&#x5C4F;&#x969C;&#x6307;&#x4EE4;&#xFF0C;&#x901A;&#x8FC7;&#x5185;&#x5B58;&#x5C4F;&#x969C;&#x6307;&#x4EE4;&#x6765;&#x7981;&#x6B62;&#x7279;&#x5B9A;&#x7C7B;&#x578B;&#x7684;&#x5904;&#x7406;&#x5668;&#x91CD;&#x6392;&#x5E8F;&#xFF08;&#x4E0D;&#x662F;&#x6240;&#x6709;&#x7684;&#x5904;&#x7406;&#x5668;&#x91CD;&#x6392;&#x5E8F;&#x90FD;&#x8981;&#x7981;&#x6B62;&#xFF09;&#x3002;
JMM&#x5C5E;&#x4E8E;&#x8BED;&#x8A00;&#x7EA7;&#x7684;&#x5185;&#x5B58;&#x6A21;&#x578B;&#xFF0C;&#x5B83;&#x786E;&#x4FDD;&#x5728;&#x4E0D;&#x540C;&#x7684;&#x7F16;&#x8BD1;&#x5668;&#x548C;&#x4E0D;&#x540C;&#x7684;&#x5904;&#x7406;&#x5668;&#x5E73;&#x53F0;&#x4E4B;&#x4E0A;&#xFF0C;&#x901A;&#x8FC7;&#x7981;&#x6B62;&#x7279;&#x5B9A;&#x7C7B;&#x578B;&#x7684;&#x7F16;&#x8BD1;&#x5668;&#x91CD;&#x6392;&#x5E8F;&#x548C;&#x5904;&#x7406;&#x5668;&#x91CD;&#x6392;&#x5E8F;&#xFF0C;&#x4E3A;&#x7A0B;&#x5E8F;&#x5458;&#x63D0;&#x4F9B;&#x4E00;&#x81F4;&#x7684;&#x5185;&#x5B58;&#x53EF;&#x89C1;&#x6027;&#x4FDD;&#x8BC1;&#x3002;</p>
<p>&#x4E0A;&#x9762;&#x8FD9;&#x4E48;&#x591A;&#x95EE;&#x9898;&#x90FD;&#x5F71;&#x54CD;&#x6211;&#x4EEC;&#x591A;&#x7EBF;&#x7A0B;&#x7F16;&#x7801;&#xFF0C;&#x56E0;&#x6B64;Java&#x4E3A;&#x4E86;&#x4FDD;&#x8BC1;&#x4E00;&#x6B21;&#x7F16;&#x8BD1;&#x5230;&#x5904;&#x8FD0;&#x884C;&#xFF0C;&#x8BA9;&#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x901A;&#x4FE1;&#x7531;Java&#x5185;&#x5B58;&#x6A21;&#x578B;&#x63A7;&#x5236;&#xFF0C;JMM&#x51B3;&#x5B9A;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x5BF9;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x7684;&#x5199;&#x5165;&#x4F55;&#x65F6;&#x5BF9;&#x53E6;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x53EF;&#x89C1;&#x3002;&#x4ECE;&#x62BD;&#x8C61;&#x7684;&#x89D2;&#x5EA6;&#x6765;&#x770B;&#xFF0C;JMM&#x5B9A;&#x4E49;&#x4E86;&#x7EBF;&#x7A0B;&#x548C;&#x4E3B;&#x5185;&#x5B58;&#x4E4B;&#x95F4;&#x7684;&#x62BD;&#x8C61;&#x5173;&#x7CFB;&#xFF1A;&#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x5B58;&#x50A8;&#x5728;&#x4E3B;&#x5185;&#x5B58;&#xFF08;main memory&#xFF09;&#x4E2D;&#xFF0C;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x90FD;&#x6709;&#x4E00;&#x4E2A;&#x79C1;&#x6709;&#x7684;&#x672C;&#x5730;&#x5185;&#x5B58;&#xFF08;local memory&#xFF09;&#xFF0C;&#x672C;&#x5730;&#x5185;&#x5B58;&#x4E2D;&#x5B58;&#x50A8;&#x4E86;&#x8BE5;&#x7EBF;&#x7A0B;&#x4EE5;&#x8BFB;/&#x5199;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x7684;&#x526F;&#x672C;&#x3002;&#x672C;&#x5730;&#x5185;&#x5B58;&#x662F;JMM&#x7684;&#x4E00;&#x4E2A;&#x62BD;&#x8C61;&#x6982;&#x5FF5;&#xFF0C;&#x5E76;&#x4E0D;&#x771F;&#x5B9E;&#x5B58;&#x5728;&#x3002;&#x5B83;&#x6DB5;&#x76D6;&#x4E86;&#x7F13;&#x5B58;&#xFF0C;&#x5199;&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x5BC4;&#x5B58;&#x5668;&#x4EE5;&#x53CA;&#x5176;&#x4ED6;&#x7684;&#x786C;&#x4EF6;&#x548C;&#x7F16;&#x8BD1;&#x5668;&#x4F18;&#x5316;&#x3002;
<img src="/images/jmm_for_memory.jpg" alt="Java&#x7EBF;&#x7A0B;&#x5DE5;&#x4F5C;&#x5185;&#x5B58;&#x548C;&#x4E3B;&#x5B58;&#x901A;&#x4FE1;"></p>
<h4 id="as-if-serial&#x8BED;&#x4E49;">as-if-serial&#x8BED;&#x4E49;</h4>
<p>as-if-serial&#x8BED;&#x4E49;&#x6307;&#x7684;&#x662F;&#x4E0D;&#x7BA1;&#x600E;&#x4E48;&#x91CD;&#x6392;&#x5E8F;(&#x7F16;&#x8BD1;&#x5668;&#x548C;&#x5904;&#x7406;&#x5668;&#x4E3A;&#x4E86;&#x63D0;&#x9AD8;&#x5E76;&#x884C;&#x5EA6;)&#xFF0C;&#x5355;&#x7EBF;&#x7A0B;&#x7684;&#x6267;&#x884C;&#x7ED3;&#x679C;&#x4E0D;&#x80FD;&#x88AB;&#x6539;&#x53D8;&#x3002;&#x7F16;&#x8BD1;&#x5668;&#xFF0C;runtime&#x548C;&#x5904;&#x7406;&#x5668;&#x90FD;&#x5FC5;&#x987B;&#x51C6;&#x5B88;as-if-serial&#x8BED;&#x4E49;&#x3002;&#x4E3A;&#x4E86;&#x9075;&#x5B88;as-if-serial&#x8BED;&#x4E49;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x548C;&#x5904;&#x7406;&#x5668;&#x4E0D;&#x4F1A;&#x5BF9;&#x5B58;&#x5728;&#x6570;&#x636E;&#x4F9D;&#x8D56;&#x5173;&#x7CFB;&#x7684;&#x64CD;&#x4F5C;&#x505A;&#x91CD;&#x6392;&#x5E8F;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x79CD;&#x91CD;&#x6392;&#x5E8F;&#x4F1A;&#x6539;&#x53D8;&#x6267;&#x884C;&#x7ED3;&#x679C;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x64CD;&#x4F5C;&#x4E4B;&#x95F4;&#x4E0D;&#x5B58;&#x5728;&#x6570;&#x636E;&#x4F9D;&#x8D56;&#x5173;&#x7CFB;&#xFF0C;&#x8FD9;&#x4E9B;&#x64CD;&#x4F5C;&#x53EF;&#x80FD;&#x88AB;&#x7F16;&#x8BD1;&#x5668;&#x548C;&#x5904;&#x7406;&#x5668;&#x91CD;&#x6392;&#x5E8F;&#x3002;</p>
<p>&#x6570;&#x636E;&#x4F9D;&#x8D56;&#x5173;&#x7CFB;&#x5206;&#x4E3A;&#x4EE5;&#x4E0B;&#x51E0;&#x79CD;:</p>
<table>
<thead>
<tr>
<th>&#x540D;&#x79F0;</th>
<th>&#x4EE3;&#x7801;&#x793A;&#x4F8B;</th>
<th>&#x8BF4;&#x660E;</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x5199;&#x540E;&#x8BFB;</td>
<td>a = 1;b = a;</td>
<td>&#x5199;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x4E4B;&#x540E;&#xFF0C;&#x518D;&#x8BFB;&#x8FD9;&#x4E2A;&#x4F4D;&#x7F6E;&#x3002;</td>
</tr>
<tr>
<td>&#x5199;&#x540E;&#x5199;</td>
<td>a = 1;a = 2;</td>
<td>&#x5199;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x4E4B;&#x540E;&#xFF0C;&#x518D;&#x5199;&#x8FD9;&#x4E2A;&#x53D8;&#x91CF;&#x3002;</td>
</tr>
<tr>
<td>&#x8BFB;&#x540E;&#x5199;</td>
<td>a = b;b = 1;</td>
<td>&#x8BFB;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x4E4B;&#x540E;&#xFF0C;&#x518D;&#x5199;&#x8FD9;&#x4E2A;&#x53D8;&#x91CF;</td>
</tr>
</tbody>
</table>
<p>&#x7F16;&#x8BD1;&#x5668;&#x548C;&#x5904;&#x7406;&#x5668;&#x4E0D;&#x4F1A;&#x6539;&#x53D8;&#x5B58;&#x5728;&#x6570;&#x636E;&#x4F9D;&#x8D56;&#x5173;&#x7CFB;&#x7684;&#x4E24;&#x4E2A;&#x64CD;&#x4F5C;&#x7684;&#x6267;&#x884C;&#x987A;&#x5E8F;&#x3002; &#x4EC5;&#x9488;&#x5BF9;&#x5355;&#x4E2A;&#x5904;&#x7406;&#x5668;&#x4E2D;&#x6267;&#x884C;&#x7684;&#x6307;&#x4EE4;&#x5E8F;&#x5217;&#x548C;&#x5355;&#x4E2A;&#x7EBF;&#x7A0B;&#x4E2D;&#x6267;&#x884C;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x4E0D;&#x540C;&#x5904;&#x7406;&#x5668;&#x4E4B;&#x95F4;&#x548C;&#x4E0D;&#x540C;&#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x6570;&#x636E;&#x4F9D;&#x8D56;&#x6027;&#x4E0D;&#x88AB;&#x7F16;&#x8BD1;&#x5668;&#x548C;&#x5904;&#x7406;&#x5668;&#x8003;&#x8651;&#x3002;</p>
<h4 id="&#x5904;&#x7406;&#x5668;&#x6392;&#x5E8F;&#x4E0E;&#x5185;&#x5B58;&#x5C4F;&#x969C;&#x6307;&#x4EE4;">&#x5904;&#x7406;&#x5668;&#x6392;&#x5E8F;&#x4E0E;&#x5185;&#x5B58;&#x5C4F;&#x969C;&#x6307;&#x4EE4;</h4>
<p>&#x73B0;&#x4EE3;&#x7684;&#x5904;&#x7406;&#x5668;&#x4F7F;&#x7528;&#x5199;&#x7F13;&#x51B2;&#x533A;&#x6765;&#x4E34;&#x65F6;&#x4FDD;&#x5B58;&#x5411;&#x5185;&#x5B58;&#x5199;&#x5165;&#x7684;&#x6570;&#x636E;&#x3002;&#x5199;&#x7F13;&#x51B2;&#x533A;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x6307;&#x4EE4;&#x6D41;&#x6C34;&#x7EBF;&#x6301;&#x7EED;&#x8FD0;&#x884C;&#xFF0C;&#x5B83;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x7531;&#x4E8E;&#x5904;&#x7406;&#x5668;&#x505C;&#x987F;&#x4E0B;&#x6765;&#x7B49;&#x5F85;&#x5411;&#x5185;&#x5B58;&#x5199;&#x5165;&#x6570;&#x636E;&#x800C;&#x4EA7;&#x751F;&#x7684;&#x5EF6;&#x8FDF;&#x3002;&#x540C;&#x65F6;&#xFF0C;&#x901A;&#x8FC7;&#x4EE5;&#x6279;&#x5904;&#x7406;&#x7684;&#x65B9;&#x5F0F;&#x5237;&#x65B0;&#x5199;&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x4EE5;&#x53CA;&#x5408;&#x5E76;&#x5199;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x5BF9;&#x540C;&#x4E00;&#x5185;&#x5B58;&#x5730;&#x5740;&#x7684;&#x591A;&#x6B21;&#x5199;&#xFF0C;&#x53EF;&#x4EE5;&#x51CF;&#x5C11;&#x5BF9;&#x5185;&#x5B58;&#x603B;&#x7EBF;&#x7684;&#x5360;&#x7528;&#x3002;&#x867D;&#x7136;&#x5199;&#x7F13;&#x51B2;&#x533A;&#x6709;&#x8FD9;&#x4E48;&#x591A;&#x597D;&#x5904;&#xFF0C;&#x4F46;&#x6BCF;&#x4E2A;&#x5904;&#x7406;&#x5668;&#x4E0A;&#x7684;&#x5199;&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x4EC5;&#x4EC5;&#x5BF9;&#x5B83;&#x6240;&#x5728;&#x7684;&#x5904;&#x7406;&#x5668;&#x53EF;&#x89C1;&#x3002;&#x8FD9;&#x4E2A;&#x7279;&#x6027;&#x4F1A;&#x5BF9;&#x5185;&#x5B58;&#x64CD;&#x4F5C;&#x7684;&#x6267;&#x884C;&#x987A;&#x5E8F;&#x4EA7;&#x751F;&#x91CD;&#x8981;&#x7684;&#x5F71;&#x54CD;&#xFF1A;&#x5904;&#x7406;&#x5668;&#x5BF9;&#x5185;&#x5B58;&#x7684;&#x8BFB;/&#x5199;&#x64CD;&#x4F5C;&#x7684;&#x6267;&#x884C;&#x987A;&#x5E8F;&#xFF0C;&#x4E0D;&#x4E00;&#x5B9A;&#x4E0E;&#x5185;&#x5B58;&#x5B9E;&#x9645;&#x53D1;&#x751F;&#x7684;&#x8BFB;/&#x5199;&#x64CD;&#x4F5C;&#x987A;&#x5E8F;&#x4E00;&#x81F4;&#xFF01;
&#x7531;&#x4E8E;&#x5199;&#x7F13;&#x51B2;&#x533A;&#x4EC5;&#x5BF9;&#x81EA;&#x5DF1;&#x7684;&#x5904;&#x7406;&#x5668;&#x53EF;&#x89C1;&#xFF0C;&#x5B83;&#x4F1A;&#x5BFC;&#x81F4;&#x5904;&#x7406;&#x5668;&#x6267;&#x884C;&#x5185;&#x5B58;&#x64CD;&#x4F5C;&#x7684;&#x987A;&#x5E8F;&#x53EF;&#x80FD;&#x4F1A;&#x4E0E;&#x5185;&#x5B58;&#x5B9E;&#x9645;&#x7684;&#x64CD;&#x4F5C;&#x6267;&#x884C;&#x987A;&#x5E8F;&#x4E0D;&#x4E00;&#x81F4;&#x3002;&#x7531;&#x4E8E;&#x73B0;&#x4EE3;&#x7684;&#x5904;&#x7406;&#x5668;&#x90FD;&#x4F1A;&#x4F7F;&#x7528;&#x5199;&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x56E0;&#x6B64;&#x73B0;&#x4EE3;&#x7684;&#x5904;&#x7406;&#x5668;&#x90FD;&#x4F1A;&#x5141;&#x8BB8;&#x5BF9;&#x5199;-&#x8BFB;&#x64CD;&#x505A;&#x91CD;&#x6392;&#x5E8F;&#x3002;
&#x4E3A;&#x4E86;&#x4FDD;&#x8BC1;&#x5185;&#x5B58;&#x53EF;&#x89C1;&#x6027;&#xFF0C;java&#x7F16;&#x8BD1;&#x5668;&#x5728;&#x751F;&#x6210;&#x6307;&#x4EE4;&#x5E8F;&#x5217;&#x7684;&#x9002;&#x5F53;&#x4F4D;&#x7F6E;&#x4F1A;&#x63D2;&#x5165;&#x5185;&#x5B58;&#x5C4F;&#x969C;&#x6307;&#x4EE4;&#x6765;&#x7981;&#x6B62;&#x7279;&#x5B9A;&#x7C7B;&#x578B;&#x7684;&#x5904;&#x7406;&#x5668;&#x91CD;&#x6392;&#x5E8F;&#x3002;JMM&#x628A;&#x5185;&#x5B58;&#x5C4F;&#x969C;&#x6307;&#x4EE4;&#x5206;&#x4E3A;&#x4E0B;&#x5217;&#x56DB;&#x7C7B;&#xFF1A;</p>
<table>
<thead>
<tr>
<th>&#x5C4F;&#x969C;&#x7C7B;&#x578B;</th>
<th>&#x6307;&#x4EE4;&#x793A;&#x4F8B;</th>
<th>&#x8BF4;&#x660E;</th>
</tr>
</thead>
<tbody>
<tr>
<td>LoadLoad Barriers</td>
<td>Load1; LoadLoad; Load2</td>
<td>Load2&#x786E;&#x4FDD;Load1&#x6570;&#x636E;&#x7684;&#x88C5;&#x8F7D;&#xFF0C;&#x4E4B;&#x524D;&#x4E8E;Load2&#x53CA;&#x6240;&#x6709;&#x540E;&#x7EED;&#x88C5;&#x8F7D;&#x6307;&#x4EE4;&#x7684;&#x88C5;&#x8F7D;&#x3002;</td>
</tr>
<tr>
<td>StoreStore Barriers</td>
<td>Store1; StoreStore; Store2</td>
<td>&#x786E;&#x4FDD;Store1&#x6570;&#x636E;&#x5BF9;&#x5176;&#x4ED6;&#x5904;&#x7406;&#x5668;&#x53EF;&#x89C1;&#xFF08;&#x5237;&#x65B0;&#x5230;&#x5185;&#x5B58;&#xFF09;&#xFF0C;&#x4E4B;&#x524D;&#x4E8E;Store2&#x53CA;&#x6240;&#x6709;&#x540E;&#x7EED;&#x5B58;&#x50A8;&#x6307;&#x4EE4;&#x7684;&#x5B58;&#x50A8;</td>
</tr>
<tr>
<td>LoadStore Barriers</td>
<td>Load1; LoadStore; Store2</td>
<td>&#x786E;&#x4FDD;Load1&#x6570;&#x636E;&#x88C5;&#x8F7D;&#xFF0C;&#x4E4B;&#x524D;&#x4E8E;Store2&#x53CA;&#x6240;&#x6709;&#x540E;&#x7EED;&#x7684;&#x5B58;&#x50A8;&#x6307;&#x4EE4;&#x5237;&#x65B0;&#x5230;&#x5185;&#x5B58;</td>
</tr>
<tr>
<td>StoreLoad Barriers</td>
<td>Store1; StoreLoad; Load2</td>
<td>&#x786E;&#x4FDD;Store1&#x6570;&#x636E;&#x5BF9;&#x5176;&#x4ED6;&#x5904;&#x7406;&#x5668;&#x53D8;&#x5F97;&#x53EF;&#x89C1;&#xFF08;&#x6307;&#x5237;&#x65B0;&#x5230;&#x5185;&#x5B58;&#xFF09;&#xFF0C;&#x4E4B;&#x524D;&#x4E8E;Load2&#x53CA;&#x6240;&#x6709;&#x540E;&#x7EED;&#x88C5;&#x8F7D;&#x6307;&#x4EE4;&#x7684;&#x88C5;&#x8F7D;&#x3002;StoreLoad Barriers&#x4F1A;&#x4F7F;&#x8BE5;&#x5C4F;&#x969C;&#x4E4B;&#x524D;&#x7684;&#x6240;&#x6709;&#x5185;&#x5B58;&#x8BBF;&#x95EE;&#x6307;&#x4EE4;&#xFF08;&#x5B58;&#x50A8;&#x548C;&#x88C5;&#x8F7D;&#x6307;&#x4EE4;&#xFF09;&#x5B8C;&#x6210;&#x4E4B;&#x540E;&#xFF0C;&#x624D;&#x6267;&#x884C;&#x8BE5;&#x5C4F;&#x969C;&#x4E4B;&#x540E;&#x7684;&#x5185;&#x5B58;&#x8BBF;&#x95EE;&#x6307;&#x4EE4;&#x3002;</td>
</tr>
</tbody>
</table>
<h4 id="&#x539F;&#x5B50;&#x6027;&#x53EF;&#x89C1;&#x6027;&#x4E0E;&#x6709;&#x5E8F;&#x6027;">&#x539F;&#x5B50;&#x6027;&#x3001;&#x53EF;&#x89C1;&#x6027;&#x3001;&#x4E0E;&#x6709;&#x5E8F;&#x6027;</h4>
<p>Java&#x5185;&#x5B58;&#x6A21;&#x578B;&#x662F;&#x56F4;&#x7ED5;&#x7740;&#x5728;&#x5E76;&#x53D1;&#x8FC7;&#x7A0B;&#x4E2D;&#x5982;&#x4F55;&#x5904;&#x7406;&#x539F;&#x5B50;&#x6027;&#x3001;&#x53EF;&#x89C1;&#x6027;&#x548C;&#x6709;&#x5E8F;&#x6027;&#x8FD9;&#x4E09;&#x4E2A;&#x7279;&#x5F81;&#x6765;&#x5EFA;&#x7ACB;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x73B0;&#x5728;&#x770B;&#x770B;&#x8FD9;&#x4E09;&#x4E2A;&#x7279;&#x6027;&#x3002;</p>
<h5 id="&#x539F;&#x5B50;&#x6027;">&#x539F;&#x5B50;&#x6027;</h5>
<p>&#x901A;&#x4FD7;&#x7684;&#x5C06;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#x4E0D;&#x80FD;&#x88AB;&#x5176;&#x4ED6;&#x64CD;&#x4F5C;&#x6253;&#x65AD;&#xFF0C;&#x8981;&#x4E48;&#x6210;&#x529F;&#xFF0C;&#x8981;&#x4E48;&#x5931;&#x8D25;&#x3002;Java&#x4E2D;&#x57FA;&#x672C;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x7684;&#x8BBF;&#x95EE;&#x8BFB;&#x5199;&#x662F;&#x5177;&#x5907;&#x539F;&#x5B50;&#x6027;&#x7684;(&#x4F8B;&#x5916;&#x5C31;&#x662F;long&#x548C;double&#x7684;&#x975E;&#x539F;&#x5B50;&#x6027;&#x534F;&#x5B9A;&#xFF0C;&#x4F46;&#x662F;&#x51E0;&#x4E4E;&#x4E0D;&#x4F1A;&#x53D1;&#x751F;)</p>
<h5 id="&#x53EF;&#x89C1;&#x6027;">&#x53EF;&#x89C1;&#x6027;</h5>
<p>&#x53EF;&#x89C1;&#x6027;&#x662F;&#x6307;&#x5F53;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x4FEE;&#x6539;&#x4E86;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x7684;&#x503C;,&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x80FD;&#x591F;&#x7ACB;&#x5373;&#x5F97;&#x77E5;&#x8FD9;&#x4E2A;&#x4FEE;&#x6539;&#x3002;</p>
<h5 id="&#x6709;&#x5E8F;&#x6027;">&#x6709;&#x5E8F;&#x6027;</h5>
<p>&#x6709;&#x5E8F;&#x6027;&#x6307;&#x7684;&#x662F;&#x4EE3;&#x7801;&#x5728;&#x672C;&#x7EBF;&#x7A0B;&#x5185;&#x90E8;&#x89C2;&#x5BDF;&#x90FD;&#x662F;&#x6709;&#x5E8F;&#xFF1B;&#x5982;&#x679C;&#x5728;&#x53E6;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x4E2D;&#x89C2;&#x5BDF;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x64CD;&#x4F5C;&#x90FD;&#x662F;&#x65E0;&#x5E8F;&#x7684;&#x3002;
&#x524D;&#x534A;&#x53E5;&#x6307;&#x7684;&#x662F;as-if-serial&#x8BED;&#x4E49;&#xFF0C;&#x540E;&#x534A;&#x53E5;&#x6307;&#x7684;&#x662F;&quot;&#x6307;&#x4EE4;&#x91CD;&#x6392;&#x5E8F;&quot;&#x73B0;&#x8C61;&#x548C;&quot;&#x672C;&#x5730;&#x5185;&#x5B58;&#x548C;&#x4E3B;&#x5185;&#x5B58;&#x540C;&#x6B65;&#x5EF6;&#x8FDF;&quot;&#x73B0;&#x8C61;&#x3002;</p>
<p>&#x5982;&#x679C;&#x6BCF;&#x4E00;&#x6B21;&#x591A;&#x7EBF;&#x7A0B;&#x7F16;&#x7A0B;&#x90FD;&#x8981;&#x53BB;&#x8003;&#x8651;&#x91CD;&#x6392;&#x5E8F;&#xFF0C;&#x90A3;&#x4E48;&#x662F;&#x975E;&#x5E38;&#x8F9B;&#x82E6;&#x7684;&#xFF0C;&#x800C;&#x4E14;&#x4E5F;&#x8FDD;&#x80CC;&#x4E86;java&#x7684;&#x521D;&#x8877;&#xFF0C;&#x56E0;&#x4E3A;&#x8003;&#x8651;&#x7CFB;&#x7EDF;&#x5E95;&#x5C42;&#x7684;&#x5B9E;&#x73B0;&#x603B;&#x662F;&#x975E;&#x5E38;&#x8F9B;&#x82E6;&#x7684;&#x3002;&#x4ECE;jdk5&#x5F00;&#x59CB;java&#x4F7F;&#x7528;&#x65B0;&#x7684;jsr-133&#x5185;&#x5B58;&#x6A21;&#x578B;&#xFF0C;&#x5176;&#x4E2D;&#x901A;&#x8FC7;happen-before(&#x5148;&#x884C;&#x53D1;&#x751F;)&#x7684;&#x6982;&#x5FF5;&#x6765;&#x9610;&#x8FF0;&#x64CD;&#x4F5C;&#x4E4B;&#x95F4;&#x7684;&#x5185;&#x5B58;&#x53EF;&#x89C1;&#x6027;&#x3002; &#x5982;&#x679C;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#x6267;&#x884C;&#x7684;&#x7ED3;&#x679C;&#x9700;&#x8981;&#x5BF9;&#x53E6;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#x53EF;&#x89C1;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E24;&#x4E2A;&#x64CD;&#x4F5C;&#x4E4B;&#x95F4;&#x5FC5;&#x987B;&#x5B58;&#x5728;happens-before&#x5173;&#x7CFB;&#x3002;&#x8FD9;&#x91CC;&#x63D0;&#x5230;&#x7684;&#x4E24;&#x4E2A;&#x64CD;&#x4F5C;&#x65E2;&#x53EF;&#x4EE5;&#x662F;&#x5728;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x4E4B;&#x5185;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x5728;&#x4E0D;&#x540C;&#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;&#x3002;&#x8FD9;&#x5C31;&#x610F;&#x5473;&#x7740;&#x5982;&#x679C;&#x8BF4;&#x64CD;&#x4F5C;A&#x5148;&#x884C;&#x53D1;&#x751F;&#x4E8E;&#x64CD;&#x4F5C;B,&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x8BF4;&#x5728;&#x53D1;&#x751F;&#x64CD;&#x4F5C;B&#x4E4B;&#x524D;,&#x4ECE;&#x64CD;&#x4F5C;A&#x4EA7;&#x751F;&#x7684;&#x5F71;&#x54CD;&#x80FD;&#x88AB;B&#x89C2;&#x5BDF;&#x5230;,&quot;&#x5F71;&#x54CD;&quot;&#x5305;&#x62EC;&#x4FEE;&#x6539;&#x4E86;&#x5185;&#x5B58;&#x4E2D;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x7684;&#x503C;&#x3001;&#x53D1;&#x9001;&#x4E86;&#x6D88;&#x606F;&#x3001;&#x8C03;&#x7528;&#x4E86;&#x65B9;&#x6CD5;&#x7B49;&#x3002;</p>
<h4 id="java&#x4E2D;&#x5929;&#x7136;&#x7684;happen-before&#x5148;&#x884C;&#x53D1;&#x751F;&#x539F;&#x5219;">Java&#x4E2D;&#x5929;&#x7136;&#x7684;happen-before(&#x5148;&#x884C;&#x53D1;&#x751F;)&#x539F;&#x5219;</h4>
<ul>
<li>&#x5728;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x5185;&#xFF0C;&#x6309;&#x7167;&#x63A7;&#x5236;&#x6D41;&#x987A;&#x5E8F;&#xFF0C;&#x4E66;&#x5199;&#x5728;&#x524D;&#x9762;&#x7684;&#x64CD;&#x4F5C;happen-before&#x4E66;&#x5199;&#x5728;&#x540E;&#x9762;&#x7684;&#x64CD;&#x4F5C;</li>
<li>&#x5BF9;&#x540C;&#x4E00;&#x4E2A;monitor&#x7684;unlock&#x64CD;&#x4F5C;&#x90FD;happens-before&#x540C;&#x4E00;&#x4E2A;monitor&#x7684;lock</li>
<li>&#x5BF9;volatile&#x53D8;&#x91CF;&#x7684;&#x5199;&#x64CD;&#x4F5C;&#x90FD;happens-before&#x540C;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x7684;&#x8BFB;&#x64CD;&#x4F5C;</li>
<li>&#x7EBF;&#x7A0B;&#x7684;start()&#x90FD;happens-before&#x7EBF;&#x7A0B;&#x7684;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;</li>
<li>&#x7EBF;&#x7A0B;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x64CD;&#x4F5C;happens-before&#x4EFB;&#x4F55;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x4ECE;&#x8BE5;&#x7EBF;&#x7A0B;&#x4E0A;&#x7684;join()&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x3002;</li>
<li>&#x7EBF;&#x7A0B;interrrupt()&#x65B9;&#x6CD5;&#x7684;&#x8C03;&#x7528;happends-before&#x88AB;&#x4E2D;&#x65AD;&#x7EBF;&#x7A0B;&#x7684;&#x4EE3;&#x7801;&#x68C0;&#x6D4B;&#x5230;&#x4E2D;&#x65AD;&#x4E8B;&#x4EF6;&#x7684;&#x53D1;&#x751F;</li>
<li>&#x5982;&#x679C;A happens-before B,&#x4E14;B happens-before C&#xFF0C;&#x90A3;&#x4E48;A happens-before C.</li>
</ul>
<h4 id="java&#x4E2D;&#x7EBF;&#x7A0B;&#x540C;&#x6B65;&#x7684;&#x5173;&#x952E;&#x5B57;">Java&#x4E2D;&#x7EBF;&#x7A0B;&#x540C;&#x6B65;&#x7684;&#x5173;&#x952E;&#x5B57;</h4>
<h5 id="volatile">volatile</h5>
<p>&#x5F53;&#x5199;&#x4E00;&#x4E2A;volatile&#x53D8;&#x91CF;&#x65F6;&#xFF0C;JMM&#x4F1A;&#x628A;&#x8BE5;&#x7EBF;&#x7A0B;&#x5BF9;&#x5E94;&#x7684;&#x672C;&#x5730;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x5237;&#x65B0;&#x5230;&#x4E3B;&#x5185;&#x5B58;&#x3002;
&#x5F53;&#x8BFB;&#x4E00;&#x4E2A;volatile&#x53D8;&#x91CF;&#x65F6;&#xFF0C;JMM&#x4F1A;&#x628A;&#x8BE5;&#x7EBF;&#x7A0B;&#x5BF9;&#x5E94;&#x7684;&#x672C;&#x5730;&#x5185;&#x5B58;&#x7F6E;&#x4E3A;&#x65E0;&#x6548;&#x3002;&#x7EBF;&#x7A0B;&#x63A5;&#x4E0B;&#x6765;&#x5C06;&#x4ECE;&#x4E3B;&#x5185;&#x5B58;&#x4E2D;&#x8BFB;&#x53D6;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x3002;</p>
<p>&#x524D;&#x6587;&#x6211;&#x4EEC;&#x63D0;&#x5230;&#x8FC7;&#x91CD;&#x6392;&#x5E8F;&#x5206;&#x4E3A;&#x7F16;&#x8BD1;&#x5668;&#x91CD;&#x6392;&#x5E8F;&#x548C;&#x5904;&#x7406;&#x5668;&#x91CD;&#x6392;&#x5E8F;&#x3002;&#x4E3A;&#x4E86;&#x5B9E;&#x73B0;volatile&#x5185;&#x5B58;&#x8BED;&#x4E49;&#xFF0C;JMM&#x4F1A;&#x5206;&#x522B;&#x9650;&#x5236;&#x8FD9;&#x4E24;&#x79CD;&#x7C7B;&#x578B;&#x7684;&#x91CD;&#x6392;&#x5E8F;&#x7C7B;&#x578B;&#x3002;&#x4E0B;&#x9762;&#x662F;JMM&#x9488;&#x5BF9;&#x7F16;&#x8BD1;&#x5668;&#x5236;&#x5B9A;&#x7684;volatile&#x91CD;&#x6392;&#x5E8F;&#x89C4;&#x5219;&#x8868;&#xFF1A;
<img src="/images/volatile_in_jmm.png" alt="volatile&#x6392;&#x5E8F;&#x89C4;&#x5219;">
&#x4ECE;&#x4E0A;&#x8868;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF1A;&#x4E3E;&#x4F8B;&#x6765;&#x8BF4;&#xFF0C;&#x7B2C;&#x4E09;&#x884C;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5355;&#x5143;&#x683C;&#x7684;&#x610F;&#x601D;&#x662F;&#xFF1A;&#x5728;&#x7A0B;&#x5E8F;&#x987A;&#x5E8F;&#x4E2D;&#xFF0C;&#x5F53;&#x7B2C;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#x4E3A;&#x666E;&#x901A;&#x53D8;&#x91CF;&#x7684;&#x8BFB;&#x6216;&#x5199;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x7B2C;&#x4E8C;&#x4E2A;&#x64CD;&#x4F5C;&#x4E3A;volatile&#x5199;&#xFF0C;&#x5219;&#x7F16;&#x8BD1;&#x5668;&#x4E0D;&#x80FD;&#x91CD;&#x6392;&#x5E8F;&#x8FD9;&#x4E24;&#x4E2A;&#x64CD;&#x4F5C;&#x3002;</p>
<p>&#x5F53;&#x7B2C;&#x4E8C;&#x4E2A;&#x64CD;&#x4F5C;&#x662F;volatile&#x5199;&#x65F6;&#xFF0C;&#x4E0D;&#x7BA1;&#x7B2C;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#x662F;&#x4EC0;&#x4E48;&#xFF0C;&#x90FD;&#x4E0D;&#x80FD;&#x91CD;&#x6392;&#x5E8F;&#x3002;&#x8FD9;&#x4E2A;&#x89C4;&#x5219;&#x786E;&#x4FDD;volatile&#x5199;&#x4E4B;&#x524D;&#x7684;&#x64CD;&#x4F5C;&#x4E0D;&#x4F1A;&#x88AB;&#x7F16;&#x8BD1;&#x5668;&#x91CD;&#x6392;&#x5E8F;&#x5230;volatile&#x5199;&#x4E4B;&#x540E;&#x3002;</p>
<p>&#x5F53;&#x7B2C;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#x662F;volatile&#x8BFB;&#x65F6;&#xFF0C;&#x4E0D;&#x7BA1;&#x7B2C;&#x4E8C;&#x4E2A;&#x64CD;&#x4F5C;&#x662F;&#x4EC0;&#x4E48;&#xFF0C;&#x90FD;&#x4E0D;&#x80FD;&#x91CD;&#x6392;&#x5E8F;&#x3002;&#x8FD9;&#x4E2A;&#x89C4;&#x5219;&#x786E;&#x4FDD;volatile&#x8BFB;&#x4E4B;&#x540E;&#x7684;&#x64CD;&#x4F5C;&#x4E0D;&#x4F1A;&#x88AB;&#x7F16;&#x8BD1;&#x5668;&#x91CD;&#x6392;&#x5E8F;&#x5230;volatile&#x8BFB;&#x4E4B;&#x524D;&#x3002;</p>
<p>&#x5F53;&#x7B2C;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#x662F;volatile&#x5199;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x64CD;&#x4F5C;&#x662F;volatile&#x8BFB;&#x65F6;&#xFF0C;&#x4E0D;&#x80FD;&#x91CD;&#x6392;&#x5E8F;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x5B9E;&#x73B0;volatile&#x7684;&#x5185;&#x5B58;&#x8BED;&#x4E49;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x5728;&#x751F;&#x6210;&#x5B57;&#x8282;&#x7801;&#x65F6;&#xFF0C;&#x4F1A;&#x5728;&#x6307;&#x4EE4;&#x5E8F;&#x5217;&#x4E2D;&#x63D2;&#x5165;&#x5185;&#x5B58;&#x5C4F;&#x969C;&#x6765;&#x7981;&#x6B62;&#x7279;&#x5B9A;&#x7C7B;&#x578B;&#x7684;&#x5904;&#x7406;&#x5668;&#x91CD;&#x6392;&#x5E8F;&#x3002;&#x5BF9;&#x4E8E;&#x7F16;&#x8BD1;&#x5668;&#x6765;&#x8BF4;&#xFF0C;&#x53D1;&#x73B0;&#x4E00;&#x4E2A;&#x6700;&#x4F18;&#x5E03;&#x7F6E;&#x6765;&#x6700;&#x5C0F;&#x5316;&#x63D2;&#x5165;&#x5C4F;&#x969C;&#x7684;&#x603B;&#x6570;&#x51E0;&#x4E4E;&#x4E0D;&#x53EF;&#x80FD;&#xFF0C;&#x4E3A;&#x6B64;&#xFF0C;JMM&#x91C7;&#x53D6;&#x4FDD;&#x5B88;&#x7B56;&#x7565;&#x3002;&#x4E0B;&#x9762;&#x662F;&#x57FA;&#x4E8E;&#x4FDD;&#x5B88;&#x7B56;&#x7565;&#x7684;JMM&#x5185;&#x5B58;&#x5C4F;&#x969C;&#x63D2;&#x5165;&#x7B56;&#x7565;&#xFF1A;</p>
<ol>
<li>
<p>&#x5728;&#x6BCF;&#x4E2A;volatile&#x5199;&#x64CD;&#x4F5C;&#x7684;&#x524D;&#x9762;&#x63D2;&#x5165;&#x4E00;&#x4E2A;StoreStore&#x5C4F;&#x969C;&#x3002;</p>
</li>
<li>
<p>&#x5728;&#x6BCF;&#x4E2A;volatile&#x5199;&#x64CD;&#x4F5C;&#x7684;&#x540E;&#x9762;&#x63D2;&#x5165;&#x4E00;&#x4E2A;StoreLoad&#x5C4F;&#x969C;&#x3002;</p>
</li>
<li>
<p>&#x5728;&#x6BCF;&#x4E2A;volatile&#x8BFB;&#x64CD;&#x4F5C;&#x7684;&#x540E;&#x9762;&#x63D2;&#x5165;&#x4E00;&#x4E2A;LoadLoad&#x5C4F;&#x969C;&#x3002;</p>
</li>
<li>
<p>&#x5728;&#x6BCF;&#x4E2A;volatile&#x8BFB;&#x64CD;&#x4F5C;&#x7684;&#x540E;&#x9762;&#x63D2;&#x5165;&#x4E00;&#x4E2A;LoadStore&#x5C4F;&#x969C;&#x3002;</p>
</li>
</ol>
<p>&#x4E0A;&#x8FF0;&#x5185;&#x5B58;&#x5C4F;&#x969C;&#x63D2;&#x5165;&#x7B56;&#x7565;&#x975E;&#x5E38;&#x4FDD;&#x5B88;&#xFF0C;&#x4F46;&#x5B83;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x5728;&#x4EFB;&#x610F;&#x5904;&#x7406;&#x5668;&#x5E73;&#x53F0;&#xFF0C;&#x4EFB;&#x610F;&#x7684;&#x7A0B;&#x5E8F;&#x4E2D;&#x90FD;&#x80FD;&#x5F97;&#x5230;&#x6B63;&#x786E;&#x7684;volatile&#x5185;&#x5B58;&#x8BED;&#x4E49;&#x3002;&#x56E0;&#x4E3A;volatile&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x53EF;&#x89C1;&#x6027;&#x4EE5;&#x53CA;&#x91CD;&#x6392;&#x5E8F;&#x4F18;&#x5316;&#x3002;</p>
<h5 id="synchronized">synchronized</h5>
<p>&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x80FD;&#x6301;&#x6709;&#x76D1;&#x89C6;&#x5668;&#xFF0C;&#x8FD9;&#x4EE3;&#x8868;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x8FDB;&#x5165;&#x540C;&#x6B65;&#x4EE3;&#x7801;&#x5757;&#xFF0C;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x53EA;&#x6709;&#x5728;&#x8FD9;&#x4E2A;&#x7EBF;&#x7A0B;&#x9000;&#x51FA;&#x4E86;&#x540C;&#x6B65;&#x4EE3;&#x7801;&#x5757;&#x4E4B;&#x540E;&#x624D;&#x80FD;&#x8FDB;&#x5165;&#xFF0C;&#x540C;&#x65F6;&#x5728;&#x9000;&#x51FA;&#x540C;&#x6B65;&#x4EE3;&#x7801;&#x5757;&#x7684;&#x65F6;&#x5019;JMM&#x4F1A;&#x628A;&#x8BE5;&#x7EBF;&#x7A0B;&#x5BF9;&#x5E94;&#x7684;&#x672C;&#x5730;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x5237;&#x65B0;&#x5230;&#x4E3B;&#x5185;&#x5B58;&#x4E2D;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x4E2A;&#x7EBF;&#x7A0B;&#x7684;&#x5199;&#x64CD;&#x4F5C;&#x5BF9;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x662F;&#x53EF;&#x89C1;&#x7684;&#x3002;&#x5F53;&#x6211;&#x4EEC;&#x8FDB;&#x5165;&#x540C;&#x6B65;&#x4EE3;&#x7801;&#x5757;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x83B7;&#x53D6;&#x76D1;&#x89C6;&#x5668;&#xFF0C;&#x5728;&#x83B7;&#x53D6;&#x76D1;&#x89C6;&#x5668;&#x7684;&#x540C;&#x65F6;&#x4F1A;&#x4F7F;&#x5F97;&#x5F53;&#x524D;&#x5904;&#x7406;&#x5668;&#x672C;&#x5730;&#x7684;&#x7F13;&#x5B58;&#x65E0;&#x6548;&#xFF0C;&#x800C;&#x662F;&#x4F1A;&#x4ECE;&#x4E3B;&#x5B58;&#x4E2D;&#x540C;&#x6B65;&#x6570;&#x636E;&#xFF0C;&#x7136;&#x540E;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x524D;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x7684;&#x6240;&#x6709;&#x5199;&#x5165;&#x4E86;&#x3002;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">synchronized</span>(<span class="keyword">new</span> Object()) {</span><br><span class="line">    dosomething();</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x5982;&#x679C;&#x7528;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x6765;&#x8BBE;&#x7F6E;&#x5185;&#x5B58;&#x5C4F;&#x969C;&#x662F;&#x4E0D;&#x8D77;&#x4F5C;&#x7528;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x7F16;&#x8BD1;&#x5668;&#x77E5;&#x9053;&#x4E0D;&#x4F1A;&#x6709;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x6765;&#x83B7;&#x53D6;&#x540C;&#x4E00;&#x4E2A;&#x800C;&#x76D1;&#x89C6;&#x5668;,&#x6240;&#x4EE5;&#x7F16;&#x8BD1;&#x5668;&#x4F1A;&#x5B8C;&#x5168;&#x7ED9;&#x4F60;&#x79FB;&#x9664;
&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#x4E24;&#x4E2A;&#x76D1;&#x89C6;&#x5668;&#x5728;&#x540C;&#x4E00;&#x4E2A;&#x76D1;&#x89C6;&#x5668;&#x9501;&#x4E0A;&#x540C;&#x6B65;&#x624D;&#x80FD;&#x89E6;&#x53D1;happens-before&#xFF0C;&#x5982;&#x679C;&#x7EBF;&#x7A0B;A&#x5728;&#x5BF9;&#x8C61;X&#x4E0A;&#x540C;&#x6B65;&#x65F6;&#x53EF;&#x89C1;&#x7684;&#x6240;&#x6709;&#x5185;&#x5BB9;&#x5728;&#x5BF9;&#x8C61;Y&#x4E0A;&#x540C;&#x6B65;&#x540E;&#x4E0D;&#x4E00;&#x5B9A;&#x5C31;&#x5BF9;&#x7EBF;&#x7A0B;B&#x53EF;&#x89C1;&#x3002;&#x6240;&#x4EE5;&#x83B7;&#x53D6;&#x548C;&#x91CA;&#x653E;&#x5FC5;&#x987B;&#x5339;&#x914D;&#x3002;</p>
<p>synchronized&#x5173;&#x952E;&#x5B57;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x539F;&#x5B50;&#x6027;&#x3001;&#x53EF;&#x89C1;&#x6027;&#x3001;&#x4E0E;&#x6709;&#x5E8F;&#x6027;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x5982;&#x6B64;&#x5F3A;&#x5927;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x8BB8;&#x591A;&#x4EBA;&#x5C06;&#x5B83;&#x5927;&#x91CF;&#x7528;&#x5728;&#x7EBF;&#x7A0B;&#x540C;&#x6B65;&#x4E2D;&#xFF0C;&#x901A;&#x5E38;&#x4F1A;&#x4F34;&#x968F;&#x7740;&#x8D8A;&#x5927;&#x7684;&#x6027;&#x80FD;&#x5F71;&#x54CD;&#x3002;</p>
<h5 id="final">final</h5>
<ol>
<li>
<p>&#x5728;&#x6784;&#x9020;&#x51FD;&#x6570;&#x5185;&#x5BF9;&#x4E00;&#x4E2A;final&#x57DF;&#x7684;&#x5199;&#x5165;&#xFF0C;&#x4E0E;&#x968F;&#x540E;&#x628A;&#x8FD9;&#x4E2A;&#x88AB;&#x6784;&#x9020;&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#x8D4B;&#x503C;&#x7ED9;&#x4E00;&#x4E2A;&#x5F15;&#x7528;&#x53D8;&#x91CF;&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A;&#x64CD;&#x4F5C;&#x4E4B;&#x95F4;&#x4E0D;&#x80FD;&#x91CD;&#x6392;&#x5E8F;&#x3002;</p>
</li>
<li>
<p>&#x521D;&#x6B21;&#x8BFB;&#x4E00;&#x4E2A;&#x5305;&#x542B;final&#x57DF;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#xFF0C;&#x4E0E;&#x968F;&#x540E;&#x521D;&#x6B21;&#x8BFB;&#x8FD9;&#x4E2A;final&#x57DF;&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A;&#x64CD;&#x4F5C;&#x4E4B;&#x95F4;&#x4E0D;&#x80FD;&#x91CD;&#x6392;&#x5E8F;&#x3002;</p>
</li>
</ol>
<p>&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x4F7F;&#x7528;final&#x5B57;&#x6BB5;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x521D;&#x59CB;&#x5316;&#x5B89;&#x5168;&#x6027;&#xFF0C;&#x5B83;&#x5141;&#x8BB8;&#x5728;&#x4E0D;&#x540C;&#x6B65;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x81EA;&#x7531;&#x8BBF;&#x95EE;&#x548C;&#x5171;&#x4EAB;&#x4E0D;&#x53EF;&#x53D8;&#x5BF9;&#x8C61;&#x3002;</p>
<h3 id="&#x603B;&#x7ED3;">&#x603B;&#x7ED3;</h3>
<p>&#x591A;&#x7EBF;&#x7A0B;&#x7F16;&#x7801;&#x4E2D;&#x5F71;&#x54CD;&#x591A;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x4E3B;&#x8981;&#x6709;&#x5185;&#x5B58;&#x3001;&#x5904;&#x7406;&#x5668;&#x91CD;&#x6392;&#x5E8F;&#x3001;&#x7F16;&#x8BD1;&#x5668;&#x91CD;&#x6392;&#x5E8F;&#x7B49;&#x786C;&#x4EF6;&#x548C;&#x8F6F;&#x4EF6;&#x65B9;&#x9762;&#x95EE;&#x9898;&#xFF0C;&#x800C;JMM&#x5219;&#x5C4F;&#x853D;&#x4E86;&#x5E95;&#x5C42;&#x7EC6;&#x8282;&#xFF0C;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x4E86;&#x62BD;&#x8C61;&#x5904;&#x7406;&#xFF0C;&#x4FDD;&#x8BC1;&#x4E86;&#x5355;&#x7EBF;&#x7A0B;&#x7684;as-if-serial&#x8BED;&#x4E49;&#x4EE5;&#x53CA;&#x591A;&#x7EBF;&#x7A0B;&#x4E0B;&#x5408;&#x7406;&#x4F7F;&#x7528;Java&#x63D0;&#x4F9B;&#x7684;&#x5173;&#x952E;&#x5B57;&#x6216;&#x8005;&#x5F00;&#x53D1;&#x5305;&#x6765;&#x4FDD;&#x8BC1;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x3002;</p>
<h3 id="&#x53C2;&#x8003;&#x6587;&#x6863;">&#x53C2;&#x8003;&#x6587;&#x6863;</h3>
<p><a href="http://www.infoq.com/cn/articles/java-memory-model-1" target="_blank" rel="external">http://www.infoq.com/cn/articles/java-memory-model-1</a></p>
<p>&lt;&lt;&#x6DF1;&#x5165;&#x7406;&#x89E3;Java&#x865A;&#x62DF;&#x673A;&gt;&gt;</p>
]]></content>
    <summary type="html">
    <![CDATA[一篇讲解Java内存模型的文章，通俗简要说明了多线程编码所面临的问题和什么是JMM。]]>
    
    </summary>
    
      <category term="jvm" scheme="http://yoursite.com/tags/jvm/"/>
    
      <category term="jvm" scheme="http://yoursite.com/categories/jvm/"/>
    
      <category term="多线程" scheme="http://yoursite.com/categories/jvm/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[从mysql到mongodb你应该快速了解的内容]]></title>
    <link href="http://yoursite.com/2018/08/05/you-should-know-from-mysql-to-mongodb/"/>
    <id>http://yoursite.com/2018/08/05/you-should-know-from-mysql-to-mongodb/</id>
    <published>2018-08-05T12:19:43.000Z</published>
    <updated>2018-10-28T13:15:19.685Z</updated>
    <content type="html"><![CDATA[<p>&#x4ECE;mysql&#x8F6C;&#x6218;mongodb&#xFF0C;&#x5E94;&#x8BE5;&#x5FEB;&#x901F;&#x7684;&#x4E86;&#x89E3;&#x4E0A;&#x624B;&#xFF0C;&#x4EE5;&#x4E0B;&#x7684;&#x5185;&#x5BB9;&#x5C31;&#x662F;&#x4E2A;&#x4EBA;&#x5BF9;&#x5176;&#x57FA;&#x672C;&#x4F7F;&#x7528;&#x7684;&#x4E00;&#x4E2A;&#x603B;&#x7ED3;&#x3002;</p>
<h3 id="&#x4E0B;&#x8F7D;&#x5B89;&#x88C5;&#x67E5;&#x770B;&#x5B98;&#x65B9;&#x6587;&#x6863;">&#x4E0B;&#x8F7D;&#x5B89;&#x88C5;&#x67E5;&#x770B;&#x5B98;&#x65B9;&#x6587;&#x6863;</h3>
<p>&#x5F53;&#x7136;&#x7B2C;&#x4E00;&#x6B65;&#x80AF;&#x5B9A;&#x662F;&#x8981;&#x5B89;&#x88C5;&#x4E0A;&#x4E86;&#xFF0C;&#x5B89;&#x88C5;&#x6B65;&#x9AA4;&#x6309;&#x7167;&#x5B98;&#x7F51;&#x7684;&#x6765;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;  <a href="https://docs.mongodb.com/manual/mongo/" target="_blank" rel="external">https://docs.mongodb.com/manual/mongo/</a>,&#x5B89;&#x88C5;&#x4E4B;&#x540E;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x81EA;&#x5E26;&#x7684;mongoshell&#x6765;&#x6D4B;&#x8BD5;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;Robo 3T&#x8FD9;&#x6837;&#x7684;&#x5DE5;&#x5177;&#x6765;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;</p>
<h3 id="&#x4E00;&#x4E9B;&#x57FA;&#x672C;&#x6982;&#x5FF5;">&#x4E00;&#x4E9B;&#x57FA;&#x672C;&#x6982;&#x5FF5;</h3>
<p>MongoDB&#x4EE5;BSON&#x683C;&#x5F0F;&#x7684;&#x6587;&#x6863;&#xFF08;Documents&#xFF09;&#x5F62;&#x5F0F;&#x5B58;&#x50A8;&#x3002;Databases&#x4E2D;&#x5305;&#x542B;&#x96C6;&#x5408;&#xFF08;Collections&#xFF09;&#xFF0C;&#x96C6;&#x5408;&#xFF08;Collections&#xFF09;&#x4E2D;&#x5B58;&#x50A8;&#x6587;&#x6863;&#xFF08;Documents&#xFF09;&#x3002;</p>
<p><a href="https://docs.mongodb.com/manual/reference/bson-types/" target="_blank" rel="external">BSON</a>&#x662F;&#x4E00;&#x4E2A;&#x4E8C;&#x8FDB;&#x5236;&#x5F62;&#x5F0F;&#x7684;JSON&#x6587;&#x6863;&#xFF0C;&#x5B83;&#x6BD4;JSON&#x5305;&#x542B;&#x66F4;&#x591A;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x3002;</p>
<table>
<thead>
<tr>
<th>SQL&#x672F;&#x8BED;/&#x6982;&#x5FF5;</th>
<th>MongoDB&#x672F;&#x8BED;/&#x6982;&#x5FF5;</th>
<th>&#x89E3;&#x91CA;/&#x8BF4;&#x660E;</th>
</tr>
</thead>
<tbody>
<tr>
<td>database</td>
<td>database</td>
<td>&#x6570;&#x636E;&#x5E93;</td>
</tr>
<tr>
<td>table</td>
<td>collection</td>
<td>&#x6570;&#x636E;&#x5E93;&#x8868;/&#x96C6;&#x5408;</td>
</tr>
<tr>
<td>row</td>
<td>document</td>
<td>&#x6570;&#x636E;&#x8BB0;&#x5F55;&#x884C;/&#x6587;&#x6863;</td>
</tr>
<tr>
<td>column</td>
<td>field</td>
<td>&#x6570;&#x636E;&#x5B57;&#x6BB5;/&#x57DF;</td>
</tr>
<tr>
<td>index</td>
<td>index</td>
<td>&#x7D22;&#x5F15;</td>
</tr>
<tr>
<td>table joins</td>
<td></td>
<td>table joins</td>
</tr>
<tr>
<td>primary key</td>
<td>primary key</td>
<td>&#x4E3B;&#x952E;,MongoDB&#x81EA;&#x52A8;&#x5C06;_id&#x5B57;&#x6BB5;&#x8BBE;&#x7F6E;&#x4E3A;&#x4E3B;&#x952E;</td>
</tr>
</tbody>
</table>
<p>&#x4E0A;&#x9762;&#x8BF4;&#x4E86;MongoDB&#x4E2D;&#x4FDD;&#x5B58;&#x7684;&#x6570;&#x636E;&#x662F;bson&#x683C;&#x5F0F;&#x7684;&#x6570;&#x636E;,&#x6240;&#x4EE5;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x770B;&#x4E0A;&#x53BB;&#x662F;&#x8FD9;&#x6837;&#x7684;</p>
<p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    &quot;<span class="attribute">_id</span>&quot; : <span class="value"><span class="number">1</span></span>,</span><br><span class="line">    &quot;<span class="attribute">zipcode</span>&quot; : <span class="value"><span class="string">&quot;63109&quot;</span></span>,</span><br><span class="line">    &quot;<span class="attribute">students</span>&quot; : <span class="value">[</span><br><span class="line">        {</span><br><span class="line">            &quot;<span class="attribute">name</span>&quot; : <span class="value"><span class="string">&quot;john&quot;</span></span>,</span><br><span class="line">            &quot;<span class="attribute">age</span>&quot; : <span class="value"><span class="number">10</span></span><br><span class="line">        </span>},</span><br><span class="line">        {</span><br><span class="line">            &quot;<span class="attribute">name</span>&quot; : <span class="value"><span class="string">&quot;jess&quot;</span></span>,</span><br><span class="line">            &quot;<span class="attribute">age</span>&quot; : <span class="value"><span class="number">11</span></span><br><span class="line">        </span>},</span><br><span class="line">        {</span><br><span class="line">            &quot;<span class="attribute">name</span>&quot; : <span class="value"><span class="string">&quot;jeff&quot;</span></span>,</span><br><span class="line">            &quot;<span class="attribute">age</span>&quot; : <span class="value"><span class="number">15</span></span><br><span class="line">        </span>}</span><br><span class="line">    ]</span><br><span class="line"></span>}</span><br></pre></td></tr></table></figure></p>
<h3 id="&#x719F;&#x6089;&#x8BED;&#x6CD5;">&#x719F;&#x6089;&#x8BED;&#x6CD5;</h3>
<h4 id="&#x8FDE;&#x63A5;&#x6570;&#x636E;&#x5E93;">&#x8FDE;&#x63A5;&#x6570;&#x636E;&#x5E93;</h4>
<p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mongo host:port/databaseName -u user -p password</span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#&#x8FDE;&#x63A5;&#x672C;&#x5730;&#x7684;local&#x5E93;</span></span><br><span class="line">mongo <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/local</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x63D2;&#x5165;&#x6570;&#x636E;">&#x63D2;&#x5165;&#x6570;&#x636E;</h4>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">use</span> myNewDB</span><br><span class="line"></span><br><span class="line">#&#x4E5F;&#x53EF;&#x4EE5;&#x8C03;&#x7528;insertMany&#x540C;&#x65F6;&#x63D2;&#x5165;&#x591A;&#x6761;&#x6570;&#x636E;,&#x63D2;&#x5165;&#x7684;&#x6570;&#x636E;&#x662F;&#x4E00;&#x4E2A;/&#x591A;&#x4E2A;<span class="keyword">json</span>&#x5BF9;&#x8C61;</span><br><span class="line">db.myNewCollection1.<span class="keyword">insert</span>( {<span class="keyword">name</span>:<span class="string">&quot;Kit&quot;</span>} )</span><br><span class="line"></span><br><span class="line"># &#x4E5F;&#x4EE5;&#x4F7F;&#x7528;getCollection&#x7684;&#x65B9;&#x5F0F;</span><br><span class="line">db.getCollection(<span class="string">&quot;myNewCollection1&quot;</span>).insertOne({<span class="keyword">name</span>:<span class="string">&quot;Kit&quot;</span>});</span></span><br></pre></td></tr></table></figure></p>
<p>insert()&#x64CD;&#x4F5C;&#x4F1A;&#x521B;&#x5EFA;&#x540D;&#x4E3A;myNewDB&#x7684;database&#x548C;&#x540D;&#x4E3A;myNewCollection1&#x7684;collection&#xFF08;&#x5982;&#x679C;&#x4ED6;&#x4EEC;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x8BDD;&#xFF09;&#x3002;</p>
<h4 id="&#x67E5;&#x8BE2;&#x6570;&#x636E;">&#x67E5;&#x8BE2;&#x6570;&#x636E;</h4>
<p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">db</span>.collectionName.find(<span class="keyword">query</span>,projection);</span><br><span class="line"></span><br><span class="line"><span class="keyword">query</span> &#xFF1A;&#x53EF;&#x9009;&#xFF0C;&#x4F7F;&#x7528;&#x67E5;&#x8BE2;&#x64CD;&#x4F5C;&#x7B26;&#x6307;&#x5B9A;&#x67E5;&#x8BE2;&#x6761;&#x4EF6;</span><br><span class="line">projection &#xFF1A;&#x53EF;&#x9009;&#xFF0C;&#x4F7F;&#x7528;&#x6295;&#x5F71;&#x64CD;&#x4F5C;&#x7B26;&#x6307;&#x5B9A;&#x8FD4;&#x56DE;&#x7684;&#x952E;&#x3002;&#x67E5;&#x8BE2;&#x65F6;&#x8FD4;&#x56DE;&#x6587;&#x6863;&#x4E2D;&#x6240;&#x6709;&#x952E;&#x503C;&#xFF0C; &#x53EA;&#x9700;&#x7701;&#x7565;&#x8BE5;&#x53C2;&#x6570;&#x5373;&#x53EF;&#xFF08;&#x9ED8;&#x8BA4;&#x7701;&#x7565;&#xFF09;&#x3002;</span><br></pre></td></tr></table></figure></p>
<h5 id="query&#x7684;&#x4F7F;&#x7528;">query&#x7684;&#x4F7F;&#x7528;</h5>
<p>&#x4E0B;&#x9762;&#x7ED9;&#x51FA;&#x51E0;&#x4E2A;&#x5BF9;&#x6BD4;&#x67E5;&#x8BE2;</p>
<p><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">select</span> * <span class="keyword">from</span> user <span class="built_in">where</span> name = <span class="string">&quot;&#x5F20;&#x4E09;&quot;</span> <span class="built_in">and</span> age = <span class="number">20</span>;</span><br><span class="line">db.user.find({</span><br><span class="line">    name:<span class="string">&quot;&#x5F20;&#x4E09;&quot;</span>,</span><br><span class="line">    age:<span class="number">20</span></span><br><span class="line">});</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># <span class="keyword">select</span> * <span class="keyword">from</span> user <span class="built_in">where</span> name = <span class="string">&quot;&#x5F20;&#x4E09;&quot;</span> <span class="built_in">and</span> age &gt; <span class="number">20</span>;</span><br><span class="line">db.user.find({</span><br><span class="line">    name:<span class="string">&quot;&#x5F20;&#x4E09;&quot;</span>,</span><br><span class="line">    age:{</span><br><span class="line">        $gt:<span class="number">20</span></span><br><span class="line">    }</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># <span class="keyword">select</span> * <span class="keyword">from</span> user <span class="built_in">where</span> name = <span class="string">&quot;&#x5F20;&#x4E09;&quot;</span> <span class="built_in">or</span> age = <span class="number">20</span>;</span><br><span class="line">db.user.find({</span><br><span class="line">    $<span class="built_in">or</span>: [</span><br><span class="line">        {name:<span class="string">&quot;&#x5F20;&#x4E09;&quot;</span>},</span><br><span class="line">        {age:<span class="number">20</span>}</span><br><span class="line">    ]</span><br><span class="line">});</span><br></pre></td></tr></table></figure></p>
<p>&#x57FA;&#x672C;mysql&#x652F;&#x6301;&#x7684;&#x67E5;&#x8BE2;&#xFF0C;mongodb&#x90FD;&#x53EF;&#x4EE5;&#x505A;&#x5230;&#xFF0C;&#x5B83;&#x652F;&#x6301;&#x7684;&#x64CD;&#x4F5C;&#x7B26;&#x5728;&#x8FD9;&#x91CC;(<a href="https://docs.mongodb.com/manual/reference/operator/query/" target="_blank" rel="external">https://docs.mongodb.com/manual/reference/operator/query/</a>)&#x53EF;&#x4EE5;&#x770B;&#x5230;.</p>
<p>&#x4ECE;&#x4E0A;&#x9762;&#x7684;&#x5BF9;&#x6BD4;&#x57FA;&#x672C;&#x53EF;&#x4EE5;&#x603B;&#x7ED3;&#x51FA;&#x6765;&#xFF0C;mongodb&#x7684;&#x67E5;&#x8BE2;&#x57FA;&#x672C;&#x662F;&#x6309;&#x7167;JSON&#x5BF9;&#x8C61;&#x7684;&#x8BED;&#x6CD5;&#x6765;&#x8FDB;&#x884C;&#x7684;,&#x6240;&#x4EE5;&#x60F3;&#x8981;&#x67E5;&#x8BE2;&#x6570;&#x636E;&#x5C31;&#x6309;&#x7167;JSON&#x5BF9;&#x8C61;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#xFF0C;&#x6240;&#x4EE5;&#x4F60;&#x80FD;&#x600E;&#x4E48;&#x8BBF;&#x95EE;&#x5C31;&#x80FD;&#x600E;&#x4E48;&#x67E5;&#x8BE2;&#xFF0C;&#x6BD4;&#x5982;&#x5BF9;&#x5D4C;&#x5957;&#x5BF9;&#x8C61;&#x6216;&#x8005;&#x6570;&#x636E;&#x5BF9;&#x8C61;&#x7684;&#x6570;&#x636E;&#x3002;</p>
<p><strong>&#x5BF9;&#x5185;&#x5D4C;&#x5BF9;&#x8C61;&#x7684;&#x67E5;&#x8BE2;</strong></p>
<p>&#x5982;&#x679C;&#x5B58;&#x5728;&#x8FD9;&#x6837;&#x7684;&#x6570;&#x636E;:
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">db.user.<span class="keyword">insert</span>(</span><br><span class="line">{</span><br><span class="line">    name:<span class="string">&quot;&#x5F20;&#x4E09;&quot;</span>,</span><br><span class="line">    age:<span class="number">20</span>,</span><br><span class="line">    sex:<span class="string">&quot;&#x7537;&quot;</span>,</span><br><span class="line">    sale_books:[</span><br><span class="line">        {</span><br><span class="line">            name:<span class="string">&quot;&#x94A2;&#x94C1;&#x600E;&#x4E48;&#x7EC3;&#x6210;&#x7684;&quot;</span>,</span><br><span class="line">            price:<span class="number">69</span></span><br><span class="line">        },</span><br><span class="line">        {</span><br><span class="line">            name:<span class="string">&quot;Spring&#x63ED;&#x79D8;&quot;</span>,</span><br><span class="line">            price:<span class="number">87</span></span><br><span class="line">        },</span><br><span class="line">        {</span><br><span class="line">            name:<span class="string">&quot;MongoDb&#x5B9E;&#x6218;&quot;</span>,</span><br><span class="line">            price:<span class="number">54</span></span><br><span class="line">        }</span><br><span class="line">    ],</span><br><span class="line">     address: {</span><br><span class="line">         zipCode: <span class="number">632185</span>,</span><br><span class="line">         name: <span class="string">&quot;&#x817E;&#x8BAF;&#x5927;&#x5B66;287&#x53F7;&quot;</span></span><br><span class="line">     }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>&#x6211;&#x73B0;&#x5728;&#x60F3;&#x8981;&#x67E5;&#x8BE2;MongoDb&#x5B9E;&#x6218;&#x8FD9;&#x672C;&#x4E66;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x600E;&#x4E48;&#x67E5;&#xFF1F;</p>
<p><figure class="highlight golo"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.user.<span class="keyword">find</span>({</span><br><span class="line">    <span class="string">&quot;sale_books.name&quot;</span> : <span class="string">&quot;MongoDb&#x5B9E;&#x6218;&quot;</span></span><br><span class="line">});</span><br></pre></td></tr></table></figure></p>
<p>&#x4F46;&#x662F;&#x8FD0;&#x884C;&#x8FD9;&#x6761;sql&#x8BED;&#x53E5;&#x4F1A;&#x8FD4;&#x56DE;sale_books&#x6570;&#x636E;&#x4E2D;&#x5176;&#x4ED6;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x5982;&#x4F55;&#x53EA;&#x8FD4;&#x56DE;MongoDb&#x5B9E;&#x6218;&#x7684;&#x6570;&#x636E;&#x5462;&#xFF1F;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x8003;&#x8651;&#x4F7F;&#x7528;projection&#x7684;&#x65B9;&#x5F0F;,&#x90A3;&#x4E48;&#x4E0B;&#x9762;&#x8FD9;&#x79CD;&#x5C31;&#x53EF;&#x4EE5;&#x6EE1;&#x8DB3;&#x9700;&#x6C42;</p>
<p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">db.user.find(</span><br><span class="line">{</span><br><span class="line">    <span class="string">&quot;sale_books.name&quot;</span> : <span class="string">&quot;MongoDb&#x5B9E;&#x6218;&quot;</span></span><br><span class="line">},</span><br><span class="line">{</span><br><span class="line">    # $&#x7528;&#x4E8E;&#x904D;&#x5386;&#x6570;&#x7EC4;&#x7684;&#x4E0B;&#x6807;</span><br><span class="line">    <span class="string">&quot;sale_books.$&quot;</span>:<span class="number">1</span></span><br><span class="line">});</span><br><span class="line"></span><br><span class="line">&#x6216;&#x8005;&#x8FD9;&#x6837;</span><br><span class="line"></span><br><span class="line">db.user.find(</span><br><span class="line">sale_books: {</span><br><span class="line">  <span class="variable">$elemMatch</span>: {</span><br><span class="line">   name: <span class="string">&quot;MongoDb&#x5B9E;&#x6218;&quot;</span></span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">},</span><br><span class="line">{</span><br><span class="line">  <span class="string">&quot;sale_books.$&quot;</span>:<span class="number">1</span></span><br><span class="line">}</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>&#x770B;&#x4E0A;&#x53BB;&#x548C;&#x8BBF;&#x95EE;json&#x5BF9;&#x8C61;&#x7684;&#x65B9;&#x5F0F;&#x662F;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x6CA1;&#x9519;&#x8FD9;&#x5C31;&#x662F;mongodb&#x7684;&#x67E5;&#x8BE2;&#x65B9;&#x5F0F;&#x3002;</p>
<p>&#x66F4;&#x591A;&#x7684;&#x5173;&#x4E8E;&#x6570;&#x636E;&#x5BF9;&#x8C61;&#x7684;&#x589E;&#x5220;&#x6539;&#x67E5;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;(<a href="https://blog.csdn.net/leshami/article/details/55192965" target="_blank" rel="external">https://blog.csdn.net/leshami/article/details/55192965</a>).</p>
<p>&#x5173;&#x4E8E;query&#x7684;&#x7528;&#x6CD5;&#x57FA;&#x672C;&#x53EF;&#x4EE5;&#x603B;&#x7ED3;&#x4E3A;&#x4EE5;&#x4E0B;&#x4E09;&#x79CD;:</p>
<p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. equal&#x7684;&#x67E5;&#x8BE2;&#x8BED;&#x6CD5;: { &lt;field1&gt;: &lt;value1&gt;, ... },&#x6BD4;&#x5982;db.inventory.find( { status: <span class="string">&quot;D&quot;</span> } )</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>. &#x4F7F;&#x7528;&#x67E5;&#x8BE2;&#x64CD;&#x4F5C;&#x7B26;&#x7684;&#x67E5;&#x8BE2;&#x8BED;&#x6CD5;: { &lt;field1&gt;: { &lt;operator1&gt;: &lt;value1&gt; }, ... },&#x6BD4;&#x5982;db.inventory.find( { status: { <span class="variable">$in</span>: [ <span class="string">&quot;A&quot;</span>, <span class="string">&quot;D&quot;</span> ] } } )</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>. {&lt;operator1&gt; : { &lt;field1&gt;: { &lt;operator1&gt;: &lt;value1&gt; }}},&#x6BD4;&#x5982;or&#x7684;&#x7528;&#x6CD5;</span><br></pre></td></tr></table></figure></p>
<h5 id="projection&#x7684;&#x7528;&#x6CD5;">projection&#x7684;&#x7528;&#x6CD5;</h5>
<p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="preprocessor"># inclusion&#x6A21;&#x5F0F; &#x6307;&#x5B9A;&#x8FD4;&#x56DE;&#x7684;&#x952E;&#xFF0C;&#x4E0D;&#x8FD4;&#x56DE;&#x5176;&#x4ED6;&#x952E;</span></span><br><span class="line">db.collection.find(query, {name: <span class="number">1</span>, age: <span class="number">1</span>})</span><br><span class="line"></span><br><span class="line"><span class="preprocessor"># exclusion&#x6A21;&#x5F0F; &#x6307;&#x5B9A;&#x4E0D;&#x8FD4;&#x56DE;&#x7684;&#x952E;,&#x8FD4;&#x56DE;&#x5176;&#x4ED6;&#x952E;,&#x9ED8;&#x8BA4;&#x4F1A;&#x8FD4;&#x56DE;_id,&#x5982;&#x679C;&#x4E0D;&#x60F3;&#x8FD4;&#x56DE;&#x9700;&#x8981;&#x624B;&#x52A8;&#x6307;&#x5B9A;</span></span><br><span class="line">db.collection.find(query, {name: <span class="number">0</span>, age: <span class="number">0</span>})</span><br><span class="line"></span><br><span class="line"><span class="preprocessor"># &#x4E24;&#x79CD;&#x6A21;&#x5F0F;&#x4E0D;&#x53EF;&#x6DF7;&#x7528;&#xFF08;&#x56E0;&#x4E3A;&#x8FD9;&#x6837;&#x7684;&#x8BDD;&#x65E0;&#x6CD5;&#x63A8;&#x65AD;&#x5176;&#x4ED6;&#x952E;&#x662F;&#x5426;&#x5E94;&#x8FD4;&#x56DE;&#xFF09;</span></span><br><span class="line"><span class="preprocessor"># &#x9519;&#x8BEF;</span></span><br><span class="line">db.collection.find(query, {title: <span class="number">1</span>, by: <span class="number">0</span>})</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="preprocessor"># &#x76F8;&#x5F53;&#x4E8E;select name from user where age = <span class="number">20</span>;</span></span><br><span class="line">db.user.find({age:<span class="number">20</span>},{name:<span class="number">1</span>});</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x4FEE;&#x6539;&#x6570;&#x636E;">&#x4FEE;&#x6539;&#x6570;&#x636E;</h4>
<p>&#x5E38;&#x7528;&#x8BED;&#x6CD5;&#x683C;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db<span class="class">.collection</span><span class="class">.update</span>(&lt;<span class="attribute">filter</span>&gt;, &lt;update&gt;, &lt;options&gt;)</span><br><span class="line">db<span class="class">.collection</span><span class="class">.updateOne</span>(&lt;<span class="attribute">filter</span>&gt;, &lt;update&gt;, &lt;options&gt;)</span><br><span class="line">db<span class="class">.collection</span><span class="class">.updateMany</span>(&lt;<span class="attribute">filter</span>&gt;, &lt;update&gt;, &lt;options&gt;)</span><br><span class="line">db<span class="class">.collection</span><span class="class">.replaceOne</span>(&lt;<span class="attribute">filter</span>&gt;, &lt;update&gt;, &lt;options&gt;)</span><br></pre></td></tr></table></figure></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5173;&#x4E8E;update&#x7684;&#x64CD;&#x4F5C;&#x4E3B;&#x8981;&#x6709;&#x4E09;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x662F;&#x67E5;&#x8BE2;&#x6761;&#x4EF6;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x662F;&#x9700;&#x8981;&#x66F4;&#x65B0;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x7B2C;&#x4E09;&#x4E2A;&#x662F;&#x4E00;&#x4E9B;&#x7279;&#x6B8A;&#x9009;&#x9879;&#xFF0C;update&#x7684;&#x8BED;&#x6CD5;&#x4E5F;&#x662F;json&#x683C;&#x5F0F;(&#x8BB0;&#x4F4F;&#x6240;&#x6709;&#x7684;&#x8BED;&#x6CD5;&#x90FD;&#x662F;json&#x683C;&#x5F0F;)</p>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">  <span class="tag">&lt;<span class="title">update</span> <span class="attribute">operator</span>&gt;</span>: { <span class="tag">&lt;<span class="title">field1</span>&gt;</span>: <span class="tag">&lt;<span class="title">value1</span>&gt;</span>, ... },</span><br><span class="line">  <span class="tag">&lt;<span class="title">update</span> <span class="attribute">operator</span>&gt;</span>: { <span class="tag">&lt;<span class="title">field2</span>&gt;</span>: <span class="tag">&lt;<span class="title">value2</span>&gt;</span>, ... },</span><br><span class="line">  ...</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x6F14;&#x793A;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x60F3;&#x8981;&#x5B9E;&#x73B0;&#x8FD9;&#x6837;&#x7684;sql&#x8BED;&#x53E5;,</p>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">update</span> <span class="keyword">user</span> <span class="keyword">set</span> age = age + <span class="number">1</span> <span class="keyword">where</span> <span class="keyword">name</span> = <span class="string">&apos;&#x5F20;&#x4E09;&apos;</span></span></span><br></pre></td></tr></table></figure></p>
<p>&#x90A3;&#x4E48;&#x5BF9;&#x5E94;&#x7684;mongo&#x67E5;&#x8BE2;&#x53EF;&#x4EE5;&#x8FD9;&#x6837;&#x5199;&#xFF1A;</p>
<p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">db.getCollection(<span class="string">&apos;user&apos;</span>).updateOne(</span><br><span class="line">{</span><br><span class="line">    name:<span class="string">&quot;&#x5F20;&#x4E09;&quot;</span></span><br><span class="line">},</span><br><span class="line">{</span><br><span class="line">    <span class="variable">$inc</span>:</span><br><span class="line">        {</span><br><span class="line">            age:<span class="number">1</span></span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>&#x7B2C;&#x4E09;&#x4E2A;&#x53C2;&#x6570;&#x6709;&#x65F6;&#x5019;&#x4E5F;&#x53EF;&#x80FD;&#x7528;&#x5230;&#xFF0C;&#x4ED6;&#x4EEC;&#x7684;&#x53C2;&#x6570;&#x5982;&#x4E0B;&#xFF1A;
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line"><span class="label">     upsert:</span> &lt;<span class="typename">boolean</span>&gt;,</span><br><span class="line"><span class="label">     multi:</span> &lt;<span class="typename">boolean</span>&gt;,</span><br><span class="line"><span class="label">     writeConcern:</span> &lt;document&gt;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="string">upsert :</span> &#x53EF;&#x9009;&#xFF0C;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x610F;&#x601D;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x5B58;&#x5728;update&#x7684;&#x8BB0;&#x5F55;&#xFF0C;&#x662F;&#x5426;&#x63D2;&#x5165;update&#x6307;&#x5B9A;&#x7684;&#x5BF9;&#x8C61;,<span class="literal">true</span>&#x4E3A;&#x63D2;&#x5165;&#xFF0C;&#x9ED8;&#x8BA4;&#x662F;<span class="literal">false</span>&#xFF0C;&#x4E0D;&#x63D2;&#x5165;&#x3002;</span><br><span class="line"><span class="string">multi :</span> &#x53EF;&#x9009;&#xFF0C;mongodb &#x9ED8;&#x8BA4;&#x662F;<span class="literal">false</span>,&#x53EA;&#x66F4;&#x65B0;&#x627E;&#x5230;&#x7684;&#x7B2C;&#x4E00;&#x6761;&#x8BB0;&#x5F55;&#xFF0C;&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x4E3A;<span class="literal">true</span>,&#x5C31;&#x628A;&#x6309;&#x6761;&#x4EF6;&#x67E5;&#x51FA;&#x6765;&#x591A;&#x6761;&#x8BB0;&#x5F55;&#x5168;&#x90E8;&#x66F4;&#x65B0;&#x3002;</span><br><span class="line"><span class="string">writeConcern :</span>&#x53EF;&#x9009;&#xFF0C;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#x7684;&#x7EA7;&#x522B;&#x3002;</span><br></pre></td></tr></table></figure></p>
<p>&#x5982;&#x679C;&#x60F3;&#x8981;&#x7ED9;&#x4E00;&#x6761;&#x8BB0;&#x5F55;&#x65B0;&#x589E;&#x4E00;&#x4E2A;sex&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x8FD9;&#x6837;&#x5199;</p>
<p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.user.<span class="keyword">update</span>({name:<span class="string">&quot;&#x5F20;&#x4E09;&quot;</span>},{<span class="variable">$set</span>:{sex:<span class="string">&quot;male&quot;</span>}},{upsert:true})</span><br></pre></td></tr></table></figure></p>
<p>update&#x652F;&#x6301;&#x7684;&#x64CD;&#x4F5C;&#x7B26;&#x5728;&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x770B;&#x5230;(<a href="https://docs.mongodb.com/manual/reference/operator/update-field/" target="_blank" rel="external">https://docs.mongodb.com/manual/reference/operator/update-field/</a>)</p>
<h4 id="&#x5220;&#x9664;&#x6570;&#x636E;">&#x5220;&#x9664;&#x6570;&#x636E;</h4>
<p>&#x5220;&#x9664;&#x6570;&#x636E;&#x7684;&#x65B9;&#x6CD5;&#x4E3B;&#x8981;&#x6709;2&#x4E2A;,&#x5B83;&#x4EEC;&#x7684;&#x8BED;&#x6CD5;&#x683C;&#x5F0F;&#x4E5F;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x662F;&#x6309;&#x7167;query&#x7684;&#x8BED;&#x6CD5;&#x6765;&#x8FDB;&#x884C;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x5220;&#x9664;&#x6570;&#x636E;&#x7684;&#x8BED;&#x6CD5;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x67E5;&#x8BE2;&#x6570;&#x636E;&#x90A3;&#x4E00;&#x8282;&#x3002;</p>
<p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db<span class="class">.collection</span><span class="class">.deleteMany</span>()</span><br><span class="line">db<span class="class">.collection</span><span class="class">.deleteOne</span>()</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x5907;&#x4EFD;&#x6570;&#x636E;">&#x5907;&#x4EFD;&#x6570;&#x636E;</h4>
<p>&#x5BFC;&#x51FA;&#x53EA;&#x80FD;&#x5728;&#x672C;&#x5730;&#x547D;&#x4EE4;&#x884C;&#x6267;&#x884C;&#x800C;&#x4E0D;&#x662F;mongo shell&#x4E2D;&#x6267;&#x884C;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x7528;&#x7528;mongo&#x5148;&#x8FDB;&#x5165;&#x5230;&#x547D;&#x4EE4;&#x884C;&#x754C;&#x9762;&#xFF0C;&#x5982;&#x679C;&#x65F6;&#x5BFC;&#x51FA;&#x672C;&#x5730;&#x6570;&#x636E;&#x5219;&#x4E0D;&#x7528;&#x6DFB;&#x52A0;-h&#x53C2;&#x6570;</p>
<p><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mongoexport -h host:port -u username -p password -d databaseName -c collectionName -o exportFilePath --type json/csv -f field</span><br><span class="line"></span><br><span class="line">&#x53C2;&#x6570;&#x8BF4;&#x660E;:</span><br><span class="line">    -<span class="ruby">h <span class="symbol">:</span> &#x4E3B;&#x673A;&#x5730;&#x5740;</span><br><span class="line"></span>    -<span class="ruby">u <span class="symbol">:</span> &#x7528;&#x6237;&#x540D;</span><br><span class="line"></span>    -<span class="ruby">p &#xFF1A;&#x5BC6;&#x7801;</span><br><span class="line"></span>    -<span class="ruby">d &#xFF1A;&#x6570;&#x636E;&#x5E93;&#x540D;</span><br><span class="line"></span>    -<span class="ruby">c &#xFF1A;collection&#x540D;</span><br><span class="line"></span>    -<span class="ruby">o &#xFF1A;&#x8F93;&#x51FA;&#x7684;&#x6587;&#x4EF6;&#x540D;</span><br><span class="line"></span>    -<span class="ruby">-type &#xFF1A; &#x8F93;&#x51FA;&#x7684;&#x683C;&#x5F0F;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A;json&#xFF0C;&#x53EF;&#x9009;&#x4E3A;<span class="constant">CSV</span></span><br><span class="line"></span>    -<span class="ruby">f &#xFF1A;&#x8F93;&#x51FA;&#x7684;&#x5B57;&#x6BB5;&#xFF0C;&#x5982;&#x679C;-type&#x4E3A;csv&#xFF0C;&#x5219;&#x9700;&#x8981;&#x52A0;&#x4E0A;-f <span class="string">&quot;&#x5B57;&#x6BB5;&#x540D;&quot;</span></span><br><span class="line"></span></span><br><span class="line">mongoexport -h localhost:27017</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x5BFC;&#x5165;&#x6570;&#x636E;">&#x5BFC;&#x5165;&#x6570;&#x636E;</h4>
<p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mongoimport -<span class="keyword">h</span> host:port -<span class="keyword">u</span> username -p password  -<span class="keyword">d</span> dbname -c collectionname --<span class="keyword">file</span> filename --headerline --<span class="keyword">type</span> json/csv -f field</span><br><span class="line"></span><br><span class="line">&#x53C2;&#x6570;&#x8BF4;&#x660E;&#xFF1A;</span><br><span class="line">    -<span class="keyword">h</span> : &#x4E3B;&#x673A;&#x5730;&#x5740;</span><br><span class="line">    -<span class="keyword">d</span> &#xFF1A;&#x6570;&#x636E;&#x5E93;&#x540D;</span><br><span class="line">    -c &#xFF1A;collection&#x540D;</span><br><span class="line">    --<span class="keyword">type</span> &#xFF1A;&#x5BFC;&#x5165;&#x7684;&#x683C;&#x5F0F;&#x9ED8;&#x8BA4;json</span><br><span class="line">    -f &#xFF1A;&#x5BFC;&#x5165;&#x7684;&#x5B57;&#x6BB5;&#x540D;</span><br><span class="line">    --headerline &#xFF1A;&#x5982;&#x679C;&#x5BFC;&#x5165;&#x7684;&#x683C;&#x5F0F;&#x662F;csv&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7B2C;&#x4E00;&#x884C;&#x7684;&#x6807;&#x9898;&#x4F5C;&#x4E3A;&#x5BFC;&#x5165;&#x7684;&#x5B57;&#x6BB5;</span><br><span class="line">    --<span class="keyword">file</span> &#xFF1A;&#x8981;&#x5BFC;&#x5165;&#x7684;&#x6587;&#x4EF6;</span><br><span class="line"></span><br><span class="line">mongoimport -<span class="keyword">h</span> localhost:27017 -<span class="keyword">d</span> <span class="keyword">local</span>-<span class="keyword">test</span> -c userSetting --<span class="keyword">file</span> <span class="keyword">E</span>:/userSetting.json --<span class="keyword">type</span> json</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x6267;&#x884C;&#x811A;&#x672C;">&#x6267;&#x884C;&#x811A;&#x672C;</h4>
<p>&#x5728;mysql&#x91CC;&#x9762;&#x6211;&#x53EF;&#x4EE5;&#x7528;mysql&#x547D;&#x4EE4;&#x76F4;&#x63A5;&#x8FD0;&#x884C;&#x811A;&#x672C;&#xFF0C;&#x5728;mongo&#x91CC;&#x9762;&#x6211;&#x4EEC;&#x540C;&#x6837;&#x53EF;&#x4EE5;&#xFF0C;&#x53EA;&#x662F;mongo&#x91CC;&#x9762;&#x7684;&#x811A;&#x672C;&#x5C31;&#x662F;js,&#x8FD9;&#x91CC;&#x9762;&#x4F60;&#x53EF;&#x4EE5;&#x7528;&#x4E0A;&#x9762;&#x7528;&#x5230;&#x7684;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;insert,find,update,delete&#x4E4B;&#x7C7B;&#x7684;&#xFF0C;&#x8FD9;&#x4E2A;&#x811A;&#x672C;&#x91CC;&#x9762;&#x5C31;&#x662F;js&#x8BED;&#x6CD5;&#xFF0C;js&#x7684;&#x4E00;&#x4E9B;&#x7279;&#x6027;&#x4E5F;&#x662F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7684;&#x3002;&#x6BD4;&#x5982;&#x6211;&#x60F3;&#x5411;&#x4E0D;&#x540C;&#x56FD;&#x5BB6;&#x7684;user&#x4E2D;&#x63D2;&#x5165;&#x4E00;&#x6761;&#x6570;&#x636E;</p>
<p>user.js&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">insertUser</span>(<span class="params">country</span>) </span>{</span><br><span class="line">    <span class="keyword">var</span> collectionName = <span class="string">&quot;user_info&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> userData = db.getCollection(collectionName).find({<span class="string">&quot;country&quot;</span>:country});</span><br><span class="line">    <span class="keyword">var</span> desc = <span class="string">&quot;Hello, my country is &quot;</span> + country;</span><br><span class="line">    db.getCollection(collectionName).insert({<span class="string">&quot;conuntry&quot;</span>:country,<span class="string">&quot;desc&quot;</span>:desc});</span><br><span class="line">}</span><br><span class="line">[<span class="string">&quot;CN&quot;</span>,<span class="string">&quot;UK&quot;</span>].forEach(<span class="function"><span class="keyword">function</span>(<span class="params">c</span>) </span>{insertUser(c)});</span><br></pre></td></tr></table></figure></p>
<p>&#x5728;&#x547D;&#x4EE4;&#x884C;&#x6267;&#x884C;</p>
<p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">mong</span> host:<span class="foreign"><span class="keyword">port</span>/databaseName filePath.js</span></span><br></pre></td></tr></table></figure></p>
<p>&#x5373;&#x53EF;,&#x6216;&#x8005;&#x5728;mongo shell&#x4E2D;&#x91C7;&#x7528;load&#x7684;&#x65B9;&#x5F0F;&#x6267;&#x884C;&#x5373;&#x53EF;&#xFF0C;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#x5982;&#x679C;&#x8BED;&#x6CD5;&#x6709;&#x9519;&#x8BEF;&#x53EF;&#x80FD;&#x4F1A;&#x8BF4;&#x62A5;file doesn&apos;t exist&#x7684;&#x95EE;&#x9898;&#x3002;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x52A0;&#x4E0A;--quiet&#x7684;&#x65B9;&#x5F0F;&#x4F1A;&#x6709;&#x4E00;&#x4E9B;&#x9519;&#x8BEF;&#x63D0;&#x793A;&#x3002;&#x5982;&#x679C;&#x60F3;&#x67E5;&#x770B;&#x66F4;&#x591A;&#x7684;&#x53C2;&#x6570;&#x4F7F;&#x7528;mongo --help&#x7684;&#x65B9;&#x5F0F;&#x67E5;&#x770B;</p>
]]></content>
    <summary type="html">
    <![CDATA[从关系型数据库突然转战到Mongodb最开始很是不习惯，但是好在官网的文档写得也挺详细的,一个数据库最重要的什么？当然是增删改查了，所以只要掌握了增删改查就可以解决平时80%的问题了，本文就抛砖引玉快速的学习下mongodb的使用。]]>
    
    </summary>
    
      <category term="mongodb" scheme="http://yoursite.com/tags/mongodb/"/>
    
      <category term="mongodb" scheme="http://yoursite.com/categories/mongodb/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[关于锁使用的补充说明]]></title>
    <link href="http://yoursite.com/2018/07/24/something-about-synchronized/"/>
    <id>http://yoursite.com/2018/07/24/something-about-synchronized/</id>
    <published>2018-07-24T13:26:25.000Z</published>
    <updated>2018-10-28T13:15:35.895Z</updated>
    <content type="html"><![CDATA[<p>&#x4E0A;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x6211;&#x8BB2;&#x4E86;&#x4E0B;synchronized&#x5173;&#x4E8E;&#x9501;&#x4F18;&#x5316;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4F46;&#x662F;&#x8FD8;&#x662F;&#x6709;&#x4EBA;&#x4E0D;&#x592A;&#x6E05;&#x695A;&#x4E34;&#x754C;&#x533A;&#x5230;&#x5E95;&#x662F;&#x4EC0;&#x4E48;&#xFF0C;&#x4E5F;&#x5BF9;notify&#x7684;&#x673A;&#x5236;&#x6709;&#x70B9;&#x7591;&#x60D1;&#xFF0C;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x5C31;&#x6765;&#x5206;&#x6790;&#x4E00;&#x4E0B;&#x3002;</p>
<h3 id="&#x4EC0;&#x4E48;&#x662F;&#x4E34;&#x754C;&#x533A;">&#x4EC0;&#x4E48;&#x662F;&#x4E34;&#x754C;&#x533A;</h3>
<p>&#x6211;&#x4EEC;&#x90FD;&#x77E5;&#x9053;Synchroinzed&#x53EF;&#x4EE5;&#x4FEE;&#x9970;&#x4EE3;&#x7801;&#x5757;&#xFF0C;&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;,&#x9759;&#x6001;&#x65B9;&#x6CD5;&#xFF0C;&#x533A;&#x522B;&#x53EA;&#x662F;&#x6301;&#x6709;&#x7684;&#x5BF9;&#x8C61;&#x9501;&#x4E0D;&#x4E00;&#x6837;&#x7F62;&#x4E86;&#xFF0C;&#x6301;&#x6709;&#x4E86;&#x8FD9;&#x628A;&#x9501;&#x4F60;&#x5C31;&#x53EF;&#x4EE5;&#x4E3A;&#x6240;&#x6B32;&#x4E3A;&#x4E86;&#xFF0C;&#x5C31;&#x597D;&#x6BD4;&#x5F88;&#x591A;&#x4EBA;&#x53BB;&#x62A2;&#x5395;&#x6240;&#xFF0C;&#x5982;&#x679C;&#x5927;&#x5BB6;&#x90FD;&#x5728;&#x4E00;&#x4E2A;&#x5395;&#x6240;&#x91CC;&#x9762;&#x4E0A;&#xFF0C;&#x90A3;&#x4E48;&#x5F88;&#x660E;&#x663E;&#x4F1A;&#x53D1;&#x751F;&#x5F88;&#x591A;&#x4E0D;&#x53EF;&#x63CF;&#x8FF0;&#x7684;&#x4E8B;&#x513F;,&#x6240;&#x4EE5;&#x5C31;&#x9700;&#x8981;&#x53BB;&#x62A2;&#x5395;&#x6240;&#x7684;&#x4F7F;&#x7528;&#xFF0C;&#x4F60;&#x62A2;&#x5230;&#x4E86;&#x7136;&#x540E;&#x4F60;&#x8FDB;&#x53BB;&#x5395;&#x6240;&#x628A;&#x95E8;&#x53CD;&#x9501;&#x4E86;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x522B;&#x4EBA;&#x8FDB;&#x4E0D;&#x6765;&#xFF0C;&#x5395;&#x6240;&#x91CC;&#x9762;&#x7684;&#x516C;&#x5171;&#x8D44;&#x6E90;&#x4F60;&#x60F3;&#x600E;&#x6837;&#x7528;&#x5C31;&#x600E;&#x6837;&#x7528;&#xFF0C;&#x53EA;&#x6709;&#x7B49;&#x4F60;&#x51FA;&#x6765;&#x4E4B;&#x540E;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x5176;&#x4ED6;&#x4EBA;&#x624D;&#x80FD;&#x53BB;&#x62A2;&#x5395;&#x6240;&#x3002;&#x5982;&#x679C;&#x5728;&#x4F60;&#x51C6;&#x5907;&#x4E0A;&#x5395;&#x6240;&#x7684;&#x65F6;&#x5019;&#x4F60;&#x53D1;&#x73B0;&#x6CA1;&#x6709;&#x5395;&#x7EB8;&#x4E86;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x4F60;&#x5F97;&#x8981;&#x5148;&#x53BB;&#x62FF;&#x7EB8;&#xFF0C;&#x8BA9;&#x522B;&#x4EBA;&#x5148;&#x7528;&#x5395;&#x6240;&#x4E86;&#x3002;</p>
<p>&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x4E5F;&#x5F88;&#x597D;&#x7684;&#x8BF4;&#x660E;&#x4E86;&#x4E34;&#x754C;&#x533A;(&#x4E0A;&#x9762;&#x6545;&#x4E8B;&#x7684;&#x5395;&#x6240;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x516C;&#x5171;&#x8D44;&#x6E90;),&#x5F53;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x53BB;&#x7ADE;&#x4E89;&#x7684;&#x65F6;&#x5019;&#x83B7;&#x53D6;&#x9501;&#x7684;&#x8FD9;&#x4E2A;&#x7EBF;&#x7A0B;&#x5C31;&#x53EF;&#x4EE5;&#x5B89;&#x5168;&#x7684;&#x6267;&#x884C;&#xFF0C;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x539F;&#x5B50;&#x6027;&#xFF0C;&#x4E00;&#x81F4;&#x6027;&#xFF0C;&#x987A;&#x5E8F;&#x6027;(JMM)&#x3002;&#x83B7;&#x53D6;&#x9501;&#x8FD9;&#x4E2A;&#x64CD;&#x4F5C;&#x662F;&#x901A;&#x8FC7;monitorenter,&#x9000;&#x51FA;&#x4E34;&#x754C;&#x533A;&#x7684;&#x65F6;&#x5019;&#x662F;&#x6267;&#x884C;monitorexit&#x6307;&#x4EE4;,&#x6B64;&#x65F6;&#x4F1A;&#x91CA;&#x653E;&#x6301;&#x6709;&#x7684;&#x9501;&#x3002;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x7EE7;&#x7EED;&#x53BB;&#x7ADE;&#x4E89;,&#x81F3;&#x4E8E;&#x662F;&#x8C01;&#x7ADE;&#x4E89;&#x4E0A;&#x5C31;&#x53D6;&#x51B3;&#x4E8E;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x4E86;,&#x7EBF;&#x7A0B;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x5E76;&#x4E0D;&#x4E00;&#x5B9A;&#x80FD;&#x8D77;&#x4F5C;&#x7528;&#xFF0C;&#x56E0;&#x4E3A;&#x8C03;&#x5EA6;&#x662F;&#x53D6;&#x51B3;&#x4E8E;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#xFF0C;&#x4E0D;&#x540C;&#x7684;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;&#x53EF;&#x80FD;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x603B;&#x5171;&#x53EA;&#x6709;&#x4E09;&#x4E2A;&#x7EA7;&#x522B;&#xFF0C;&#x4F46;&#x662F;java&#x4E2D;&#x662F;&#x4ECE;1&#x5230;10&#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x5FC5;&#x7136;&#x4F1A;&#x5BFC;&#x81F4;&#x6709;&#x91CD;&#x590D;&#xFF0C;&#x6240;&#x4EE5;&#x8C03;&#x5EA6;&#x4E0D;&#x8981;&#x5B8C;&#x5168;&#x4F9D;&#x8D56;&#x4F18;&#x5148;&#x7EA7;&#x3002;</p>
<p>&#x5F53;&#x9047;&#x5230;&#x6CA1;&#x6709;&#x5E26;&#x5395;&#x7EB8;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5176;&#x5B9E;&#x8FD9;&#x4E5F;&#x5BF9;&#x5E94;&#x4E86;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x5C31;&#x662F;&#x5728;&#x6267;&#x884C;&#x67D0;&#x4E9B;&#x64CD;&#x4F5C;&#x7684;&#x65F6;&#x5019;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x7B49;&#x5F85;&#x5176;&#x4ED6;&#x6761;&#x4EF6;&#x5148;&#x6EE1;&#x8DB3;&#x5728;&#x6267;&#x884C;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x4F60;&#x5C31;&#x4F1A;&#x8BA9;&#x51FA;&#x8FD9;&#x628A;&#x9501;&#xFF0C;&#x8BA9;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x53BB;&#x6267;&#x884C;&#xFF0C;&#x7B49;&#x5230;&#x6761;&#x4EF6;&#x6EE1;&#x8DB3;&#x4E86;&#x4E4B;&#x540E;&#x4F60;&#x5728;&#x53BB;&#x8FD0;&#x884C;&#x3002;</p>
<p>&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#x5F53;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5206;&#x914D;&#x7ED9;&#x6211;&#x4EEC;&#x7684;&#x65F6;&#x95F4;&#x7247;&#x7528;&#x5B8C;&#x4E86;&#x7684;&#x65F6;&#x5019;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x5E76;&#x4E0D;&#x4F1A;&#x8BA9;&#x51FA;&#x9501;(Thread.sleep)&#xFF0C;&#x800C;&#x662F;&#x4F1A;&#x7B49;&#x5F85;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x8C03;&#x5EA6;&#xFF0C;&#x7B49;&#x5230;&#x4E0B;&#x4E00;&#x6B21;&#x6267;&#x884C;&#x3002;</p>
<h3 id="&#x8C03;&#x7528;&#x4E86;notifyall&#x540E;&#x8C01;&#x4F1A;&#x88AB;&#x5524;&#x9192;">&#x8C03;&#x7528;&#x4E86;notify(All)&#x540E;&#x8C01;&#x4F1A;&#x88AB;&#x5524;&#x9192;&#xFF1F;</h3>
<p>&#x8FD9;&#x91CC;&#x5B58;&#x5728;<strong>&#x4E24;&#x79CD;&#x60C5;&#x51B5;</strong></p>
<ol>
<li>&#x5982;&#x679C;&#x662F;&#x901A;&#x8FC7;notify&#x6765;&#x5524;&#x8D77;&#x7684;&#x7EBF;&#x7A0B;&#xFF0C;&#x90A3;&#x5148;&#x8FDB;&#x5165;wait&#x7684;&#x7EBF;&#x7A0B;&#x4F1A;&#x5148;&#x88AB;&#x5524;&#x8D77;&#x6765;</li>
<li>&#x5982;&#x679C;&#x662F;&#x901A;&#x8FC7;nootifyAll&#x5524;&#x8D77;&#x7684;&#x7EBF;&#x7A0B;&#xFF0C;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x662F;&#x6700;&#x540E;&#x8FDB;&#x5165;&#x7684;&#x4F1A;&#x5148;&#x88AB;&#x5524;&#x8D77;&#x6765;&#xFF0C;&#x5373;LIFO&#x7684;&#x7B56;&#x7565;</li>
</ol>
<p>&#x9A8C;&#x8BC1;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x770B;&#x770B;&#x4E0B;&#x9762;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NotifyTest</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        Object lock  = <span class="keyword">new</span> Object();</span><br><span class="line">        Thread p = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Producer(lock));</span><br><span class="line">        Thread con = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Consumer(lock));</span><br><span class="line"></span><br><span class="line">        p.start();</span><br><span class="line">        con.start();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Producer</span> <span class="keyword">implements</span>  <span class="title">Runnable</span> </span>{</span><br><span class="line"></span><br><span class="line">    Object lock;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Producer</span><span class="params">(Object obj)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.lock = obj;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">synchronized</span> (lock) {</span><br><span class="line">            <span class="keyword">try</span> {</span><br><span class="line">                System.out.println(<span class="string">&quot;producer will wait&quot;</span>);</span><br><span class="line">                lock.wait();</span><br><span class="line">                System.out.println(<span class="string">&quot;producer wait over&quot;</span>);</span><br><span class="line">            } <span class="keyword">catch</span> (InterruptedException e) {</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> <span class="keyword">implements</span>  <span class="title">Runnable</span> </span>{</span><br><span class="line"></span><br><span class="line">    Object lock;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Consumer</span><span class="params">(Object obj)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.lock = obj;</span><br><span class="line">    }</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            <span class="comment">//&#x6A21;&#x62DF;producer&#x5148;&#x6267;&#x884C;</span></span><br><span class="line">            Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">        } <span class="keyword">catch</span> (InterruptedException e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">synchronized</span> (lock) {</span><br><span class="line">            System.out.println(<span class="string">&quot;consumer will notify&quot;</span>);</span><br><span class="line">            lock.notify();</span><br><span class="line">            System.out.println(<span class="string">&quot;producer notify over&quot;</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#x5982;&#x4E0B;:</p>
<p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">producer will wait</span><br><span class="line">consumer will notify</span><br><span class="line">producer notify <span class="keyword">over</span></span><br><span class="line">producer wait <span class="keyword">over</span></span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x4E2A;&#x7ED3;&#x679C;&#x8BC1;&#x660E;&#x4E86;&#x6211;&#x521A;&#x624D;&#x8BF4;&#x7684;&#xFF0C;&#x53EA;&#x6709;&#x5728;&#x9000;&#x51FA;&#x540C;&#x6B65;&#x4EE3;&#x7801;&#x5757;&#x4E4B;&#x540E;&#x624D;&#x4F1A;&#x91CA;&#x653E;&#x9501;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x5728;&#x8C03;&#x7528;&#x4E86;notify(All)&#x65B9;&#x6CD5;&#x5C31;&#x9A6C;&#x4E0A;&#x53BB;&#x5524;&#x9192;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x9ED8;&#x8BA4;&#x7B56;&#x7565;&#xFF0C;&#x4E5F;&#x662F;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x7684;&#x3002;</p>
<h3 id="wait&#x7684;&#x7EBF;&#x7A0B;&#x662F;&#x5426;&#x4F1A;&#x5360;&#x7528;cpu">wait&#x7684;&#x7EBF;&#x7A0B;&#x662F;&#x5426;&#x4F1A;&#x5360;&#x7528;cpu?</h3>
<p>wait/nofity&#x662F;&#x901A;&#x8FC7;jvm&#x91CC;&#x7684;park/unpark&#x673A;&#x5236;<a href="https://github.com/openjdk-mirror/jdk7u-hotspot/blob/50bdefc3afe944ca74c3093e7448d6b889cd20d1/src/share/vm/runtime/objectMonitor.cpp#L1507" target="_blank" rel="external">wait/notify&#x5E95;&#x5C42;&#x539F;&#x7406;</a>
&#x6765;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x5728;linux&#x4E0B;&#x8FD9;&#x79CD;&#x673A;&#x5236;&#x53C8;&#x662F;&#x901A;&#x8FC7;pthread_cond_wait/pthread_cond_signal&#x6765;&#x5B8C;&#x6210;&#x7684;&#xFF0C;pthread_cond_wait&#x5176;&#x601D;&#x60F3;&#x5C31;&#x662F;&#x5148;&#x91CA;&#x653E;&#x9501;&#xFF0C;&#x8BA9;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#xFF0C;&#x7136;&#x540E;&#x8FDB;&#x5165;&#x7761;&#x7720;&#xFF0C;&#x7B49;&#x5F85;&#x88AB;&#x5524;&#x9192;&#xFF0C;&#x88AB;&#x5524;&#x9192;&#x4E4B;&#x540E;&#x91CD;&#x65B0;&#x52A0;&#x9501;&#x3002;
&#x56E0;&#x6B64;&#x5F53;&#x7EBF;&#x7A0B;&#x8FDB;&#x5165;&#x5230;wait&#x72B6;&#x6001;&#x7684;&#x65F6;&#x5019;&#x5176;&#x5B9E;&#x662F;&#x4F1A;&#x653E;&#x5F03;cpu&#x7684;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x8FD9;&#x7C7B;&#x7EBF;&#x7A0B;&#x662F;&#x4E0D;&#x4F1A;&#x5360;&#x7528;cpu&#x8D44;&#x6E90;&#x3002;</p>
]]></content>
    <summary type="html">
    <![CDATA[在涉及到临界区的时候，就不得到谈到synchronized,又不得不谈到notify,这个也是对锁的优化那一章的一些补充说明。]]>
    
    </summary>
    
      <category term="jvm" scheme="http://yoursite.com/tags/jvm/"/>
    
      <category term="多线程" scheme="http://yoursite.com/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
      <category term="多线程" scheme="http://yoursite.com/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[java中锁的优化]]></title>
    <link href="http://yoursite.com/2018/07/19/lock-optimization-about-java/"/>
    <id>http://yoursite.com/2018/07/19/lock-optimization-about-java/</id>
    <published>2018-07-19T13:22:46.000Z</published>
    <updated>2018-10-28T13:15:28.123Z</updated>
    <content type="html"><![CDATA[<h3 id="&#x4E00;&#x5207;&#x90FD;&#x59CB;&#x4E8E;&#x7EBF;&#x7A0B;thread">&#x4E00;&#x5207;&#x90FD;&#x59CB;&#x4E8E;&#x7EBF;&#x7A0B;(Thread)</h3>
<p>&#x7EBF;&#x7A0B;&#x662F;&#x6BD4;&#x8FDB;&#x7A0B;&#x66F4;&#x52A0;&#x8F7B;&#x91CF;&#x7EA7;&#x7684;&#x8C03;&#x5EA6;&#x6267;&#x884C;&#x5355;&#x4F4D;,&#x7EBF;&#x7A0B;&#x7684;&#x5F15;&#x5165;&#x53EF;&#x4EE5;&#x628A;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x8D44;&#x6E90;&#x5206;&#x914D;&#x548C;&#x6267;&#x884C;&#x8C03;&#x670D;&#x5206;&#x5F00;&#xFF0C;&#x5404;&#x4E2A;&#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;&#x5171;&#x4EAB;&#x8FDB;&#x7A0B;&#x8D44;&#x6E90;&#x53C8;&#x53EF;&#x4EE5;&#x72EC;&#x7ACB;&#x8C03;&#x5EA6;&#xFF0C;&#x4E3B;&#x6D41;&#x7684;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x90FD;&#x63D0;&#x4F9B;&#x4E86;&#x7EBF;&#x7A0B;&#x5B9E;&#x73B0;&#xFF0C;Java&#x8FD9;&#x63D0;&#x4F9B;&#x4E86;&#x5728;&#x4E0D;&#x540C;&#x786C;&#x4EF6;&#x548C;&#x4E0D;&#x540C;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5E73;&#x53F0;&#x4E0A;&#x5BF9;&#x7EBF;&#x7A0B;&#x64CD;&#x4F5C;&#x7684;&#x7EDF;&#x4E00;&#x5904;&#x7406;&#x3002;</p>
<p>&#x4E00;&#x822C;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5B9E;&#x73B0;&#x7EBF;&#x7A0B;&#x4E3B;&#x8981;&#x6709;3&#x79CD;&#x65B9;&#x5F0F;&#xFF1A;</p>
<ol>
<li>&#x4F7F;&#x7528;&#x5185;&#x6838;&#x7EBF;&#x7A0B;(&#x76F4;&#x63A5;&#x7531;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5185;&#x6838;&#x652F;&#x6301;)&#x5B9E;&#x73B0;,&#x4F46;&#x662F;&#x4E00;&#x822C;&#x90FD;&#x662F;&#x53BB;&#x4F7F;&#x7528;&#x5185;&#x6838;&#x7EBF;&#x7A0B;&#x7684;&#x4E00;&#x79CD;&#x9AD8;&#x7EA7;&#x63A5;&#x53E3;&#x2014;&#x2014;&#x8F7B;&#x91CF;&#x7EA7;&#x8FDB;&#x7A0B;</li>
<li>&#x4F7F;&#x7528;&#x7528;&#x6237;&#x7EBF;&#x7A0B;(&#x9664;&#x4E86;&#x5185;&#x6838;&#x7EBF;&#x7A0B;)&#x5B9E;&#x73B0;</li>
<li>&#x4F7F;&#x7528;&#x7528;&#x6237;&#x7EBF;&#x7A0B;&#x52A0;&#x8F7B;&#x91CF;&#x7EA7;&#x8FDB;&#x7A0B;&#x6DF7;&#x5408;&#x5B9E;&#x73B0;&#x3002;</li>
</ol>
<p>&#x800C;java&#x4E2D;&#x7684;&#x7EBF;&#x7A0B;&#x5C31;&#x662F;&#x6620;&#x5C04;&#x5230;&#x4E00;&#x6761;&#x8F7B;&#x91CF;&#x7EA7;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;,&#x6240;&#x4EE5;&#x5982;&#x679C;&#x8981;&#x963B;&#x585E;&#x6216;&#x8005;&#x5524;&#x9192;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x90FD;&#x9700;&#x8981;&#x9700;&#x8981;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x652F;&#x6301;,&#x56E0;&#x4E3A;&#x8981;&#x4ECE;&#x7528;&#x6237;&#x6001;&#x8F6C;&#x6362;&#x5230;&#x6838;&#x5FC3;&#x6001;&#x4E2D;&#x9700;&#x8981;&#x8017;&#x8D39;&#x5F88;&#x591A;&#x7684;&#x5904;&#x7406;&#x5668;&#x65F6;&#x95F4;&#xFF0C;&#x6240;&#x4EE5;&#x624D;&#x6709;&#x8BF4;&#x6CD5;&#x8BF4;synchronized&#x662F;java&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x91CD;&#x91CF;&#x7EA7;&#x7684;&#x64CD;&#x4F5C;&#x3002;&#x4F46;&#x662F;&#x4E00;&#x6765;&#x6211;&#x4EEC;&#x5F88;&#x5C11;&#x4F7F;&#x7528;(&#x4FDD;&#x8BC1;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x5904;&#x7406;synchronized&#x5173;&#x952E;&#x5B57;&#x8FD8;&#x6709;JUC&#x5305;&#x4E0B;&#x63D0;&#x4F9B;&#x7684;&#x5176;&#x4ED6;&#x652F;&#x6301;)&#xFF0C;&#x4E8C;&#x6765;&#x865A;&#x62DF;&#x673A;&#x672C;&#x8EAB;&#x4E5F;&#x505A;&#x4E86;&#x4E00;&#x4E9B;&#x4F18;&#x5316;&#xFF0C;&#x800C;&#x6211;&#x4EEC;&#x4ECA;&#x5929;&#x8C08;&#x7684;&#x5C31;&#x662F;&#x9501;&#x7684;&#x4F18;&#x5316;&#x3002;</p>
<h3 id="synchronized&#x4F60;&#x5BF9;&#x6211;&#x7684;&#x4EE3;&#x7801;&#x505A;&#x4E86;&#x4EC0;&#x4E48;">synchronized&#x4F60;&#x5BF9;&#x6211;&#x7684;&#x4EE3;&#x7801;&#x505A;&#x4E86;&#x4EC0;&#x4E48;?</h3>
<p>&#x6211;&#x4EEC;&#x90FD;&#x77E5;&#x9053;synchronized&#x5173;&#x952E;&#x5B57;&#x7ECF;&#x8FC7;&#x7F16;&#x8BD1;&#x4E4B;&#x540E;&#x4F1A;&#x7EBF;&#x7A0B;monitorenter&#x548C;monitorexit&#x8FD9;&#x4E24;&#x4E2A;&#x5B57;&#x8282;&#x7801;&#x6307;&#x4EE4;,&#x8FD9;&#x4E2A;&#x4E24;&#x4E2A;&#x5B57;&#x8282;&#x7801;&#x90FD;&#x9700;&#x8981;&#x4E00;&#x4E2A;reference&#x7C7B;&#x578B;&#x7684;&#x53C2;&#x6570;&#x6765;&#x6307;&#x660E;&#x9700;&#x8981;&#x9501;&#x5B9A;&#x548C;&#x89E3;&#x9501;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x800C;&#x6211;&#x4EEC;&#x4E00;&#x822C;&#x53EF;&#x4EE5;&#x5728;&#x4EE3;&#x7801;&#x5757;&#x4E2D;&#x6307;&#x660E;&#x9700;&#x8981;&#x52A0;&#x9501;&#x7684;&#x5BF9;&#x8C61;&#x6216;&#x8005;&#x5728;&#x6839;&#x636E;&#x4FEE;&#x9970;&#x7684;&#x662F;&#x5B9E;&#x4F8B;&#x65B9;&#x6CD5;&#x8FD8;&#x662F;&#x7C7B;&#x65B9;&#x6CD5;(static&#x65B9;&#x6CD5;)&#x6765;&#x83B7;&#x53D6;&#x5BF9;&#x5E94;&#x7684;&#x5BF9;&#x5E94;&#x5B9E;&#x4F8B;&#x6216;&#x8005;Class&#x5BF9;&#x8C61;&#x6765;&#x8FDB;&#x884C;&#x52A0;&#x9501;&#x3002;</p>
<p>&#x65E2;&#x7136;&#x662F;&#x52A0;&#x9501;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x52A0;&#x9501;&#x4E4B;&#x524D;&#x80AF;&#x5B9A;&#x8981;&#x53BB;&#x83B7;&#x53D6;&#x9501;&#xFF0C;&#x5982;&#x679C;&#x83B7;&#x53D6;&#x5230;&#x4E86;&#x5C31;&#x628A;&#x9501;&#x7684;&#x8BA1;&#x6570;&#x5668;&#x52A0;1,&#x91CA;&#x653E;&#x9501;&#x5C31;&#x51CF;&#x53BB;1&#xFF0C;&#x5F53;&#x8BA1;&#x6570;&#x5668;&#x7684;&#x503C;&#x4E3A;0&#x7684;&#x65F6;&#x5019;&#x5C31;&#x91CA;&#x653E;&#x9501;,monitorexit&#x8FD9;&#x4E2A;&#x6307;&#x4EE4;&#x4F1A;&#x5728;&#x540C;&#x6B65;&#x4EE3;&#x7801;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x7684;&#x65F6;&#x5019;&#x5C06;&#x8BA1;&#x6570;&#x5668;&#x51CF;&#x53BB;1&#x3002;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x83B7;&#x53D6;&#x5230;&#x9501;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x8981;&#x963B;&#x585E;&#x7B49;&#x5F85;&#xFF0C;&#x77E5;&#x9053;&#x5BF9;&#x8C61;&#x9501;&#x88AB;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x91CA;&#x653E;&#xFF0C;&#x5728;&#x91CD;&#x65B0;&#x53BB;&#x7ADE;&#x4E89;&#x3002;</p>
<h3 id="&#x9501;&#x7684;&#x4F18;&#x5316;">&#x9501;&#x7684;&#x4F18;&#x5316;</h3>
<h4 id="&#x81EA;&#x65CB;&#x9501;&#x4EE5;&#x53CA;&#x81EA;&#x9002;&#x5E94;&#x81EA;&#x65CB;">&#x81EA;&#x65CB;&#x9501;&#x4EE5;&#x53CA;&#x81EA;&#x9002;&#x5E94;&#x81EA;&#x65CB;</h4>
<p>&#x5728;&#x8BB2;&#x8FD9;&#x4E24;&#x4E2A;&#x9501;&#x4E4B;&#x524D;&#x6211;&#x5148;&#x8BB2;&#x4E00;&#x4E2A;&#x5C0F;&#x6545;&#x4E8B;&#x3002;</p>
<p>&#x5C0F;&#x660E;&#x4E2D;&#x5348;&#x8D81;&#x7740;&#x4F11;&#x606F;&#x65F6;&#x95F4;&#x53BB;&#x94F6;&#x884C;&#x529E;&#x4E8B;&#x60C5;&#xFF0C;&#x4F46;&#x662F;&#x5C0F;&#x660E;&#x53BB;&#x7684;&#x65F6;&#x5019;&#x5C0F;&#x660E;&#x524D;&#x9762;&#x6709;&#x4EBA;&#x5728;&#x529E;&#x7406;&#x4E1A;&#x52A1;&#xFF0C;&#x603B;&#x4E0D;&#x80FD;&#x770B;&#x5230;&#x6709;&#x4EBA;&#x529E;&#x7406;&#x5C31;&#x56DE;&#x53BB;&#x5427;&#xFF0C;&#x8FD9;&#x6837;&#x4E0D;&#x4EC5;&#x96BE;&#x5F97;&#x8DD1;&#x8FD8;&#x6D6A;&#x8D39;&#x4E86;&#x4E2D;&#x5348;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x5C0F;&#x660E;&#x51B3;&#x5B9A;&#x591A;&#x7B49;&#x4E00;&#x4F1A;&#x513F;&#xFF0C;&#x770B;&#x770B;&#x522B;&#x4EBA;&#x80FD;&#x4E0D;&#x80FD;&#x529E;&#x7406;&#x5B8C;,&#x4F46;&#x662F;&#x4E5F;&#x4E0D;&#x80FD;&#x4E00;&#x76F4;&#x7B49;&#x5440;&#xFF0C;&#x7B49;&#x4E45;&#x4E86;&#x4E0B;&#x5348;&#x4E0A;&#x73ED;&#x5C31;&#x4F1A;&#x8FDF;&#x5230;&#xFF0C;&#x4F1A;&#x88AB;&#x9886;&#x5BFC;&#x6279;&#x8BC4;&#x7684;&#xFF0C;&#x4E8E;&#x662F;&#x5C0F;&#x660E;&#x51B3;&#x5B9A;&#x7ED9;&#x81EA;&#x5DF1;&#x8BBE;&#x5B9A;&#x4E00;&#x4E2A;&#x65F6;&#x95F4;&#xFF0C;&#x6682;&#x4E14;&#x5C31;&#x4E3A;&#x5341;&#x5206;&#x949F;&#x5427;&#xFF0C;&#x540E;&#x9762;&#x5341;&#x5206;&#x949F;&#x5230;&#x4E86;&#x524D;&#x9762;&#x8FD8;&#x6709;&#x4EBA;&#x5728;&#x529E;&#x7406;&#xFF0C;&#x5C0F;&#x660E;&#x51B3;&#x5B9A;&#x4E0D;&#x7B49;&#x4E86;&#x5148;&#x56DE;&#x53BB;&#x4E0A;&#x73ED;&#xFF0C;&#x660E;&#x5929;&#x518D;&#x6765;&#x3002;
&#x7B2C;&#x4E8C;&#x5929;&#xFF0C;&#x5C0F;&#x660E;&#x53C8;&#x6765;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x524D;&#x9762;&#x8FD8;&#x662F;&#x6709;&#x5F88;&#x591A;&#x4EBA;&#xFF0C;&#x5C0F;&#x660E;&#x7A81;&#x7136;&#x6709;&#x70B9;&#x7EDD;&#x671B;&#xFF0C;&#x5C0F;&#x660E;&#x95EE;&#x4E86;&#x95EE;&#x65C1;&#x8FB9;&#x7684;&#x54E5;&#x4EEC;&#x7B49;&#x4E86;&#x591A;&#x4E45;&#xFF0C;&#x4ED6;&#x8BF4;&#x4ED6;&#x7B49;&#x4E86;&#x4E94;&#x5206;&#x949F;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x4ECA;&#x5929;&#x529E;&#x7406;&#x4E1A;&#x52A1;&#x7684;&#x901F;&#x5EA6;&#x6BD4;&#x8F83;&#x5FEB;&#xFF0C;&#x90FD;&#x529E;&#x4E86;10&#x4E2A;&#x4EBA;&#x4E86;&#xFF0C;&#x521A;&#x8BF4;&#x7740;&#x5C31;&#x8F6E;&#x5230;&#x4ED6;&#x4E86;&#x3002;&#x5C0F;&#x660E;&#x770B;&#x4E86;&#x4E0B;&#x987F;&#x65F6;&#x8C03;&#x6574;&#x4E86;&#x81EA;&#x5DF1;&#x7684;&#x7B49;&#x5F85;&#x65F6;&#x95F4;&#xFF0C;&#x89C9;&#x5F97;&#x81EA;&#x5DF1;&#x5728;&#x591A;&#x7B49;&#x4E0B;&#x80AF;&#x5B9A;&#x80FD;&#x591F;&#x529E;&#x7406;&#x4E1A;&#x52A1;&#x4E86;&#xFF0C;&#x7136;&#x540E;&#x5C0F;&#x660E;&#x5C31;&#x7B49;&#x5440;&#x7B49;&#xFF0C;&#x60F3;&#x4E0D;&#x5230;&#x524D;&#x9762;&#x90A3;&#x4E2A;&#x54E5;&#x4EEC;&#x4E0D;&#x5230;&#x4E00;&#x5206;&#x949F;&#x5C31;&#x5B8C;&#x4E8B;&#x513F;&#x4E86;&#xFF0C;&#x5C31;&#x8F6E;&#x5230;&#x5C0F;&#x660E;&#x529E;&#x7406;&#x4E1A;&#x52A1;&#x4E86;&#xFF0C;&#x4ECA;&#x5929;&#x603B;&#x7B97;&#x6CA1;&#x6709;&#x767D;&#x8DD1;&#x4E00;&#x8D9F;&#x3002;</p>
<p>&#x7EBF;&#x7A0B;&#x963B;&#x585E;&#x7684;&#x65F6;&#x5019;&#x662F;&#x9700;&#x8981;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x652F;&#x6301;&#xFF0C;&#x4ECE;&#x7528;&#x6237;&#x6001;&#x5207;&#x6362;&#x5230;&#x6838;&#x5FC3;&#x6001;&#x7684;&#xFF0C;&#x8FD9;&#x4E2A;&#x64CD;&#x4F5C;&#x7ED9;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x5E76;&#x53D1;&#x6027;&#x80FD;&#x5E26;&#x6765;&#x4E86;&#x5F88;&#x5927;&#x7684;&#x538B;&#x529B;(&#x5C0F;&#x660E;&#x8DD1;&#x8DEF;&#x5F88;&#x7D2F;)&#x3002;&#x800C;&#x4E14;&#x5F88;&#x591A;&#x65F6;&#x5019;&#x5171;&#x4EAB;&#x6570;&#x636E;&#x7684;&#x9501;&#x5B9A;&#x72B6;&#x6001;&#x53EA;&#x4F1A;&#x6301;&#x7EED;&#x5F88;&#x77ED;&#x7684;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#xFF0C;&#x4E3A;&#x4E86;&#x8FD9;&#x6BB5;&#x65F6;&#x95F4;&#x53BB;&#x6302;&#x8D77;&#x548C;&#x56DE;&#x590D;&#x7EBF;&#x7A0B;&#x5E76;&#x4E0D;&#x503C;&#x5F97;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x5C31;&#x8BA9;&#x8BF7;&#x6C42;&#x9501;&#x7684;&#x90A3;&#x4E2A;&#x7EBF;&#x7A0B;&#x7B49;&#x4E00;&#x4E0B;&#x4E0D;&#x8981;&#x653E;&#x5F03;&#x5904;&#x7406;&#x5668;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x5FD9;&#x5FAA;&#x73AF;(&#x81EA;&#x65CB;,&#x76F8;&#x5F53;&#x4E8E;&#x5C0F;&#x660E;&#x5728;&#x4E1A;&#x52A1;&#x5927;&#x5385;&#x767E;&#x65E0;&#x804A;&#x8D56;&#x7684;&#x73A9;&#x624B;&#x673A;,&#x76EF;&#x7740;&#x4E1A;&#x52A1;&#x529E;&#x7406;&#x60C5;&#x51B5;)&#xFF0C;&#x4F46;&#x662F;&#x4E0D;&#x80FD;&#x7B49;&#x4E45;&#x4E86;&#x5440;&#xFF0C;&#x7B49;&#x4E45;&#x4E86;&#x4E5F;&#x662F;&#x5F88;&#x8017;&#x8D39;&#x5904;&#x7406;&#x5668;&#x8D44;&#x6E90;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x5C31;&#x7ED9;&#x81EA;&#x5DF1;&#x8BBE;&#x5B9A;&#x4E86;&#x4E00;&#x4E2A;&#x81EA;&#x65CB;&#x7684;&#x6B21;&#x6570;10&#x6B21;(&#x9ED8;&#x8BA4;)&#xFF0C;&#x5982;&#x679C;&#x64CD;&#x4F5C;&#x4E86;&#x8FD9;&#x4E2A;&#x6B21;&#x6570;&#x5C31;&#x6302;&#x8D77;&#x4E86;&#x3002;</p>
<p>&#x540E;&#x6765;JDK6&#x4E2D;&#x5F15;&#x5165;&#x4E86;&#x81EA;&#x9002;&#x5E94;&#x7684;&#x81EA;&#x65CB;&#x9501;&#xFF0C;&#x5B83;&#x4F1A;&#x7531;&#x524D;&#x4E00;&#x6B21;&#x5728;&#x540C;&#x4E00;&#x4E2A;&#x9501;&#x4E0A;&#x7684;&#x81EA;&#x65CB;&#x65F6;&#x95F4;&#x4EE5;&#x53CA;&#x9501;&#x7684;&#x62E5;&#x6709;&#x8005;&#x72B6;&#x6001;&#x6765;&#x51B3;&#x5B9A;&#xFF0C;&#x5982;&#x679C;&#x540C;&#x4E00;&#x4E2A;&#x9501;&#x4E0A;&#x81EA;&#x65CB;&#x521A;&#x83B7;&#x5F97;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x8BA4;&#x4E3A;&#x8FD9;&#x6B21;&#x4E5F;&#x6709;&#x5F88;&#x5927;&#x51E0;&#x7387;&#x83B7;&#x53D6;&#x5230;&#xFF0C;&#x5C31;&#x591A;&#x81EA;&#x65CB;&#x51E0;&#x6B21;&#xFF0C;&#x5982;&#x679C;&#x5BF9;&#x4E8E;&#x67D0;&#x4E2A;&#x9501;&#x8BF4;&#xFF0C;&#x81EA;&#x65CB;&#x5F88;&#x5C11;&#x83B7;&#x53D6;&#x5230;&#xFF0C;&#x5C31;&#x8BA4;&#x4E3A;&#x6CA1;&#x620F;&#xFF0C;&#x5C31;&#x4E0D;&#x81EA;&#x65CB;&#x4E86;&#xFF0C;&#x76F4;&#x63A5;&#x53BB;&#x6302;&#x8D77;&#x4E86;&#x3002;</p>
<h4 id="&#x9501;&#x7684;&#x6D88;&#x9664;">&#x9501;&#x7684;&#x6D88;&#x9664;</h4>
<p>&#x9501;&#x6D88;&#x9664;&#x662F;&#x6307;&#x865A;&#x62DF;&#x673A;&#x5373;&#x65F6;&#x7F16;&#x8BD1;&#x5668;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#xFF0C;&#x5BF9;&#x4E00;&#x4E9B;&#x4EE3;&#x7801;&#x8981;&#x6C42;&#x540C;&#x6B65;&#xFF0C;&#x4F46;&#x662F;&#x88AB;&#x68C0;&#x6D4B;&#x5230;&#x4E0D;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x6570;&#x636E;&#x5171;&#x4EAB;&#x7ADE;&#x4E89;&#x7684;&#x60C5;&#x51B5;&#x7684;&#x9501;&#x8FDB;&#x884C;&#x6D88;&#x9664;,&#x9501;&#x6D88;&#x9664;&#x7684;&#x4E3B;&#x8981;&#x5224;&#x65AD;&#x4F9D;&#x636E;&#x6765;&#x6E90;&#x4E8E;&#x9003;&#x9038;&#x5206;&#x6790;&#x7684;&#x652F;&#x6301;,&#x5982;&#x679C;&#x5224;&#x65AD;&#x5728;&#x4E00;&#x6BB5;&#x4EE3;&#x7801;&#x4E2D;&#xFF0C;&#x5806;&#x4E0A;&#x7684;&#x6570;&#x636E;&#x4E0D;&#x4F1A;&#x9003;&#x9038;&#x51FA;&#x53BB;&#x4ECE;&#x800C;&#x88AB;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x8BBF;&#x95EE;&#x5230;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x628A;&#x4ED6;&#x4EEC;&#x5F53;&#x6210;&#x6808;&#x6570;&#x636E;&#x5BF9;&#x5F85;&#xFF0C;&#x8BA4;&#x4E3A;&#x4ED6;&#x4EEC;&#x662F;&#x79C1;&#x6709;&#x7684;&#xFF0C;&#x81EA;&#x7136;&#x5C31;&#x4E0D;&#x7528;&#x52A0;&#x9501;&#x4E86;&#x3002;&#x6BD4;&#x5982;&#x4E0B;&#x9762;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">appendString</span><span class="params">(String a,String b,String c)</span> </span>{</span><br><span class="line"></span><br><span class="line">	StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">	sb.append(a);</span><br><span class="line">	sb.append(b);</span><br><span class="line">	sb.append(c);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> sb.toString();</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x6211;&#x4EEC;&#x90FD;&#x77E5;&#x9053;StringBuffer&#x662F;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;,&#x5728;&#x4E8E;&#x5B83;&#x5728;&#x65B9;&#x6CD5;&#x4E0A;&#x52A0;&#x4E86;synchronized&#x5173;&#x952E;&#x5B57;&#xFF0C;&#x6B64;&#x65F6;&#x5C31;&#x6301;&#x6709;sb&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x4E0A;&#x7684;&#x9501;&#x4E86;&#x3002;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x5C31;&#x76F8;&#x5F53;&#x4E8E;&#x88AB;&#x52A0;&#x4E86;&#x9501;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x53D1;&#x73B0;sb&#x4F5C;&#x7528;&#x57DF;&#x88AB;&#x9650;&#x5236;&#x5728;&#x4E86;appendString&#x65B9;&#x6CD5;&#x5185;&#x90E8;&#xFF0C;sb&#x7684;&#x6240;&#x6709;&#x5F15;&#x7528;&#x4E0D;&#x4F1A;&#x88AB;&#x5916;&#x90E8;&#x7EBF;&#x7A0B;&#x8BBF;&#x95EE;&#x5230;&#xFF0C;&#x56E0;&#x6B64;&#x8FD9;&#x91CC;&#x867D;&#x7136;&#x6709;&#x9501;&#xFF0C;&#x4F46;&#x662F;&#x7F16;&#x8BD1;&#x4E4B;&#x540E;&#x5C31;&#x4F1A;&#x5FFD;&#x7565;&#x6240;&#x6709;&#x7684;&#x540C;&#x6B65;&#x800C;&#x6267;&#x884C;&#x4E86;&#x3002;</p>
<h4 id="&#x9501;&#x7684;&#x7C97;&#x5316;">&#x9501;&#x7684;&#x7C97;&#x5316;</h4>
<p>&#x4E00;&#x822C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;synchronized&#xFF0C;&#x603B;&#x662F;&#x63A8;&#x8350;&#x5C06;&#x5173;&#x952E;&#x5B57;&#x7684;&#x4F5C;&#x7528;&#x8303;&#x56F4;&#x9650;&#x5236;&#x5F97;&#x8D8A;&#x6765;&#x8D8A;&#x5C0F;&#xFF0C;&#x53EA;&#x6709;&#x6570;&#x636E;&#x7ADE;&#x4E89;&#x7684;&#x5B9E;&#x9645;&#x8303;&#x56F4;&#x624D;&#x8FDB;&#x884C;&#x540C;&#x6B65;&#xFF0C;&#x8FD9;&#x6837;&#x662F;&#x4E3A;&#x4E86;&#x4F7F;&#x5F97;&#x9700;&#x8981;&#x540C;&#x6B65;&#x7684;&#x64CD;&#x4F5C;&#x6570;&#x91CF;&#x5C3D;&#x53EF;&#x80FD;&#x5C0F;&#xFF0C;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x4E5F;&#x80FD;&#x5C3D;&#x5FEB;&#x62FF;&#x5230;&#x9501;&#x3002;&#x4F46;&#x662F;&#x5982;&#x679C;&#x4E00;&#x6BB5;&#x4EE3;&#x7801;&#x4E2D;&#x53CD;&#x590D;&#x7684;&#x5BF9;&#x540C;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x52A0;&#x9501;&#xFF0C;&#x5373;&#x4F7F;&#x6CA1;&#x6709;&#x7EBF;&#x7A0B;&#x7ADE;&#x4E89;&#xFF0C;&#x9891;&#x7E41;&#x7684;&#x8FDB;&#x884C;&#x4E92;&#x65A5;&#x64CD;&#x4F5C;&#x4E5F;&#x4F1A;&#x5BFC;&#x81F4;&#x8D44;&#x6E90;&#x7684;&#x6D88;&#x8017;&#x3002;</p>
<p>&#x56E0;&#x4E3A;&#x5982;&#x679C;&#x865A;&#x62DF;&#x673A;&#x68C0;&#x6D4B;&#x5230;&#x4E86;&#x4E00;&#x6BB5;&#x4EE3;&#x7801;&#x9891;&#x7E41;&#x7684;&#x5BF9;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x52A0;&#x9501;&#xFF0C;&#x5C31;&#x4F1A;&#x5C06;&#x8FD9;&#x4E2A;&#x9501;&#x5C31;&#x884C;&#x7C97;&#x5316;&#xFF0C;&#x63D0;&#x5347;&#x5230;&#x6700;&#x5916;&#x56F4;&#xFF0C;&#x6BD4;&#x5982;&#x4E0B;&#x9762;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#xFF1A;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">synchronized</span>(stringBuffer) {</span><br><span class="line">	stringBuffer.append(aStr);</span><br><span class="line">	</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">synchronized</span>(stringBuffer) {</span><br><span class="line">	stringBuffer.append(bStr);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">synchronized</span>(stringBuffer) {</span><br><span class="line">	stringBuffer.append(cStr);</span><br><span class="line">	</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x90A3;&#x4E48;&#x6B64;&#x65F6;jvm&#x4F1A;&#x5C06;&#x4EE3;&#x7801;&#x4F18;&#x5316;&#x6210;&#x4E0B;&#x9762;&#x8FD9;&#x6837;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">synchronized</span>(stringBuffer) {</span><br><span class="line">	stringBuffer.append(aStr);</span><br><span class="line">	stringBuffer.append(bStr);</span><br><span class="line">	stringBuffer.append(cStr);</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x5728;&#x8BB2;&#x4E0B;&#x9762;&#x8FD9;&#x4E09;&#x4E2A;&#x9501;&#x4E4B;&#x524D;&#xFF0C;&#x9700;&#x5F97;&#x4ECE;jvm&#x7684;&#x5BF9;&#x8C61;&#x5934;&#x8BF4;&#x8D77;&#xFF0C;&#x5BF9;&#x8C61;&#x5934;&#x5206;&#x4E3A;&#x4E24;&#x90E8;&#x5206;&#xFF0C;&#x7B2C;&#x4E00;&#x90E8;&#x5206;&#x5B58;&#x50A8;hash&#x7801;(hashcode),GC&#x5206;&#x4EE3;&#x5E74;&#x9F84;&#x7B49;,&#x8FD9;&#x90E8;&#x5206;&#x6570;&#x636E;&#x7684;&#x957F;&#x5EA6;&#x5728;32&#x4F4D;&#x7CFB;&#x7EDF;&#x548C;64&#x4F4D;&#x7CFB;&#x7EDF;&#x5206;&#x522B;&#x4E3A;32&#x4F4D;&#x548C;64&#x4F4D;,&#x5B98;&#x65B9;&#x79F0;&#x5176;&#x4E3A;&#x201C;Mark Word&quot;,&#x5B83;&#x4EEC;&#x662F;&#x5B9E;&#x73B0;&#x504F;&#x5411;&#x9501;&#x548C;&#x8F7B;&#x91CF;&#x7EA7;&#x9501;&#x7684;&#x5173;&#x952E;&#x3002;&#x53E6;&#x4E00;&#x90E8;&#x5206;&#x7528;&#x4E8E;&#x5B58;&#x50A8;&#x6307;&#x5411;&#x65B9;&#x6CD5;&#x533A;&#x5BF9;&#x8C61;&#x7C7B;&#x578B;&#x6570;&#x636E;&#x7684;&#x6307;&#x9488;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x6570;&#x7EC4;&#x5BF9;&#x8C61;&#x7684;&#x8BDD;&#xFF0C;&#x8FD8;&#x4F1A;&#x6709;&#x4E00;&#x4E2A;&#x989D;&#x5916;&#x7684;&#x90E8;&#x5206;&#x7528;&#x4E8E;&#x5B58;&#x50A8;&#x6570;&#x7EC4;&#x957F;&#x5EA6;&#x3002;</p>
<p>&#x5BF9;&#x8C61;&#x5934;&#x4FE1;&#x606F;&#x4E0E;&#x5BF9;&#x8C61;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x6570;&#x636E;&#x65E0;&#x5173;&#x7684;&#x989D;&#x5916;&#x5B58;&#x50A8;&#x6210;&#x672C;&#xFF0C;&#x8003;&#x8651;&#x865A;&#x62DF;&#x673A;&#x7684;&#x7A7A;&#x95F4;&#x6548;&#x7387;&#xFF0C;Mark Word&#x88AB;&#x8BBE;&#x8BA1;&#x6210;&#x4E00;&#x4E2A;&#x975E;&#x56FA;&#x5B9A;&#x7684;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x4EE5;&#x4FBF;&#x5728;&#x6781;&#x5C0F;&#x7684;&#x7A7A;&#x95F4;&#x5B58;&#x50A8;&#x66F4;&#x591A;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x5B83;&#x4F1A;&#x6839;&#x636E;&#x5BF9;&#x8C61;&#x7684;&#x72B6;&#x6001;&#x590D;&#x7528;&#x81EA;&#x5DF1;&#x7684;&#x5B58;&#x50A8;&#x7A7A;&#x95F4;&#x3002;</p>
<p>&#x90A3;&#x4E48;&#x4ECE;&#x54EA;&#x91CC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x8FD9;&#x4E9B;&#x4FE1;&#x606F;&#x5462;&#xFF1F;&#x6709;&#x95EE;&#x9898;&#x5F53;&#x7136;&#x770B;&#x6E90;&#x7801;&#xFF0C;&#x4ECE;github&#x4E0A;jdk&#x7684;&#x6E90;&#x7801;<a href="https://github.com/openjdk-mirror/jdk7u-hotspot/blob/50bdefc3afe944ca74c3093e7448d6b889cd20d1/src/share/vm/oops/markOop.hpp#L38" target="_blank" rel="external">&#x6E90;&#x7801;</a></p>
<p>&#x6574;&#x7406;&#x4E0B;&#xFF0C;&#x8FD9;&#x91CC;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x5E03;&#x5C40;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><img src="/images/mark_word.png" alt="32&#x4F4D;&#x7CFB;&#x7EDF;mark word">
&#x4E0A;&#x56FE;&#x8868;&#x660E;&#x4E86;MarkWord&#x5728;&#x4E0D;&#x540C;&#x72B6;&#x6001;&#x4E0B;&#x7684;&#x5B58;&#x50A8;&#x5185;&#x5BB9;&#xFF0C;&#x5F53;&#x7136;&#x4E0A;&#x9762;&#x8FD9;&#x662F;32&#x4F4D;&#x7CFB;&#x7EDF;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x662F;64&#x4F4D;&#x57FA;&#x672C;&#x4E0A;&#x662F;&#x5927;&#x540C;&#x5C0F;&#x5F02;&#xFF0C;</p>
<h4 id="&#x504F;&#x5411;&#x9501;">&#x504F;&#x5411;&#x9501;</h4>
<p>&#x5F53;&#x7EBF;&#x7A0B;A&#x8FDB;&#x5165;&#x4E34;&#x754C;&#x533A;&#x51C6;&#x5907;&#x6267;&#x884C;&#x4EE3;&#x7801;&#x7684;&#x65F6;&#x5019;&#xFF0C;jvm&#x53D1;&#x73B0;&#x6B64;&#x65F6;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x5728;&#x6267;&#x884C;&#x4E34;&#x754C;&#x533A;&#x4EE3;&#x7801;&#x6240;&#x4EE5;&#x6B64;&#x65F6;&#x4F1A;&#x5C06;&#x662F;&#x5426;&#x504F;&#x5411;&#x9501;&#x7684;&#x6807;&#x5FD7;&#x4F4D;&#x4FEE;&#x6539;&#x4E3A;1&#xFF0C;
&#x7136;&#x540E;&#x8BB0;&#x5F55;&#x4E0B;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x7684;&#x5730;&#x5740;(&#x6CE8;&#x610F;&#x8FD9;&#x91CC;&#x4E0D;&#x662F;&#x7EBF;&#x7A0B;id&#xFF0C;&#x5F88;&#x591A;&#x4E66;&#x4E0A;&#x90FD;&#x5199;&#x9519;&#x4E86;)&#xFF0C;&#x8868;&#x793A;&#x5F53;&#x524D;&#x7684;&#x9501;&#x662F;&#x504F;&#x5411;&#x8FD9;&#x4E2A;&#x7EBF;&#x7A0B;&#x7684;</p>
<h4 id="&#x8F7B;&#x91CF;&#x7EA7;&#x9501;">&#x8F7B;&#x91CF;&#x7EA7;&#x9501;</h4>
<p>&#x5982;&#x679C;&#x6B64;&#x65F6;&#x53C8;&#x6709;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;B&#x9700;&#x8981;&#x8FDB;&#x5165;&#x4E34;&#x754C;&#x533A;&#x6267;&#x884C;&#x4EE3;&#x7801;&#xFF0C;&#x4F46;&#x662F;&#x6B64;&#x65F6;&#x9501;&#x5BF9;&#x8C61;&#x7684;Mark Word&#x4E2D;&#x662F;&#x504F;&#x5411;&#x7EBF;&#x7A0B;A&#x7684;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x7EBF;&#x7A0B;B&#x662F;&#x4E0D;&#x80FD;&#x8FDB;&#x5165;&#x4E34;&#x754C;&#x533A;&#x3002;
&#x6B64;&#x65F6;&#x4F1A;&#x5C06;&#x9501;&#x5BF9;&#x8C61;&#x4FEE;&#x6539;&#x4E3A;&#x65E0;&#x9501;&#x72B6;&#x6001;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x5404;&#x81EA;&#x7684;&#x6808;&#x5206;&#x914D;&#x4E00;&#x4E2A;&#x7A7A;&#x95F4;&#xFF0C;&#x53EB;&#x505A;Lock Record,&#x628A;&#x9501;&#x5BF9;&#x8C61;&#x7684;Mark Word&#x5728;A,B&#x4E24;&#x4E2A;&#x7EBF;&#x7A0B;&#x5404;&#x81EA;&#x590D;&#x5236;&#x4E00;&#x4EFD;&#xFF0C;&#x53EB;&#x505A;Displaced Mard Word.
&#x7136;&#x540E;&#x5C06;Lock Record&#x7684;&#x5730;&#x5740;&#x4F7F;&#x7528;CAS&#x653E;&#x5230;&#x4E86;Mark Word&#x4E2D;&#xFF0C;&#x5E76;&#x4E14;&#x5C06;&#x9501;&#x6807;&#x5FD7;&#x4F4D;&#x4FEE;&#x6539;&#x4E3A;00&#xFF0C;&#x54EA;&#x4E2A;&#x7EBF;&#x7A0B;&#x4FEE;&#x6539;&#x6210;&#x529F;&#xFF0C;&#x5C31;&#x4EE3;&#x8868;&#x83B7;&#x53D6;&#x5230;&#x4E86;&#x9501;&#xFF0C;&#x53EF;&#x4EE5;&#x8FDB;&#x5165;&#x4E34;&#x754C;&#x533A;&#x3002;&#x6CA1;&#x6709;&#x83B7;&#x5F97;&#x9501;&#x7684;&#x7EBF;&#x7A0B;&#x81EA;&#x65CB;&#x51E0;&#x6B21;&#x7B49;&#x5F85;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x91CA;&#x653E;&#x9501;&#x3002;</p>
<h4 id="&#x91CD;&#x91CF;&#x7EA7;&#x9501;">&#x91CD;&#x91CF;&#x7EA7;&#x9501;</h4>
<p>A,B&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#xFF0C;&#x76F8;&#x5B89;&#x65E0;&#x4E8B;&#xFF0C;&#x5373;&#x4FBF;&#x54EA;&#x4E00;&#x4E2A;&#x83B7;&#x53D6;&#x5230;&#x4E86;&#x9501;&#x4E5F;&#x5F88;&#x5FEB;&#x5C31;&#x4F1A;&#x8BA9;&#x51FA;&#x6765;&#xFF0C;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x4E0D;&#x4F1A;&#x7B49;&#x5F85;&#x592A;&#x4E45;&#xFF0C;&#x4F46;&#x662F;&#x6709;&#x4E00;&#x5929;&#xFF0C;&#x67D0;&#x4E2A;&#x7EBF;&#x7A0B;&#x81EA;&#x65CB;&#x4E86;&#x5F88;&#x591A;&#x6B21;&#x8FD8;&#x662F;&#x6CA1;&#x6709;&#x83B7;&#x53D6;&#x5230;&#x9501;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x5C31;&#x9700;&#x8981;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x5E2E;&#x52A9;&#xFF0C;&#x8FD9;&#x4E2A;&#x5C06;&#x8F7B;&#x91CF;&#x7EA7;&#x9501;&#x5347;&#x7EA7;&#x4E3A;&#x91CD;&#x91CF;&#x7EA7;&#x9501;&#xFF0C;&#x540C;&#x65F6;&#x5C06;&#x6807;&#x5FD7;&#x4F4D;&#x4FEE;&#x6539;&#x4E3A;10&#xFF0C;&#x963B;&#x585E;&#x5176;&#x4ED6;&#x672A;&#x83B7;&#x53D6;&#x5230;&#x9501;&#x7684;&#x7EBF;&#x7A0B;&#x3002;</p>
<h3 id="&#x603B;&#x7ED3;">&#x603B;&#x7ED3;</h3>
<p>java&#x5BF9;&#x4E8E;&#x9501;&#x7684;&#x4F18;&#x5316;&#x662F;&#x81EA;&#x52A8;&#x7684;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x6211;&#x4EEC;&#x505A;&#x4EC0;&#x4E48;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x5728;&#x7F16;&#x8BD1;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x5206;&#x6790;&#x4EE3;&#x7801;&#x5BF9;&#x4EE3;&#x7801;&#x8FDB;&#x884C;&#x4F18;&#x5316;&#x3002;</p>
<p>JVM&#x4E2D;&#x5173;&#x4E8E;&#x9501;&#x7684;&#x4F18;&#x5316;&#x5927;&#x62B5;&#x5982;&#x662F;&#x4E86;&#xFF0C;&#x5176;&#x5B9E;synchronized&#x5E76;&#x4E0D;&#x6BD4;lock&#x6162;&#x591A;&#x5C11;&#xFF0C;&#x751A;&#x81F3;&#x5728;&#x67D0;&#x4E9B;&#x65B9;&#x9762;&#x53EF;&#x80FD;&#x8FD8;&#x6BD4;lock&#x5FEB;&#xFF0C;&#x800C;&#x4E14;JDK8&#x4E2D;ConcurrentHashMap&#x4E5F;&#x5C06;&#x4E4B;&#x524D;&#x7684;&#x5206;&#x6BB5;&#x9501;&#x6539;&#x4E3A;&#x4E86;Synchronized&#x5B9E;&#x73B0;&#x3002;</p>
]]></content>
    <summary type="html">
    <![CDATA[多线程编码中,我们常用到synchronized关键字,都知道它是加锁关键字，也或多或少听说过轻量级锁，重量级锁，偏向锁这些关键字，可是我们知道这些具体指的是什么吗？为了我们更优的使用，JVM团队在背后做了多少努力?]]>
    
    </summary>
    
      <category term="多线程" scheme="http://yoursite.com/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
      <category term="java" scheme="http://yoursite.com/categories/java/"/>
    
      <category term="jvm" scheme="http://yoursite.com/categories/java/jvm/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[关于wait,notify,join,sleep的用法说明]]></title>
    <link href="http://yoursite.com/2018/07/16/how-to-use-methods-about-thread/"/>
    <id>http://yoursite.com/2018/07/16/how-to-use-methods-about-thread/</id>
    <published>2018-07-16T12:21:05.000Z</published>
    <updated>2018-10-28T13:15:44.047Z</updated>
    <content type="html"><![CDATA[<p>&#x63D0;&#x5230;&#x591A;&#x7EBF;&#x7A0B;&#x603B;&#x662F;&#x7ED5;&#x4E0D;&#x5F00;wait,notify,notifyAll&#x8FD9;&#x4E9B;&#x64CD;&#x4F5C;,&#x5728;&#x5F80;&#x4E0B;&#x770B;&#x4E4B;&#x524D;,&#x95EE;&#x95EE;&#x81EA;&#x5DF1;&#x771F;&#x7684;&#x77E5;&#x9053;&#x5B83;&#x4EEC;&#x600E;&#x4E48;&#x4F7F;&#x7528;&#x5417;?</p>
<h3 id="&#x4EC0;&#x4E48;&#x662F;&#x7EBF;&#x7A0B;">&#x4EC0;&#x4E48;&#x662F;&#x7EBF;&#x7A0B;</h3>
<p>&#x8FDB;&#x7A0B;&#xFF08;process&#xFF09;&#x548C;&#x7EBF;&#x7A0B;&#xFF08;thread&#xFF09;&#x662F;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x57FA;&#x672C;&#x6982;&#x5FF5;&#xFF0C;&#x4F46;&#x662F;&#x5B83;&#x4EEC;&#x6BD4;&#x8F83;&#x62BD;&#x8C61;&#xFF0C;&#x6211;&#x4E3E;&#x4E2A;&#x4F8B;&#x5B50;&#x6765;&#x5E2E;&#x52A9;&#x7406;&#x89E3;&#x3002;
&#x5510;&#x50E7;&#x5BF9;&#x609F;&#x7A7A;&#x8BF4;:&quot;&#x609F;&#x7A7A;,&#x4F60;&#x8981;&#x597D;&#x597D;&#x4FDD;&#x62A4;&#x6211;&#xFF0C;&#x53D6;&#x7ECF;&#x8DEF;&#x4E0A;&#x8270;&#x8F9B;&#x5440;,&#x4F46;&#x662F;&#x4E3A;&#x5E08;&#x73B0;&#x5728;&#x6709;&#x70B9;&#x997F;&#x4E86;&#xFF0C;&#x4F60;&#x53BB;&#x7ED9;&#x6211;&#x5316;&#x70B9;&#x658B;&#x996D;&#x5427;?&quot;,&#x609F;&#x7A7A;&#x5FC3;&#x60F3;&#xFF0C;&#x6211;&#x53C8;&#x8981;&#x4FDD;&#x62A4;&#x4F60;&#xFF0C;&#x53C8;&#x8981;&#x7ED9;&#x4F60;&#x5316;&#x7F18;&#xFF0C;&#x6211;&#x5F88;&#x53EF;&#x548B;&#x529E;&#x5440;&#xFF1F;(&#x540C;&#x4E00;&#x65F6;&#x95F4;&#x4E00;&#x4E2A;CPU&#x53EA;&#x80FD;&#x5904;&#x7406;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;&#x609F;&#x7A7A;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;),&#x7A81;&#x7136;&#x609F;&#x7A7A;&#x7075;&#x5149;&#x4E00;&#x95EA;&#xFF0C;&#x6211;&#x7528;&#x6211;&#x7684;&#x7334;&#x6BDB;&#x53D8;&#x4E00;&#x4E2A;&#x6211;&#xFF0C;&#x7136;&#x540E;&#x53BB;&#x7ED9;&#x5E08;&#x5085;&#x8001;&#x4EBA;&#x5BB6;&#x5316;&#x7F18;&#x4E0D;&#x5C31;&#x884C;&#x4E86;&#xFF0C;&#x8FD9;&#x6837;&#x6211;&#x4E5F;&#x53EF;&#x4EE5;&#x4FDD;&#x62A4;&#x5E08;&#x5085;(&#x5206;&#x51FA;&#x53BB;&#x7684;&#x7334;&#x6BDB;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;)&#x3002;
&#x6240;&#x4EE5;&#xFF0C;&#x7EBF;&#x7A0B;&#xFF08;&#x82F1;&#x8BED;&#xFF1A;thread&#xFF09;&#x662F;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x80FD;&#x591F;&#x8FDB;&#x884C;&#x8FD0;&#x7B97;&#x8C03;&#x5EA6;&#x7684;&#x6700;&#x5C0F;&#x5355;&#x4F4D;&#x3002;&#x5B83;&#x88AB;&#x5305;&#x542B;&#x5728;&#x8FDB;&#x7A0B;&#x4E4B;&#x4E2D;&#xFF0C;&#x662F;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;&#x5B9E;&#x9645;&#x8FD0;&#x4F5C;&#x5355;&#x4F4D;&#x3002;&#x4E00;&#x6761;&#x7EBF;&#x7A0B;&#x6307;&#x7684;&#x662F;&#x8FDB;&#x7A0B;&#x4E2D;&#x4E00;&#x4E2A;&#x5355;&#x4E00;&#x987A;&#x5E8F;&#x7684;&#x63A7;&#x5236;&#x6D41;&#xFF0C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E2D;&#x53EF;&#x4EE5;&#x5E76;&#x53D1;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF0C;&#x6BCF;&#x6761;&#x7EBF;&#x7A0B;&#x5E76;&#x884C;&#x6267;&#x884C;&#x4E0D;&#x540C;&#x7684;&#x4EFB;&#x52A1;&#x3002;</p>
<h3 id="&#x7EBF;&#x7A0B;&#x7684;&#x72B6;&#x6001;">&#x7EBF;&#x7A0B;&#x7684;&#x72B6;&#x6001;</h3>
<p>Java&#x7684;<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Thread.State.html" target="_blank" rel="external">Thread.State</a>&#x4E2D;&#x5B9A;&#x4E49;&#x4E86;&#x7EBF;&#x7A0B;&#x7684;6&#x79CD;&#x72B6;&#x6001;,&#x5206;&#x522B;&#x5982;&#x4E0B;&#xFF1A;</p>
<ol>
<li>NEW    &#x672A;&#x542F;&#x52A8;&#x7684;,&#x4E0D;&#x4F1A;&#x51FA;&#x73B0;&#x5728;dump&#x6587;&#x4EF6;&#x4E2D;(&#x53EF;&#x4EE5;&#x901A;&#x8FC7;jstack&#x547D;&#x4EE4;&#x67E5;&#x770B;&#x7EBF;&#x7A0B;&#x5806;&#x6808;)</li>
<li>RUNNABLE    &#x6B63;&#x5728;JVM&#x4E2D;&#x6267;&#x884C;&#x7684;</li>
<li>BLOCKED    &#x88AB;&#x963B;&#x585E;,&#x7B49;&#x5F85;&#x83B7;&#x53D6;&#x76D1;&#x89C6;&#x5668;&#x9501;&#x8FDB;&#x5165;synchronized&#x4EE3;&#x7801;&#x5757;&#x6216;&#x8005;&#x5728;&#x8C03;&#x7528;Object.wait&#x4E4B;&#x540E;&#x91CD;&#x65B0;&#x8FDB;&#x5165;synchronized&#x4EE3;&#x7801;&#x5757;</li>
<li>WAITING    &#x65E0;&#x9650;&#x671F;&#x7B49;&#x5F85;&#x53E6;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x7279;&#x5B9A;&#x52A8;&#x4F5C;&#x540E;&#x5524;&#x9192;&#x5B83;,&#x4E5F;&#x5C31;&#x662F;&#x8C03;&#x7528;Object.wait&#x540E;&#x4F1A;&#x7B49;&#x5F85;&#x62E5;&#x6709;&#x540C;&#x4E00;&#x4E2A;&#x76D1;&#x89C6;&#x5668;&#x9501;&#x7684;&#x7EBF;&#x7A0B;&#x8C03;&#x7528;notify/notifyAll&#x6765;&#x8FDB;&#x884C;&#x5524;&#x9192;</li>
<li>TIMED_WAITING    &#x6709;&#x65F6;&#x9650;&#x7684;&#x7B49;&#x5F85;&#x53E6;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x7279;&#x5B9A;&#x52A8;&#x4F5C;</li>
<li>TERMINATED    &#x5DF2;&#x7ECF;&#x5B8C;&#x6210;&#x4E86;&#x6267;&#x884C;</li>
</ol>
<h3 id="&#x548C;&#x591A;&#x7EBF;&#x7A0B;&#x76F8;&#x5173;&#x7684;&#x65B9;&#x6CD5;&#x4EE5;&#x53CA;&#x5173;&#x952E;&#x5B57;">&#x548C;&#x591A;&#x7EBF;&#x7A0B;&#x76F8;&#x5173;&#x7684;&#x65B9;&#x6CD5;&#x4EE5;&#x53CA;&#x5173;&#x952E;&#x5B57;</h3>
<p>wait,notify,notifyAll,sleep,join&#x4EE5;&#x53CA;synchronized</p>
<h3 id="&#x9519;&#x8BEF;&#x7684;&#x4F7F;&#x7528;wait">&#x9519;&#x8BEF;&#x7684;&#x4F7F;&#x7528;wait</h3>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadTest</span> </span>{</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">	ThreadTest tt = <span class="keyword">new</span> ThreadTest();</span><br><span class="line">		<span class="keyword">try</span> {</span><br><span class="line">			tt.wait();</span><br><span class="line">		} <span class="keyword">catch</span> (InterruptedException e) {</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x5F53;&#x6211;&#x4EEC;&#x8FD0;&#x884C;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x770B;&#x5230;&#x5982;&#x4E0B;&#x7684;&#x9519;&#x8BEF;&#xFF1A;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Exception in thread <span class="string">&quot;main&quot;</span> java.lang.IllegalMonitorStateException</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x662F;&#x4E3A;&#x4EC0;&#x4E48;&#x5462;&#xFF1F;&#x5B98;&#x65B9;API&#x8BF4;&#x7684;&#x5F88;&#x6E05;&#x695A;&#x4E86;&#xFF0C;&#x5728;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x7684;&#x65F6;&#x5019;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x5FC5;&#x987B;&#x62E5;&#x6709;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x7684; <strong>&#x76D1;&#x89C6;&#x5668;</strong>&#x3002;&#x8C03;&#x7528;&#x4E86;wait&#x65B9;&#x6CD5;&#x4E4B;&#x540E;&#x8FD9;&#x4E2A;&#x7EBF;&#x7A0B;&#x4F1A;&#x91CA;&#x653E;&#x76D1;&#x89C6;&#x5668;&#x9501;&#x76F4;&#x5230;&#x8C03;&#x7528;notify/notifyAll&#x65B9;&#x6CD5;&#x3002;</p>
<h3 id="&#x5982;&#x4F55;&#x83B7;&#x53D6;&#x76D1;&#x89C6;&#x5668;">&#x5982;&#x4F55;&#x83B7;&#x53D6;&#x76D1;&#x89C6;&#x5668;&#xFF1F;</h3>
<p>&#x901A;&#x5E38;&#x6211;&#x4EEC;&#x4F7F;&#x7528;synchronized&#x5173;&#x952E;&#x5B57;&#x6765;&#x83B7;&#x53D6;&#x76D1;&#x89C6;&#x5668;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x80FD;&#x4F1A;&#x7ECF;&#x5E38;&#x770B;&#x5230;&#x8FD9;&#x6837;&#x7684;&#x4EE3;&#x7801;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">execute1</span><span class="params">()</span> </span>{</span><br><span class="line">    System.out.println(<span class="string">&quot;synchronized method test&quot;</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Boolean <span class="title">execute2</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">synchronized</span> (ThreadTest.class) {</span><br><span class="line">        System.out.println(<span class="string">&quot;synchronized code block test&quot;</span>);</span><br><span class="line">    }</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">static</span>  <span class="keyword">void</span>  <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">       execute1();</span><br><span class="line">       System.out.println(execute2());</span><br><span class="line">    }</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x5C31;&#x662F;synchronized&#x7684;&#x7528;&#x6CD5;,&#x4E00;&#x822C;&#x4F7F;&#x7528;&#x5B83;&#x7528;&#x6765;&#x4FEE;&#x9970;&#x8BED;&#x53E5;&#x6216;&#x8005;&#x4FEE;&#x9970;&#x65B9;&#x6CD5;,&#x5BF9;&#x4E8E;synchronized&#x8BED;&#x53E5;&#x5F53;Java&#x6E90;&#x4EE3;&#x7801;&#x88AB;javac&#x7F16;&#x8BD1;&#x6210;bytecode&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x5728;&#x540C;&#x6B65;&#x5757;&#x7684;&#x5165;&#x53E3;&#x4F4D;&#x7F6E;&#x548C;&#x9000;&#x51FA;&#x4F4D;&#x7F6E;&#x5206;&#x522B;&#x63D2;&#x5165;monitorenter&#x548C;monitorexit&#x5B57;&#x8282;&#x7801;&#x6307;&#x4EE4;.&#x800C;synchronized&#x65B9;&#x6CD5;&#x5219;&#x4F1A;&#x88AB;&#x7FFB;&#x8BD1;&#x6210;&#x666E;&#x901A;&#x7684;&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#x548C;&#x8FD4;&#x56DE;&#x6307;&#x4EE4;&#x5982;:invokevirtual&#x3001;return&#x6307;&#x4EE4;&#xFF0C;&#x5728;VM&#x5B57;&#x8282;&#x7801;&#x5C42;&#x9762;&#x5E76;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x7279;&#x522B;&#x7684;&#x6307;&#x4EE4;&#x6765;&#x5B9E;&#x73B0;&#x88AB;synchronized&#x4FEE;&#x9970;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x800C;&#x662F;&#x5728;Class&#x6587;&#x4EF6;&#x7684;&#x65B9;&#x6CD5;&#x8868;&#x4E2D;&#x5C06;&#x8BE5;&#x65B9;&#x6CD5;&#x7684;access_flags&#x5B57;&#x6BB5;&#x4E2D;&#x7684;synchronized&#x6807;&#x5FD7;&#x4F4D;&#x7F6E;1&#xFF0C;&#x8868;&#x793A;&#x8BE5;&#x65B9;&#x6CD5;&#x662F;&#x540C;&#x6B65;&#x65B9;&#x6CD5;&#x5E76;&#x4F7F;&#x7528;&#x8C03;&#x7528;&#x8BE5;&#x65B9;&#x6CD5;&#x7684;&#x5BF9;&#x8C61;&#x6216;&#x8BE5;&#x65B9;&#x6CD5;&#x6240;&#x5C5E;&#x7684;Class&#x5728;JVM&#x7684;&#x5185;&#x90E8;&#x5BF9;&#x8C61;&#x8868;&#x793A;Klass&#x505A;&#x4E3A;&#x9501;&#x5BF9;&#x8C61;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x5BF9;synchronized&#x539F;&#x7406;&#x505A;&#x6DF1;&#x5165;&#x8BF4;&#x660E;&#x4E86;&#x3002;</p>
<p><img src="/images/synchro_compile_code.png" alt="&#x53CD;&#x7F16;&#x8BD1;&#x4EE3;&#x7801;"></p>
<h3 id="&#x4E3A;&#x4EC0;&#x4E48;&#x4F7F;&#x7528;synchronized">&#x4E3A;&#x4EC0;&#x4E48;&#x4F7F;&#x7528;synchronized</h3>
<p>synchonized&#x7528;&#x4E8E;&#x5B9E;&#x73B0;&#x591A;&#x7EBF;&#x7A0B;&#x7684;&#x540C;&#x6B65;&#x64CD;&#x4F5C;&#xFF0C;&#x4E00;&#x822C;&#x591A;&#x7EBF;&#x7A0B;&#x534F;&#x4F5C;&#x8FC7;&#x7A0B;&#x4E2D;,&#x90FD;&#x4F1A;&#x64CD;&#x4F5C;&#x5171;&#x4EAB;&#x8D44;&#x6E90;,&#x53EF;&#x80FD;&#x662F;&#x67D0;&#x4E2A;&#x7C7B;,&#x6BD4;&#x5982;HashMap&#x4E5F;&#x53EF;&#x80FD;&#x662F;&#x786C;&#x76D8;&#x6587;&#x4EF6;,&#x6570;&#x636E;&#x5E93;&#x8D44;&#x6E90;&#x7B49;&#x7B49;&#xFF0C;&#x4E0D;&#x6B63;&#x5F53;&#x7684;&#x64CD;&#x4F5C;&#x65B9;&#x5F0F;&#x4F1A;&#x5BFC;&#x81F4;&#x7ED3;&#x679C;&#x96BE;&#x4EE5;&#x9884;&#x6599;&#x3002;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x9700;&#x8981;&#x4FDD;&#x8BC1;&#x51E0;&#x4E2A;&#x57FA;&#x672C;&#x7279;&#x5F81;&#xFF1A;</p>
<ol>
<li>
<p>&#x539F;&#x5B50;&#x6027;&#xFF0C;&#x7B80;&#x5355;&#x8BF4;&#x5C31;&#x662F;&#x76F8;&#x5173;&#x64CD;&#x4F5C;&#x4E0D;&#x4F1A;&#x4E2D;&#x9014;&#x88AB;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x5E72;&#x6270;&#xFF0C;&#x4E00;&#x822C;&#x901A;&#x8FC7;&#x540C;&#x6B65;&#x673A;&#x5236;&#x5B9E;&#x73B0;</p>
</li>
<li>
<p>&#x53EF;&#x89C1;&#x6027;&#xFF0C;&#x662F;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x4FEE;&#x6539;&#x4E86;&#x67D0;&#x4E2A;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#xFF0C;&#x5176;&#x72B6;&#x6001;&#x80FD;&#x591F;&#x7ACB;&#x5373;&#x88AB;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x77E5;&#x6653;&#xFF0C;&#x901A;&#x5E38;&#x88AB;&#x89E3;&#x91CA;&#x4E3A;&#x5C06;&#x7EBF;&#x7A0B;&#x672C;&#x5730;&#x72B6;&#x6001;&#x540C;&#x6B65;&#x5230;&#x4E3B;&#x5185;&#x5B58;&#x4E0A;&#xFF0C;volatile&#x5C31;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x53EF;&#x89C1;&#x6027;</p>
</li>
<li>
<p>&#x6709;&#x5E8F;&#x6027;&#xFF0C;&#x662F;&#x4FDD;&#x8BC1;&#x7EBF;&#x7A0B;&#x5185;&#x4E32;&#x884C;&#x8BED;&#x4E49;&#xFF0C;&#x907F;&#x514D;<a href="https://www.cs.umd.edu/~pugh/java/memoryModel/jsr-133-faq.html" target="_blank" rel="external">&#x6307;&#x4EE4;&#x91CD;&#x6392;</a></p>
</li>
</ol>
<p>&#x800C;synchronized&#x80FD;&#x4FDD;&#x8BC1;&#x8FD9;&#x4E9B;&#x7279;&#x6027;&#xFF0C;&#x6240;&#x4EE5;&#x5B83;&#x4E5F;&#x662F;&#x4FDD;&#x8BC1;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x4E00;&#x79CD;&#x624B;&#x6BB5;&#xFF0C;&#x4F46;&#x662F;&#x4E0D;&#x8981;&#x6EE5;&#x7528;&#xFF0C;&#x5BB9;&#x6613;&#x5BFC;&#x81F4;&#x6B7B;&#x9501;&#xFF0C;&#x5173;&#x4E8E;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x4F60;&#x53EF;&#x4EE5;&#x770B;&#x770B;&#x6211;&#x7684;&#x8FD9;&#x7BC7;<a href="http://generalthink.github.io/2016/09/21/talk-thread-safe/" target="_blank" rel="external">&#x6587;&#x7AE0;</a>,&#x5F53;&#x7136;&#x4ECA;&#x5929;&#x7684;&#x91CD;&#x70B9;&#x4E0D;&#x662F;&#x8FD9;&#x4E2A;&#xFF0C;&#x6BD5;&#x7ADF;&#x6211;&#x4EEC;&#x804A;&#x7684;&#x662F;wait&#x3002;</p>
<h3 id="&#x4EC0;&#x4E48;&#x662F;&#x76D1;&#x89C6;&#x5668;monitor">&#x4EC0;&#x4E48;&#x662F;&#x76D1;&#x89C6;&#x5668;(monitor)</h3>
<p>Java&#x4E2D;&#x6BCF;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x90FD;&#x53EF;&#x4EE5;&#x6210;&#x4E3A;&#x4E00;&#x4E2A;&#x76D1;&#x89C6;&#x5668;&#xFF08;Monitor&#xFF09;, &#x8BE5;Monitor&#x7531;&#x4E00;&#x4E2A;&#x9501;&#xFF08;lock&#xFF09;, &#x4E00;&#x4E2A;&#x7B49;&#x5F85;&#x961F;&#x5217;&#xFF08;waiting queue &#xFF09;, &#x4E00;&#x4E2A;&#x5165;&#x53E3;&#x961F;&#x5217;( entry queue).
&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x65B9;&#x6CD5;&#xFF0C; &#x5982;&#x679C;&#x6CA1;&#x6709;synchonized&#x5173;&#x952E;&#x5B57;&#xFF0C; &#x8BE5;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x88AB;&#x4EFB;&#x610F;&#x6570;&#x91CF;&#x7684;&#x7EBF;&#x7A0B;&#xFF0C;&#x5728;&#x4EFB;&#x610F;&#x65F6;&#x523B;&#x8C03;&#x7528;&#x3002;
&#x5BF9;&#x4E8E;&#x6DFB;&#x52A0;&#x4E86;synchronized&#x5173;&#x952E;&#x5B57;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4EFB;&#x610F;&#x65F6;&#x523B;&#x53EA;&#x80FD;&#x88AB;&#x552F;&#x4E00;&#x7684;&#x4E00;&#x4E2A;&#x83B7;&#x5F97;&#x4E86;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x9501;&#x7684;&#x7EBF;&#x7A0B;&#x8C03;&#x7528;&#x3002;</p>
<p><img src="/images/java_monitor.bmp" alt="java&#x76D1;&#x89C6;&#x5668;"></p>
<p><strong>&#x8FDB;&#x5165;&#x533A;(Entry Set):</strong> &#x8868;&#x793A;&#x7EBF;&#x7A0B;&#x901A;&#x8FC7; synchronized&#x8981;&#x6C42;&#x83B7;&#x5F97;&#x5BF9;&#x8C61;&#x9501;&#xFF0C;&#x5982;&#x679C;&#x83B7;&#x53D6;&#x5230;&#x4E86;&#xFF0C;&#x5219;&#x6210;&#x4E3A;&#x62E5;&#x6709;&#x8005;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x83B7;&#x53D6;&#x5230;&#x5728;&#x5728;&#x8FDB;&#x5165;&#x533A;&#x7B49;&#x5F85;&#xFF0C;&#x76F4;&#x5230;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x91CA;&#x653E;&#x9501;&#x4E4B;&#x540E;&#x518D;&#x53BB;&#x7ADE;&#x4E89;(&#x8C01;&#x83B7;&#x53D6;&#x5230;&#x5219;&#x6839;&#x636E;)</p>
<p><strong>&#x62E5;&#x6709;&#x8005;(Owner):</strong> &#x8868;&#x793A;&#x7EBF;&#x7A0B;&#x83B7;&#x53D6;&#x5230;&#x4E86;&#x5BF9;&#x8C61;&#x9501;&#xFF0C;&#x53EF;&#x4EE5;&#x6267;&#x884C;synchronized&#x5305;&#x56F4;&#x7684;&#x4EE3;&#x7801;&#x4E86;</p>
<p><strong>&#x7B49;&#x5F85;&#x533A;(Wait Set):</strong> &#x8868;&#x793A;&#x7EBF;&#x7A0B;&#x8C03;&#x7528;&#x4E86;wait&#x65B9;&#x6CD5;,&#x6B64;&#x65F6;&#x91CA;&#x653E;&#x4E86;&#x6301;&#x6709;&#x7684;&#x5BF9;&#x8C61;&#x9501;&#xFF0C;&#x7B49;&#x5F85;&#x88AB;&#x5524;&#x9192;(&#x8C01;&#x88AB;&#x5524;&#x9192;&#x53D6;&#x5F97;&#x76D1;&#x89C6;&#x5668;&#x9501;&#x7531;jvm&#x51B3;&#x5B9A;)</p>
<h3 id="&#x6B63;&#x786E;&#x7684;&#x4F7F;&#x7528;waitnotify">&#x6B63;&#x786E;&#x7684;&#x4F7F;&#x7528;wait/notify</h3>
<p>&#x4E4B;&#x524D;&#x4E5F;&#x8BF4;&#x4E86;wait/notify&#x662F;&#x4E3A;&#x4E86;&#x5904;&#x7406;&#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;&#x534F;&#x4F5C;&#x7684;&#x95EE;&#x9898;&#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x65E2;&#x7136;&#x662F;&#x534F;&#x4F5C;&#x5FC5;&#x7136;&#x6D89;&#x53CA;&#x5230;&#x4E86;&#x5BF9;&#x516C;&#x5171;&#x8D44;&#x6E90;&#x7684;&#x64CD;&#x4F5C;&#x3002;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x4E3E;&#x4E00;&#x4E2A;&#x751F;&#x4EA7;&#x8005;&#x6D88;&#x8D39;&#x8005;&#x7684;&#x4F8B;&#x5B50;&#x3002;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"><span class="keyword">import</span> java.util.Queue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadTest</span> </span>{</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">	Queue&lt;Integer&gt; queue = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">	Thread producer = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Producer(queue,<span class="number">20</span>));</span><br><span class="line">	Thread consumer = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Consumer(queue,<span class="number">20</span>));</span><br><span class="line"></span><br><span class="line">	producer.start();</span><br><span class="line">	consumer.start();</span><br><span class="line"></span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Producer</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>{</span><br><span class="line"></span><br><span class="line">    Queue&lt;Integer&gt; queue;</span><br><span class="line">    Integer maxSize = <span class="number">10</span>;</span><br><span class="line">    Integer maxTime;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Producer</span><span class="params">(Queue&lt;Integer&gt; queue, Integer maxTime)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.queue = queue;</span><br><span class="line">        <span class="keyword">this</span>.maxTime = maxTime;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (i &lt;= maxTime) {</span><br><span class="line">            <span class="keyword">synchronized</span> (queue) {</span><br><span class="line">                <span class="keyword">while</span> (queue.size() &gt;= maxSize) {</span><br><span class="line">                    <span class="keyword">try</span> {</span><br><span class="line">                        System.out.println(<span class="string">&quot;waiting producer&quot;</span>);</span><br><span class="line">                        queue.wait();</span><br><span class="line">                    } <span class="keyword">catch</span> (InterruptedException e) {</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    }</span><br><span class="line">                }</span><br><span class="line">                <span class="comment">// &#x4EA7;&#x751F;&#x4E00;&#x4E2A;&#x6570;&#x636E;</span></span><br><span class="line">                <span class="keyword">int</span> d = (<span class="keyword">int</span>) (Math.random() * <span class="number">100</span>);</span><br><span class="line">                queue.add(d);</span><br><span class="line">                System.out.println(<span class="string">&quot;producer queue size is &quot;</span> + queue.size() + <span class="string">&quot;,produce data &quot;</span> + d);</span><br><span class="line"></span><br><span class="line">                queue.notify();</span><br><span class="line"></span><br><span class="line">                i++;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>{</span><br><span class="line"></span><br><span class="line">	Queue&lt;Integer&gt; queue;</span><br><span class="line">	Integer maxTime;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Consumer</span><span class="params">(Queue queue,Integer maxTime)</span> </span>{</span><br><span class="line">		<span class="keyword">this</span>.queue = queue;</span><br><span class="line">		<span class="keyword">this</span>.maxTime = maxTime;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="annotation">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>{</span><br><span class="line">		<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>(i &lt;= maxTime) {</span><br><span class="line">			<span class="keyword">synchronized</span> (queue) {</span><br><span class="line">				<span class="keyword">while</span>(queue.isEmpty()) {</span><br><span class="line">					<span class="keyword">try</span> {</span><br><span class="line">						queue.wait();</span><br><span class="line">					} <span class="keyword">catch</span> (InterruptedException e) {</span><br><span class="line">						e.printStackTrace();</span><br><span class="line">					}</span><br><span class="line">				}</span><br><span class="line"></span><br><span class="line">				System.out.println(<span class="string">&quot;consume data &quot;</span> + queue.poll());</span><br><span class="line">				<span class="comment">//&#x53BB;&#x5524;&#x9192;&#x751F;&#x4EA7;&#x8005;</span></span><br><span class="line">				queue.notify();</span><br><span class="line">				i++;</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">producer <span class="built_in">queue</span> size is <span class="number">1</span>,produce data  <span class="number">99</span></span><br><span class="line">producer <span class="built_in">queue</span> size is <span class="number">2</span>,produce data  <span class="number">55</span></span><br><span class="line">producer <span class="built_in">queue</span> size is <span class="number">3</span>,produce data  <span class="number">59</span></span><br><span class="line">producer <span class="built_in">queue</span> size is <span class="number">4</span>,produce data  <span class="number">78</span></span><br><span class="line">producer <span class="built_in">queue</span> size is <span class="number">5</span>,produce data  <span class="number">99</span></span><br><span class="line">producer <span class="built_in">queue</span> size is <span class="number">6</span>,produce data  <span class="number">30</span></span><br><span class="line">producer <span class="built_in">queue</span> size is <span class="number">7</span>,produce data  <span class="number">40</span></span><br><span class="line">producer <span class="built_in">queue</span> size is <span class="number">8</span>,produce data  <span class="number">28</span></span><br><span class="line">producer <span class="built_in">queue</span> size is <span class="number">9</span>,produce data  <span class="number">52</span></span><br><span class="line">producer <span class="built_in">queue</span> size is <span class="number">10</span>,produce data  <span class="number">57</span></span><br><span class="line"><span class="built_in">queue</span> is full,waiting produce</span><br><span class="line">consume data <span class="number">99</span></span><br><span class="line">consume data <span class="number">55</span></span><br><span class="line">consume data <span class="number">59</span></span><br><span class="line">consume data <span class="number">78</span></span><br><span class="line">consume data <span class="number">99</span></span><br><span class="line">consume data <span class="number">30</span></span><br><span class="line">consume data <span class="number">40</span></span><br><span class="line">consume data <span class="number">28</span></span><br><span class="line">consume data <span class="number">52</span></span><br><span class="line">consume data <span class="number">57</span></span><br><span class="line">producer <span class="built_in">queue</span> size is <span class="number">1</span>,produce data  <span class="number">29</span></span><br><span class="line">producer <span class="built_in">queue</span> size is <span class="number">2</span>,produce data  <span class="number">72</span></span><br><span class="line">producer <span class="built_in">queue</span> size is <span class="number">3</span>,produce data  <span class="number">8</span></span><br><span class="line">producer <span class="built_in">queue</span> size is <span class="number">4</span>,produce data  <span class="number">66</span></span><br><span class="line">producer <span class="built_in">queue</span> size is <span class="number">5</span>,produce data  <span class="number">27</span></span><br><span class="line">producer <span class="built_in">queue</span> size is <span class="number">6</span>,produce data  <span class="number">37</span></span><br><span class="line">producer <span class="built_in">queue</span> size is <span class="number">7</span>,produce data  <span class="number">27</span></span><br><span class="line">producer <span class="built_in">queue</span> size is <span class="number">8</span>,produce data  <span class="number">27</span></span><br><span class="line">producer <span class="built_in">queue</span> size is <span class="number">9</span>,produce data  <span class="number">4</span></span><br><span class="line">producer <span class="built_in">queue</span> size is <span class="number">10</span>,produce data  <span class="number">87</span></span><br><span class="line"><span class="built_in">queue</span> is full,waiting produce</span><br><span class="line">consume data <span class="number">29</span></span><br><span class="line">consume data <span class="number">72</span></span><br><span class="line">consume data <span class="number">8</span></span><br><span class="line">consume data <span class="number">66</span></span><br><span class="line">consume data <span class="number">27</span></span><br><span class="line">consume data <span class="number">37</span></span><br><span class="line">consume data <span class="number">27</span></span><br><span class="line">consume data <span class="number">27</span></span><br><span class="line">consume data <span class="number">4</span></span><br><span class="line">consume data <span class="number">87</span></span><br><span class="line">producer <span class="built_in">queue</span> size is <span class="number">1</span>,produce data  <span class="number">79</span></span><br><span class="line">consume data <span class="number">79</span></span><br></pre></td></tr></table></figure></p>
<p>&#x4E0A;&#x9762;&#x7684;wait&#x7684;&#x7528;&#x6CD5;&#x57FA;&#x672C;&#x53EF;&#x4EE5;&#x7B80;&#x5316;&#x6210;&#x4E3A;&#x8FD9;&#x6837;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">synchronized</span>(queue) {<span class="comment">//&#x4F7F;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x83B7;&#x53D6;&#x5230;queue&#x5BF9;&#x8C61;&#x7684;&#x76D1;&#x89C6;&#x5668;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//&#x8BA9;&#x62E5;&#x6709;queue&#x5BF9;&#x8C61;&#x76D1;&#x89C6;&#x5668;&#x7684;&#x7EBF;&#x7A0B;&#x8FDB;&#x884C;&#x7B49;&#x5F85;(&#x8BA9;&#x51FA;monitor&#x4F7F;&#x7528;&#x6743;)&#x76F4;&#x5230;&#x88AB;&#x5524;&#x9192;(notify/notifyAll)</span></span><br><span class="line">    queue.wait();</span><br><span class="line"></span><br><span class="line">    doSomething();</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x6240;&#x4EE5;&#xFF0C;wait&#x548C;notify/notifyAll&#x57FA;&#x672C;&#x4E0A;&#x662F;&#x6210;&#x5BF9;&#x51FA;&#x73B0;&#x7684;,
wait(0)=wait()&#x540E;&#x7684;&#x7EBF;&#x7A0B;&#x5FC5;&#x987B;&#x8981;&#x7531;notify/notifyAll&#x5524;&#x9192;&#x624D;&#x80FD;&#x7EE7;&#x7EED;&#x53BB;&#x7ADE;&#x4E89;&#x9501;&#xFF0C;&#x4ECE;&#x800C;&#x8FD0;&#x884C;wait&#x4E4B;&#x540E;&#x7684;&#x4EE3;&#x7801;.&#x5982;&#x679C;&#x8C03;&#x7528;&#x7684;wait(200)&#x8FD9;&#x79CD;&#x4EE3;&#x7801;,&#x90A3;&#x4E48;&#x4F1A;&#x5728;200ms&#x540E;&#x5C06;&#x7EBF;&#x7A0B;&#x4ECE;waiting set&#x4E2D;&#x79FB;&#x9664;&#x5E76;&#x5141;&#x8BB8;&#x5176;&#x91CD;&#x65B0;&#x7ADE;&#x4E89;&#x9501;&#xFF0C;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;notify&#x65B9;&#x6CD5;&#x5E76;&#x4E0D;&#x4F1A;&#x91CA;&#x653E;&#x6240;&#x6301;&#x6709;&#x7684;monitor.</p>
<h3 id="join&#x7684;&#x4F7F;&#x7528;">join&#x7684;&#x4F7F;&#x7528;</h3>
<p>&#x5148;&#x6765;&#x770B;&#x770B;join&#x7684;&#x6E90;&#x7801;&#xFF0C;&#x548B;&#x5728;&#x63A5;&#x7740;&#x5206;&#x6790;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">join</span><span class="params">(<span class="keyword">long</span> millis)</span></span><br><span class="line">	<span class="keyword">throws</span> InterruptedException </span>{</span><br><span class="line">	<span class="keyword">long</span> base = System.currentTimeMillis();</span><br><span class="line">	<span class="keyword">long</span> now = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (millis &lt; <span class="number">0</span>) {</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;timeout value is negative&quot;</span>);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (millis == <span class="number">0</span>) {</span><br><span class="line">		<span class="keyword">while</span> (isAlive()) {</span><br><span class="line">			wait(<span class="number">0</span>);</span><br><span class="line">		}</span><br><span class="line">	} <span class="keyword">else</span> {</span><br><span class="line">		<span class="keyword">while</span> (isAlive()) {</span><br><span class="line">			<span class="keyword">long</span> delay = millis - now;</span><br><span class="line">			<span class="keyword">if</span> (delay &lt;= <span class="number">0</span>) {</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			}</span><br><span class="line">			wait(delay);</span><br><span class="line">			now = System.currentTimeMillis() - base;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x5982;&#x679C;&#x6211;&#x4EEC;&#x5199;&#x4E86;&#x8FD9;&#x6837;&#x7684;&#x4E00;&#x6BB5;&#x4EE3;&#x7801;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadTest</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>{</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">		Thread th = <span class="keyword">new</span> Thread(<span class="keyword">new</span> ThreadTest());</span><br><span class="line">		th.start();</span><br><span class="line">		<span class="keyword">try</span> {</span><br><span class="line">			th.join();</span><br><span class="line">		} <span class="keyword">catch</span> (InterruptedException e) {</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		}</span><br><span class="line">		System.out.println(<span class="string">&quot;main thread execute over&quot;</span>);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="annotation">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>{</span><br><span class="line">		<span class="keyword">try</span> {</span><br><span class="line">			System.out.println(<span class="string">&quot;sleep 3s&quot;</span>);</span><br><span class="line">			Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">			System.out.println(<span class="string">&quot;wake up&quot;</span>);</span><br><span class="line">		} <span class="keyword">catch</span> (Exception e) {</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x90A3;&#x4E48;&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#x662F;&#xFF1A;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sleep <span class="number">3</span>s</span><br><span class="line">wake up</span><br><span class="line">main thread execute over</span><br></pre></td></tr></table></figure></p>
<p>&#x5982;&#x679C;&#x5C06;th.join&#x4FEE;&#x6539;&#x4E3A;th.join(2000)&#x90A3;&#x4E48;main thread&#x4F1A;&#x5728;sleep 3s&#x4E4B;&#x540E;&#x6253;&#x5370;&#x3002;
&#x4E0A;&#x9762;&#x6211;&#x4EEC;&#x8D34;&#x51FA;&#x6765;&#x4E86;join&#x7684;&#x6E90;&#x7801;&#xFF0C;&#x5176;&#x5B9E;&#x6211;&#x89C9;&#x5F97;th.join()&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x6210;&#x4E3A;&#x8FD9;&#x6837;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">synchronized</span>(th) {</span><br><span class="line"><span class="keyword">while</span>(th.isAlive()) {</span><br><span class="line">    th.wait();</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">}</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>synchronized&#x5173;&#x952E;&#x5B57;&#x662F;&#x52A0;&#x5728;&#x65B9;&#x6CD5;&#x4E0A;&#x9762;&#x7684;&#xFF0C;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x5E76;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;static&#x65B9;&#x6CD5;&#xFF0C;&#x6240;&#x4EE5;&#x6B64;&#x65F6;&#x83B7;&#x53D6;&#x5230;&#x7684;&#x662F;&#x7EBF;&#x7A0B;&#x5B9E;&#x4F8B;&#x7684;&#x76D1;&#x89C6;&#x5668;&#xFF0C;&#x5728;&#x4E0A;&#x9762;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x4E2D;&#x83B7;&#x53D6;&#x5230;&#x7684;&#x5C31;&#x662F;th&#x8FD9;&#x5B9E;&#x4F8B;&#x7684;&#x76D1;&#x89C6;&#x5668;&#x3002;&#x7531;&#x4E8E;&#x662F;main&#x7EBF;&#x7A0B;&#x8FD0;&#x884C;&#x7684;th.join()&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x6240;&#x4EE5;&#x4F1A;&#x5BFC;&#x81F4;main&#x7EBF;&#x7A0B;&#x8FDB;&#x884C;&#x7B49;&#x5F85;(&#x7B49;&#x5F85;&#x65F6;&#x95F4;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x6DFB;&#x52A0;&#x8C03;&#x7528;&#x4E0D;&#x540C;&#x7684;&#x65B9;&#x6CD5;&#x6765;&#x51B3;&#x5B9A;&#xFF0C;&#x6BD4;&#x5982;wait(2000),join(2000)),&#x4E0A;&#x9762;&#x6211;&#x4EEC;&#x53D1;&#x73B0;join&#x65B9;&#x6CD5;&#x5176;&#x5B9E;&#x5185;&#x90E8;&#x4E5F;&#x662F;&#x4F7F;&#x7528;&#x7684;wait&#xFF0C;&#x4F46;&#x662F;&#x662F;&#x54EA;&#x91CC;notify&#x7684;&#x5462;&#xFF1F;&#x5B98;&#x65B9;api&#x8BF4;&#x660E;&#xFF0C;&#x5728;&#x7EBF;&#x7A0B;&#x7ED3;&#x675F;&#x540E;&#x4F1A;&#x9690;&#x542B;&#x7684;&#x8C03;&#x7528;notifyAll&#x65B9;&#x6CD5;&#xFF0C;&#x6240;&#x4EE5;&#x624D;&#x4F1A;&#x6709;&#x8F93;&#x51FA;&#xFF0C;&#x5982;&#x679C;&#x628A;&#x9501;&#x52A0;&#x5728;&#x5176;&#x4ED6;&#x5BF9;&#x8C61;(&#x6BD4;&#x5982;new Object)&#x4E0A;&#xFF0C;&#x4F1A;&#x53D1;&#x73B0;&#x4E00;&#x76F4;&#x7B49;&#x5F85;&#xFF0C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x65E0;&#x6CD5;&#x9000;&#x51FA;&#x3002;</p>
<h3 id="&#x5173;&#x4E8E;sleep">&#x5173;&#x4E8E;sleep</h3>
<p>&#x5B83;&#x662F;&#x4E00;&#x4E2A;&#x9759;&#x6001;&#x65B9;&#x6CD5;&#xFF0C;&#x4E00;&#x822C;&#x7684;&#x8C03;&#x7528;&#x65B9;&#x5F0F;&#x662F;Thread.sleep(2000),&#x8868;&#x793A;&#x8BA9;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x4F11;&#x7720;2000ms,&#x5E76;&#x4E0D;&#x4F1A;&#x8BA9;&#x51FA;&#x76D1;&#x89C6;&#x5668;&#xFF0C;&#x8FD9;&#x4E00;&#x70B9;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x3002;</p>
<h3 id="&#x603B;&#x7ED3;">&#x603B;&#x7ED3;</h3>
<ol>
<li>wait/notify&#x57FA;&#x672C;&#x4E0A;&#x662F;&#x6210;&#x5BF9;&#x51FA;&#x73B0;&#xFF0C;&#x6709;&#x65F6;&#x5019;&#x5728;&#x4EE3;&#x7801;&#x4E2D;&#x4F7F;&#x7528;&#x4E0D;&#x5F53;&#x4F1A;&#x5BFC;&#x81F4;&#x7A0B;&#x5E8F;&#x51FA;&#x73B0;&#x5F02;&#x5E38;&#x6548;&#x679C;</li>
<li>&#x5173;&#x4E8E;monitor&#x7684;&#x6982;&#x5FF5;&#x9700;&#x8981;&#x4E86;&#x89E3;&#x6E05;&#x695A;&#xFF0C;wait/join&#x65B9;&#x6CD5;&#x4F1A;&#x8BA9;&#x51FA;monitor,notify&#x4E0D;&#x4F1A;</li>
</ol>
]]></content>
    <summary type="html">
    <![CDATA[一说到多线程，那么必然离不开Object中的wait,notify,notifyAll,join以及Thread中的sleep等方法,虽然这些是耳熟能详，但是你真的会用吗？你知道如何使用吗？你知道这里面涉及到的知识点吗？]]>
    
    </summary>
    
      <category term="多线程" scheme="http://yoursite.com/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
      <category term="多线程" scheme="http://yoursite.com/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[从Eclipse到Idea,常用的快捷键]]></title>
    <link href="http://yoursite.com/2018/07/11/idea-shortcut-key-md/"/>
    <id>http://yoursite.com/2018/07/11/idea-shortcut-key-md/</id>
    <published>2018-07-11T13:01:49.000Z</published>
    <updated>2018-11-13T13:37:06.246Z</updated>
    <content type="html"><![CDATA[<h3 id="&#x4ECE;eclipse&#x8F6C;&#x5230;idea">&#x4ECE;Eclipse&#x8F6C;&#x5230;Idea</h3>
<p>&#x6211;&#x7528;&#x4E86;&#x4E03;&#x5E74;&#x7684;Eclipse&#xFF0C;&#x719F;&#x6089;&#x4E86;Eclipse&#x7684;&#x5FEB;&#x6377;&#x952E;&#xFF0C;&#x4ECA;&#x5E74;&#x8F6C;&#x6218;&#x5230;Idea,&#x8FD8;&#x6709;&#x6709;&#x70B9;&#x4E0D;&#x559C;&#x6B22;&#xFF0C;&#x867D;&#x7136;&#x53EF;&#x4EE5;&#x5207;&#x6362;&#x5230;Eclipse&#x7684;&#x5FEB;&#x6377;&#x952E;&#xFF0C;&#x4F46;&#x662F;&#x5176;&#x4ED6;&#x4EBA;&#x7684;&#x4E0D;&#x4F1A;&#x5207;&#x6362;&#xFF0C;&#x4EE5;&#x540E;&#x4F60;&#x5728;&#x522B;&#x4EBA;&#x7535;&#x8111;&#x4E0A;&#x8C03;&#x8BD5;&#x6216;&#x8005;&#x522B;&#x4EBA;&#x5E2E;&#x4F60;&#x770B;&#x95EE;&#x9898;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x4F1A;&#x4E0D;&#x559C;&#x6B22;&#xFF0C;&#x5E72;&#x8106;&#x5C31;&#x4E0D;&#x6362;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x6709;&#x4E9B;&#x5FEB;&#x6377;&#x952E;&#x786E;&#x5B9E;&#x8BB0;&#x4E0D;&#x4F4F;&#xFF0C;&#x800C;&#x4E14;&#x4E5F;&#x5F88;&#x591A;&#xFF0C;&#x5C31;&#x8BB0;&#x5F55;&#x4E0B;&#x81EA;&#x5DF1;&#x5E38;&#x7528;&#x7684;&#x5FEB;&#x6377;&#x952E;&#x3002;</p>
<p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="bullet">1. </span>&#x6839;&#x636E;&#x6A21;&#x7CCA;&#x7684;&#x7C7B;&#x540D;&#x6216;&#x8005;&#x65B9;&#x6CD5;&#x540D;&#x67E5;&#x627E;Java&#x6587;&#x4EF6;&#xFF1A; Ctrl+Shift+Alt+N</span><br><span class="line"></span><br><span class="line"><span class="bullet">2. </span>&#x67E5;&#x627E;&#x6587;&#x4EF6;&#x6216;&#x76EE;&#x5F55;: Ctrl+Shift+N&#x540E;&#xFF0C;&#x4F7F;&#x7528;/&#x7136;&#x540E;&#x8F93;&#x5165;&#x76EE;&#x5F55;&#x540D;&#x79F0;&#x5373;&#x53EF;</span><br><span class="line"></span><br><span class="line"><span class="bullet">3. </span>&#x67E5;&#x770B;&#x6240;&#x6709;&#x5FEB;&#x6377;&#x952E;: Ctrl+Shift+A(&#x5F88;&#x5E38;&#x7528;)</span><br><span class="line"></span><br><span class="line"><span class="bullet">4. </span>&#x5728;&#x5F53;&#x524D;&#x7A97;&#x53E3;&#x5F39;&#x51FA;&#x67D0;&#x4E2A;&#x7C7B;&#x7684;&#x5B9A;&#x4E49;: Ctrl+Shift+i</span><br><span class="line"></span><br><span class="line"><span class="bullet">5. </span>&#x5B9E;&#x73B0;&#x63A5;&#x53E3;&#x65B9;&#x6CD5;&#xFF1A; Ctrl+I</span><br><span class="line"></span><br><span class="line"><span class="bullet">6. </span>&#x590D;&#x5199;&#x6216;&#x8005;&#x5B9E;&#x73B0;&#x7236;&#x7C7B;&#x7684;&#x65B9;&#x6CD5;: Ctrl+O</span><br><span class="line"></span><br><span class="line"><span class="bullet">7. </span>&#x5FEB;&#x901F;&#x8FD4;&#x56DE;&#x4E0A;&#x6B21;&#x67E5;&#x770B;&#x4EE3;&#x7801;&#x7684;&#x4F4D;&#x7F6E;: Ctrl+Alt+&#x65B9;&#x5411;&#x952E;</span><br><span class="line"></span><br><span class="line"><span class="bullet">8. </span>&#x4E00;&#x952E;&#x683C;&#x5F0F;&#x5316;&#x4EE3;&#x78BC;: Ctrl+Alt+L</span><br><span class="line"></span><br><span class="line"><span class="bullet">9. </span>&#x53BB;&#x6389;&#x65E0;&#x6548;&#x7684;import: Ctrl+Alt+O</span><br><span class="line"></span><br><span class="line"><span class="bullet">9. </span>&#x5220;&#x9664;&#x4E00;&#x884C;: Ctrl+X  &#x6216;&#x8005;Ctrl+Y</span><br><span class="line"></span><br><span class="line"><span class="bullet">10. </span>&#x67E5;&#x770B;&#x7C7B;&#x6216;&#x63A5;&#x53E3;&#x7684;&#x7EE7;&#x627F;&#x5173;&#x7CFB;&#xFF1A;Ctrl+H</span><br><span class="line"></span><br><span class="line"><span class="bullet">11. </span>&#x67E5;&#x627E;&#x63A5;&#x53E3;&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#xFF1A; ctrl + alt +B</span><br><span class="line"></span><br><span class="line"><span class="bullet">12. </span>&#x590D;&#x5236;&#x884C;: Ctrl+D</span><br><span class="line"></span><br><span class="line"><span class="bullet">13. </span>&#x5FEB;&#x901F;&#x6253;&#x5F00;&#x7C7B;: Ctrl+N</span><br><span class="line"></span><br><span class="line"><span class="bullet">14. </span>&#x67E5;&#x770B;&#x5F53;&#x524D;&#x7C7B;&#x7684;&#x6240;&#x6709;&#x65B9;&#x6CD5;: Alt+7  &#x6216;&#x8005;Ctrl+F12(&#x8FD9;&#x4E2A;&#x653E;&#x65B9;&#x4FBF;)</span><br><span class="line"></span><br><span class="line"><span class="bullet">15. </span>&#x67E5;&#x770B;&#x4E0B;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;: ctrl+&#x4E0B;&#x65B9;&#x5411;&#x952E;</span><br><span class="line"></span><br><span class="line"><span class="bullet">16. </span>&#x67E5;&#x770B;&#x4E0A;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;: ctrl+&#x4E0A;&#x65B9;&#x5411;&#x952E;</span><br><span class="line"></span><br><span class="line"><span class="bullet">15. </span>&#x5173;&#x95ED;Tab&#x9875; : Ctrl+F4</span><br><span class="line"></span><br><span class="line"><span class="bullet">16. </span>&#x67E5;&#x770B;&#x65B9;&#x6CD5;&#x88AB;&#x90FD;&#x88AB;&#x8C01;&#x8C03;&#x7528;&#x4E86;&#xFF1A; Ctrl+Alt+H  &#x4F1A;&#x663E;&#x793A;&#x51FA;&#x54EA;&#x4E9B;&#x7C7B;&#x8C03;&#x7528;&#x4E86;&#x5B83;&#x4EE5;&#x53CA;&#x6B21;&#x6570;</span><br><span class="line"></span><br><span class="line"><span class="bullet">17. </span>&#x7CBE;&#x786E;&#x67E5;&#x770B;&#x88AB;&#x8C01;&#x8C03;&#x7528;&#x4E86;&#xFF1A; Alt+F7</span><br><span class="line"></span><br><span class="line"><span class="bullet">18. </span>&#x5BFB;&#x627E;Controller&#x4E2D;URL&#x8DEF;&#x5F84;&#xFF1A; Ctrl+Alt+Shift+H &#x6216;&#x8005; double shift(search everything)</span><br><span class="line"></span><br><span class="line"><span class="bullet">19. </span>&#x6DFB;&#x52A0;bookmark&#x65B9;&#x6CD5;&#xFF1A;</span><br><span class="line"><span class="code">    1. &#x4F7F;&#x7528;Ctrl+F12&#x5217;&#x51FA;&#x8BE5;&#x7C7B;&#x7684;&#x6240;&#x6709;&#x65B9;&#x6CD5;&#xFF0C;&#x5B9A;&#x4F4D;&#x5230;&#x4F60;&#x60F3;&#x8981;&#x52A0;&#x5165;&#x7684;&#x65B9;&#x6CD5;</span></span><br><span class="line"><span class="code">    2. &#x6309;&#x4E0B;F11&#xFF0C;&#x5C06;&#x65B9;&#x6CD5;&#x52A0;&#x5165;&#x5230;bookmark</span></span><br><span class="line"><span class="code">    3. &#x6309;&#x4E0B;shift+F11,&#x5C06;bookmark&#x5217;&#x8868;&#x5F39;&#x51FA;&#x6765;</span></span><br><span class="line"><span class="code">    4. &#x5728;&#x4E0A;&#x9762;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x5BF9;&#x5E94;&#x7684;&#x4FEE;&#x6539;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="bullet">20. </span>&#x6DFB;&#x52A0;&#x4EE3;&#x7801;&#x6298;&#x53E0;&#x5757;</span><br><span class="line"><span class="code">    1. &#x5C06;&#x5149;&#x6807;&#x5B9A;&#x4F4D;&#x5728;&#x5DE6;&#x8FB9;&#x5927;&#x62EC;&#x53F7;&#x91CC;&#x9762;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528;Ctrl+Shift+.&#x5373;&#x53EF;</span></span><br><span class="line"><span class="code">    2. &#x6309;&#x4E0B;Ctrl&#x52A0;&#x4E0A;&#x4E00;&#x4E2A;+&#x5373;&#x53EF;&#x8BA9;&#x6298;&#x53E0;&#x5FEB;&#x4FEE;&#x6539;</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">21. </span>&#x5927;&#x62EC;&#x53F7;&#x5339;&#x914D;&#xFF1A; Ctrl+] &#x6216;&#x8005; Ctrl+[&#x6765;&#x56DE;&#x5B9A;&#x4F4D;&#x5373;&#x53EF;</span><br><span class="line"></span><br><span class="line"><span class="bullet">22. </span>&#x9AD8;&#x4EAE;&#x67D0;&#x4E2A;&#x53D8;&#x91CF;&#xFF1A; Ctrl+Shift+F7  &#x4E0D;&#x4F1A;&#x968F;&#x7740;&#x9F20;&#x6807;&#x7684;&#x79FB;&#x52A8;&#x800C;&#x9AD8;&#x4EAE;&#x6D88;&#x5931;</span><br><span class="line"></span><br><span class="line"><span class="bullet">23. </span>&#x8DF3;&#x8F6C;&#x5230;&#x7236;&#x7C7B;&#x63A5;&#x53E3;&#xFF1A; Ctrl+U</span><br><span class="line"></span><br><span class="line"><span class="bullet">24. </span>&#x56DE;&#x6EDA;&#x4EE3;&#x7801;&#xFF1A; Ctrl+Z  &#x56DE;&#x6EDA;&#x56DE;&#x53BB;&#xFF1A; Ctrl+Shift+Z</span><br><span class="line"></span><br><span class="line"><span class="bullet">25. </span>&#x8C03;&#x8BD5;</span><br><span class="line"><span class="code">    1. F9            resume programe &#x6062;&#x590D;&#x7A0B;&#x5E8F;</span></span><br><span class="line"><span class="code">    2. Alt+F10       show execution point &#x663E;&#x793A;&#x6267;&#x884C;&#x65AD;&#x70B9;</span></span><br><span class="line"><span class="code">    3. F8            Step Over &#x76F8;&#x5F53;&#x4E8E;eclipse&#x7684;f6      &#x8DF3;&#x5230;&#x4E0B;&#x4E00;&#x6B65;</span></span><br><span class="line"><span class="code">    4. F7            Step Into &#x76F8;&#x5F53;&#x4E8E;eclipse&#x7684;f5&#x5C31;&#x662F;  &#x8FDB;&#x5165;&#x5230;&#x4EE3;&#x7801;</span></span><br><span class="line"><span class="code">    5. Alt+shift+F7  Force Step Into &#x8FD9;&#x4E2A;&#x662F;&#x5F3A;&#x5236;&#x8FDB;&#x5165;&#x4EE3;&#x7801;</span></span><br><span class="line"><span class="code">    6. Shift+F8      Step Out  &#x76F8;&#x5F53;&#x4E8E;eclipse&#x7684;f8&#x8DF3;&#x5230;&#x4E0B;&#x4E00;&#x4E2A;&#x65AD;&#x70B9;&#xFF0C;&#x4E5F;&#x76F8;&#x5F53;&#x4E8E;eclipse&#x7684;f7&#x8DF3;&#x51FA;&#x51FD;&#x6570;</span></span><br><span class="line"><span class="code">    7. Atl+F9        Run To Cursor &#x8FD0;&#x884C;&#x5230;&#x5149;&#x6807;&#x5904;</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">26. </span>&#x5E38;&#x7528;&#x63D2;&#x4EF6;</span><br><span class="line"></span><br><span class="line"><span class="code">    1. CheckStyle-IDEA   &#x4EE3;&#x7801;&#x98CE;&#x683C;&#x68C0;&#x6D4B;&#x63D2;&#x4EF6;</span></span><br><span class="line"><span class="code">    2. FindBugs-IDEA      &#x5BFB;&#x627E;&#x4EE3;&#x7801;&#x7684;bug&#x63D2;&#x4EF6;</span></span><br><span class="line"><span class="code">    3. Lombok plugin      &#x652F;&#x6301;lombok&#x7684;&#x63D2;&#x4EF6;</span></span><br><span class="line"><span class="code">    4. &#x963F;&#x91CC;&#x5DF4;&#x5DF4;&#x89C4;&#x7EA6;&#x63D2;&#x4EF6;</span></span><br><span class="line"><span class="code">    5. Maven Helper     &#x67E5;&#x770B;maven&#x4F9D;&#x8D56;&#x5173;&#x7CFB;&#x63D2;&#x4EF6;</span></span><br><span class="line"><span class="code">    6. CodeGlance   &#x7C7B;&#x4F3C;&#x4E8E;SublimeText&#x7684;Mini Map&#x63D2;&#x4EF6;</span></span><br><span class="line"><span class="code">    7. Grep Console     &#x7ED9;&#x5DE5;&#x4F5C;&#x53F0;&#x8F93;&#x51FA;&#x4E0A;&#x8272;&#xFF0C;&#x6839;&#x636E;&#x4E0D;&#x540C;&#x7684;&#x65E5;&#x5FD7;&#x7B49;&#x7EA7;&#x8BBE;&#x7F6E;&#x4E0D;&#x540C;&#x7684;&#x524D;&#x666F;&#x8272;&#x6216;&#x8005;&#x80CC;&#x666F;&#x8272;&#xFF0C;&#x4EE5;&#x53CA;&#x67E5;&#x627E;&#x7B49;&#x529F;&#x80FD;</span></span><br><span class="line"><span class="code">    8. JRebel for IntelliJ  &#x70ED;&#x90E8;&#x7F72;&#x63D2;&#x4EF6;&#x4FEE;&#x6539;&#x4E86;&#x4EE3;&#x7801;&#x65E0;&#x9700;&#x91CD;&#x542F;</span></span><br><span class="line"><span class="code">    9. lombok Plugin    &#x4F7F;&#x7528;lombok&#x7684;&#x90FD;&#x77E5;&#x9053;</span></span><br><span class="line"><span class="code">    10.  rainbow brackets    &#x5F69;&#x8679;&#x62EC;&#x53F7;,&#x4EE3;&#x7801;&#x4E2D;&#x62EC;&#x53F7;&#x5C42;&#x7EA7;&#x592A;&#x591A;&#x7684;&#x65F6;&#x5019;&#x4F60;&#x5C31;&#x77E5;&#x9053;&#x5B83;&#x7684;&#x7528;&#x5904;&#x4E86;</span></span><br></pre></td></tr></table></figure></p>
]]></content>
    <summary type="html">
    <![CDATA[从Eclipse转到Idea,多多少少会有些不习惯，虽然可以使用Eclipse的快捷键，但是开发中总是会在别人的机器上或者别人在你的机器上调测，所以掌握Idea的快捷键很很有必要的，但是一般来说我们掌握常用的即可，其他的即使记不住也可以搜索。]]>
    
    </summary>
    
      <category term="Idea" scheme="http://yoursite.com/tags/Idea/"/>
    
      <category term="工具" scheme="http://yoursite.com/tags/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="工具" scheme="http://yoursite.com/categories/%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Java开发者常用的线上命令]]></title>
    <link href="http://yoursite.com/2018/04/27/java-programer-always-use-command/"/>
    <id>http://yoursite.com/2018/04/27/java-programer-always-use-command/</id>
    <published>2018-04-27T12:52:16.000Z</published>
    <updated>2018-11-13T13:33:41.047Z</updated>
    <content type="html"><![CDATA[<h3 id="1-java&#x547D;&#x4EE4;&#x7684;&#x4F7F;&#x7528;">1. Java&#x547D;&#x4EE4;&#x7684;&#x4F7F;&#x7528;</h3>
<p>jps&#x3001;jconsole&#x3001;jvisualvm&#x7B49;&#x5DE5;&#x5177;&#x7684;&#x6570;&#x636E;&#x6765;&#x6E90;&#x662F;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;(/tmp/hsperfdata_userName/pid)&#x3002;&#x6240;&#x4EE5;&#x5F53;&#x8BE5;&#x6587;&#x4EF6;&#x4E0D;&#x5B58;&#x5728;&#x6216;&#x662F;&#x65E0;&#x6CD5;&#x8BFB;&#x53D6;&#x65F6;&#x5C31;&#x4F1A;&#x51FA;&#x73B0;jps&#x65E0;&#x6CD5;&#x67E5;&#x770B;&#x8BE5;&#x8FDB;&#x7A0B;&#x53F7;,jconsole&#x65E0;&#x6CD5;&#x76D1;&#x63A7;&#x7B49;&#x95EE;&#x9898;,&#x5982;&#x679C;&#x8BE5;&#x6587;&#x4EF6;&#x4E0D;&#x5B58;&#x5728;&#x6216;&#x8005;&#x6CA1;&#x6709;&#x6743;&#x9650;&#x5747;&#x4F1A;&#x5BFC;&#x81F4;&#x8FD9;&#x4E9B;&#x547D;&#x4EE4;&#x65E0;&#x6CD5;&#x4F7F;&#x7528;,java&#x542F;&#x52A8;&#x65F6;&#x63D0;&#x4F9B;&#x4E86;&#x53C2;&#x6570;(-Djava.io.tmpdir),&#x53EF;&#x4EE5;&#x5BF9;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x4F4D;&#x7F6E;&#x8FDB;&#x884C;&#x8BBE;&#x7F6E;,&#x800C;jps&#x3001;jconsole&#x90FD;&#x53EA;&#x4F1A;&#x4ECE;/tmp&#x76EE;&#x5F55;&#x8BFB;&#x53D6;,&#x800C;&#x65E0;&#x6CD5;&#x4ECE;&#x8BBE;&#x7F6E;&#x540E;&#x7684;&#x76EE;&#x5F55;&#x8BFB;&#x53D6;&#x4FE1;&#x606F;&#x3002;</p>
<hr>
<ol>
<li>&#x663E;&#x793A;&#x5F53;&#x524D;&#x6240;&#x6709;java&#x8FDB;&#x7A0B;</li>
</ol>
<p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./jdk/<span class="keyword">bin/jps </span>-v</span><br></pre></td></tr></table></figure></p>
<ol start="2">
<li>&#x67E5;&#x770B;&#x5F53;&#x524D;&#x65F6;&#x523B;java&#x7EBF;&#x7A0B;&#x72B6;&#x6001;</li>
</ol>
<p><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./jdk/bin/jstack <span class="keyword">pid</span></span><br><span class="line">jstack -F <span class="keyword">pid</span>   &#x5F3A;&#x5236;&#x6027;&#x83B7;&#x53D6;&#x7EBF;&#x7A0B;&#x72B6;&#x6001;</span><br></pre></td></tr></table></figure></p>
<p><strong>&#x67E5;&#x770B;&#x4EA7;&#x751F;&#x7684;&#x7EBF;&#x7A0B;&#x6587;&#x4EF6;&#xFF0C;&#x4E3B;&#x8981;&#x6709;&#x4EE5;&#x4E0B;&#x51E0;&#x79CD;&#x7EBF;&#x7A0B;&#x4FEE;&#x9970;</strong></p>
<p><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">locked <span class="variable">&lt;&#x5730;&#x5740;&gt;</span> &#x76EE;&#x6807;&#xFF1A;&#x4F7F;&#x7528;synchronized&#x7533;&#x8BF7;&#x5BF9;&#x8C61;&#x9501;&#x6210;&#x529F;,&#x76D1;&#x89C6;&#x5668;&#x7684;&#x62E5;&#x6709;&#x8005;&#x3002;</span><br><span class="line"></span><br><span class="line">waiting <span class="keyword">to</span> lock <span class="variable">&lt;&#x5730;&#x5740;&gt;</span> &#x76EE;&#x6807;&#xFF1A;&#x4F7F;&#x7528;synchronized&#x7533;&#x8BF7;&#x5BF9;&#x8C61;&#x9501;&#x672A;&#x6210;&#x529F;,&#x5728;&#x8FDB;&#x5165;&#x533A;&#x7B49;&#x5F85;&#x3002;</span><br><span class="line"></span><br><span class="line">waiting <span class="keyword">on</span> <span class="variable">&lt;&#x5730;&#x5740;&gt;</span> &#x76EE;&#x6807;&#xFF1A;&#x4F7F;&#x7528;synchronized&#x7533;&#x8BF7;&#x5BF9;&#x8C61;&#x9501;&#x6210;&#x529F;&#x540E;,&#x91CA;&#x653E;&#x9501;&#x5E75;&#x5728;&#x7B49;&#x5F85;&#x533A;&#x7B49;&#x5F85;&#x3002;</span><br></pre></td></tr></table></figure></p>
<p><strong>&#x5F00;&#x53D1;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x7ECF;&#x5E38;&#x4F1A;&#x9047;&#x5230;&#x7EBF;&#x7A0B;&#x72B6;&#x6001;,&#x7EBF;&#x7A0B;&#x72B6;&#x6001;&#x6709;&#x5982;&#x4E0B;&#x51E0;&#x79CD;</strong>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">runnable:&#x72B6;&#x6001;&#x4E00;&#x822C;&#x4E3A;RUNNABLE&#x3002;</span><br><span class="line"></span><br><span class="line">in<span class="function"> Object.wait(</span><span class="function">)</span>:&#x7B49;&#x5F85;&#x533A;&#x7B49;&#x5F85;,&#x72B6;&#x6001;&#x4E3A;WAITING&#x6216;TIMED_WAITING&#x3002;</span><br><span class="line"></span><br><span class="line">waiting for<span class="instruction"> monitor </span>entry:&#x8FDB;&#x5165;&#x533A;&#x7B49;&#x5F85;,&#x72B6;&#x6001;&#x4E3A;BLOCKED&#x3002;</span><br><span class="line"></span><br><span class="line">waiting on condition:&#x7B49;&#x5F85;&#x533A;&#x7B49;&#x5F85;&#x3001;&#x88AB;park&#x3002;</span><br><span class="line"></span><br><span class="line">sleeping:&#x4F11;&#x7720;&#x7684;&#x7EBF;&#x7A0B;,&#x8C03;&#x7528;&#x4E86;Thread.sleep(<span class="function">)</span>&#x3002;</span><br></pre></td></tr></table></figure></p>
<p><strong>&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x51E0;&#x70B9;:</strong></p>
<ul>
<li>IO&#x64CD;&#x4F5C;&#x662F;&#x53EF;&#x4EE5;&#x4EE5;RUNNABLE&#x72B6;&#x6001;&#x8FBE;&#x6210;&#x963B;&#x585E;&#x3002;&#x4F8B;&#x5982;:&#x6570;&#x636E;&#x5E93;&#x6B7B;&#x9501;&#x3001;&#x7F51;&#x7EDC;&#x8BFB;&#x5199;&#x3002; &#x683C;&#x5916;&#x6CE8;&#x610F;&#x5BF9;IO&#x7EBF;&#x7A0B;&#x7684;&#x771F;&#x5B9E;&#x72B6;&#x6001;&#x7684;&#x5206;&#x6790;&#x3002; &#x4E00;&#x822C;&#x6765;&#x8BF4;,&#x88AB;&#x6355;&#x6349;&#x5230;RUNNABLE&#x7684;IO&#x8C03;&#x7528;,&#x90FD;&#x662F;&#x6709;&#x95EE;&#x9898;&#x7684;&#x3002;</li>
<li>wait on monitor entry&#xFF1A; &#x88AB;&#x963B;&#x585E;&#x7684;,&#x80AF;&#x5B9A;&#x6709;&#x95EE;&#x9898;</li>
<li>in Object.wait()&#xFF1A; &#x6CE8;&#x610F;&#x975E;&#x7EBF;&#x7A0B;&#x6C60;&#x7B49;&#x5F85;</li>
</ul>
<h4 id="2-&#x67E5;&#x770B;java&#x5806;&#x5185;&#x5B58;&#x7684;&#x7EC6;&#x8282;">2. &#x67E5;&#x770B;java&#x5806;&#x5185;&#x5B58;&#x7684;&#x7EC6;&#x8282;</h4>
<ol>
<li>&#x67E5;&#x770B;&#x5BF9;&#x5185;&#x5B58;&#x4F7F;&#x7528;&#x60C5;&#x51B5;</li>
</ol>
<p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">jmap</span> -heap pid</span><br></pre></td></tr></table></figure></p>
<ol start="2">
<li>&#x67E5;&#x770B;&#x5806;&#x5185;&#x5B58;&#x5BF9;&#x8C61;&#x7684;&#x6570;&#x91CF;&#x4EE5;&#x53CA;&#x5927;&#x5C0F;</li>
</ol>
<p><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">jmap -histo <span class="keyword">pid</span></span><br><span class="line">jmap -histo:live <span class="keyword">pid</span>   &#x67E5;&#x770B;&#x5B58;&#x6D3B;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x6570;&#x91CF;&#x4EE5;&#x53CA;&#x5927;&#x5C0F;,&#x4F1A;&#x5148;&#x8FDB;&#x884C;&#x4E00;&#x6B21;full gc</span><br></pre></td></tr></table></figure></p>
<ol start="3">
<li>&#x5C06;&#x5185;&#x5B58;&#x7684;&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;&#x8F93;&#x51FA;&#x5230;&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x5206;&#x6790;</li>
</ol>
<p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jmap -dump:<span class="keyword">format</span>=b,<span class="keyword">file</span>=heapDump  &#x5C06;&#x5185;&#x5B58;&#x4F7F;&#x7528;&#x7684;&#x8BE6;&#x7EC6;&#x60C5;&#x51B5;&#x8F93;&#x51FA;&#x5230;&#x6587;&#x4EF6;&#xFF0C;&#x540E;&#x671F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<span class="keyword">mat</span>&#x5206;&#x6790;</span><br></pre></td></tr></table></figure></p>
<ol start="4">
<li>&#x76D1;&#x63A7;java&#x8FD0;&#x884C;&#x72B6;&#x6001;&#x4FE1;&#x606F;</li>
</ol>
<p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jstat -gcutil <span class="number">250</span> <span class="number">5</span>   &#x7EDF;&#x8BA1;gc&#x4FE1;&#x606F;&#xFF0C;&#x6BCF;<span class="number">250</span>ms&#x7EDF;&#x8BA1;&#x4E00;&#x6B21;,&#x603B;&#x5171;&#x7EDF;&#x8BA1;<span class="number">5</span>&#x6B21;</span><br></pre></td></tr></table></figure></p>
<h3 id="2-linux&#x547D;&#x4EE4;&#x7684;&#x4F7F;&#x7528;">2. Linux&#x547D;&#x4EE4;&#x7684;&#x4F7F;&#x7528;</h3>
<p>&#x5927;&#x591A;&#x6570;&#x7684;Java&#x5E94;&#x7528;&#x90FD;&#x8FD0;&#x884C;&#x5728;Linux&#x4E0B;,&#x6240;&#x4EE5;&#x5728;&#x5F88;&#x591A;&#x65F6;&#x5019;&#x5206;&#x6790;Java&#x95EE;&#x9898;&#x7684;&#x65F6;&#x5019;&#x514D;&#x4E0D;&#x4E86;&#x4F7F;&#x7528;Linux&#x5E2E;&#x52A9;&#x8F85;&#x52A9;&#x5206;&#x6790;&#xFF0C;&#x8FD9;&#x91CC;&#x7ED9;&#x51FA;&#x51E0;&#x4E2A;&#x5E38;&#x7528;&#x7684;Linux&#x547D;&#x4EE4;&#x4ECB;&#x7ECD;</p>
<h4 id="1-vi&#x547D;&#x4EE4;">1. vi&#x547D;&#x4EE4;</h4>
<p>&#x7ECF;&#x5E38;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;vi&#x5C31;&#x6D3E;&#x7684;&#x4E0A;&#x7528;&#x573A;&#x4E86;&#xFF0C;&#x4F46;&#x662F;vi&#x547D;&#x4EE4;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x592A;&#x591A;&#x4E86;&#xFF0C;&#x4E5F;&#x8BB0;&#x4E0D;&#x4F4F;&#xFF0C;&#x6211;&#x4E00;&#x76F4;&#x90FD;&#x662F;&#x9700;&#x8981;&#x7528;&#x7684;&#x65F6;&#x5019;&#x518D;&#x67E5;&#xFF0C;&#x4F46;&#x662F;&#x7ECF;&#x5E38;&#x4F7F;&#x7528;&#x4E0B;&#x6765;&#x53D1;&#x73B0;&#x5176;&#x5B9E;&#x5E38;&#x7528;&#x7684;&#x4E5F;&#x5C31;&#x90A3;&#x4E48;&#x51E0;&#x79CD;&#x3002;</p>
<ol>
<li>
<p>vi&#x57FA;&#x672C;&#x5206;&#x4E3A;&#x4E00;&#x822C;&#x6A21;&#x5F0F;&#x3001;&#x7F16;&#x8F91;&#x6A21;&#x5F0F;&#x4E0E;&#x547D;&#x4EE4;&#x884C;&#x6A21;&#x5F0F;</p>
<ul>
<li>&#x4E00;&#x822C;&#x6253;&#x5F00;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x5C31;&#x662F;&#x4E00;&#x822C;&#x6A21;&#x5F0F;</li>
<li>&#x5728;&#x4E00;&#x822C;&#x6A21;&#x5F0F;&#x4E2D;,&#x6309;&#x4E0B;&#x201C;i,I,o,O,A,a,r,R&quot;&#x7B49;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x5B57;&#x6BCD;&#x8FDB;&#x5165;&#x7F16;&#x8F91;&#x6A21;&#x5F0F;,&#x6309;&#x4E0B;ESC&#x9000;&#x51FA;&#x5230;&#x7F16;&#x8F91;&#x6A21;&#x5F0F;&#x8FDB;&#x5165;&#x4E00;&#x822C;&#x6A21;&#x5F0F;</li>
<li>&#x5728;&#x4E00;&#x822C;&#x6A21;&#x5F0F;&#x4E2D;&#x6309;&#x4E0B;&#x201C;:&#x3001;/&#x3001;?&quot;&#x4E09;&#x4E2A;&#x4E2D;&#x7684;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x6309;&#x94AE;,&#x5C31;&#x53EF;&#x4EE5;&#x5C06;&#x5149;&#x6807;&#x79FB;&#x52A8;&#x5230;&#x6700;&#x4E0B;&#x9762;&#x90A3;&#x4E00;&#x884C;,&#x8FDB;&#x5165;&#x547D;&#x4EE4;&#x884C;&#x6A21;&#x5F0F;</li>
</ul>
</li>
<li>
<p>&#x4E00;&#x822C;&#x6A21;&#x5F0F;&#x4E0B;&#x5E38;&#x7528;&#x6309;&#x952E;</p>
<ul>
<li>G : &#x79FB;&#x52A8;&#x5230;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x6700;&#x540E;&#x4E00;&#x884C;</li>
<li>nG : n&#x4E3A;&#x6570;&#x5B57;,&#x79FB;&#x52A8;&#x5230;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x7B2C;n&#x884C;&#x3002;&#x4F8B;&#x5982;20G&#x5219;&#x4F1A;&#x79FB;&#x52A8;&#x5230;&#x7B2C;20&#x884C;(&#x53EF;&#x4EE5;&#x914D;&#x5408;:set nu)</li>
<li>/word : &#x5411;&#x4E0B;&#x5BFB;&#x627E;&#x4E00;&#x4E2A;&#x540D;&#x79F0;&#x4E3A;word&#x7684;&#x5B57;&#x7B26;&#x4E32;,&#x4F8B;&#x5982;&#x4F60;&#x8981;&#x5728;&#x6587;&#x4EF6;&#x4E2D;&#x67E5;&#x627E;config&#x8FD9;&#x4E2A;&#x5355;&#x8BCD;&#x5C31;&#x8F93;&#x5165;/config</li>
<li>?word : &#x5411;&#x4E0A;&#x5BFB;&#x627E;&#x4E00;&#x4E2A;&#x540D;&#x79F0;&#x4E3A;Word&#x7684;&#x5B57;&#x7B26;&#x4E32;</li>
<li>n : &#x8FD9;&#x4E2A;n&#x662F;&#x82F1;&#x6587;&#x6309;&#x952E;,&#x4EE3;&#x8868;&#x91CD;&#x590D;&#x524D;&#x4E00;&#x4E2A;&#x67E5;&#x627E;&#x7684;&#x64CD;&#x4F5C;</li>
<li>N : &#x8FD9;&#x4E2A;N&#x662F;&#x82F1;&#x6587;&#x6309;&#x94AE;,&#x4EE3;&#x8868;&#x53CD;&#x5411;&#x8FDB;&#x884C;&#x524D;&#x4E00;&#x4E2A;&#x67E5;&#x627E;&#x7684;&#x64CD;&#x4F5C;</li>
<li>:n1,n2s/word1/word2/g : n1&#x4E0E;n2&#x4E3A;&#x6570;&#x5B57;,&#x4EE3;&#x8868;&#x5728;n1&#x4E0E;n2&#x884C;&#x4E4B;&#x95F4;&#x67E5;&#x627E;word1&#x8FD9;&#x4E2A;&#x4E32;,&#x7136;&#x540E;&#x66FF;&#x6362;&#x6210;n2&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;</li>
<li>dd : &#x5220;&#x9664;&#x5149;&#x6807;&#x6240;&#x5728;&#x7684;&#x90A3;&#x4E00;&#x6574;&#x884C;</li>
<li>yy : &#x590D;&#x5236;&#x5149;&#x6807;&#x6240;&#x5728;&#x7684;&#x90A3;&#x4E00;&#x884C;</li>
<li>p,P : p&#x4E3A;&#x5C06;&#x4EE5;&#x590D;&#x5236;&#x7684;&#x6570;&#x636E;&#x5728;&#x5149;&#x6807;&#x4E0B;&#x4E00;&#x884C;&#x7C98;&#x8D34;,P&#x5219;&#x4E3A;&#x5728;&#x4E0A;&#x4E00;&#x884C;&#x7C98;&#x8D34;</li>
</ul>
</li>
<li>
<p>&#x4E00;&#x822C;&#x6A21;&#x5F0F;&#x5207;&#x6362;&#x5230;&#x547D;&#x4EE4;&#x884C;&#x6A21;&#x5F0F;&#x7684;&#x53EF;&#x7528;&#x6309;&#x94AE;</p>
<ul>
<li>:q! : &#x4FEE;&#x6539;&#x8FC7;&#x4E0D;&#x4FDD;&#x5B58;&#x76F4;&#x63A5;&#x79BB;&#x5F00;,!&#x8868;&#x793A;&#x5F3A;&#x5236;</li>
<li>:wq : &#x4FDD;&#x5B58;&#x540E;&#x79BB;&#x5F00;,&#x4E5F;&#x53EF;&#x4EE5;&#x7528;:wq!</li>
<li>ZZ : &#x5927;&#x5199;&#x7684;Z,&#x5982;&#x679C;&#x6CA1;&#x6709;&#x6539;&#x52A8;&#x5219;&#x4E0D;&#x4FDD;&#x5B58;&#x79BB;&#x5F00;,&#x82E5;&#x5DF2;&#x7ECF;&#x6539;&#x52A8;&#x8FC7;,&#x5219;&#x4FDD;&#x5B58;&#x540E;&#x79BB;&#x5F00;</li>
<li>:w[filename] : &#x5C06;&#x7F16;&#x8F91;&#x7684;&#x6570;&#x636E;&#x4FDD;&#x5B58;&#x6210;&#x53E6;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;</li>
<li>:set nu : &#x663E;&#x793A;&#x884C;&#x53F7;</li>
<li>: set nonu : &#x53D6;&#x6D88;&#x884C;&#x53F7;</li>
</ul>
</li>
</ol>
<h4 id="2-&#x6587;&#x4EF6;&#x64CD;&#x4F5C;&#x76F8;&#x5173;&#x547D;&#x4EE4;">2. &#x6587;&#x4EF6;&#x64CD;&#x4F5C;&#x76F8;&#x5173;&#x547D;&#x4EE4;</h4>
<p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. ls <span class="operator">-a</span> : &#x5168;&#x90E8;&#x7684;&#x6587;&#x4EF6;,&#x8FDE;&#x540C;&#x9690;&#x85CF;&#x6587;&#x4EF6;(&#x5F00;&#x5934;&#x4E3A;.&#x7684;&#x6587;&#x4EF6;)</span><br><span class="line"><span class="number">2</span>. cp <span class="operator">-a</span> <span class="built_in">source</span> destination &#x6216;&#x8005;   cp [&#x53C2;&#x6570;] <span class="built_in">source</span>1 <span class="built_in">source</span>2 <span class="built_in">source</span>3 ... directory    &#x8BF4;&#x660E;: <span class="operator">-a</span>&#x7684;&#x610F;&#x601D;&#x662F;&#x548C;&#x590D;&#x5236;&#x4E4B;&#x524D;&#x7684;&#x6587;&#x4EF6;&#x5C5E;&#x6027;&#x4E00;&#x6A21;&#x4E00;&#x6837;</span><br><span class="line"><span class="number">3</span>. rm <span class="operator">-f</span> &#xFF1A; &#x5F3A;&#x5236;&#x5220;&#x9664;&#x6587;&#x4EF6;&#xFF0C;&#x5FFD;&#x7565;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x6587;&#x4EF6;</span><br><span class="line"><span class="number">4</span>. rm -r : &#x9012;&#x5F52;&#x5220;&#x9664;,&#x5E38;&#x7528;&#x4E8E;&#x76EE;&#x5F55;&#x7684;&#x5220;&#x9664;,&#x975E;&#x5E38;&#x5371;&#x9669;&#x53C2;&#x6570;</span><br><span class="line"><span class="number">5</span>. mv [-fiu] <span class="built_in">source</span> destination &#x6216;&#x8005;      mv [&#x53C2;&#x6570;] <span class="built_in">source</span>1 <span class="built_in">source</span>2 <span class="built_in">source</span>3 ... directory</span><br><span class="line">	<span class="operator">-f</span>:&#x8868;&#x793A;&#x5F3A;&#x5236;&#xFF0C;&#x5982;&#x679C;&#x5B58;&#x5728;&#x5219;&#x76F4;&#x63A5;&#x8986;&#x76D6;</span><br><span class="line">	-i:&#x5982;&#x679C;&#x5DF2;&#x7ECF;&#x5B58;&#x5728;&#x5C31;&#x4F1A;&#x8BE2;&#x95EE;</span><br><span class="line">	-u:&#x5982;&#x679C;&#x5DF2;&#x7ECF;&#x5B58;&#x5728;&#xFF0C;&#x4E14;<span class="built_in">source</span>&#x6BD4;&#x8F83;&#x65B0;,&#x624D;&#x4F1A;&#x66F4;&#x65B0;</span><br><span class="line"></span><br><span class="line"><span class="number">6</span>. cat -n fileName : &#x663E;&#x793A;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#xFF0C;&#x5E76;&#x663E;&#x793A;&#x884C;&#x53F7;</span><br><span class="line"><span class="number">7</span>. tail [-n number] fileName : &#x663E;&#x793A;&#x6587;&#x4EF6;&#x7ED3;&#x5C3E;n&#x884C;&#x5185;&#x5BB9;&#xFF0C;&#x6BD4;&#x5982;tail -<span class="number">20</span> mylog.log</span><br><span class="line"><span class="number">8</span>. tial <span class="operator">-f</span> core.log    &#x663E;&#x793A;&#x6587;&#x4EF6;&#x6700;&#x65B0;<span class="number">10</span>&#x884C;&#x5185;&#x5BB9;&#xFF0C;&#x4F1A;&#x81EA;&#x52A8;&#x66F4;&#x65B0;</span><br><span class="line"><span class="number">9</span>. find /usr -name fileName   &#x67E5;&#x627E;usr&#x76EE;&#x5F55;&#x4E0B;&#x6587;&#x4EF6;&#x540D;&#x4E3A;fileName&#x7684;&#x6587;&#x4EF6;&#xFF0C;fileName&#x652F;&#x6301;&#x6B63;&#x5219;,&#x6BD4;&#x5982;*.js</span><br><span class="line"><span class="number">10</span>. ls <span class="operator">-l</span> | grep file.txt   &#x5217;&#x51FA;file.txt&#x7684;&#x6587;&#x4EF6;&#x4FE1;&#x606F;&#xFF0C;grep&#x540E;&#x53EF;&#x4EE5;&#x8DDF;&#x9707;&#x6CFD;&#x8868;&#x8FBE;&#x5F0F;</span><br><span class="line"><span class="number">11</span>. tar -czf test.tar.gz /<span class="built_in">test</span>1 /<span class="built_in">test</span>2   &#x538B;&#x7F29;&#x6587;&#x4EF6;</span><br><span class="line"><span class="number">12</span>. tar -xvzf test.tar.gz  &#x89E3;&#x538B;&#x6587;&#x4EF6;</span><br></pre></td></tr></table></figure></p>
<h4 id="3-&#x7CFB;&#x7EDF;&#x72B6;&#x6001;&#x76F8;&#x5173;&#x547D;&#x4EE4;">3. &#x7CFB;&#x7EDF;&#x72B6;&#x6001;&#x76F8;&#x5173;&#x547D;&#x4EE4;</h4>
<p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> ps -aux | grep java &#x67E5;&#x770B;java&#x8FDB;&#x7A0B;</span><br><span class="line"><span class="number">2.</span> top</span><br><span class="line">	&#x6309;&#x4E0B;&#x6570;&#x5B57;<span class="number">1</span>&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x6BCF;&#x4E2A;&#x903B;&#x8F91;CPU&#x7684;&#x72B6;&#x6001;</span><br><span class="line">	top -d <span class="number">2</span> -n <span class="number">3</span>  &#x6BCF;<span class="number">2</span>s&#x66F4;&#x65B0;&#x4E00;&#x6B21;&#x72B6;&#x6001;&#xFF0C;&#x603B;&#x5171;&#x66F4;&#x65B0;<span class="number">3</span>&#x6B21;</span><br><span class="line">	top -p <span class="number">574</span>   &#x663E;&#x793A;&#x6307;&#x5B9A;&#x7684;&#x8FDB;&#x7A0B;&#x4FE1;&#x606F;</span><br><span class="line">	%wa &#x8868;&#x793A;I/Owait&#x5360;&#x7528;&#x7684;CPU&#x65F6;&#x95F4;&#x767E;&#x5206;&#x6BD4;,&#x901A;&#x5E38;&#x7CFB;&#x7EDF;&#x53D8;&#x6162;&#x90FD;&#x662F;I/O&#x4EA7;&#x751F;&#x7684;&#x95EE;&#x9898;&#x6BD4;&#x8F83;&#x5927;</span><br><span class="line">	swap&#x8868;&#x793A;&#x865A;&#x62DF;&#x5185;&#x5B58;&#xFF0C;&#x5982;&#x679C;&#x88AB;&#x5927;&#x91CF;&#x4F7F;&#x7528;&#x8868;&#x793A;&#x7CFB;&#x7EDF;&#x7684;&#x7269;&#x7406;&#x5185;&#x5B58;&#x5B9E;&#x5728;&#x4E0D;&#x8DB3;</span><br><span class="line">	S &#x8FDB;&#x7A0B;&#x72B6;&#x6001;&#x3002;D=&#x4E0D;&#x53EF;&#x4E2D;&#x65AD;&#x7684;&#x7761;&#x7720;&#x72B6;&#x6001; R=&#x8FD0;&#x884C; S=&#x7761;&#x7720; T=&#x8DDF;&#x8E2A;/&#x505C;&#x6B62; Z=&#x50F5;&#x5C38;&#x8FDB;&#x7A0B;</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> vmstat  &#x5982;&#x679C;&#x5176;&#x4E2D;&#x7684;cs(&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x6B21;&#x6570;)&#x503C;&#x8FC7;&#x9AD8;&#xFF0C;&#x4F1A;&#x5BFC;&#x81F4;&#x7CFB;&#x7EDF;&#x8D1F;&#x8F7D;&#x8FC7;&#x9AD8;&#xFF0C;&#x6392;&#x67E5;&#x95EE;&#x9898;&#x7684;&#x65F6;&#x5019;&#x9700;&#x8981;&#x7528;&#x5230;</span><br><span class="line"><span class="number">4.</span> netstat -anp | grep <span class="number">8080</span>   &#x67E5;&#x770B;&#x7AEF;&#x53E3;&#x5360;&#x7528;&#x60C5;&#x51B5;</span><br></pre></td></tr></table></figure></p>
<h4 id="4-&#x5176;&#x4ED6;linux&#x547D;&#x4EE4;">4. &#x5176;&#x4ED6;Linux&#x547D;&#x4EE4;</h4>
<p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> echo $LANG   &#x67E5;&#x770B;&#x5F53;&#x524D;&#x7CFB;&#x7EDF;&#x7F16;&#x7801;</span><br><span class="line"><span class="number">2.</span> lsof app.js  &#x67E5;&#x770B;&#x6587;&#x4EF6;&#x88AB;&#x54EA;&#x4E2A;&#x8FDB;&#x7A0B;&#x6253;&#x5F00;&#x4E86;</span><br><span class="line"><span class="number">3.</span> lsof -i :<span class="number">8080</span> &#x67E5;&#x770B;&#x54EA;&#x4E2A;&#x7AEF;&#x53E3;&#x5C5E;&#x4E8E;&#x54EA;&#x4E2A;&#x7A0B;&#x5E8F;</span><br><span class="line"><span class="number">4.</span> lsof -p pid  &#x67E5;&#x770B;&#x67D0;&#x4E2A;&#x8FDB;&#x7A0B;&#x6253;&#x5F00;&#x4E86;&#x54EA;&#x4E9B;&#x6587;&#x4EF6;</span><br><span class="line"><span class="number">5.</span> tcpdump -s <span class="number">0</span> -i ge1 -A port <span class="number">8084</span>     &#x76D1;&#x542C;<span class="number">8084</span>&#x7AEF;&#x53E3;&#x6536;&#x5230;&#x7684;&#x6570;&#x636E;</span><br><span class="line"><span class="number">6.</span> lsof | wc -l     &#x67E5;&#x770B;&#x8FDB;&#x7A0B;&#x6253;&#x5F00;&#x4E2A;&#x591A;&#x5C11;&#x4E2A;&#x6587;&#x4EF6;</span><br><span class="line"><span class="number">7.</span> lsof -p pid |wc -l    &#x67E5;&#x770B;&#x67D0;&#x4E2A;&#x8FDB;&#x7A0B;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x6570;</span><br></pre></td></tr></table></figure></p>
<h3 id="&#x53C2;&#x8003;&#x6587;&#x6863;">&#x53C2;&#x8003;&#x6587;&#x6863;</h3>
<p><a href="http://www.hollischuang.com/archives/110" target="_blank" rel="external">jstack&#x7684;&#x4F7F;&#x7528;</a></p>
]]></content>
    <summary type="html">
    <![CDATA[在开发过程中，遇到一些问题常常需要在Linux下进行定位分析，查看日志、分析堆栈情况、分析网络状况等，但是Linux系统下命令不胜繁多，这里总结了写自己在开发过程中常用的命令。]]>
    
    </summary>
    
      <category term="Java开发常用命令" scheme="http://yoursite.com/tags/Java%E5%BC%80%E5%8F%91%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
    
      <category term="Linux命令" scheme="http://yoursite.com/tags/Linux%E5%91%BD%E4%BB%A4/"/>
    
      <category term="Java开发命令" scheme="http://yoursite.com/categories/Java%E5%BC%80%E5%8F%91%E5%91%BD%E4%BB%A4/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[如何写出高效率的正则表达式]]></title>
    <link href="http://yoursite.com/2018/04/08/write-high-performance-regular-expressions/"/>
    <id>http://yoursite.com/2018/04/08/write-high-performance-regular-expressions/</id>
    <published>2018-04-08T13:01:42.000Z</published>
    <updated>2018-10-28T13:16:22.530Z</updated>
    <content type="html"><![CDATA[<h3 id="&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x5F15;&#x64CE;dfanfa">&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x5F15;&#x64CE;(DFA/NFA)</h3>
<p>NFA &#x662F;&#x4E0D;&#x786E;&#x5B9A;&#x7684;&#x6709;&#x9650;&#x81EA;&#x52A8;&#x673A;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x5728;&#x72B6;&#x6001;&#x7684;&#x8FC1;&#x79FB;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x4E0B;&#x4E00;&#x4E2A;&#x72B6;&#x6001;&#x53EF;&#x80FD;&#x6709;&#x597D;&#x51E0;&#x79CD;&#x53EF;&#x80FD;&#xFF0C;&#x800C;&#x5BF9;&#x4E8E; DFA &#x786E;&#x5B9A;&#x6709;&#x9650;&#x81EA;&#x52A8;&#x673A;&#x800C;&#x8A00;&#xFF0C;&#x4E0B;&#x4E00;&#x4E2A;&#x72B6;&#x6001;&#x53EA;&#x6709;&#x4E00;&#x79CD;&#x53EF;&#x80FD;&#x3002;
DFA&#x5F15;&#x64CE;&#x56E0;&#x4E3A;&#x4E0D;&#x9700;&#x8981;&#x56DE;&#x6EAF;&#xFF0C;&#x6240;&#x4EE5;&#x5339;&#x914D;&#x5FEB;&#x901F;&#xFF0C;&#x4F46;&#x4E0D;&#x652F;&#x6301;&#x6355;&#x83B7;&#x7EC4;&#xFF0C;&#x6240;&#x4EE5;&#x4E5F;&#x5C31;&#x4E0D;&#x652F;&#x6301;&#x53CD;&#x5411;&#x5F15;&#x7528;&#x548C;$number&#x8FD9;&#x79CD;&#x5F15;&#x7528;&#x65B9;&#x5F0F;&#xFF0C;&#x76EE;&#x524D;&#x4F7F;&#x7528;DFA&#x5F15;&#x64CE;&#x7684;&#x8BED;&#x8A00;&#x548C;&#x5DE5;&#x5177;&#x4E3B;&#x8981;&#x6709;awk&#x3001;egrep &#x548C; lex&#x3002;
&#x800C;NFA&#x53C8;&#x57FA;&#x672C;&#x4E0A;&#x53EF;&#x4EE5;&#x5206;&#x4E3A;&#x4F20;&#x7EDF;&#x578B;NFA&#x548C;POSIX NFA&#xFF0C;
POSIX NFA&#x4E3B;&#x8981;&#x6307;&#x7B26;&#x5408;POSIX&#x6807;&#x51C6;&#x7684;NFA&#x5F15;&#x64CE;&#xFF0C;&#x5B83;&#x7684;&#x7279;&#x70B9;&#x4E3B;&#x8981;&#x662F;&#x63D0;&#x4F9B;longest-leftmost&#x5339;&#x914D;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x5728;&#x627E;&#x5230;&#x6700;&#x5DE6;&#x4FA7;&#x6700;&#x957F;&#x5339;&#x914D;&#x4E4B;&#x524D;&#xFF0C;&#x5B83;&#x5C06;&#x7EE7;&#x7EED;&#x56DE;&#x6EAF;&#x3002;&#x540C;DFA&#x4E00;&#x6837;&#xFF0C;&#x975E;&#x8D2A;&#x5A6A;&#x6A21;&#x5F0F;&#x6216;&#x8005;&#x8BF4;&#x5FFD;&#x7565;&#x4F18;&#x5148;&#x91CF;&#x8BCD;&#x5BF9;&#x4E8E;POSIX NFA&#x540C;&#x6837;&#x662F;&#x6CA1;&#x6709;&#x610F;&#x4E49;&#x7684;&#x3002;</p>
<p><strong>Java&#x4F7F;&#x7528;&#x7684;&#x662F;&#x4F20;&#x7EDF;&#x578B;NFA&#x5F15;&#x64CE;</strong>,&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x63A5;&#x4E0B;&#x6765;&#x8BA8;&#x8BBA;&#x7684;&#x5185;&#x5BB9;&#x4E5F;&#x662F;&#x57FA;&#x4E8E;&#x4F20;&#x7EDF;&#x578B;NFA&#x5F15;&#x64CE;&#x7684;</p>
<h3 id="&#x6548;&#x7387;&#x95EE;&#x9898;">&#x6548;&#x7387;&#x95EE;&#x9898;</h3>
<p>&#x56E0;&#x4E3A; DFA &#x5728;&#x5339;&#x914D;&#x8FC7;&#x7A0B;&#x4E2D;&#x662F;&#x8DDF;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x65E0;&#x5173;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x63A5;&#x4E0B;&#x6765;&#x6548;&#x7387;&#x63D0;&#x5347;&#x65B9;&#x9762;&#x7684;&#x8BA8;&#x8BBA;&#x53EA;&#x9488;&#x5BF9; NFA&#x3002;
&#x5339;&#x914D;&#x5931;&#x8D25;&#x53D1;&#x751F;&#x56DE;&#x6714;&#x7684;&#x6B21;&#x6570;&#x662F;&#x4E00;&#x4E2A;&#x6307;&#x6807;&#xFF0C;&#x800C;&#x4E3A;&#x4EC0;&#x4E48;&#x4F1A;&#x53D1;&#x751F;&#x56DE;&#x6714;&#x5462;?
&#x56E0;&#x4E3A;&#x57FA;&#x672C;&#x7684;&#x5143;&#x5B57;&#x7B26;&#x662F;&#x8D2A;&#x5A6A;&#x7684; (*, +)&#xFF0C;&#x56E0;&#x4E3A;&#x6709;&#x9009;&#x62E9;&#x6027;&#x7684;&#x5339;&#x914D; (|), &#x4E8E;&#x662F;&#x5728;&#x5339;&#x914D;&#x8FC7;&#x7A0B;&#x4E2D;&#x6BCF;&#x4E00;&#x6B21;&#x8FD9;&#x6837;&#x7684;&#x9009;&#x62E9;&#xFF0C;&#x90FD;&#x4F1A;&#x8BB0;&#x5F55;&#x4E00;&#x4E2A;&#x56DE;&#x6714;&#x70B9;&#xFF0C;&#x5728;&#x5339;&#x914D;&#x5931;&#x8D25;&#x65F6;&#xFF0C;&#x5C31;&#x4F1A;&#x56DE;&#x6714;&#x5230;&#x4E4B;&#x524D;&#x4E00;&#x4E2A;&#x56DE;&#x6714;&#x70B9;&#xFF0C;&#x7EE7;&#x7EED;&#x5339;&#x914D;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x7C7B;&#x4F3C;&#x4E8E;&#x6808;&#x7684;&#x673A;&#x5236;&#xFF0C;&#x540E;&#x8FDB;&#x5148;&#x51FA;&#x3002;</p>
<h3 id="&#x5B66;&#x4F1A;&#x4F7F;&#x7528;&#x5DE5;&#x5177;">&#x5B66;&#x4F1A;&#x4F7F;&#x7528;&#x5DE5;&#x5177;</h3>
<p>&#x5728;&#x8FD9;&#x91CC;&#x5B89;&#x5229;&#x4E00;&#x4E2A;RegexBuddy&#x5DE5;&#x5177;&#xFF0C;&#x4F7F;&#x7528;&#x5B83;&#x53EF;&#x4EE5;&#x5F88;&#x7B80;&#x5355;&#x7684;&#x5728;&#x5404;&#x79CD;&#x8BED;&#x8A00;&#x73AF;&#x5883;&#x4E0B;&#x6D4B;&#x8BD5;&#x3001;&#x4F7F;&#x7528;&#x3001;debug&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x4E0D;&#x8981;&#x4F7F;&#x7528;&#x7F51;&#x9875;&#x7248;&#x672C;&#x7684;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x5339;&#x914D;&#x5DE5;&#x5177;&#xFF0C;&#x90A3;&#x4E9B;&#x5927;&#x591A;&#x6570;&#x662F;&#x5339;&#x914D;js&#x7684;&#xFF0C;&#x6709;&#x4E9B;&#x751A;&#x81F3;&#x8FDE;js&#x90FD;&#x5339;&#x914D;&#x4E0D;&#x51C6;&#x786E;&#x3002;</p>
<h3 id="&#x5F00;&#x59CB;&#x4F18;&#x5316;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;">&#x5F00;&#x59CB;&#x4F18;&#x5316;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;</h3>
<h4 id="&#x4F7F;&#x7528;&#x5B57;&#x7B26;&#x7EC4;&#x4EE3;&#x66FF;&#x5206;&#x652F;&#x6761;&#x4EF6;">&#x4F7F;&#x7528;&#x5B57;&#x7B26;&#x7EC4;&#x4EE3;&#x66FF;&#x5206;&#x652F;&#x6761;&#x4EF6;</h4>
<p>&#x5339;&#x914D;abcd&#x5B57;&#x7B26;&#x8BF7;&#x4F7F;&#x7528;[a-d]&#x800C;&#x4E0D;&#x662F;&#x4F7F;&#x7528;a|b|c|d,&#x524D;&#x8005;&#x5339;&#x914D;&#x4E00;&#x6B21;&#x5373;&#x53EF;&#x5339;&#x914D;&#x9700;&#x8981;&#x7684;&#x5B57;&#x7B26;&#xFF0C;&#x800C;&#x540E;&#x8005;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x5339;&#x914D;&#x56DB;&#x6B21;(&#x56E0;&#x4E3A;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x56DE;&#x6EAF;)</p>
<h3 id="&#x5C3D;&#x91CF;&#x4F7F;&#x7528;&#x951A;&#x70B9;&#x4F18;&#x5316;&#x6216;&#x8005;">&#x5C3D;&#x91CF;&#x4F7F;&#x7528;&#x951A;&#x70B9;&#x4F18;&#x5316;(^&#x6216;&#x8005;$)</h3>
<p>&#x5982;&#x679C;&#x77E5;&#x9053;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x5F00;&#x5934;&#x662F;&#x4EC0;&#x4E48;&#xFF0C;&#x5C3D;&#x91CF;&#x4F7F;&#x7528;^,&#x5982;&#x679C;&#x77E5;&#x9053;&#x7ED3;&#x5C3E;&#x662F;&#x4EC0;&#x4E48;&#x5C3D;&#x91CF;&#x4F7F;&#x7528;$,&#x5B83;&#x53EF;&#x4EE5;&#x4ECE;&#x5B57;&#x7B26;&#x4E32;&#x672B;&#x5C3E;&#x5012;&#x6570;&#x5982;&#x5E72;&#x4E2A;&#x5B57;&#x7B26;&#x5F00;&#x59CB;&#x8FDB;&#x884C;&#x5339;&#x914D;&#xFF0C;&#x6BD4;&#x5982;regex$&#x53EA;&#x53EF;&#x80FD;&#x4ECE;&#x5B57;&#x7B26;&#x4E32;&#x9ED8;&#x8BA4;&#x5012;&#x6570;&#x7684;&#x7B2C;&#x4E94;&#x4E2A;&#x5B57;&#x7B26;&#x5F00;&#x59CB;&#x5339;&#x914D;&#xFF0C;&#x8FD9;&#x6837;&#x53EF;&#x4EE5;&#x7565;&#x8FC7;&#x5F88;&#x591A;&#x5B57;&#x7B26;&#xFF0C;&#x8FBE;&#x5230;&#x4F18;&#x5316;&#x7684;&#x6548;&#x679C;&#x3002;</p>
<h3 id="&#x5C3D;&#x91CF;&#x4F7F;&#x7528;&#x957F;&#x5EA6;&#x4F18;&#x5316;">&#x5C3D;&#x91CF;&#x4F7F;&#x7528;&#x957F;&#x5EA6;&#x4F18;&#x5316;</h3>
<p>&#x5982;&#x679C;&#x4F60;&#x77E5;&#x9053;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x957F;&#x5EA6;&#x4E0D;&#x64CD;&#x4F5C;&#x591A;&#x5C11;&#xFF0C;&#x6216;&#x8005;&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x662F;&#x5B9A;&#x957F;&#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x8BF7;&#x4E00;&#x5B9A;&#x52A0;&#x4E0A;&#x957F;&#x5EA6;&#x5339;&#x914D;&#xFF0C;&#x6BD4;&#x5982;\d{11}&#x5339;&#x914D;11&#x4F4D;&#x7684;&#x6570;&#x5B57;&#xFF0C;\d{4,8}&#x5339;&#x914D;4&#x5230;8&#x4F4D;&#x7684;&#x6570;&#x5B57;&#xFF0C;&#x5728;&#x5339;&#x914D;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x4E0D;&#x4F1A;&#x5339;&#x914D;&#x5C0F;&#x4E8E;4&#x4F4D;&#x7684;&#x6570;&#x5B57;&#x3002;</p>
<h3 id="&#x4F7F;&#x7528;&#x5360;&#x6709;&#x4F18;&#x5148;&#x91CF;&#x8BCD;&#x548C;&#x56FA;&#x5316;&#x5206;&#x7EC4;">&#x4F7F;&#x7528;&#x5360;&#x6709;&#x4F18;&#x5148;&#x91CF;&#x8BCD;&#x548C;&#x56FA;&#x5316;&#x5206;&#x7EC4;</h3>
<p><strong>&#x5360;&#x6709;&#x4F18;&#x5148;&#x91CF;&#x8BCD;&#xFF1A;</strong></p>
<p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?+ 	*+ 	++ 	{<span class="keyword">m</span>,<span class="keyword">n</span>}+</span><br></pre></td></tr></table></figure></p>
<p>&#x5360;&#x6709;&#x4F18;&#x5148;&#x91CF;&#x8BCD;&#x4E0E;&#x5339;&#x914D;&#x4F18;&#x5148;&#x91CF;&#x8BCD;&#x5F88;&#x76F8;&#x4F3C;,&#x53EA;&#x662F;&#x5B83;&#x4EEC;&#x4ECE;&#x6765;&#x4E0D;&#x4F1A;&#x4EA4;&#x8FD8;&#x5DF2;&#x7ECF;&#x5339;&#x914D;&#x7684;&#x5B57;&#x7B26;&#x3002;
<strong>&#x56FA;&#x5316;&#x5206;&#x7EC4;&#xFF1A;</strong></p>
<p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(?&gt;<span class="keyword">...</span>)       <span class="keyword">...</span>&#x662F;&#x6307;&#x5177;&#x4F53;&#x5185;&#x5BB9;</span><br></pre></td></tr></table></figure></p>
<p>&#x56FA;&#x5316;&#x5206;&#x7EC4;&#x7684;&#x5185;&#x5BB9;&#x4E0E;&#x6B63;&#x5E38;&#x7684;&#x5339;&#x914D;&#x5E76;&#x65E0;&#x533A;&#x522B;&#xFF0C;&#x53EA;&#x662F;&#x5F53;&#x5339;&#x914D;&#x5B8C;&#x62EC;&#x53F7;&#x4E2D;&#x7684;&#x5185;&#x5BB9;&#x540E;&#xFF0C;&#x62EC;&#x53F7;&#x4E2D;&#x7684;&#x5907;&#x7528;&#x72B6;&#x6001;&#x4F1A;&#x5168;&#x90E8;&#x820D;&#x53BB;&#x3002;</p>
<h4 id="&#x662F;&#x5426;&#x4F7F;&#x7528;&#x975E;&#x6355;&#x83B7;&#x578B;&#x62EC;&#x53F7;">&#x662F;&#x5426;&#x4F7F;&#x7528;&#x975E;&#x6355;&#x83B7;&#x578B;&#x62EC;&#x53F7;</h4>
<p>&#x5728;&#x4E0A;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x57FA;&#x672C;&#x4F7F;&#x7528;&#x4E2D;&#x6307;&#x51FA;&#x4E86;&#x4F7F;&#x7528;&#x975E;&#x6355;&#x83B7;&#x578B;&#x62EC;&#x53F7;&#x6709;&#x5229;&#x4E8E;&#x6027;&#x80FD;&#x63D0;&#x5347;&#xFF0C;&#x56E0;&#x4E3A;&#x4F60;&#x4E0D;&#x5728;&#x9700;&#x8981;&#x6355;&#x83B7;&#x6587;&#x672C;&#x7684;&#x5F00;&#x9500;,&#x4F46;&#x662F;&#x8FD9;&#x4E5F;&#x4E0D;&#x662F;&#x5FC5;&#x7136;&#x7684;&#xFF0C;&#x6BD4;&#x5982;(000|999)$&#x4F7F;&#x7528;&#x4E86;&#x975E;&#x6355;&#x83B7;&#x578B;&#x62EC;&#x53F7;&#x4E4B;&#x540E;&#x53CD;&#x800C;&#x6BD4;&#x4E4B;&#x524D;&#x8FD8;&#x53D8;&#x6162;&#x4E86;&#xFF0C;&#x90A3;&#x662F;&#x56E0;&#x4E3A;&#x975E;&#x6355;&#x83B7;&#x578B;&#x62EC;&#x53F7;&#x4E0D;&#x4F1A;&#x4F7F;&#x7528;$&#x8FD9;&#x4E2A;&#x951A;&#x7ED3;&#x5C3E;&#x4F18;&#x5316;&#xFF0C;&#x4F46;&#x662F;&#x5927;&#x591A;&#x6570;&#x65F6;&#x5019;&#x975E;&#x6355;&#x83B7;&#x578B;&#x62EC;&#x53F7;&#x90FD;&#x662F;&#x6709;&#x76CA;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x4E2A;&#x4F7F;&#x7528;&#x5C31;&#x9700;&#x8981;&#x81EA;&#x5DF1;&#x6743;&#x8861;&#x3002;</p>
<h4 id="&#x5C3D;&#x53EF;&#x80FD;&#x5C11;&#x7684;&#x7F16;&#x8BD1;">&#x5C3D;&#x53EF;&#x80FD;&#x5C11;&#x7684;&#x7F16;&#x8BD1;</h4>
<p>&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x7F16;&#x8F91;&#x4E5F;&#x662F;&#x9700;&#x8981;&#x8017;&#x8D39;&#x65F6;&#x95F4;&#x7684;&#xFF0C;&#x4E0D;&#x8981;&#x6BCF;&#x6B21;&#x5728;&#x5FAA;&#x73AF;&#x5185;&#x91CD;&#x65B0;&#x7F16;&#x8F91;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;</p>
<h4 id="&#x4E0D;&#x8981;&#x6EE5;&#x7528;&#x62EC;&#x53F7;">&#x4E0D;&#x8981;&#x6EE5;&#x7528;&#x62EC;&#x53F7;</h4>
<p>&#x53EA;&#x6709;&#x5728;&#x9700;&#x8981;&#x7684;&#x65F6;&#x5019;&#x624D;&#x4F7F;&#x7528;&#x62EC;&#x53F7;&#xFF0C;&#x8981;&#x4E0D;&#x7136;&#x62EC;&#x53F7;&#x4F1A;&#x963B;&#x6B62;&#x67D0;&#x4E9B;&#x4F18;&#x5316;&#x63AA;&#x65BD;&#xFF0C;&#x6BD4;&#x5982;.*&#x8BF7;&#x4E0D;&#x8981;&#x7528;&#x6210;(.)*</p>
<h4 id="&#x4E0D;&#x8981;&#x6EE5;&#x7528;&#x5B57;&#x7B26;&#x7EC4;">&#x4E0D;&#x8981;&#x6EE5;&#x7528;&#x5B57;&#x7B26;&#x7EC4;</h4>
<p>&#x5B57;&#x7B26;&#x7EC4;&#x4F7F;&#x7528;&#x65F6;&#x6709;&#x597D;&#x5904;&#xFF0C;&#x4F46;&#x662F;&#x4E0D;&#x8981;&#x6EE5;&#x7528;&#x5440;,&#x5E76;&#x4E0D;&#x9700;&#x8981;&#x7528;&#x5230;&#x5B57;&#x7B26;&#x7EC4;&#x63D0;&#x4F9B;&#x7684;&#x591A;&#x5B57;&#x7B26;&#x5339;&#x914D;&#x529F;&#x80FD;&#x7684;&#x65F6;&#x5019;&#x8BF7;&#x4E0D;&#x8981;&#x4F7F;&#x7528;&#x5B57;&#x7B26;&#x7EC4;</p>
<h4 id="&#x50CF;&#x5199;&#x4EE3;&#x7801;&#x4E00;&#x6837;&#x4F18;&#x5316;">&#x50CF;&#x5199;&#x4EE3;&#x7801;&#x4E00;&#x6837;&#x4F18;&#x5316;</h4>
<p>&#x8FD9;&#x4E2A;&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;&#xFF1F;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x5C3D;&#x91CF;&#x5C06;&#x5E38;&#x91CF;&#x5B57;&#x7B26;&#x4E32;&#x63D0;&#x53D6;&#x51FA;&#x6765;,&#x5C06;&#x5171;&#x540C;&#x7684;&#x90E8;&#x5206;&#x63D0;&#x53D6;&#x51FA;&#x6765;</p>
<h4 id="&#x522B;&#x5199;&#x592A;&#x957F;&#x7684;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;">&#x522B;&#x5199;&#x592A;&#x957F;&#x7684;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;</h4>
<p>&#x592A;&#x957F;&#x7684;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x6548;&#x7387;&#x4E0D;&#x4E00;&#x5B9A;&#x9AD8;&#xFF0C;&#x800C;&#x4E14;&#x540E;&#x671F;&#x4E0D;&#x597D;&#x7EF4;&#x62A4;&#xFF0C;&#x6240;&#x4EE5;&#x5C3D;&#x91CF;&#x4E0D;&#x8981;&#x5199;&#x592A;&#x957F;&#x7684;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x5C31;&#x7B97;&#x6709;&#x957F;&#x7684;&#x4E5F;&#x5C3D;&#x91CF;&#x62C6;&#x5206;&#x6210;&#x6BD4;&#x8F83;&#x77ED;&#x7684;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x80FD;&#x7528;&#x5B57;&#x7B26;&#x4E32;&#x5904;&#x7406;&#x89E3;&#x51B3;&#x7684;&#x5C31;&#x5C3D;&#x91CF;&#x4E0D;&#x7528;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x3002;</p>
<h4 id="&#x4F7F;&#x7528;&#x73AF;&#x89C6;&#x6A21;&#x62DF;&#x5F00;&#x5934;&#x7B26;&#x8BC6;&#x522B;">&#x4F7F;&#x7528;&#x73AF;&#x89C6;&#x6A21;&#x62DF;&#x5F00;&#x5934;&#x7B26;&#x8BC6;&#x522B;</h4>
<p>&#x5982;&#x679C;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x4E3A; Jan|Feb|Dec&#xFF0C; &#x5BF9;&#x5E94;&#x7684;&#x5C31;&#x662F;(?=[JFMASOND])(?:Jan|Feb|Dec)&#x3002;
&#x5F00;&#x5934;&#x7684;[JFMASOND]&#x4EE3;&#x8868;&#x4E86;&#x82F1;&#x6587;&#x4E2D;&#x6708;&#x4EFD;&#x5355;&#x8BCD;&#x53EF;&#x80FD;&#x7684;&#x5F00;&#x59CB;&#x5B57;&#x6BCD;&#x3002;</p>
<h4 id="&#x5C06;&#x5C3D;&#x53EF;&#x80FD;&#x591A;&#x7684;&#x591A;&#x9009;&#x5206;&#x652F;&#x653E;&#x5728;&#x524D;&#x9762;">&#x5C06;&#x5C3D;&#x53EF;&#x80FD;&#x591A;&#x7684;&#x591A;&#x9009;&#x5206;&#x652F;&#x653E;&#x5728;&#x524D;&#x9762;</h4>
<p>&#x591A;&#x9009;&#x5206;&#x652F;&#x4E0B;&#x5C3D;&#x53EF;&#x80FD;&#x5C06;&#x51FA;&#x73B0;&#x6982;&#x7387;&#x6BD4;&#x8F83;&#x5927;&#x7684;&#x8868;&#x8FBE;&#x5F0F;&#x653E;&#x5728;&#x524D;&#x9762;&#xFF0C;&#x6BD4;&#x5982;&#x5339;&#x914D;&#x4E3B;&#x673A;&#x540D;&#x7684;&#x8868;&#x8FBE;&#x5F0F;&#x4E2D;(?:aero|biz|com|cooph|...)&#x7684;&#x6548;&#x7387;&#x6CA1;&#x6709;(?:com|net|edu|org|...)&#x7684;&#x6548;&#x7387;&#x9AD8;</p>
<h3 id="&#x6D88;&#x9664;&#x5FAA;&#x73AF;">&#x6D88;&#x9664;&#x5FAA;&#x73AF;</h3>
<p>&#x5982;&#x679C;&#x4F60;&#x5199;&#x4E86;&#x4E00;&#x4E2A;&#x8F83;&#x590D;&#x6742;&#x7684;&#x8868;&#x8FBE;&#x5F0F;,&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x6D88;&#x9664;&#x5FAA;&#x73AF;&#x6765;&#x63D0;&#x9AD8;&#x6548;&#x7387;,&#x6D88;&#x9664;&#x5FAA;&#x73AF;&#x7684;&#x5E38;&#x7528;&#x89E3;&#x6CD5;:
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">opening normal<span class="keyword">*</span> (special normal\<span class="keyword">*</span>)<span class="keyword">*</span> closing</span><br></pre></td></tr></table></figure></p>
<p>&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x51E0;&#x70B9;
** 1. special &#x90E8;&#x5206;&#x548C;normal&#x90E8;&#x5206;&#x5339;&#x914D;&#x7684;&#x5F00;&#x5934;&#x4E0D;&#x80FD;&#x91CD;&#x5408; **
** 2. normal &#x90E8;&#x5206;&#x5FC5;&#x987B;&#x5339;&#x914D;&#x81F3;&#x5C11;&#x4E00;&#x4E2A;&#x5B57;&#x7B26; **
** 3. special&#x90E8;&#x5206;&#x5FC5;&#x987B;&#x662F;&#x56FA;&#x8BDD;&#x7684;,&#x90E8;&#x5206;&#x5339;&#x914D;&#x7684;&#x6587;&#x672C;&#x4E0D;&#x80FD;&#x7531;&#x8BE5;&#x90E8;&#x5206;&#x7684;&#x591A;&#x6B21;&#x8FED;&#x4EE3;&#x5B8C;&#x6210;,&#x6BD4;&#x5982;(abc*)<em>&#x91CD;&#x8981;&#x6BD4;.*&#x597D;&#x4E00;&#x4E9B;&#x3002;</em>*</p>
<h3 id="&#x662F;&#x5426;&#x5FC5;&#x987B;&#x4F7F;&#x7528;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;">&#x662F;&#x5426;&#x5FC5;&#x987B;&#x4F7F;&#x7528;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;?</h3>
<p>&#x6709;&#x65F6;&#x5019;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x786E;&#x5B9E;&#x80FD;&#x4E3A;&#x6211;&#x4EEC;&#x5E26;&#x6765;&#x4FBF;&#x6377;&#xFF0C;&#x4F46;&#x662F;&#x6EE5;&#x7528;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x540E;&#x679C;&#x540C;&#x6837;&#x662F;&#x975E;&#x5E38;&#x4E25;&#x91CD;&#x7684;,&#x53EF;&#x80FD;&#x4F1A;&#x5BFC;&#x81F4;&#x6B7B;&#x5FAA;&#x73AF;&#xFF0C;&#x8BA9;&#x4F60;&#x7A0B;&#x5E8F;&#x7684;&#x6548;&#x7387;&#x663E;&#x8457;&#x7684;&#x4E0B;&#x964D;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x80FD;&#x7528;&#x5B57;&#x7B26;&#x4E32;&#x89E3;&#x51B3;&#x7684;&#x95EE;&#x9898;&#x5C3D;&#x91CF;&#x4E0D;&#x4F7F;&#x7528;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x5982;&#x679C;&#x4F7F;&#x7528;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x8BF7;&#x5C3D;&#x91CF;&#x591A;&#x6D4B;&#x8BD5;&#xFF0C;&#x5199;&#x51FA;&#x9AD8;&#x6C34;&#x5E73;&#x7684;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x3002;</p>
]]></content>
    <summary type="html">
    <![CDATA[写出高效的正则表达式应该注意什么，一篇文章再次回顾]]>
    
    </summary>
    
      <category term="java" scheme="http://yoursite.com/tags/java/"/>
    
      <category term="正则表达式" scheme="http://yoursite.com/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    
      <category term="正则表达式" scheme="http://yoursite.com/categories/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[正则表达式基本使用]]></title>
    <link href="http://yoursite.com/2018/03/25/basic-use-of-regular-expressions/"/>
    <id>http://yoursite.com/2018/03/25/basic-use-of-regular-expressions/</id>
    <published>2018-03-25T04:17:39.000Z</published>
    <updated>2018-10-28T13:16:30.282Z</updated>
    <content type="html"><![CDATA[<p>&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x662F;&#x4E00;&#x4E2A;&#x5F88;&#x5F3A;&#x5927;&#x7684;&#x6A21;&#x5F0F;&#x8BED;&#x8A00;&#xFF0C;&#x4F7F;&#x7528;&#x5B83;&#x6211;&#x4EEC;&#x80FD;&#x591F;&#x89E3;&#x51B3;&#x5F88;&#x591A;&#x5F88;&#x68D8;&#x624B;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x6709;&#x65F6;&#x5019;&#x4F7F;&#x7528;&#x5B57;&#x7B26;&#x4E32;&#x67E5;&#x627E;&#x6765;&#x89E3;&#x51B3;&#x8FD9;&#x7C7B;&#x95EE;&#x9898;&#x4E0D;&#x662F;&#x5F88;&#x65B9;&#x4FBF;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x5C31;&#x80FD;&#x5E2E;&#x6211;&#x4EEC;&#x5F88;&#x5927;&#x7684;&#x5FD9;&#x3002;</p>
<p>&#x5B8C;&#x6574;&#x7684;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x7531;&#x4E24;&#x79CD;&#x5B57;&#x7B26;&#x6784;&#x6210;&#x3002;&#x7279;&#x6B8A;&#x5B57;&#x7B26;(specialcharacters,&#x6BD4;&#x5982;*)
&#x79F0;&#x4E3A;&#x201C;&#x5143;&#x5B57;&#x7B26;&#x201D;(metacharacters),&#x5176;&#x4ED6;&#x4E3A;&#x201C;&#x6587;&#x5B57;&#x201D;(literal),&#x6216;&#x8005;&#x662F;&#x666E;&#x901A;&#x6587;&#x672C;&#x5B57;&#x7B26;(normaltext characters).</p>
<h3 id="&#x5982;&#x4F55;&#x7406;&#x89E3;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;">&#x5982;&#x4F55;&#x7406;&#x89E3;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;</h3>
<p>&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x662F;&#x4E00;&#x95E8;&#x8BED;&#x8A00;&#xFF0C;&#x540C;&#x6837;&#x6709;&#x7740;&#x5B83;&#x7684;&#x8BED;&#x8A00;&#x6A21;&#x5F0F;,&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x8981;&#x4EE5;&#x5B83;&#x7684;&#x6A21;&#x5F0F;&#x6765;&#x7406;&#x89E3;&#x5B83;&#xFF0C;&#x6BD4;&#x5982;^cat(^&#x8868;&#x793A;&#x884C;&#x5F00;&#x5934;)&#x7684;&#x610F;&#x601D;&#x662F;&#x5339;&#x914D;&#x4EE5;c&#x5B57;&#x7B26;&#x4F5C;&#x4E3A;&#x7B2C;&#x4E00;&#x884C;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;,&#x7D27;&#x63A5;&#x4E00;&#x4E2A;a&#xFF0C;&#x7D27;&#x63A5;&#x4E00;&#x4E2A;t&#x7684;&#x6587;&#x672C;.</p>
<h3 id="&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x57FA;&#x672C;&#x4F7F;&#x7528;">&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x57FA;&#x672C;&#x4F7F;&#x7528;</h3>
<h4 id="&#x666E;&#x901A;&#x5B57;&#x7B26;">&#x666E;&#x901A;&#x5B57;&#x7B26;</h4>
<p>&#x666E;&#x901A;&#x5B57;&#x7B26;&#x5305;&#x62EC;&#x6CA1;&#x6709;&#x663E;&#x5F0F;&#x6307;&#x5B9A;&#x4E3A;&#x5143;&#x5B57;&#x7B26;&#x7684;&#x6240;&#x6709;&#x53EF;&#x6253;&#x5370;&#x548C;&#x4E0D;&#x53EF;&#x6253;&#x5370;&#x5B57;&#x7B26;&#x3002;&#x8FD9;&#x5305;&#x62EC;&#x6240;&#x6709;&#x5927;&#x5199;&#x548C;&#x5C0F;&#x5199;&#x5B57;&#x6BCD;&#x3001;&#x6240;&#x6709;&#x6570;&#x5B57;&#x3001;&#x6240;&#x6709;&#x6807;&#x70B9;&#x7B26;&#x53F7;&#x548C;&#x4E00;&#x4E9B;&#x5176;&#x4ED6;&#x7B26;&#x53F7;&#x3002;</p>
<h4 id="&#x7279;&#x6B8A;&#x5B57;&#x7B26;">&#x7279;&#x6B8A;&#x5B57;&#x7B26;</h4>
<p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#x5143;&#x5B57;&#x7B26;		 &#x540D; &#x79F0; 			&#x5339;&#x914D;&#x5BF9;&#x8C61;</span><br><span class="line">.       	&#x70B9;&#x53F7; 			&#x5339;&#x914D;&#x9664;&#x4E86;&#x6362;&#x884C;&#x7B26;(\<span class="keyword">n</span>)&#x4EE5;&#x5916;&#x7684;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;</span><br><span class="line">[&#x2026;] 		&#x5B57;&#x7B26;&#x7EC4; 			&#x5217;&#x51FA;&#x7684;&#x4EFB;&#x610F;&#x5B57;&#x7B26;</span><br><span class="line">[^&#x2026;] 		&#x6392;&#x9664;&#x578B;&#x5B57;&#x7B26;&#x7EC4; 	&#x672A;&#x5217;&#x51FA;&#x7684;&#x4EFB;&#x610F;&#x5B57;&#x7B26;</span><br><span class="line">^			&#x8131;&#x5B57;&#x7B26; 			&#x884C;&#x7684;&#x8D77;&#x59CB;&#x4F4D;&#x7F6E;</span><br><span class="line">$ 			&#x7F8E;&#x5143;&#x7B26; 			&#x884C;&#x7684;&#x7ED3;&#x675F;&#x4F4D;&#x7F6E;</span><br><span class="line">| 			&#x7AD6;&#x7EBF; 			&#x5339;&#x914D;&#x5206;&#x9694;&#x4E24;&#x8FB9;&#x7684;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x8868;&#x8FBE;&#x5F0F;</span><br><span class="line">(&#x2026;) 		&#x62EC;&#x53F7; 			&#x9650;&#x5236;&#x7AD6;&#x7EBF;&#x7684;&#x4F5C;&#x7528;&#x8303;&#x56F4;&#xFF0C;&#x5176;&#x4ED6;&#x529F;&#x80FD;&#x4E0B;&#x6587;&#x8BA8;&#x8BBA;</span><br><span class="line">?			&#x95EE;&#x53F7;			&#x5BB9;&#x8BB8;&#x5339;&#x914D;&#x4E00;&#x6B21;,&#x5F53;&#x5E76;&#x975E;&#x5FC5;&#x8981;</span><br><span class="line">+           &#x52A0;&#x53F7;			&#x8868;&#x793A;&#x4E4B;&#x524D;&#x7D27;&#x90BB;&#x7684;&#x5143;&#x7D20;&#x81F3;&#x5C11;&#x9700;&#x8981;&#x5339;&#x914D;&#x4E00;&#x6B21;,&#x81F3;&#x591A;&#x53EF;&#x80FD;&#x4EFB;&#x610F;&#x591A;&#x6B21;</span><br><span class="line"><span class="comment">*           &#x661F;&#x53F7;           	&#x8868;&#x793A;&#x4E4B;&#x524D;&#x7D27;&#x90BB;&#x7684;&#x5143;&#x7D20;&#x5C3D;&#x53EF;&#x80FD;&#x5339;&#x914D;&#x591A;&#x6B21;,&#x4E5F;&#x53EF;&#x80FD;&#x4E0D;&#x5339;&#x914D;</span></span><br><span class="line">\<span class="keyword">char</span> 		&#x8F6C;&#x4E49;&#x5B57;&#x7B26;		&#x82E5;<span class="keyword">char</span>&#x662F;&#x5143;&#x5B57;&#x7B26;&#xFF0C;&#x6216;&#x8F6C;&#x4E49;&#x5E8F;&#x5217;&#x65E0;&#x7279;&#x6B8A;&#x542B;&#x4E49;&#x65F6;&#xFF0C;&#x5339;&#x914D;</span><br><span class="line"><span class="keyword">char</span>&#x5BF9;&#x5E94;&#x7684;&#x666E;&#x901A;&#x5B57;&#x7B26;,&#x5982;&#x679C;&#x662F;&#x666E;&#x901A;&#x5B57;&#x7B26;&#x5219;&#x53CD;&#x659C;&#x7EBF;&#x88AB;&#x5FFD;&#x7565;</span><br><span class="line">{<span class="keyword">n</span>,<span class="keyword">m</span>} 		&#x533A;&#x95F4;&#x91CF;&#x8BCD;		&#x8868;&#x793A;&#x81F3;&#x5C11;&#x5339;&#x914D;<span class="keyword">n</span>&#x6B21;,&#x6700;&#x591A;&#x5339;&#x914D;<span class="keyword">m</span>&#x6B21;</span><br><span class="line">\1,\2		&#x53CD;&#x5411;&#x5F15;&#x7528;		&#x5339;&#x914D;&#x4E4B;&#x524D;&#x7684;&#x7B2C;&#x4E00;&#x3001;&#x7B2C;&#x4E8C;&#x7EC4;&#x62EC;&#x53F7;&#x5185;&#x7684;&#x5B57;&#x8868;&#x8FBE;&#x5F0F;&#x5339;&#x914D;&#x7684;</span><br><span class="line">&#x6587;&#x672C;</span><br></pre></td></tr></table></figure></p>
<p>&#x5982;&#x679C;&#x8981;&#x5339;&#x914D;&#x5143;&#x5B57;&#x7B26;&#xFF0C;&#x90FD;&#x9700;&#x8981;&#x52A0;&#x4E0A;&#x53CD;&#x659C;&#x6760;(&apos;&apos;)&#x8F6C;&#x4E49;,&#x5728;&#x5B57;&#x7B26;&#x7EC4;&#x5185;&#x90E8;&#x65E0;&#x6548;</p>
<h4 id="&#x91CF;&#x8BCD;">&#x91CF;&#x8BCD;</h4>
<p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x5FFD;&#x7565;&#x4F18;&#x5148;&#x91CF;&#x8BCD;: *?,+?,??,{<span class="keyword">n</span>}?,{<span class="keyword">n</span>,}?,{<span class="keyword">n</span>,<span class="keyword">m</span>}?   &#x91CF;&#x8BCD;&#x5728;&#x6B63;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#x90FD;&#x662F;&#x201C;&#x5339;&#x914D;&#x4F18;&#x5148;&#x201D;&#x7684;&#xFF0C;&#x5339;&#x914D;&#x5C3D;&#x53EF;&#x80FD;&#x591A;&#x7684;&#x5185;&#x5BB9;&#x3002;&#x76F8;&#x53CD;&#xFF0C;&#x8FD9;&#x4E9B;&#x5FFD;&#x7565;</span><br><span class="line">&#x4F18;&#x5148;&#x7684;&#x91CF;&#x8BCD;&#x4F1A;&#x5339;&#x914D;&#x5C3D;&#x53EF;&#x80FD;&#x5C11;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x6EE1;&#x8DB3;&#x4E0B;&#x9650;&#xFF0C;&#x5339;&#x914D;&#x5C31;&#x80FD;&#x6210;&#x529F;</span><br><span class="line"></span><br><span class="line">&#x5339;&#x914D;&#x4F18;&#x5148;&#x91CF;&#x8BCD;&#xFF1A; *&#x3001;+&#x3001;?&#x3001;{num,num}</span><br><span class="line"></span><br><span class="line">&#x5360;&#x6709;&#x4F18;&#x5148;&#x91CF;&#x8BCD;: ?+  *+  ++  {<span class="keyword">m</span>,<span class="keyword">n</span>}+    &#x8FD9;&#x4E9B;&#x91CF;&#x8BCD;&#x76EE;&#x524D;&#x53EA;&#x6709;java.util.regex &#x548C; PCRE (&#x4EE5;&#x53CA;PHP)&#x63D0;&#x4F9B;,&#x5360;&#x6709;&#x4F18;&#x5148;&#x91CF;&#x8BCD;&#x7C7B;&#x4F3C;&#x666E;&#x901A;&#x7684;&#x5339;&#x914D;&#x4F18;&#x5148;&#x91CF;&#x8BCD;&#xFF0C;&#x4E0D;&#x8FC7;&#x4ED6;&#x4EEC;&#x4E00;&#x65E6;&#x5339;&#x914D;&#x67D0;&#x4E9B;&#x5185;&#x5BB9;&#xFF0C;&#x5C31; &#x4E0D; &#x4F1A; &#x201C;&#x4EA4;&#x8FD8;&#x201D;&#x3002;</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x5176;&#x4ED6;&#x901A;&#x7528;&#x89C4;&#x5219;">&#x5176;&#x4ED6;&#x901A;&#x7528;&#x89C4;&#x5219;</h4>
<p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">\xXX</span>	&#x7F16;&#x53F7;&#x5728; <span class="number">0</span> ~ <span class="number">255</span> &#x8303;&#x56F4;&#x7684;&#x5B57;&#x7B26;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;&#x7A7A;&#x683C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <span class="string">&quot;\x20&quot;</span> &#x8868;&#x793A;</span><br><span class="line"><span class="string">\uXXXX</span>	&#x4EFB;&#x4F55;&#x5B57;&#x7B26;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <span class="string">&quot;\u&quot;</span> &#x518D;&#x52A0;&#x4E0A;&#x5176;&#x7F16;&#x53F7;&#x7684;<span class="number">4</span>&#x4F4D;&#x5341;&#x516D;&#x8FDB;&#x5236;&#x6570;&#x8868;&#x793A;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;<span class="string">&quot;\u4E2D&quot;</span></span><br><span class="line"><span class="string">\t</span> 		&#x5236;&#x8868;&#x7B26;</span><br><span class="line"><span class="string">\n</span> 		&#x6362;&#x884C;&#x7B26;</span><br><span class="line"><span class="string">\r</span> 		&#x56DE;&#x8F66;&#x7B26;</span><br><span class="line"><span class="string">\s</span> 		&#x4EFB; &#x4F55; &#x201C;&#x7A7A;&#x767D;&#x201D;&#x5B57; &#x7B26; &#xFF08;&#x4F8B;&#x5982;&#x7A7A;&#x683C;&#x7B26;&#x3001;&#x5236;&#x8868;&#x7B26;&#x3001;&#x8FDB;&#x7EB8;&#x7B26;&#x7B49;&#xFF09;</span><br><span class="line"><span class="string">\S</span> 		&#x9664;<span class="string">\s</span> &#x4E4B;&#x5916;&#x7684;&#x4EFB;&#x4F55;&#x5B57;&#x7B26;</span><br><span class="line"><span class="string">\w</span> 		[a-zA-ZO-<span class="number">9</span>](<span class="string">\w+&#x4E2D;&#x5F88;&#x6709;&#x7528;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x5339;&#x914D;&#x4E00;&#x4E2A;&#x5355;&#x8BCD;)</span></span><br><span class="line"><span class="string">\W</span> 		&#x9664;<span class="string">\w&#x4E4B;&#x5916;&#x7684;&#x4EFB;&#x4F55;&#x5B57;&#x7B26;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;[Aa-zA-ZO-9]</span></span><br><span class="line"><span class="string">\d</span> 		[<span class="number">0</span>-<span class="number">9</span>],&#x5373;&#x6570;&#x5B57;</span><br><span class="line"><span class="string">\D</span> 		&#x9664;<span class="string">\d&#x4EE5;&#x5916;&#x7684;&#x4EFB;&#x4F55;&#x5B57;&#x7B26;&#xFF0C;&#x5373;[^a-zA-Z0-9]</span></span><br><span class="line"><span class="string">\B</span>		&#x5339;&#x914D;&#x975E;&#x5355;&#x8BCD;&#x8FB9;&#x754C;&#xFF0C;&#x5373;&#x5DE6;&#x53F3;&#x4E24;&#x8FB9;&#x90FD;&#x662F; <span class="string">&quot;\w&quot;</span> &#x8303;&#x56F4;&#x6216;&#x8005;&#x5DE6;&#x53F3;&#x4E24;&#x8FB9;&#x90FD;&#x4E0D;&#x662F; <span class="string">&quot;\w&quot;</span> &#x8303;&#x56F4;&#x65F6;&#x7684;&#x5B57;&#x7B26;&#x7F1D;&#x9699;</span><br><span class="line"><span class="string">\b</span>  	&#x5339;&#x914D;&#x5355;&#x8BCD;&#x8FB9;&#x754C;</span><br></pre></td></tr></table></figure></p>
<h3 id="&#x5B57;&#x7B26;&#x7EC4;">&#x5B57;&#x7B26;&#x7EC4;</h3>
<p>&#x5B57;&#x7B26;&#x7EC4;&#x7684;&#x610F;&#x601D;&#x8868;&#x793A;&#x5339;&#x914D;&#x82E5;&#x5E72;&#x4E2A;&#x5B57;&#x7B26;&#x4E4B;&#x4E00;,&#x6BD4;&#x5982;gr[ae]y,&#x8868;&#x793A;&#x5339;&#x914D;&#x7684;&#x7ED3;&#x679C;&#x662F;grey&#x6216;&#x8005;&#x662F;gray.&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5728;&#x5B57;&#x7B26;&#x7EC4;&#x4EE5;&#x5916;&#xFF0C;&#x666E;&#x901A;&#x5B57;&#x7B26;&#xFF08;&#x4F8B;&#x5982;gr[ae]y &#x4E2D;&#x7684;g&#x548C;r)&#x90FD;&#x6709;&#x201C;&#x63A5;&#x4E0B;&#x6765;&#x662F;&#xFF08;and then)&#x201D;
&#x7684;&#x610F;&#x601D;&#x2014;&#x2014;&#x201C;&#x9996;&#x5148;&#x5339;&#x914D;g&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x662F;r&#x201D;&#x3002;&#x8FD9;&#x4E0E;&#x5B57;&#x7B26;&#x7EC4;&#x5185;&#x90E8;&#x7684;&#x60C5;&#x51B5;&#x662F;&#x5B8C;&#x5168;&#x76F8;&#x53CD;&#x7684;&#x3002;&#x5B57;
&#x7B26;&#x7EC4;&#x7684;&#x5185;&#x5BB9;&#x662F;&#x5728;&#x540C;&#x4E00;&#x4E2A;&#x4F4D;&#x7F6E;&#x80FD;&#x591F;&#x5339;&#x914D;&#x7684;&#x82E5;&#x5E72;&#x5B57;&#x7B26;&#xFF0C;&#x6240;&#x4EE5;&#x5B83;&#x7684;&#x610F;&#x601D;&#x662F;&#x201C;&#x6216;&#x201D;&#x3002;</p>
<p>&#x5728;&#x5B57;&#x7B26;&#x7EC4;&#x5185;&#x90E8;&#xFF0C;&#x5B57;&#x7B26;&#x7EC4;&#x5143;&#x5B57;&#x7B26;&#x2018;-&#x2019;&#x8868;&#x793A;&#x8303;&#x56F4;&#x7684;&#x610F;&#x601D;,&#x6BD4;&#x5982;[123456]&#x8868;&#x793A;1&#x5230;6&#x4E4B;&#x95F4;&#x7684;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#xFF0C;&#x4E0E;[1-6]&#x662F;&#x4E00;&#x6837;&#x7684;,&#x540C;&#x7406;[0-9A-Za-z]&#x8868;&#x793A;&#x5339;&#x914D;9&#x4E2A;&#x6570;&#x5B57;&#x4E0E;52&#x4E2A;&#x5B57;&#x6BCD;&#x4E2D;&#x7684;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#xFF0C;&#x987A;&#x5E8F;&#x65E0;&#x6240;&#x8C13;&#x3002;&#x6211;&#x4EEC;&#x8FD8;&#x53EF;&#x4EE5;&#x968F;&#x5FC3;&#x6240;&#x6B32;&#x5730;&#x628A;&#x5B57;&#x7B26;&#x8303;&#x56F4;&#x4E0E;&#x666E;&#x901A;&#x6587;&#x672C;&#x7ED3;&#x5408;&#x8D77;&#x6765;:[0-9A-Z_!.?]&#x80FD;&#x591F;&#x5339;&#x914D;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#x3001;&#x5927;&#x5199;&#x5B57;&#x6BCD;&#x3001;&#x4E0B;&#x753B;&#x7EBF;&#x3001;&#x60CA;&#x53F9;&#x53F7;&#x3001;&#x70B9;&#x53F7;&#xFF0C;&#x6216;&#x8005;&#x662F;&#x95EE;&#x53F7;&#x3002;</p>
<p>&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x53EA;&#x6709;&#x5728;&#x5B57;&#x7B26;&#x7EC4;&#x5185;&#x90E8;&#xFF0C;&#x8FDE;&#x5B57;&#x7B26;&#x624D;&#x662F;&#x5143;&#x5B57;&#x7B26;&#x4E00;&#x5426;&#x5219;&#x5B83;&#x5C31;&#x53EA;&#x80FD;&#x5339;&#x914D;&#x666E;&#x901A;&#x7684;&#x8FDE;&#x5B57;&#x7B26;&#x53F7;&#x3002;&#x5176;
&#x5B9E;&#xFF0C;&#x5373;&#x4F7F;&#x5728;&#x5B57;&#x7B26;&#x7EC4;&#x5185;&#x90E8;&#xFF0C;&#x5B83;&#x4E5F;&#x4E0D;&#x4E00;&#x5B9A;&#x5C31;&#x662F;&#x5143;&#x5B57;&#x7B26;&#x3002;&#x5982;&#x679C;&#x8FDE;&#x5B57;&#x7B26;&#x51FA;&#x73B0;&#x5728;&#x5B57;&#x7B26;&#x7EC4;&#x7684;&#x5F00;&#x5934;&#xFF0C;&#x5B83;&#x8868;
&#x793A;&#x7684;&#x5C31;&#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x5B57;&#x7B26;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x8303;&#x56F4;&#x3002;&#x540C;&#x6837;&#x7684;&#x9053;&#x7406;&#xFF0C;&#x95EE;&#x53F7;&#x548C;&#x70B9;&#x53F7;&#x901A;&#x5E38;&#x88AB;&#x5F53;&#x4F5C;&#x5143;&#x5B57;&#x7B26;
&#x5904;&#x7406;&#xFF0C;&#x4F46;&#x5728;&#x5B57;&#x7B26;&#x7EC4;&#x4E2D;&#x5219;&#x4E0D;&#x662F;&#x5982;&#x6B64;&#xFF08;&#x8BF4;&#x660E;&#x767D;&#x4E00;&#x70B9;&#x5C31;&#x662F;&#xFF0C;[0-9A-Z_!] &#x91CC;&#x9762;&#xFF0C;&#x771F;&#x6B63;&#x7684;&#x7279;&#x6B8A;&#x5B57;&#x7B26;
&#x5C31;&#x53EA;&#x6709;&#x90A3;&#x4E24;&#x4E2A;&#x8FDE;&#x5B57;&#x7B26;)&#x3002;</p>
<p>&#x5B57;&#x7B26;&#x7EC4;&#x4E2D;&#x7684;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x5143;&#x5B57;&#x7B26;&#x662F;^,&#x8868;&#x793A;&#x6392;&#x9664;&#x7684;&#x610F;&#x601D;&#xFF0C;&#x6BD4;&#x5982;[^1-6],&#x8868;&#x793A;&#x5339;&#x914D;&#x9664;&#x4E86;1&#x5230;6&#x4E4B;&#x5916;&#x7684;&#x4EFB;&#x610F;&#x5B57;&#x7B26;&#x3002;&#x800C;&#x4E14;&#x5FC5;&#x987B;&#x662F;&#x7D27;&#x63A5;&#x5728;&#x5B57;&#x7B26;&#x7EC4;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x65B9;&#x62EC;&#x53F7;&#x4E4B;&#x540E;&#x624D;&#x662F;&#x6392;&#x9664;&#x7684;&#x610F;&#x601D;&#x3002;&#x9700;&#x8981;&#x8BB0;&#x4F4F;&#x7684;&#x662F;&#x6392;&#x9664;&#x578B;&#x5B57;&#x7B26;&#x7EC4;&#x8868;&#x793A;&#x201C;&#x5339;&#x914D;&#x4E00;&#x4E2A;&#x672A;&#x5217;&#x51FA;&#x7684;&#x5B57;&#x7B26;(match a character that&#x2019;s not listed)&#x201D;,&#x800C;&#x4E0D;&#x662F; &#x201C;&#x4E0D;&#x8981;&#x5339;&#x914D;&#x5217;&#x51FA;&#x7684;&#x5B57;&#x7B26;(don&#x2019;t match what is listed)&#x201D;</p>
<h3 id="&#x5206;&#x7EC4;&#x548C;&#x53CD;&#x5411;&#x5F15;&#x7528;">&#x5206;&#x7EC4;&#x548C;&#x53CD;&#x5411;&#x5F15;&#x7528;</h3>
<p>&#x5C0F;&#x62EC;&#x53F7; () &#x53EF;&#x4EE5;&#x8FBE;&#x5230;&#x5BF9;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x8FDB;&#x884C;&#x5206;&#x7EC4;&#x7684;&#x6548;&#x679C;&#xFF0C;&#x5206;&#x7EC4;&#x540E;&#x4F1A;&#x5728;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x4E2D;&#x521B;&#x5EFA;&#x53CD;&#x5411;&#x5F15;&#x7528;&#xFF0C;&#x53CD;&#x5411;&#x5F15;&#x7528;&#x4F1A;&#x4FDD;&#x5B58;&#x5206;&#x7EC4;&#x7684;&#x5B57;&#x7B26;&#x7247;&#x6BB5;&#xFF0C;&#x8FD9;&#x4F7F;&#x5F97;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x7247;&#x6BB5;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&quot;((\w)\d(test)))&quot;&#x603B;&#x5171;&#x5B58;&#x5728;3&#x7EC4;(&#x6BCF;&#x4E2A;&#x62EC;&#x53F7;&#x662F;1&#x7EC4;,&#x4ECE;&#x5DE6;&#x5230;&#x53F3;&#x5F00;&#x59CB;&#x6570;,&#x6574;&#x4E2A;&#x8868;&#x8FBE;&#x5F0F;&#x662F;&#x7B2C;&#x4E00;&#x7EC4;,&#x56E0;&#x4E3A;&#x5B83;&#x88AB;&#x62EC;&#x53F7;&#x5305;&#x56F4;&#x4E86;,\w&#x662F;&#x7B2C;&#x4E8C;&#x7EC4;,test&#x662F;&#x7B2C;&#x4E09;&#x7EC4;&#x5185;&#x5BB9;),&#x6BCF;&#x4E2A;&#x7EC4;&#x5728;&#x7A0B;&#x5E8F;&#x4E2D;&#x90FD;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#xFF0C;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x5F15;&#x64CE;&#x5728;&#x5339;&#x914D;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x4FDD;&#x5B58;&#x6574;&#x4E2A;&#x7EC4;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x7528;&#x4E8E;&#x4EE5;&#x540E;&#x83B7;&#x53D6;&#xFF0C;&#x5982;&#x679C;&#x5C06;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x4FEE;&#x6539;&#x4E3A; &#x201C;((?:\w)\d(test)))&#x201D;,&#x8FD9;&#x6837;&#x5C31;&#x4E0D;&#x80FD;&#x83B7;&#x53D6;\w&#x6240;&#x6355;&#x83B7;&#x7684;&#x90A3;&#x4E00;&#x7EC4;&#x7684;&#x5185;&#x5BB9;&#x3002;</p>
<p>&#x5728;&#x4EE5;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x66FF;&#x6362;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x8BED;&#x6CD5;&#x4E2D;&#xFF0C;&#x662F;&#x901A;&#x8FC7; $ &#x6765;&#x5F15;&#x7528;&#x5206;&#x7EC4;&#x7684;&#x53CD;&#x5411;&#x5F15;&#x7528;&#xFF0C;$0 &#x662F;&#x5339;&#x914D;&#x5B8C;&#x6574;&#x6A21;&#x5F0F;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF08;&#x6CE8;&#x610F;&#x5728; JavaScript &#x4E2D;&#x662F;&#x7528; $&amp; &#x8868;&#x793A;&#xFF09;&#xFF1B;$1 &#x662F;&#x7B2C;&#x4E00;&#x4E2A;&#x5206;&#x7EC4;&#x7684;&#x53CD;&#x5411;&#x5F15;&#x7528;&#xFF1B;$2 &#x662F;&#x7B2C;&#x4E8C;&#x4E2A;&#x5206;&#x7EC4;&#x7684;&#x53CD;&#x5411;&#x5F15;&#x7528;&#xFF0C;&#x4EE5;&#x6B64;&#x7C7B;&#x63A8;&#x3002;</p>
<p>&#x5728;&#x5339;&#x914D;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x4E5F;&#x662F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5206;&#x7EC4;&#x7684;&#x7ED3;&#x679C;&#x7684;&#xFF0C;&#x8868;&#x8FBE;&#x5F0F;&#x540E;&#x8FB9;&#x7684;&#x90E8;&#x5206;&#xFF0C;&#x53EF;&#x4EE5;&#x5F15;&#x7528;&#x524D;&#x9762; &quot;&#x62EC;&#x53F7;&#x5185;&#x7684;&#x5B50;&#x5339;&#x914D;&#x5DF2;&#x7ECF;&#x5339;&#x914D;&#x5230;&#x7684;&#x5B57;&#x7B26;&#x4E32;&quot;&#x3002;&#x5F15;&#x7528;&#x65B9;&#x6CD5;&#x662F; &quot;&quot; &#x52A0;&#x4E0A;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#x3002;&quot;\1&quot; &#x5F15;&#x7528;&#x7B2C;1&#x5BF9;&#x62EC;&#x53F7;&#x5185;&#x5339;&#x914D;&#x5230;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&quot;\2&quot; &#x5F15;&#x7528;&#x7B2C;2&#x5BF9;&#x62EC;&#x53F7;&#x5185;&#x5339;&#x914D;&#x5230;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x2026;&#x2026;&#x4EE5;&#x6B64;&#x7C7B;&#x63A8;&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x5BF9;&#x62EC;&#x53F7;&#x5185;&#x5305;&#x542B;&#x53E6;&#x4E00;&#x5BF9;&#x62EC;&#x53F7;&#xFF0C;&#x5219;&#x5916;&#x5C42;&#x7684;&#x62EC;&#x53F7;&#x5148;&#x6392;&#x5E8F;&#x53F7;&#x3002;&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x54EA;&#x4E00;&#x5BF9;&#x7684;&#x5DE6;&#x62EC;&#x53F7; &quot;(&quot; &#x5728;&#x524D;&#xFF0C;&#x90A3;&#x8FD9;&#x4E00;&#x5BF9;&#x5C31;&#x5148;&#x6392;&#x5E8F;&#x53F7;&#x3002;</p>
<h3 id="&#x975E;&#x6355;&#x83B7;&#x578B;&#x62EC;&#x53F7;">&#x975E;&#x6355;&#x83B7;&#x578B;&#x62EC;&#x53F7;</h3>
<p>&#x62EC;&#x53F7; &quot;( )&quot; &#x5185;&#x7684;&#x5B50;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x5982;&#x679C;&#x5E0C;&#x671B;&#x5339;&#x914D;&#x7ED3;&#x679C;&#x4E0D;&#x8FDB;&#x884C;&#x8BB0;&#x5F55;&#x4F9B;&#x4EE5;&#x540E;&#x4F7F;&#x7528;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; &quot;(?:xxxxx)&quot; &#x683C;&#x5F0F;,&#x6B64;&#x79CD;&#x65B9;&#x5F0F;&#x53EF;&#x4EE5;&#x63D0;&#x9AD8;&#x6548;&#x7387;&#x3002;
&#x4E3E;&#x4F8B;1&#xFF1A;&#x8868;&#x8FBE;&#x5F0F; &quot;(?:(\w)\1)+&quot; &#x5339;&#x914D; &quot;a bbccdd efg&quot; &#x65F6;&#xFF0C;&#x7ED3;&#x679C;&#x662F; &quot;bbccdd&quot;&#x3002;&#x62EC;&#x53F7; &quot;(?:)&quot; &#x8303;&#x56F4;&#x7684;&#x5339;&#x914D;&#x7ED3;&#x679C;&#x4E0D;&#x8FDB;&#x884C;&#x8BB0;&#x5F55;&#xFF0C;&#x56E0;&#x6B64; &quot;(\w)&quot; &#x4F7F;&#x7528; &quot;\1&quot; &#x6765;&#x5F15;&#x7528;&#x3002;</p>
<h3 id="&#x73AF;&#x89C6;&#x6216;&#x8BB8;&#x4E5F;&#x88AB;&#x53EB;&#x505A;&#x96F6;&#x5BBD;&#x65AD;&#x8A00;">&#x73AF;&#x89C6;(&#x6216;&#x8BB8;&#x4E5F;&#x88AB;&#x53EB;&#x505A;&#x96F6;&#x5BBD;&#x65AD;&#x8A00;)</h3>
<p>&#x73AF;&#x89C6;(Perl&#x4E2D;&#x53EB;&#x8FD9;&#x4E2A;&#x540D;&#x5B57;)&#x66F4;&#x591A;&#x7684;&#x8868;&#x793A;&#x7684;&#x662F;&#x4E00;&#x4E2A;&#x4F4D;&#x7F6E;,&#x5728;java&#x4E2D;&#x9002;&#x7528;,js&#x4E2D;&#x4E5F;&#x9002;&#x7528;,&#x4E5F;&#x53EB;&#x505A;&#x96F6;&#x5BBD;&#x8868;&#x8FBE;&#x5F0F;.</p>
<p>&#x5728;&#x8BF4;&#x73AF;&#x89C6;&#x4E4B;&#x524D;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x4E00;&#x70B9;&#x662F;,&#x5728;&#x68C0;&#x67E5;&#x5B50;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x5B83;&#x4EEC;&#x672C;&#x8EAB;&#x4E0D;&#x4F1A;&quot;&#x5360;&#x7528;&quot;&#x4EFB;&#x4F55;&#x6587;&#x672C;&#xFF0C;&#x53EA;&#x5339;&#x914D;&#x6807;&#x8BB0;&#x7684;&#x4F4D;&#x7F6E;</p>
<p>&#x80AF;&#x5B9A;&#x987A;&#x5E8F;&#x73AF;&#x89C6;  (?=......)      &#x5B50;&#x8868;&#x8FBE;&#x5F0F;&#x80FD;&#x591F;&#x5339;&#x914D;&#x53F3;&#x4FA7;&#x6587;&#x672C;
&#x539F;&#x59CB;&#x4E32;&#xFF1A;abcdef   &#x6B63;&#x5219;:abc(?=def)  &#x80FD;&#x591F;&#x5339;&#x914D;&#x5176;&#x4E2D;&#x7684;abc,&#x8FD9;&#x91CC;?=def&#x5339;&#x914D;&#x7684;&#x662F;&#x4E00;&#x4E2A;&#x4F4D;&#x7F6E;,&#x5373;d&#x7684;&#x4F4D;&#x7F6E;,&#x7136;&#x540E;&#x8FD9;&#x4E2A;&#x4F4D;&#x7F6E;&#x524D;&#x9762;&#x6709;abc&#x4E09;&#x4E2A;&#x5B57;&#x7B26;,&#x6240;&#x4EE5;&#x5339;&#x914D;&#x6210;&#x529F;</p>
<p>&#x5426;&#x5B9A;&#x987A;&#x5E8F;&#x5E8F;&#x73AF;&#x89C6; (?!......)      &#x5B50;&#x8868;&#x8FBE;&#x5F0F;&#x4E0D;&#x80FD;&#x5339;&#x914D;&#x53F3;&#x4FA7;&#x6587;&#x672C;
&#x539F;&#x59CB;&#x4E32;&#xFF1A;abcdef   &#x6B63;&#x5219;:abc(?!def)  &#x4E0D;&#x80FD;&#x5339;&#x914D;&#x5176;&#x4E2D;&#x7684;abc  &#x4F46;&#x662F;&#x53EF;&#x4EE5;&#x5339;&#x914D;abcddef&#x4E2D;&#x7684;abc</p>
<p>&#x80AF;&#x5B9A;&#x9006;&#x5E8F;&#x73AF;&#x89C6;  (?&lt;=......)     &#x5B50;&#x8868;&#x8FBE;&#x5F0F;&#x80FD;&#x591F;&#x5339;&#x914D;&#x5DE6;&#x4FA7;&#x6587;&#x672C;
&#x539F;&#x59CB;&#x4E32;&#xFF1A;abcdef   &#x6B63;&#x5219;:(?&lt;=abc)def  &#x80FD;&#x591F;&#x5339;&#x914D;&#x5176;&#x4E2D;&#x7684;def,</p>
<p>&#x5426;&#x5B9A;&#x9006;&#x5E8F;&#x73AF;&#x89C6;  (?&lt;!......)     &#x5B50;&#x8868;&#x8FBE;&#x5F0F;&#x4E0D;&#x80FD;&#x5339;&#x914D;&#x5DE6;&#x4FA7;&#x6587;&#x672C;
&#x539F;&#x59CB;&#x4E32;&#xFF1A;abcdef   &#x6B63;&#x5219;:(?&lt;!abc)def  &#x4E0D;&#x80FD;&#x591F;&#x5339;&#x914D;def  &#x4F46;&#x662F;&#x53EF;&#x4EE5;&#x5339;&#x914D; abdef&#x4E2D;&#x7684;def</p>
<p>&#x987A;&#x5E8F;&#x73AF;&#x89C6;&#x7ED3;&#x6784;&#x4E2D;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4EFB;&#x610F;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x4F46;&#x662F;&#x9006;&#x5E8F;&#x73AF;&#x89C6;&#x4E2D;&#x7684;&#x5B50;&#x8868;&#x8FBE;&#x5F0F;&#x53EA;&#x80FD;&#x5339;&#x914D;&#x957F;&#x5EA6;
&#x6709;&#x9650;&#x7684;&#x6587;&#x672C;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4; ?&#x53EF;&#x4EE5;&#x51FA;&#x73B0;&#x5728;&#x9006;&#x5E8F;&#x73AF;&#x89C6;&#x4E2D;&#xFF0C;&#x4F46; * &#x548C; +&#x5219;&#x4E0D;&#x884C;</p>
<h3 id="&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x4E2D;&#x7684;&#x5339;&#x914D;&#x6A21;&#x5F0F;">&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x4E2D;&#x7684;&#x5339;&#x914D;&#x6A21;&#x5F0F;</h3>
<p>&#x53EF;&#x4EE5;&#x5728;&#x6B63;&#x5219;&#x7684;&#x5F00;&#x5934;&#x6307;&#x5B9A;&#x6A21;&#x5F0F;&#x4FEE;&#x9970;&#x7B26;&#x3002;</p>
<pre><code>1. (?i) &#x4F7F;&#x6B63;&#x5219;&#x5FFD;&#x7565;&#x5927;&#x5C0F;&#x5199;&#x3002;

2. (?s) &#x8868;&#x793A;&#x5355;&#x884C;&#x6A21;&#x5F0F;&#xFF08;&quot;single line mode&quot;&#xFF09;&#x4F7F;&#x6B63;&#x5219;&#x7684; . &#x5339;&#x914D;&#x6240;&#x6709;&#x5B57;&#x7B26;&#xFF0C;&#x5305;&#x62EC;&#x6362;&#x884C;&#x7B26;&#x3002;

3. (?m) &#x8868;&#x793A;&#x591A;&#x884C;&#x6A21;&#x5F0F;&#xFF08;&quot;multi-line mode&quot;&#xFF09;&#xFF0C;&#x4F7F;&#x6B63;&#x5219;&#x7684; ^ &#x548C; $ &#x5339;&#x914D;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x6BCF;&#x884C;&#x7684;&#x5F00;&#x59CB;&#x548C;&#x7ED3;&#x675F;&#x3002;
</code></pre>
<h3 id="&#x5728;java&#x4E2D;&#x4F7F;&#x7528;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;">&#x5728;Java&#x4E2D;&#x4F7F;&#x7528;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;</h3>
<p>&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5148;&#x4E86;&#x89E3;Java&#x4E2D;&#x7684;&#x4E24;&#x4E2A;&#x7C7B;</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java.util.regex.Pattern</span><br><span class="line">java.util.regex.Matcher</span><br></pre></td></tr></table></figure></p>
<p>&#x7B80;&#x79F0;&#x8FD9;&#x4E24;&#x4E2A;&#x4E3A;&#x201C; pattern &#x201D;&#x548C; &#x201C; matcher &#x201D;&#xFF0C;&#x8BB8;&#x591A;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x53EA;&#x4F1A;&#x7528;&#x5230;&#x8FD9;&#x4E24;
&#x4E2A;&#x7C7B;&#x3002;&#x7B80;&#x5355;&#x5730;&#x8BF4;&#xFF0C; Pattern&#x5BF9;&#x8C61;&#x5C31;&#x662F;&#x7F16;&#x8BD1;&#x597D;&#x7684;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x53EF;&#x4EE5;&#x5E94;&#x7528;&#x4E8E;&#x4EFB;&#x610F;&#x591A;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;
Matcher&#x5BF9;&#x8C61;&#x5219;&#x5BF9;&#x5E94;&#x5355;&#x72EC;&#x7684;&#x5B9E;&#x4F8B;&#xFF0C;&#x8868;&#x793A;&#x5C06;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x5E94;&#x7528;&#x5230;&#x67D0;&#x4E2A;&#x5177;&#x4F53;&#x7684;&#x76EE;&#x6807;&#x5B57;&#x7B26;&#x4E32;&#x4E0A;.</p>
<p>&#x7B80;&#x5355;&#x5E94;&#x7528;:</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RegexTest</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        String myTest = <span class="string">&quot;this is my 1st test string&quot;</span>;</span><br><span class="line">        String myRegex = <span class="string">&quot;\\d+\\w+&quot;</span>;</span><br><span class="line">        Pattern pattern = Pattern.compile(myRegex);</span><br><span class="line">        Matcher matcher = pattern.matcher(myTest);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(matcher.find()) {</span><br><span class="line">            String matchText = matcher.group();</span><br><span class="line">            <span class="keyword">int</span> matchFrom = matcher.start();</span><br><span class="line">            <span class="keyword">int</span> matchEnd  =matcher.end();</span><br><span class="line">            System.out.println(<span class="string">&quot;matched [ &quot;</span> + matchText + <span class="string">&quot; ] from &quot;</span> + matchFrom + <span class="string">&quot; to &quot;</span> + matchEnd);</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            System.out.println(<span class="string">&quot;don&apos;t match&quot;</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">matched [ <span class="number">1</span>st ] from <span class="number">11</span> to <span class="number">14</span></span><br></pre></td></tr></table></figure></p>
<h4 id="matcher&#x5BF9;&#x8C61;&#x7684;&#x5E38;&#x7528;api">Matcher&#x5BF9;&#x8C61;&#x7684;&#x5E38;&#x7528;API</h4>
<p>&#x901A;&#x8FC7;Matcher&#x5BF9;&#x8C61;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x51E0;&#x4E2A;&#x5E38;&#x7528;&#x7684;&#x5BF9;&#x8C61;&#xFF1A;</p>
<ol>
<li>Pattern(usePattern&#x65B9;&#x6CD5;)</li>
<li>&#x76EE;&#x6807;&#x5B57;&#x7B26;&#x4E32;(reset(text)&#x65B9;&#x6CD5;)</li>
<li>&#x76EE;&#x6807;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x68C0;&#x7D22;&#x8303;&#x56F4;(region),&#x9ED8;&#x8BA4;&#x662F;&#x6574;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;,&#x4F46;&#x662F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;region&#x65B9;&#x6CD5;&#x4FEE;&#x6539;&#x4E3A;&#x76EE;&#x6807;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x67D0;&#x4E00;&#x6BB5;,&#x8FD9;&#x6837;&#x67D0;&#x4E9B;&#x5339;&#x914D;&#x64CD;&#x4F5C;&#x5C31;&#x53EA;&#x80FD;&#x5728;&#x67D0;&#x4E2A;&#x533A;&#x57DF;&#x8FDB;&#x884C;&#x4E86;&#x3002;</li>
<li>&#x5F53;&#x524D; pattern &#x7684;&#x6355;&#x83B7;&#x578B;&#x62EC;&#x53F7;&#x7684;&#x6570;&#x76EE;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;groupCount&#x67E5;&#x8BE2;</li>
</ol>
<p>&#x5F53;Matcher&#x7684;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x5E94;&#x7528;&#x5230;&#x6587;&#x672C;&#x7684;&#x65F6;&#x5019;,&#x4E0B;&#x9762;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x4F1A;&#x6BD4;&#x8F83;&#x5E38;&#x7528;</p>
<ol>
<li>
<p>boolean find()
&#x6B64;&#x65B9;&#x6CD5;&#x5728;&#x76EE;&#x6807;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x5F53;&#x524D;&#x68C0;&#x7D22;&#x8303;&#x56F4;&#x4E2D;&#x5E94;&#x7528; Matcher &#x7684;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x8FD4;&#x56DE;&#x7684;
Boolean &#x503C;&#x8868;&#x793A;&#x662F;&#x5426;&#x80FD;&#x627E;&#x5230;&#x5339;&#x914D;&#x3002;&#x5982;&#x679C;&#x591A;&#x6B21;&#x8C03;&#x7528;&#xFF0C;&#x5219;&#x6BCF;&#x6B21;&#x90FD;&#x5728;&#x4E0A;&#x6B21;&#x7684;&#x5339;&#x914D;&#x4F4D;&#x7F6E;&#x4E4B;&#x540E;&#x5C1D;&#x8BD5;
&#x65B0;&#x7684;&#x5339;&#x914D;&#x3002;&#x6CA1;&#x6709;&#x7ED9;&#x5B9A;&#x53C2;&#x6570;&#x7684; find &#x53EA;&#x4F7F;&#x7528;&#x5F53;&#x524D;&#x7684;&#x68C0;&#x7D22;</p>
</li>
<li>
<p>boolean find (int  offset)
&#x5982;&#x679C;&#x6307;&#x5B9A;&#x4E86;&#x6574; &#x578B;&#x53C2; &#x6570; &#xFF0C;&#x5339;&#x914D;&#x5C1D;&#x8BD5;&#x4F1A;&#x4ECE;&#x8DDD;&#x79BB;&#x76EE;&#x6807;&#x5B57;&#x7B26;&#x4E32;&#x5F00;&#x5934; offset&#x4E2A;&#x5B57;&#x7B26;&#x7684;&#x4F4D;&#x7F6E; &#x5F00;&#x59CB;,&#x8FD9;&#x79CD;&#x5F62;&#x5F0F;&#x7684;find&#x4E0D;&#x4F1A;&#x53D7;&#x5F53;&#x524D;&#x68C0;&#x7D22;&#x8303;&#x56F4;&#x7684;&#x5F71;&#x54CD;,&#x800C;&#x4F1A;&#x628A;&#x5B83;&#x8BBE;&#x7F6E;&#x4E3A;&#x6574;&#x4E2A;&#x201C;&#x76EE;&#x6807;&#x5B57;&#x7B26;&#x4E32;&#x201D;(&#x5B83;&#x4F1A;&#x5728;&#x5185;&#x90E8;&#x8C03;&#x7528;reset&#x65B9;&#x6CD5;)</p>
</li>
<li>
<p>boolean matches()
&#x6B64;&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x7684;Boolean&#x503C;&#x8868;&#x793A;matcher&#x7684;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x80FD;&#x5426;&#x5B8C;&#x5168;&#x5339;&#x914D;&#x76EE;&#x6807;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x5F53;&#x524D;&#x68C0;
&#x7D22;&#x8303;&#x56F4;&#x7684;&#x90A3;&#x6BB5;&#x6587;&#x672C;.&#x4E5F;&#x5C31;&#x662F;&#x8BF4;,&#x5982;&#x679C;&#x5339;&#x914D;&#x6210;&#x529F;,&#x5339;&#x914D;&#x7684;&#x6587;&#x672C;&#x5FC5;&#x987B;&#x4ECE;&#x68C0;&#x7D22;&#x8303;&#x56F4;&#x7684;&#x5F00;&#x5934;&#x5F00;
&#x59CB; &#xFF0C;&#x5230;&#x68C0;&#x7D22;&#x8303;&#x56F4;&#x7684;&#x7ED3;&#x5C3E;&#x7ED3;&#x675F;(&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x5C31;&#x662F;&#x6574;&#x4E2A;&#x76EE;&#x6807;&#x5B57;&#x7B26;&#x4E32;)</p>
</li>
<li>
<p>boolean lookingAt()
&#x6B64;&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x7684;Boolean&#x503C;&#x8868;&#x793A;Matches&#x7684;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x80FD;&#x5426;&#x5728;&#x5F53;&#x524D;&#x76EE;&#x6807;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x5F53;&#x524D;&#x68C0;
&#x7D22;&#x8303;&#x56F4;&#x4E2D;&#x627E;&#x5230;&#x5339;&#x914D;.&#x5B83;&#x7C7B;&#x4F3C;&#x4E8E;matches&#x65B9;&#x6CD5;,&#x4F46;&#x4E0D;&#x8981;&#x6C42;&#x68C0;&#x7D22;&#x8303;&#x56F4;&#x4E2D;&#x7684;&#x6574;&#x6BB5;&#x6587;&#x672C;&#x90FD;&#x80FD;&#x5339;&#x914D;.</p>
</li>
<li>
<p>String group()
&#x8FD4;&#x56DE;&#x524D;&#x4E00;&#x6B21;&#x5E94;&#x7528;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x7684;&#x5339;&#x914D;&#x6587;&#x672C;</p>
</li>
<li>
<p>Stirng group(int num)
&#x8FD4;&#x56DE;&#x7F16;&#x53F7;&#x4E3A;num&#x7684;&#x6355;&#x83B7;&#x578B;&#x62EC;&#x53F7;&#x5339;&#x914D;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x5982;&#x679C;&#x5BF9;&#x5E94;&#x7684;&#x6355;&#x83B7;&#x578B;&#x62EC;&#x53F7;&#x6CA1;&#x6709;&#x53C2;&#x4E0E;&#x5339;&#x914D;&#xFF0C;&#x5219;
&#x8FD4;&#x56DE; null&#x3002;&#x5982;&#x679C;num&#x4E3A;0&#xFF0C;&#x8868;&#x793A;&#x8FD4;&#x56DE;&#x6574;&#x4E2A;&#x5339;&#x914D;&#x7684;&#x5185;&#x5BB9;&#xFF0C;group(O)&#x5C31;&#x7B49;&#x4E8E;group()</p>
</li>
</ol>
<h3 id="&#x51E0;&#x4E2A;&#x4F8B;&#x5B50;">&#x51E0;&#x4E2A;&#x4F8B;&#x5B50;</h3>
<h4 id="&#x83B7;&#x53D6;&#x8FD4;&#x56DE;&#x7684;&#x6570;&#x636E;">&#x83B7;&#x53D6;&#x8FD4;&#x56DE;&#x7684;&#x6570;&#x636E;</h4>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RegexTest</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        String myTest = <span class="string">&quot;http://localhost:8080/spring/swagger-ui.html&quot;</span>;</span><br><span class="line">        <span class="comment">//&#x6307;&#x5B9A;&#x6355;&#x83B7;&#x7EC4;&#x540D;&#x79F0;&#x4E3A;port</span></span><br><span class="line">        String myRegex = <span class="string">&quot;http://(\\w+)(?&lt;port&gt;:\\d+)&quot;</span>;</span><br><span class="line">        Pattern pattern = Pattern.compile(myRegex);</span><br><span class="line">        </span><br><span class="line">        Matcher matcher = pattern.matcher(myTest);</span><br><span class="line">        <span class="keyword">int</span> groupCount = matcher.groupCount();</span><br><span class="line">        System.out.println(<span class="string">&quot;groupCount = &quot;</span> + groupCount);</span><br><span class="line">        <span class="keyword">if</span>(matcher.find()) {</span><br><span class="line">        	<span class="comment">//&#x8FD4;&#x56DE;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x5339;&#x914D;&#x6587;&#x672C;</span></span><br><span class="line">            System.out.println(matcher.group(<span class="number">0</span>));</span><br><span class="line">            System.out.println(matcher.group(<span class="number">1</span>));</span><br><span class="line">            <span class="comment">//group(2)</span></span><br><span class="line">            System.out.println(matcher.group(<span class="string">&quot;port&quot;</span>));</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">&#x8F93;&#x51FA;&#x5982;&#x4E0B;&#xFF1A;</span><br><span class="line">groupCount = <span class="number">2</span></span><br><span class="line">http:<span class="comment">//localhost:8080</span></span><br><span class="line">localhost</span><br><span class="line">:<span class="number">8080</span></span><br></pre></td></tr></table></figure></p>
<h4 id="&#x975E;&#x6355;&#x83B7;&#x7EC4;&#x83B7;&#x53D6;&#x6570;&#x636E;">&#x975E;&#x6355;&#x83B7;&#x7EC4;&#x83B7;&#x53D6;&#x6570;&#x636E;</h4>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RegexTest</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        String myTest = <span class="string">&quot;http://localhost:8080/spring/swagger-ui.html&quot;</span>;</span><br><span class="line">        <span class="comment">//&#x6CE8;&#x610F;&#x8FD9;&#x91CC;&#x7684;?:</span></span><br><span class="line">        String myRegex = <span class="string">&quot;http://(\\w+)(?::\\d+)&quot;</span>;</span><br><span class="line">        Pattern pattern = Pattern.compile(myRegex);</span><br><span class="line">        </span><br><span class="line">        Matcher matcher = pattern.matcher(myTest);</span><br><span class="line">        <span class="keyword">int</span> groupCount = matcher.groupCount();</span><br><span class="line">        System.out.println(<span class="string">&quot;groupCount = &quot;</span> + groupCount);</span><br><span class="line">        <span class="keyword">if</span>(matcher.find()) {</span><br><span class="line">            System.out.println(matcher.group(<span class="number">0</span>));</span><br><span class="line">            System.out.println(matcher.group(<span class="number">1</span>));</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">&#x8F93;&#x51FA;&#x5982;&#x4E0B;&#xFF1A;</span><br><span class="line">groupCount = <span class="number">1</span></span><br><span class="line">http:<span class="comment">//localhost:8080</span></span><br><span class="line">localhost</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x5206;&#x7EC4;&#x5F15;&#x7528;&#x7684;&#x4F7F;&#x7528;">&#x5206;&#x7EC4;&#x5F15;&#x7528;&#x7684;&#x4F7F;&#x7528;</h4>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">String str = <span class="string">&quot;hello world,hello java&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//&#x8FD9;&#x91CC;&#x7684;$1&#x662F;&#x5BF9;&#x5206;&#x7EC4;&#x7684;&#x5F15;&#x7528;,&#x5982;&#x679C;&#x6539;&#x6210;(?:hello),&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x4F1A;&#x62A5;&#x9519;</span></span><br><span class="line">System.out.println(str.replaceAll(<span class="string">&quot;(hello)&quot;</span>, <span class="string">&quot;$1 my&quot;</span>));</span><br><span class="line"></span><br><span class="line">&#x8F93;&#x51FA;: hello my world,hello my java</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x6570;&#x636E;&#x91CD;&#x7F6E;">&#x6570;&#x636E;&#x91CD;&#x7F6E;</h4>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RegexTest</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        String myTest = <span class="string">&quot;hello java&quot;</span>;</span><br><span class="line">        String myRegex = <span class="string">&quot;\\w+&quot;</span>;</span><br><span class="line">        Pattern pattern = Pattern.compile(myRegex);</span><br><span class="line">        </span><br><span class="line">        Matcher matcher = pattern.matcher(myTest);</span><br><span class="line">       </span><br><span class="line">        <span class="comment">//&#x4E24;&#x884C;&#x6570;&#x636E;</span></span><br><span class="line">        matcher.reset(<span class="string">&quot;hello 1998\r\n hello 2018&quot;</span>);</span><br><span class="line">        matcher.usePattern(Pattern.compile(<span class="string">&quot;\\d+&quot;</span>));</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span>(matcher.find()) {</span><br><span class="line">            System.out.println(matcher.group());</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line">&#x8F93;&#x51FA;&#x5982;&#x4E0B;:</span><br><span class="line"><span class="number">1998</span></span><br><span class="line"><span class="number">2018</span></span><br></pre></td></tr></table></figure></p>
<h4 id="&#x5339;&#x914D;&#x975E;&#x4E2D;&#x6587;&#x6570;&#x636E;">&#x5339;&#x914D;&#x975E;&#x4E2D;&#x6587;&#x6570;&#x636E;</h4>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RegexTest</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        String myTest = <span class="string">&quot;&#x6211;&#x662F;&#x4E2D;&#x56FD;&#x4EBA; I&apos;m chinese&quot;</span>;</span><br><span class="line">        <span class="comment">//&#x53BB;&#x6389;^&#x5339;&#x914D;&#x5230;&#x7684;&#x5C06;&#x662F;&#x4E2D;&#x6587;</span></span><br><span class="line">        String myRegex = <span class="string">&quot;[^\\u4e00-\\u9fa5]+&quot;</span>;</span><br><span class="line">        Pattern pattern = Pattern.compile(myRegex);</span><br><span class="line">        Matcher matcher = pattern.matcher(myTest);</span><br><span class="line">        <span class="keyword">while</span> (matcher.find()) {</span><br><span class="line">            System.out.println(matcher.group());</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line">&#x8F93;&#x51FA;&#x5982;&#x4E0B;:</span><br><span class="line">	I<span class="string">&apos;m chines</span></span><br></pre></td></tr></table></figure></p>
<h4 id="&#x53BB;&#x9664;&#x8FDE;&#x5B57;&#x7B26;">&#x53BB;&#x9664;&#x8FDE;&#x5B57;&#x7B26;</h4>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">String myTest = <span class="string">&quot;&#x6211;&#x8981;&#x8981;&#x5B66;&#x5B66;&#x5B66;Jaaaaaava&quot;</span>;</span><br><span class="line">String myRegex = <span class="string">&quot;(.)\\1+&quot;</span>;</span><br><span class="line">System.out.println(myTest.replaceAll(myRegex, <span class="string">&quot;$1&quot;</span>));</span><br><span class="line"></span><br><span class="line">&#x8F93;&#x51FA;&#x5982;&#x4E0B;:</span><br><span class="line">	&#x6211;&#x8981;&#x5B66;Java</span><br></pre></td></tr></table></figure></p>
]]></content>
    <summary type="html">
    <![CDATA[关于正则表达式的基本使用]]>
    
    </summary>
    
      <category term="java" scheme="http://yoursite.com/tags/java/"/>
    
      <category term="正则表达式" scheme="http://yoursite.com/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    
      <category term="正则表达式" scheme="http://yoursite.com/categories/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[关于GC参数的一个问题]]></title>
    <link href="http://yoursite.com/2016/11/30/about-gc-parameters/"/>
    <id>http://yoursite.com/2016/11/30/about-gc-parameters/</id>
    <published>2016-11-30T13:23:32.000Z</published>
    <updated>2018-10-28T13:16:55.173Z</updated>
    <content type="html"><![CDATA[<h3 id="&#x6211;&#x9047;&#x5230;&#x4E00;&#x4E2A;&#x4E00;&#x4E2A;&#x95EE;&#x9898;">&#x6211;&#x9047;&#x5230;&#x4E00;&#x4E2A;&#x4E00;&#x4E2A;&#x95EE;&#x9898;</h3>
<p>&#x6211;&#x9047;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x95EE;&#x9898;,&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x771F;&#x7684;&#x5F88;&#x96BE;,&#x6211;&#x60F3;&#x8BF4;&#x5728;&#x56FD;&#x5185;&#x53BB;&#x5173;&#x6CE8;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x7684;&#x4EBA;&#x5E94;&#x8BE5;&#x5E76;&#x4E0D;&#x591A;&#xFF0C;&#x81F3;&#x5C11;&#x6211;&#x95EE;&#x4E86;&#x5F88;&#x591A;&#x4EBA;&#x4F46;&#x662F;&#x4ED6;&#x4EEC;&#x5E76;&#x6CA1;&#x6709;&#x53BB;&#x6DF1;&#x7A76;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x4E0D;&#x8FC7;&#x65E2;&#x7136;&#x8BA9;&#x6211;&#x53D1;&#x73B0;&#x4E86;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x90A3;&#x4E48;&#x6211;&#x80AF;&#x5B9A;&#x4E0D;&#x80FD;&#x5E26;&#x7740;&#x7591;&#x60D1;&#x79BB;&#x5F00;&#xFF0C;&#x6211;&#x5FC5;&#x987B;&#x5F97;&#x7559;&#x4E0B;&#x70B9;&#x4EC0;&#x4E48;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x89E3;&#x51B3;&#x4E86;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x7136;&#x540E;&#x5199;&#x4E0B;&#x4E86;&#x8FD9;&#x7BC7;&#x535A;&#x5BA2;&#xFF0C;&#x6211;&#x90FD;&#x4E0D;&#x77E5;&#x9053;&#x5E94;&#x8BE5;&#x600E;&#x4E48;&#x8D5E;&#x7F8E;&#x81EA;&#x5DF1;&#x4E86;,&#x597D;&#x4E86;&#x4E0D;&#x5439;&#x725B;&#x903C;&#x4E86;&#x3002;&#x3002;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x90FD;&#x77E5;&#x9053;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;VM&#x53C2;&#x6570;&#x6765;&#x8BBE;&#x7F6E;&#x5806;&#x7684;&#x5927;&#x5C0F;,&#x901A;&#x8FC7;-Xmx&#x8BBE;&#x7F6E;&#x5806;&#x7684;&#x6700;&#x5927;&#x503C;,-Xms&#x8BBE;&#x7F6E;&#x5806;&#x7684;&#x6700;&#x5C0F;&#x503C;&#x3002;&#x7136;&#x540E;&#x865A;&#x62DF;&#x673A;&#x5728;&#x542F;&#x52A8;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x6839;&#x636E;&#x6211;&#x4EEC;&#x7684;&#x53C2;&#x6570;&#x8FDB;&#x884C;&#x52A8;&#x6001;&#x8C03;&#x6574;&#x3002;&#x4F46;&#x662F;&#x8FD9;&#x5176;&#x4E2D;&#x8FD8;&#x662F;&#x6709;&#x70B9;&#x5C0F;&#x79D8;&#x5BC6;&#x7684;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x5728;&#x672C;&#x5730;&#x8FD0;&#x884C;&#x8FD9;&#x6837;&#x7684;&#x4E00;&#x6BB5;&#x4EE3;&#x7801;:
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//VM Args&#xFF1A;-Xms4m  -Xmx4m -XX:+PrintGCDetails</span></span><br><span class="line">  <span class="annotation">@Test</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">heapOutOfMomory</span><span class="params">()</span> </span>{</span><br><span class="line">    Byte[] b = <span class="keyword">new</span> Byte[<span class="number">1</span>*<span class="number">1024</span>*<span class="number">1024</span>];</span><br><span class="line">  }</span><br></pre></td></tr></table></figure></p>
<p>&#x67E5;&#x770B;&#x6253;&#x5370;&#x51FA;&#x6765;&#x7684;&#x7684;GC&#x4FE1;&#x606F;&#xFF1A;
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[GC [PSYoungGen: <span class="number">2344</span>K-&gt;<span class="number">312</span>K(<span class="number">2368</span>K)] <span class="number">2910</span>K-&gt;<span class="number">1477</span>K(<span class="number">5120</span>K), <span class="number">0.0083535</span> secs] [Times: user=<span class="number">0.05</span> sys=<span class="number">0.00</span>, real=<span class="number">0.01</span> secs] </span><br><span class="line">Heap</span><br><span class="line"> PSYoungGen      total <span class="number">2368</span>K, used <span class="number">1830</span>K [<span class="number">0x00000000ffd60000</span>, <span class="number">0x0000000100000000</span>, <span class="number">0x0000000100000000</span>)</span><br><span class="line">  eden space <span class="number">2048</span>K, <span class="number">74</span>% used [<span class="number">0x00000000ffd60000</span>,<span class="number">0x00000000ffedb9d8</span>,<span class="number">0x00000000fff60000</span>)</span><br><span class="line">  from space <span class="number">320</span>K, <span class="number">97</span>% used [<span class="number">0x00000000fffb0000</span>,<span class="number">0x00000000ffffe010</span>,<span class="number">0x0000000100000000</span>)</span><br><span class="line">  to   space <span class="number">320</span>K, <span class="number">0</span>% used [<span class="number">0x00000000fff60000</span>,<span class="number">0x00000000fff60000</span>,<span class="number">0x00000000fffb0000</span>)</span><br><span class="line"> ParOldGen       total <span class="number">5504</span>K, used <span class="number">5261</span>K [<span class="number">0x00000000ff800000</span>, <span class="number">0x00000000ffd60000</span>, <span class="number">0x00000000ffd60000</span>)</span><br><span class="line">  object space <span class="number">5504</span>K, <span class="number">95</span>% used [<span class="number">0x00000000ff800000</span>,<span class="number">0x00000000ffd23760</span>,<span class="number">0x00000000ffd60000</span>)</span><br><span class="line"> PSPermGen       total <span class="number">21248</span>K, used <span class="number">5716</span>K [<span class="number">0x00000000fa600000</span>, <span class="number">0x00000000fbac0000</span>, <span class="number">0x00000000ff800000</span>)</span><br><span class="line">  object space <span class="number">21248</span>K, <span class="number">26</span>% used [<span class="number">0x00000000fa600000</span>,<span class="number">0x00000000fab95308</span>,<span class="number">0x00000000fbac0000</span>)</span><br></pre></td></tr></table></figure></p>
<p>&#x53D1;&#x73B0;&#x4E86;&#x5427;&#xFF01;&#x5806;&#x7684;&#x5927;&#x5C0F;&#x662F;5504(ParOldGen)+320(from)+320(to)+2048(eden) = 8192(8M),&#x867D;&#x7136;&#x6211;&#x4EEC;&#x8BBE;&#x7F6E;&#x7684;&#x662F;4M,&#x4F46;&#x662F;&#x5B9E;&#x9645;&#x4E0A;&#x5374;&#x662F;8M?&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x4E3A;&#x4EC0;&#x4E48;&#x4E86;?&#x6211;&#x4EEC;&#x7684;&#x53C2;&#x6570;&#x6CA1;&#x6709;&#x8D77;&#x4F5C;&#x7528;?</p>
<h3 id="&#x548C;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x6709;&#x5173;&#x7684;vm">&#x548C;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x6709;&#x5173;&#x7684;VM</h3>
<p>&#x6211;&#x4EEC;&#x5148;&#x770B;&#x4E00;&#x4E2A;&#x56FE;,&#x5982;&#x56FE;&#x6240;&#x793A;64&#x4F4D;&#x7684;windows&#x7CFB;&#x7EDF;&#x662F;Server&#x6A21;&#x5F0F;,&#x800C;&#x5176;&#x9ED8;&#x8BA4;&#x7684;&#x6536;&#x96C6;&#x5668;&#x662F;parallel scavenge&#x3002;
<img src="/images/default_server.png" alt="&#x4E0D;&#x540C;&#x7CFB;&#x7EDF;&#x4E0B;&#x7684;server"></p>
<p>&#x4E3A;&#x4EC0;&#x4E48;&#x8FD9;&#x4E2A;&#x6536;&#x96C6;&#x5668;&#x5C31;&#x8FD9;&#x4E48;&#x795E;&#x5947;&#x5462;&#xFF1F;&#x7ECF;&#x8FC7;&#x6211;&#x7684;&#x63A2;&#x7D22;&#x53D1;&#x73B0;
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">The problem is os::page_size_for_region, in particular the <span class="operator"><span class="keyword">check</span>: </span><br><span class="line"><span class="keyword">if</span> ((region_min_size &amp; <span class="keyword">mask</span>) == <span class="number">0</span> &amp;&amp; (region_max_size &amp; <span class="keyword">mask</span>) == <span class="number">0</span>) </span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> page_size_for_region <span class="keyword">is</span> called <span class="keyword">with</span> min_region_size <span class="keyword">and</span> max_region_size that <span class="keyword">are</span> a multiple <span class="keyword">of</span> a page <span class="keyword">size</span> larger <span class="keyword">than</span> <span class="keyword">than</span> max_page_size, <span class="keyword">then</span> page_size_for_region will <span class="keyword">return</span> that page. </span><br><span class="line"></span><br><span class="line">This problem manifests itself <span class="keyword">on</span> Solaris <span class="keyword">using</span> <span class="keyword">large</span> pages. Solaris will <span class="keyword">use</span> a page <span class="keyword">size</span> <span class="keyword">of</span> <span class="number">2</span> MB. <span class="keyword">If</span> -Xmx4m <span class="keyword">is</span> used, <span class="keyword">then</span> GenerationSizer::initialize_size_info will <span class="keyword">call</span> page_size_for_region(<span class="number">4</span>MB, <span class="number">4</span>MB, <span class="number">8</span> <span class="comment">/* min_pages*/</span>). Since <span class="number">4</span>MB <span class="keyword">is</span> a multiple <span class="number">2</span>MB, page_size_for_region will <span class="keyword">return</span> <span class="number">2</span>MB. The bug <span class="keyword">is</span> that we ask <span class="keyword">for</span> <span class="keyword">at</span> <span class="keyword">least</span> <span class="number">8</span> pages, which would <span class="keyword">limit</span> the page <span class="keyword">size</span> <span class="keyword">to</span> <span class="number">4</span>MB/<span class="number">8</span> = <span class="number">0.5</span>MB (<span class="number">512</span> KB). Since <span class="keyword">parallel</span> scavenge needs <span class="keyword">at</span> <span class="keyword">least</span> <span class="number">4</span> pages, we <span class="keyword">get</span> a <span class="keyword">heap</span> <span class="keyword">size</span> <span class="number">4</span> * <span class="number">2</span>MB = <span class="number">8</span>MB, even though the <span class="keyword">user</span> specified -Xmx4m!</span></span><br></pre></td></tr></table></figure></p>
<p>&#x4E8B;&#x60C5;&#x5F53;&#x7136;&#x4E0D;&#x4F1A;&#x5230;&#x4E86;&#x8FD9;&#x91CC;&#x5C31;&#x7ED3;&#x675F;&#x3002;&#x6211;&#x4EEC;&#x77E5;&#x9053;-XX:SurvivorRatio&#x8868;&#x793A;Eden&#x533A;&#x4E0E;Survivor&#x533A;&#x7684;&#x5927;&#x5C0F;&#x6BD4;&#x503C;&#xFF0C;&#x9ED8;&#x8BA4;&#x662F;8&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;eden:from=8&#xFF0C;&#x4F46;&#x662F;&#x5F88;&#x660E;&#x663E;&#x6211;&#x4EEC;&#x6253;&#x5370;&#x51FA;&#x6765;&#x7684;&#x4FE1;&#x606F;&#x5E76;&#x4E0D;&#x662F;&#x8FD9;&#x6837;,2048:320=6,&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;8&#x54EA;&#x91CC;&#x6765;&#x7684;&#x5462;&#xFF1F;&#x987F;&#x65F6;&#x6211;&#x53C8;&#x5D29;&#x6E83;&#x4E86;,&#x8FD8;&#x597D;&#x7ECF;&#x8FC7;&#x6211;&#x4E0D;&#x7BA1;&#x7684;&#x67E5;&#x627E;&#x8D44;&#x6599;&#xFF0C;&#x7FFB;&#x770B;JDK&#x6E90;&#x7801;,&#x53D1;&#x73B0;&#x4E86;&#x539F;&#x6765;&#x662F;&#x662F;&#x8FD9;&#x6837;&#x7684;
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// The survivor ratio&apos;s are calculated &quot;raw&quot;, unlike the</span></span><br><span class="line">    <span class="comment">// default gc, which adds 2 to the ratio value. We need to</span></span><br><span class="line">    <span class="comment">// make sure the values are valid before using them.</span></span><br><span class="line">    <span class="keyword">if</span> (MinSurvivorRatio &lt; <span class="number">3</span>) {</span><br><span class="line">      MinSurvivorRatio = <span class="number">3</span>;</span><br><span class="line">    }</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x8D44;&#x6599;<a href="https://searchcode.com/codesearch/view/17980811/" target="_blank" rel="external">parallelScavenge&#x4E2D;GenerationSize</a></p>
<p>&#x4F60;&#x4EE5;&#x4E3A;&#x5230;&#x4E86;&#x8FD9;&#x91CC;&#x95EE;&#x9898;&#x5C31;&#x5B8C;&#x4E86;&#x5417;&#xFF1F;&#x6211;&#x544A;&#x8BC9;&#x4F60;&#x5E76;&#x6CA1;&#x6709;&#x3002;</p>
<h3 id="&#x89E3;&#x51B3;&#x4E00;&#x4E2A;&#x95EE;&#x9898;">&#x89E3;&#x51B3;&#x4E00;&#x4E2A;&#x95EE;&#x9898;</h3>
<p>&#x6211;&#x9047;&#x5230;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x7684;&#x65F6;&#x5019;&#x6211;&#x4E5F;&#x662F;&#x5F88;&#x5D29;&#x6E83;&#x7684;,&#x6211;&#x5148;&#x662F;&#x7FFB;&#x9605;&#x4E66;&#x7C4D;&#xFF0C;&#x7136;&#x540E;&#x53D1;&#x73B0;&#x6CA1;&#x6709;&#xFF0C;&#x7136;&#x540E;&#x4E3A;&#x7FA4;&#x53CB;&#xFF0C;&#x53BB;&#x793E;&#x533A;&#x63D0;&#x95EE;&#x9898;&#xFF0C;&#x8FD8;&#x662F;&#x6CA1;&#x6709;&#x80FD;&#x591F;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x4F46;&#x662F;&#x6211;&#x662F;&#x8C01;&#x5440;&#xFF01;&#x6211;&#x6CA1;&#x6709;&#x653E;&#x5F03;&#xFF0C;&#x6CA1;&#x6709;&#x5F97;&#x8FC7;&#x8D77;&#x8FC7;&#xFF0C;&#x6211;&#x8FD8;&#x548C;&#x4F60;&#x8017;&#x4E0A;&#x4E86;&#x3002;&#x7136;&#x540E;&#x6211;&#x53BB;&#x7FFB;&#x9605;&#x5B98;&#x65B9;&#x6587;&#x6863;&#xFF0C;&#x7136;&#x540E;&#x8BA9;&#x6211;&#x53D1;&#x73B0;&#x4E86;&#x8FD9;&#x4E2A;client&#x548C;server&#x7AEF;&#x7684;&#x533A;&#x522B;&#xFF0C;&#x662F;&#x7684;&#x4E4B;&#x524D;&#x6211;&#x6CA1;&#x6709;&#x53D1;&#x73B0;&#x8FD9;&#x4E2A;&#x3002;&#x7136;&#x540E;&#x5B98;&#x65B9;&#x6587;&#x6863;&#x4E0A;&#x6CA1;&#x63A5;&#x7740;&#x8BF4;&#x8FD9;&#x4E9B;&#x7EC6;&#x8282;&#xFF0C;&#x7136;&#x540E;&#x6211;&#x5C31;&#x53BB;&#x627E;&#x6E90;&#x7801;&#x5440;&#xFF01;&#x6211;&#x770B;&#x4EBA;&#x5BB6;&#x6E90;&#x7801;&#x600E;&#x4E48;&#x8BF4;&#x7684;&#x5440;&#xFF0C;&#x8FD9;&#x6837;&#x4E00;&#x5C42;&#x4E00;&#x5C42;&#x627E;&#x4E0B;&#x6765;&#xFF0C;&#x6700;&#x7EC8;&#x95EE;&#x9898;&#x89E3;&#x51B3;&#x4E86;&#x3002;</p>
<p>&#x867D;&#x7136;&#x73B0;&#x5728;&#x770B;&#x6765;&#x6211;&#x5199;&#x51FA;&#x6765;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x771F;&#x7684;&#x5F88;&#x5C0F;&#xFF0C;&#x53EF;&#x662F;&#x5728;&#x627E;&#x95EE;&#x9898;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x786E;&#x5B9E;&#x82B1;&#x8D39;&#x4E86;&#x5F88;&#x591A;&#x4E8B;&#x4EF6;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x4E5F;&#x953B;&#x70BC;&#x4E86;&#x6211;&#x89E3;&#x51B3;&#x95EE;&#x9898;&#x7684;&#x601D;&#x7EF4;&#x3002;</p>
<p>&#x6211;&#x7684;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<ol>
<li>&#x786E;&#x5B9A;&#x662F;&#x81EA;&#x5DF1;&#x914D;&#x7F6E;&#x4E0D;&#x5BF9;&#x8FD8;&#x662F;&#x81EA;&#x5DF1;&#x7406;&#x89E3;&#x6709;&#x8BEF;</li>
<li>&#x5728;1&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x5B9A;&#x4F4D;&#x95EE;&#x9898;&#x89E3;&#x51B3;&#x65B9;&#x5411;&#x662F;&#x5BFB;&#x627E;&#x5B98;&#x65B9;&#x6587;&#x6863;&#x8FD8;&#x662F;&#x52A0;&#x6DF1;&#x7406;&#x89E3;</li>
<li>&#x627E;&#x7B54;&#x6848;&#xFF0C;&#x505A;&#x5B9E;&#x9A8C;&#x3002;</li>
</ol>
<h3 id="&#x53C2;&#x8003;&#x6587;&#x6863;">&#x53C2;&#x8003;&#x6587;&#x6863;</h3>
<ol>
<li>http://docs.oracle.com/javase/7/docs/technotes/guides/vm/server-class.html</li>
<li>http://www.oracle.com/technetwork/java/javase/gc-tuning-6-140523.html</li>
<li>http://www.oracle.com/technetwork/java/faq-140837.html</li>
<li>https://bugs.openjdk.java.net/browse/JDK-4484370</li>
<li>https://bugs.openjdk.java.net/browse/JDK-8027915</li>
<li>https://searchcode.com/codesearch/view/17980811/</li>
</ol>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="&#x6211;&#x9047;&#x5230;&#x4E00;&#x4E2A;&#x4E00;&#x4E2A;&#x95EE;&#x9898;">&#x6211;&#x9047;&#x5230;&#x4E00;&#x4E2A;&#x4E00;&#x4E2A;&#]]>
    </summary>
    
      <category term="java" scheme="http://yoursite.com/tags/java/"/>
    
      <category term="java" scheme="http://yoursite.com/categories/java/"/>
    
      <category term="jvm" scheme="http://yoursite.com/categories/java/jvm/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[从OutOfMemory开始]]></title>
    <link href="http://yoursite.com/2016/10/31/start-with-OutOfMemory/"/>
    <id>http://yoursite.com/2016/10/31/start-with-OutOfMemory/</id>
    <published>2016-10-31T12:57:56.000Z</published>
    <updated>2018-10-28T13:17:05.176Z</updated>
    <content type="html"><![CDATA[<p>&#x6211;&#x4EEC;&#x6765;&#x770B;&#x4E00;&#x4E0B;&#x4E0B;&#x9762;&#x8FD9;&#x6BB5;&#x5F02;&#x5E38;&#x4FE1;&#x606F;
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java.lang.OutOfMemoryError: Java heap space</span><br><span class="line">    at test.OutofMemoryTest.heapOutOfMomory(OutofMemoryTest.java:<span class="number">27</span>)</span><br></pre></td></tr></table></figure></p>
<p>&#x770B;&#x89C1;&#x4E0A;&#x9762;&#x7684;&#x8FD9;&#x6BB5;&#x9519;&#x8BEF;&#x4FE1;&#x606F;&#x662F;&#x4E0D;&#x662F;&#x5F88;&#x719F;&#x6089;,&#x7ECF;&#x5E38;&#x6211;&#x4EEC;&#x5728;&#x7F16;&#x5199;&#x4EE3;&#x7801;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x4F1A;&#x9047;&#x5230;&#x8FD9;&#x6837;&#x7684;&#x9519;&#x8BEF;,&#x90A3;&#x4E48;&#x5F15;&#x8D77;&#x8FD9;&#x4E2A;&#x9519;&#x8BEF;&#x7684;&#x539F;&#x56E0;&#x6709;&#x54EA;&#x4E9B;&#x5462;&#xFF1F;&#x53C8;&#x6709;&#x54EA;&#x4E9B;&#x7C7B;&#x578B;&#x7684;OutOfMemory&#x5462;&#xFF1F;</p>
<p>&#x6211;&#x4EEC;&#x77E5;&#x9053;JVM&#x8FD0;&#x884C;&#x65F6;&#x6570;&#x636E;&#x533A;&#x57DF;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A;
<img src="/images/thread-java-running-data-area.png" alt="JVM&#x8FD0;&#x884C;&#x65F6;&#x533A;&#x57DF;">
&#x5728;JVM&#x89C4;&#x8303;&#x7684;&#x63CF;&#x8FF0;&#x4E2D;,&#x9664;&#x4E86;&#x7A0B;&#x5E8F;&#x8BA1;&#x6570;&#x5668;&#x4E4B;&#x5916;,&#x865A;&#x62DF;&#x673A;&#x5185;&#x5B58;&#x7684;&#x5176;&#x4ED6;&#x51E0;&#x4E2A;&#x8FD0;&#x884C;&#x65F6;&#x533A;&#x57DF;&#x90FD;&#x6709;&#x53D1;&#x751F;OutOfMemoryError&#x5F02;&#x5E38;&#x7684;&#x53EF;&#x80FD;&#x3002;</p>
<h3 id="java&#x5806;&#x6EA2;&#x51FA;">Java&#x5806;&#x6EA2;&#x51FA;</h3>
<p>&#x6211;&#x4EEC;&#x770B;&#x770B;&#x5BFC;&#x81F4;&#x4EE5;&#x4E0B;&#x8FD9;&#x6BB5;&#x5BFC;&#x81F4;&#x6587;&#x7AE0;&#x5F00;&#x5934;&#x90A3;&#x6BB5;&#x5F02;&#x5E38;&#x4FE1;&#x606F;&#x7684;&#x4EE3;&#x7801;
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Test</span></span><br><span class="line"><span class="comment">//VM Args&#xFF1A;-Xms10m  -Xmx10m -XX:+HeapDumpOnOutOfMemoryError</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">heapOutOfMomory</span><span class="params">()</span> </span>{</span><br><span class="line">    Byte[] b = <span class="keyword">new</span> Byte[<span class="number">20</span>*<span class="number">1024</span>*<span class="number">1024</span>];</span><br><span class="line">  }</span><br></pre></td></tr></table></figure></p>
<p>&#x4EE3;&#x7801;&#x5176;&#x5B9E;&#x5F88;&#x7B80;&#x5355;,&#x4F46;&#x662F;&#x4E3A;&#x4EC0;&#x4E48;&#x4F1A;&#x5BFC;&#x81F4;OutOfMemoryError&#x5462;&#xFF1F;&#x539F;&#x56E0;&#x662F;&#x6211;&#x4EEC;&#x8BBE;&#x7F6E;&#x4E86;&#x5806;&#x7684;&#x5927;&#x5C0F;&#x4E3A;10M(&#x901A;&#x8FC7;-Xmx&#x8BBE;&#x7F6E;&#x5806;&#x7684;&#x6700;&#x5927;&#x503C;,-Xms&#x8BBE;&#x7F6E;&#x5806;&#x7684;&#x6700;&#x5C0F;&#x503C;),&#x800C;&#x6211;&#x4EEC;&#x5728;&#x4EE3;&#x7801;&#x4E2D;&#x5374;&#x7533;&#x8BF7;&#x4E86;20M&#x7684;&#x7A7A;&#x95F4;,&#x6240;&#x4EE5;&#x4F1A;&#x5BFC;&#x81F4;&#x629B;&#x51FA;OutOfMemoryError&#x3002;&#x6B64;&#x79CD;&#x95EE;&#x9898;&#x4E00;&#x822C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8BBE;&#x7F6E;-XX:+HeapDumpOnOutOfMemoryError&#x53C2;&#x6570;&#x8BA9;&#x865A;&#x62DF;&#x673A;&#x5728;&#x51FA;&#x73B0;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#x5F02;&#x5E38;&#x65F6;Dump&#x51FA;&#x5F53;&#x524D;&#x7684;&#x5185;&#x5B58;&#x5806;&#x8F6C;&#x50A8;&#x5FEB;&#x7167;&#x4EE5;&#x4FBF;&#x4E8B;&#x540E;&#x8FDB;&#x884C;&#x5206;&#x6790;(&#x5F53;&#x7136;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;java&#x81EA;&#x5E26;&#x7684;jmap&#x547D;&#x4EE4;&#x4EE5;&#x53CA;jstat&#x547D;&#x4EE4;&#x8054;&#x5408;&#x67E5;&#x770B;,&#x4E5F;&#x53EF;&#x901A;&#x8FC7;Eclipse Memory Analyzer&#x8FDB;&#x884C;&#x5206;&#x6790;)&#x3002;</p>
<h3 id="&#x865A;&#x62DF;&#x673A;&#x6808;&#x548C;&#x672C;&#x5730;&#x65B9;&#x6CD5;&#x6808;&#x6EA2;&#x51FA;">&#x865A;&#x62DF;&#x673A;&#x6808;&#x548C;&#x672C;&#x5730;&#x65B9;&#x6CD5;&#x6808;&#x6EA2;&#x51FA;</h3>
<p>&#x7531;&#x4E8E;&#x865A;&#x62DF;&#x673A;&#x5E76;&#x4E0D;&#x533A;&#x5206;&#x865A;&#x62DF;&#x673A;&#x6808;&#x548C;&#x672C;&#x5730;&#x65B9;&#x6CD5;&#x6808;,&#x56E0;&#x6B64;&#x5BF9;&#x4E8E;HotSpot&#x6765;&#x8BF4;,&#x867D;&#x7136;-Xoss&#x53C2;&#x6570;(&#x8BBE;&#x7F6E;&#x672C;&#x5730;&#x65B9;&#x6CD5;&#x6808;&#x5927;&#x5C0F;)&#x5B58;&#x5728;,&#x4F46;&#x662F;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x65E0;&#x6548;&#x7684;,&#x6808;&#x5BB9;&#x91CF;&#x53EA;&#x80FD;&#x7531;-Xss&#x53C2;&#x6570;&#x8BBE;&#x5B9A;&#x3002;&#x5173;&#x4E8E;&#x865A;&#x62DF;&#x673A;&#x6808;&#x548C;&#x672C;&#x5730;&#x65B9;&#x6CD5;&#x6808;,&#x5728;Java&#x865A;&#x62DF;&#x673A;&#x89C4;&#x8303;&#x4E2D;&#x63CF;&#x8FF0;&#x4E86;&#x4E24;&#x79CD;&#x5F02;&#x5E38;&#xFF1A;</p>
<ol>
<li>&#x5982;&#x679C;&#x7EBF;&#x7A0B;&#x8BF7;&#x6C42;&#x7684;&#x7684;&#x6808;&#x6DF1;&#x5EA6;&#x5927;&#x4E8E;&#x865A;&#x62DF;&#x673A;&#x6240;&#x5141;&#x8BB8;&#x7684;&#x6700;&#x5927;&#x6DF1;&#x5EA6;,&#x5C06;&#x629B;&#x51FA;StackOverflowError&#x5F02;&#x5E38;</li>
<li>&#x5982;&#x679C;&#x865A;&#x62DF;&#x673A;&#x5728;&#x6269;&#x5C55;&#x6808;&#x65F6;&#x65E0;&#x6CD5;&#x7533;&#x8BF7;&#x5230;&#x8DB3;&#x591F;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;,&#x5219;&#x629B;&#x51FA;OutOfMemoryError&#x5F02;&#x5E38;&#x3002;</li>
</ol>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OutofMemoryTest</span> </span>{</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> statckLen = <span class="number">1</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">statckLeak</span><span class="params">()</span> </span>{</span><br><span class="line">    statckLen ++;</span><br><span class="line">    statckLeak();</span><br><span class="line">  }</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">    OutofMemoryTest test = <span class="keyword">new</span> OutofMemoryTest();</span><br><span class="line">    <span class="keyword">try</span> {</span><br><span class="line">      test.statckLeak();</span><br><span class="line">    } <span class="keyword">catch</span> (Throwable e) {</span><br><span class="line">      System.out.println(<span class="string">&quot;stack length = &quot;</span> + test.statckLen);</span><br><span class="line">      <span class="keyword">throw</span> e;</span><br><span class="line">    }</span><br><span class="line">  }</span><br></pre></td></tr></table></figure></p>
<p>&#x5728;&#x8FD0;&#x884C;&#x8FC7;&#x7A0B;&#x4E2D;&#x8BBE;&#x7F6E;&#x4E86;-Xss128K(&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x503C;&#x8BBE;&#x7F6E;&#x592A;&#x5C0F;&#x5C31;&#x4F1A;&#x63D0;&#x793A;The stack size specified is too small, Specify at least 104k),&#x7A0B;&#x5E8F;&#x629B;&#x51FA;&#x7684;&#x5F02;&#x5E38;&#x4FE1;&#x606F;&#x4E3A;:
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">stack length = <span class="number">990</span></span><br><span class="line">Exception <span class="keyword">in</span> thread <span class="string">&quot;main&quot;</span> java<span class="class">.lang</span><span class="class">.StackOverflowError</span></span><br><span class="line">    at test<span class="class">.OutofMemoryTest</span><span class="class">.statckLeak</span>(OutofMemoryTest<span class="class">.java</span>:<span class="number">41</span>)</span><br></pre></td></tr></table></figure></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x8FD9;&#x91CC;&#x5E76;&#x6CA1;&#x6709;&#x629B;&#x51FA;OutOfMemoryError,&#x5F88;&#x660E;&#x663E;,&#x5728;&#x5355;&#x7EBF;&#x7A0B;&#x60C5;&#x51B5;&#x4E0B;,&#x65E0;&#x8BBA;&#x662F;&#x6808;&#x5E27;&#x592A;&#x5927;&#x8FD8;&#x662F;&#x865A;&#x62DF;&#x673A;&#x5BB9;&#x91CF;&#x592A;&#x5C0F;,&#x5F53;&#x5185;&#x5B58;&#x65E0;&#x6CD5;&#x5206;&#x914D;&#x7684;&#x65F6;&#x5019;,&#x865A;&#x62DF;&#x673A;&#x629B;&#x51FA;&#x7684;&#x90FD;&#x662F;StackOverflowError&#x5F02;&#x5E38;&#x3002;
&#x5982;&#x679C;&#x6D4B;&#x8BD5;&#x4E0D;&#x9650;&#x4E8E;&#x5355;&#x7EBF;&#x7A0B;&#x5462;&#xFF1F;&#x901A;&#x8FC7;&#x4E0D;&#x65AD;&#x5EFA;&#x7ACB;&#x7EBF;&#x7A0B;&#x7684;&#x65B9;&#x5F0F;&#x5012;&#x662F;&#x53EF;&#x4EE5;&#x4EA7;&#x751F;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#x5F02;&#x5E38;&#x3002;
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//VM Args&#xFF1A;-Xss20M -Xmx7168M -Xms7168M -XX:MaxPermSize1024M -XX:PermSize1024M</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">statckLeakByThread</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">while</span>(<span class="keyword">true</span>) {</span><br><span class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() {</span><br><span class="line">            </span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>{</span><br><span class="line">                <span class="keyword">while</span>(<span class="keyword">true</span>) {</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }).start();</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD0;&#x884C;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x6781;&#x5BB9;&#x6613;&#x4F7F;&#x5F97;&#x7535;&#x8111;&#x5361;&#x6B7B;,&#x9700;&#x8981;&#x5C24;&#x5176;&#x6CE8;&#x610F;,&#x5728;&#x6211;&#x7684;&#x6D4B;&#x8BD5;&#x73AF;&#x5883;&#x4E2D;&#x629B;&#x51FA;&#x7684;&#x5F02;&#x5E38;&#x4FE1;&#x606F;&#x5982;&#x4E0B;:
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">java<span class="class">.lang</span><span class="class">.OutOfMemoryError</span>: unable to create new native thread</span><br><span class="line">    at java<span class="class">.lang</span><span class="class">.Thread</span><span class="class">.start0</span>(Native Method)</span><br><span class="line">    at java<span class="class">.lang</span><span class="class">.Thread</span><span class="class">.start</span>(Unknown Source)</span><br><span class="line">    at com<span class="class">.think</span><span class="class">.base</span><span class="class">.OutOfMemoryTest</span><span class="class">.stackLeak</span>(OutOfMemoryTest<span class="class">.java</span>:<span class="number">40</span>)</span><br></pre></td></tr></table></figure></p>
<p>&#x4F46;&#x662F;&#x8FD9;&#x6837;&#x4EA7;&#x751F;&#x7684;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#x5F02;&#x5E38;&#x4E0E;&#x6808;&#x7A7A;&#x95F4;&#x662F;&#x5426;&#x8DB3;&#x591F;&#x5927;&#x5E76;&#x4E0D;&#x5B58;&#x5728;&#x4EFB;&#x4F55;&#x8054;&#x7CFB;,&#x6216;&#x8005;&#x53EF;&#x4EE5;&#x8FD9;&#x6837;&#x8BF4;,&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;,&#x4E3A;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x7684;&#x6808;&#x5206;&#x914D;&#x7684;&#x5185;&#x5B58;&#x8D8A;&#x5927;,&#x53CD;&#x800C;&#x8D8A;&#x5BB9;&#x6613;&#x4EA7;&#x751F;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#x5F02;&#x5E38;&#x3002;&#x5176;&#x5B9E;&#x539F;&#x56E0;&#x5F88;&#x7B80;&#x5355;,&#x56E0;&#x4E3A;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5206;&#x914D;&#x7ED9;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x5185;&#x5B58;&#x662F;&#x6709;&#x9650;&#x5236;&#x7684;,&#x6BD4;&#x5982;32&#x4F4D;&#x7684;windows&#x9650;&#x5236;&#x4E3A;2G(&#x5B9E;&#x9645;&#x4E0A;&#x6211;&#x4EEC;&#x5728;&#x4F7F;&#x7528;&#x7684;&#x65F6;&#x5019;&#x8BBE;&#x7F6E;-Xmx&#x5E76;&#x4E0D;&#x80FD;&#x8BBE;&#x7F6E;&#x4E3A;2G,&#x4E00;&#x822C;&#x53EA;&#x6709;1.5G),&#x51CF;&#x53BB;Xmx(&#x6700;&#x5927;&#x5806;&#x5BB9;&#x91CF;),&#x5728;&#x51CF;&#x53BB;MaxPermSize(&#x6700;&#x5927;&#x65B9;&#x6CD5;&#x533A;&#x5BB9;&#x91CF;),&#x7A0B;&#x5E8F;&#x8BA1;&#x6570;&#x5668;&#x6D88;&#x8017;&#x5185;&#x5B58;&#x5F88;&#x5C0F;,&#x5FFD;&#x7565;&#x4E0D;&#x8BA1;,&#x5982;&#x679C;&#x865A;&#x62DF;&#x673A;&#x672C;&#x8EAB;&#x8017;&#x8D39;&#x7684;&#x5185;&#x5B58;&#x4E0D;&#x8BA1;&#x7B97;&#x5728;&#x5185;,&#x90A3;&#x4E48;&#x5269;&#x4E0B;&#x7684;&#x5C31;&#x7531;&#x865A;&#x62DF;&#x673A;&#x6808;&#x548C;&#x672C;&#x5730;&#x65B9;&#x6CD5;&#x6808;&#x74DC;&#x5206;&#x4E86;&#x3002;&#x56E0;&#x6B64;&#x5982;&#x679C;&#x662F;&#x7531;&#x4E8E;&#x5EFA;&#x7ACB;&#x8FC7;&#x591A;&#x7EBF;&#x7A0B;&#x5BFC;&#x81F4;&#x7684;&#x5185;&#x5B58;&#x6EA2;&#x51FA;,&#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x51CF;&#x5C11;&#x6700;&#x5927;&#x5806;&#x548C;&#x51CF;&#x5C11;&#x6808;&#x5BB9;&#x91CF;&#x6765;&#x83B7;&#x53D6;&#x66F4;&#x591A;&#x7684;&#x7EBF;&#x7A0B;&#x3002;</p>
<h3 id="&#x65B9;&#x6CD5;&#x533A;&#x548C;&#x8FD0;&#x884C;&#x65F6;&#x5E38;&#x91CF;&#x6C60;&#x6EA2;&#x51FA;">&#x65B9;&#x6CD5;&#x533A;&#x548C;&#x8FD0;&#x884C;&#x65F6;&#x5E38;&#x91CF;&#x6C60;&#x6EA2;&#x51FA;</h3>
<h4 id="&#x8FD0;&#x884C;&#x65F6;&#x5E38;&#x91CF;&#x6C60;&#x5BFC;&#x81F4;&#x7684;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#x5F02;&#x5E38;">&#x8FD0;&#x884C;&#x65F6;&#x5E38;&#x91CF;&#x6C60;&#x5BFC;&#x81F4;&#x7684;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#x5F02;&#x5E38;</h4>
<p>&#x5982;&#x679C;&#x5728;JDK6&#x7684;&#x73AF;&#x5883;&#x4E0B;&#x5199;&#x4E0B;&#x5982;&#x4E0B;&#x7684;&#x4EE3;&#x7801;,&#x90A3;&#x4E48;&#x4F1A;&#x629B;&#x51FA;OutOfMemoryError: PermGen space&#x8FD9;&#x6837;&#x7684;&#x9519;&#x8BEF;&#x4FE1;&#x606F;&#x3002;
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//VM Args&#xFF1A;-XX:PermSize=10M -XX:MaxPermSize=10M</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">    <span class="comment">// &#x4F7F;&#x7528;List&#x4FDD;&#x6301;&#x7740;&#x5E38;&#x91CF;&#x6C60;&#x5F15;&#x7528;,&#x907F;&#x514D;Full GC&#x56DE;&#x6536;&#x5E38;&#x91CF;&#x6C60;&#x884C;&#x4E3A;</span></span><br><span class="line">    List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">    <span class="comment">// 10MB&#x7684;PermSize&#x5728;integer&#x8303;&#x56F4;&#x5185;&#x8DB3;&#x591F;&#x4EA7;&#x751F;OOM&#x4E86;</span></span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>; </span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">true</span>) {</span><br><span class="line">        list.add(String.valueOf(i++).intern());</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x800C;&#x4F7F;&#x7528;JDK7&#x5C31;&#x4E0D;&#x4F1A;&#x51FA;&#x73B0;&#x8FD9;&#x6837;&#x7684;&#x95EE;&#x9898;,&#x56E0;&#x4E3A;&#x5728;JDK6&#x7684;intern()&#x65B9;&#x6CD5;&#x4F1A;&#x628A;&#x9996;&#x6B21;&#x9047;&#x5230;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5B9E;&#x4F8B;&#x590D;&#x5236;&#x5230;&#x6C38;&#x4E45;&#x5E26;&#x4E2D;,&#x8FD4;&#x56DE;&#x7684;&#x4E5F;&#x662F;&#x6C38;&#x4E45;&#x5E26;&#x4E2D;&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x5B9E;&#x4F8B;&#x7684;&#x5F15;&#x7528;&#x3002;&#x800C;JDK7&#x7684;intern()&#x5B9E;&#x73B0;&#x4E0D;&#x4F1A;&#x518D;&#x590D;&#x5236;&#x5B9E;&#x4F8B;,&#x53EA;&#x662F;&#x5728;&#x5E38;&#x91CF;&#x6C60;&#x4E2D;&#x8BB0;&#x5F55;&#x9996;&#x6B21;&#x51FA;&#x73B0;&#x7684;&#x5B9E;&#x4F8B;&#x5F15;&#x7528;&#x3002;</p>
<h4 id="&#x65B9;&#x6CD5;&#x533A;&#x51FA;&#x73B0;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#x5F02;&#x5E38;">&#x65B9;&#x6CD5;&#x533A;&#x51FA;&#x73B0;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#x5F02;&#x5E38;</h4>
<p>&#x6211;&#x4EEC;&#x77E5;&#x9053;&#x65B9;&#x6CD5;&#x533A;&#x7528;&#x4E8E;&#x5B58;&#x653E;Class&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;,&#x5982;&#x7C7B;&#x540D;&#x3001;&#x8BBF;&#x95EE;&#x4FEE;&#x9970;&#x7B26;&#x3001;&#x5E38;&#x91CF;&#x6C60;&#x3001;&#x5B57;&#x6BB5;&#x63CF;&#x8FF0;&#x3001;&#x65B9;&#x6CD5;&#x63CF;&#x8FF0;&#x7B49;&#x3002;&#x5982;&#x679C;&#x5728;&#x8FD0;&#x884C;&#x7684;&#x65F6;&#x5019;&#x5927;&#x91CF;&#x7684;&#x7C7B;&#x586B;&#x6EE1;&#x65B9;&#x6CD5;&#x533A;,&#x90A3;&#x4E48;&#x4E5F;&#x4F1A;&#x629B;&#x51FA;OutOfMemoryError,&#x6BD4;&#x5982;&#x4E0B;&#x9762;&#x7684;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x5C31;&#x501F;&#x52A9;&#x4E86;CGLib(2.0&#x7248;&#x672C;)&#x4F7F;&#x5F97;&#x65B9;&#x6CD5;&#x533A;&#x51FA;&#x73B0;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#x5F02;&#x5E38;&#x3002;
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Test</span></span><br><span class="line">  <span class="comment">//VM Args&#xFF1A;-XX:PermSize=10M -XX:MaxPermSize=10M</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">permGenOutOfMemory</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="comment">//&#x5982;&#x679C;&#x6CA1;&#x6709;&#x8FD9;&#x4E2A;&#x8BBE;&#x7F6E;&#x5728;JDK7&#x4E2D;&#x65E0;&#x6CD5;&#x6253;&#x5370;&#x51FA;&#x5F02;&#x5E38;&#x4FE1;&#x606F;</span></span><br><span class="line">    Thread.setDefaultUncaughtExceptionHandler(<span class="keyword">new</span> MyHandler());</span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">true</span>) {</span><br><span class="line">      Enhancer enhancer = <span class="keyword">new</span> Enhancer();</span><br><span class="line">      enhancer.setSuperclass(OOMObject.class);</span><br><span class="line">      enhancer.setUseCache(<span class="keyword">false</span>);</span><br><span class="line">      enhancer.setCallback(<span class="keyword">new</span> MethodInterceptor() {</span><br><span class="line">       <span class="annotation">@Override</span></span><br><span class="line">       <span class="function"><span class="keyword">public</span> Object <span class="title">intercept</span><span class="params">(Object obj, Method method, Object[] args, MethodProxy proxy)</span></span><br><span class="line">           <span class="keyword">throws</span> Throwable </span>{</span><br><span class="line">         <span class="keyword">return</span> proxy.invokeSuper(obj, args);</span><br><span class="line">       }</span><br><span class="line">      });</span><br><span class="line">      enhancer.create();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyHandler</span> <span class="keyword">implements</span> <span class="title">UncaughtExceptionHandler</span> </span>{</span><br><span class="line"></span><br><span class="line">  <span class="annotation">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">uncaughtException</span><span class="params">(Thread t, Throwable e)</span> </span>{</span><br><span class="line">    System.out.println(<span class="string">&quot;&#x5F02;&#x5E38;&#x4FE1;&#x606F;&#x4E3A;:&quot;</span> + e);</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OOMObject</span> </span>{</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">OOMObject</span><span class="params">()</span> </span>{</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x629B;&#x51FA;&#x7684;&#x5F02;&#x5E38;&#x4FE1;&#x606F;&#x4E3A;&#xFF1A;
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x5F02;&#x5E38;&#x4FE1;&#x606F;&#x4E3A;:java<span class="class">.lang</span><span class="class">.OutOfMemoryError</span>: PermGen space</span><br></pre></td></tr></table></figure></p>
<p>&#x5F53;&#x7136;&#x6211;&#x4EEC;&#x5728;&#x5E73;&#x65F6;&#x505A;WEB&#x9879;&#x76EE;&#x7684;&#x65F6;&#x5019;,&#x5982;&#x679C;&#x5728;&#x542F;&#x52A8;&#x9879;&#x76EE;&#x7684;&#x65F6;&#x5019;&#x6307;&#x5B9A;-XX:MaxPermSize&#x548C;-XX:PermSize&#x7684;&#x503C;&#x90FD;&#x6BD4;&#x8F83;&#x5C0F;&#x7684;&#x60C5;&#x51B5;&#x4E0B;,ClassLoader&#x5728;&#x88C5;&#x8F7D;&#x8F83;&#x591A;&#x7C7B;&#x7684;&#x65F6;&#x5019;&#x4E5F;&#x662F;&#x4F1A;&#x629B;&#x51FA;&#x8FD9;&#x4E2A;&#x5F02;&#x5E38;&#x7684;,&#x6709;&#x5174;&#x8DA3;&#x7684;&#x8BFB;&#x8005;&#x53EF;&#x4EE5;&#x8BD5;&#x4E00;&#x8BD5;&#x3002;</p>
<h3 id="&#x672C;&#x673A;&#x76F4;&#x63A5;&#x5185;&#x5B58;&#x6EA2;&#x51FA;">&#x672C;&#x673A;&#x76F4;&#x63A5;&#x5185;&#x5B58;&#x6EA2;&#x51FA;</h3>
<p>DirectMemory&#x53EF;&#x4EE5;&#x901A;&#x8FC7;-XX:MaxDirectMemorySize&#x6307;&#x5B9A;,&#x5982;&#x679C;&#x4E0D;&#x6307;&#x5B9A;&#x5219;&#x9ED8;&#x8BA4;&#x4E0E;Java&#x5806;&#x6700;&#x5927;&#x503C;(-Xmx&#x6307;&#x5B9A;)&#x4E00;&#x6837;&#x3002;
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//-Xmx10M -XX:MaxDirectMemorySize=10M</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IllegalArgumentException, IllegalAccessException </span>{</span><br><span class="line">    Field unsafeField = Unsafe.class.getDeclaredFields()[<span class="number">0</span>];</span><br><span class="line">    unsafeField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    Unsafe unsafe = (Unsafe) unsafeField.get(<span class="keyword">null</span>);</span><br><span class="line">    <span class="keyword">int</span> _1MB = <span class="number">1024</span>*<span class="number">1024</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="keyword">true</span>) {</span><br><span class="line">      unsafe.allocateMemory(_1MB);<span class="comment">//&#x7533;&#x8BF7;&#x5206;&#x914D;&#x5185;&#x5B58;&#x7684;&#x65B9;&#x6CD5;</span></span><br><span class="line">    }</span><br></pre></td></tr></table></figure></p>
<p>&#x629B;&#x51FA;&#x7684;&#x5F02;&#x5E38;&#x4FE1;&#x606F;&#x4E3A;:
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Exception <span class="keyword">in</span> thread <span class="string">&quot;main&quot;</span> java<span class="class">.lang</span><span class="class">.OutOfMemoryError</span></span><br><span class="line">    at sun<span class="class">.misc</span><span class="class">.Unsafe</span><span class="class">.allocateMemory</span>(Native Method)</span><br><span class="line">    at test<span class="class">.OutofMemoryTest</span><span class="class">.main</span>(OutofMemoryTest<span class="class">.java</span>:<span class="number">65</span>)</span><br></pre></td></tr></table></figure></p>
<p>&#x7531;DirectMemory&#x5BFC;&#x81F4;&#x7684;&#x5185;&#x5B58;&#x6EA2;&#x51FA;,&#x4E00;&#x4E2A;&#x660E;&#x663E;&#x7684;&#x7279;&#x5F81;&#x662F;&#x5728;Heap Dump&#x6587;&#x4EF6;&#x4E2D;&#x4E0D;&#x4F1A;&#x770B;&#x89C1;&#x660E;&#x663E;&#x7684;&#x5F02;&#x5E38;,&#x5982;&#x679C;&#x53D1;&#x73B0;OOM&#x4E4B;&#x540E;Dump&#x6587;&#x4EF6;&#x5F88;&#x5C0F;,&#x800C;&#x7A0B;&#x5E8F;&#x4E2D;&#x53C8;&#x76F4;&#x63A5;&#x6216;&#x95F4;&#x63A5;&#x4F7F;&#x7528;&#x4E86;NIO,&#x90A3;&#x5C31;&#x53EF;&#x4EE5;&#x8003;&#x8651;&#x68C0;&#x67E5;&#x4E00;&#x4E0B;&#x662F;&#x4E0D;&#x662F;&#x8FD9;&#x65B9;&#x9762;&#x7684;&#x539F;&#x56E0;&#x3002;</p>
<h3 id="&#x5173;&#x4E8E;outofmemory&#x7684;&#x6392;&#x67E5;">&#x5173;&#x4E8E;OutOfMemory&#x7684;&#x6392;&#x67E5;</h3>
<p>&#x5927;&#x591A;&#x6570;&#x65F6;&#x5019;&#x5F53;&#x6211;&#x4EEC;&#x9047;&#x5230;&#x4E86;OutOfMemoryError&#x7684;&#x65F6;&#x5019;,&#x4E00;&#x822C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x63D0;&#x793A;&#x4FE1;&#x606F;&#x786E;&#x5B9A;&#x5230;&#x662F;&#x54EA;&#x91CC;&#x7684;&#x95EE;&#x9898;,&#x4E00;&#x822C;&#x90FD;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8C03;&#x6574;&#x5806;&#x3001;&#x65B9;&#x6CD5;&#x533A;&#x7684;&#x5927;&#x5C0F;&#x6765;&#x4FDD;&#x8BC1;&#x7A0B;&#x5E8F;&#x7684;&#x6B63;&#x5E38;&#x8FD0;&#x884C;&#x3002;&#x4F46;&#x662F;&#x6709;&#x65F6;&#x5019;&#x5185;&#x5B58;&#x6CC4;&#x9732;&#x5BFC;&#x81F4;&#x7684;&#x95EE;&#x9898;&#x5C31;&#x4E0D;&#x662F;&#x7B80;&#x5355;&#x7684;&#x901A;&#x8FC7;&#x8C03;&#x6574;&#x5806;&#x5927;&#x5C0F;&#x53EF;&#x4EE5;&#x89E3;&#x51B3;&#x7684;&#x4E86;&#x3002;&#x4E0D;&#x8FC7;JAVA&#x81EA;&#x5E26;&#x4E86;&#x8BB8;&#x591A;&#x5173;&#x4E8E;&#x6392;&#x67E5;&#x95EE;&#x9898;&#x7684;&#x5DE5;&#x5177;,&#x7279;&#x522B;&#x662F;&#x7EBF;&#x4E0A;&#x95EE;&#x9898;,&#x901A;&#x8FC7;&#x8FD9;&#x4E9B;&#x547D;&#x4EE4;&#x90FD;&#x5F88;&#x6709;&#x5E2E;&#x52A9;&#x3002;&#x6BD4;&#x5982;&#x8BF4;jmap&#x3001;jstat&#x3001;jinfo&#x3001;jps&#x3001;jstack&#x8FD9;&#x6837;&#x7684;&#x547D;&#x4EE4;&#x5DE5;&#x5177;,&#x5982;&#x679C;&#x89C9;&#x5F97;&#x4E0D;&#x65B9;&#x4FBF;&#x8FD8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;jvisualvm&#x3001;jconsole&#x8FD9;&#x6837;&#x7684;&#x56FE;&#x5F62;&#x5316;&#x5DE5;&#x5177;,&#x5F53;&#x7136;&#x6211;&#x4EEC;&#x5E38;&#x7528;&#x7684;Eclipse&#x4E5F;&#x63D0;&#x4F9B;&#x4E86;Memory Analyzer&#x8FD9;&#x6837;&#x7684;&#x5206;&#x6790;&#x5DE5;&#x5177;&#x3002;</p>
<h3 id="&#x5199;&#x5728;&#x6700;&#x540E;">&#x5199;&#x5728;&#x6700;&#x540E;</h3>
<p>&#x672C;&#x6587;&#x4E2D;&#x4EE3;&#x7801;&#x6D4B;&#x8BD5;&#x73AF;&#x5883;&#x4E3A;JDK1.7(64&#x4F4D;),Windows64&#x4F4D;,Eclipse Luna Service Release 2 (4.4.2)</p>
<h3 id="&#x53C2;&#x8003;&#x8D44;&#x6599;">&#x53C2;&#x8003;&#x8D44;&#x6599;</h3>
<p>&#x300A;&#x6DF1;&#x5165;&#x7406;&#x89E3;Java&#x865A;&#x62DF;&#x673A;&#x7B2C;&#x4E8C;&#x7248;&#x300B;</p>
]]></content>
    <summary type="html">
    <![CDATA[我们经常会遇到OutOfMemoryError,我们通常的使用手段是增大堆内存,但是真正导致这个错误的原因有哪些呢？]]>
    
    </summary>
    
      <category term="java" scheme="http://yoursite.com/tags/java/"/>
    
      <category term="java" scheme="http://yoursite.com/categories/java/"/>
    
      <category term="多线程" scheme="http://yoursite.com/categories/java/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[浅谈java线程安全]]></title>
    <link href="http://yoursite.com/2016/09/21/talk-thread-safe/"/>
    <id>http://yoursite.com/2016/09/21/talk-thread-safe/</id>
    <published>2016-09-21T14:27:34.000Z</published>
    <updated>2018-10-28T13:18:56.378Z</updated>
    <content type="html"><![CDATA[<h3 id="&#x8FDB;&#x7A0B;&#x4E0E;&#x7EBF;&#x7A0B;">&#x8FDB;&#x7A0B;&#x4E0E;&#x7EBF;&#x7A0B;</h3>
<p>&#x8BA1;&#x7B97;&#x673A;&#x7684;&#x6838;&#x5FC3;&#x662F;CPU&#xFF0C;&#x5B83;&#x627F;&#x62C5;&#x4E86;&#x6240;&#x6709;&#x7684;&#x8BA1;&#x7B97;&#x4EFB;&#x52A1;&#x3002;&#x5B83;&#x5C31;&#x50CF;&#x4E00;&#x5EA7;&#x5DE5;&#x5382;&#xFF0C;&#x65F6;&#x523B;&#x5728;&#x8FD0;&#x884C;&#x3002;
&#x5047;&#x5B9A;&#x5DE5;&#x5382;&#x7684;&#x7535;&#x529B;&#x6709;&#x9650;&#xFF0C;&#x4E00;&#x6B21;&#x53EA;&#x80FD;&#x4F9B;&#x7ED9;&#x4E00;&#x4E2A;&#x8F66;&#x95F4;&#x4F7F;&#x7528;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x4E00;&#x4E2A;&#x8F66;&#x95F4;&#x5F00;&#x5DE5;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5176;&#x4ED6;&#x8F66;&#x95F4;&#x90FD;&#x5FC5;&#x987B;&#x505C;&#x5DE5;&#x3002;&#x80CC;&#x540E;&#x7684;&#x542B;&#x4E49;&#x5C31;&#x662F;&#xFF0C;&#x5355;&#x4E2A;CPU&#x4E00;&#x6B21;&#x53EA;&#x80FD;&#x8FD0;&#x884C;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x3002;
&#x8FDB;&#x7A0B;&#x5C31;&#x597D;&#x6BD4;&#x5DE5;&#x5382;&#x7684;&#x8F66;&#x95F4;&#xFF0C;&#x5B83;&#x4EE3;&#x8868;CPU&#x6240;&#x80FD;&#x5904;&#x7406;&#x7684;&#x5355;&#x4E2A;&#x4EFB;&#x52A1;&#x3002;&#x4EFB;&#x4E00;&#x65F6;&#x523B;&#xFF0C;CPU&#x603B;&#x662F;&#x8FD0;&#x884C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF0C;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x5904;&#x4E8E;&#x975E;&#x8FD0;&#x884C;&#x72B6;&#x6001;&#x3002;
&#x4E00;&#x4E2A;&#x8F66;&#x95F4;&#x91CC;&#xFF0C;&#x53EF;&#x4EE5;&#x6709;&#x5F88;&#x591A;&#x5DE5;&#x4EBA;&#x3002;&#x4ED6;&#x4EEC;&#x534F;&#x540C;&#x5B8C;&#x6210;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x3002;
&#x7EBF;&#x7A0B;&#x5C31;&#x597D;&#x6BD4;&#x8F66;&#x95F4;&#x91CC;&#x7684;&#x5DE5;&#x4EBA;&#x3002;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x5305;&#x62EC;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x3002;</p>
<h3 id="java&#x4E2D;&#x7684;&#x591A;&#x7EBF;&#x7A0B;">JAVA&#x4E2D;&#x7684;&#x591A;&#x7EBF;&#x7A0B;</h3>
<p>&#x4E00;&#x822C;&#x6765;&#x8BF4;&#xFF0C;&#x5F53;&#x8FD0;&#x884C;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C31;&#x542F;&#x52A8;&#x4E86;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF0C;&#x5F53;&#x7136;&#x6709;&#x4E9B;&#x4F1A;&#x542F;&#x52A8;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#x3002;&#x542F;&#x52A8;&#x8FDB;&#x7A0B;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x4F1A;&#x4E3A;&#x8FDB;&#x7A0B;&#x5206;&#x914D;&#x8D44;&#x6E90;&#xFF0C;&#x5176;&#x4E2D;&#x6700;&#x4E3B;&#x8981;&#x7684;&#x8D44;&#x6E90;&#x662F;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#xFF0C;&#x56E0;&#x4E3A;&#x7A0B;&#x5E8F;&#x662F;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x8FD0;&#x884C;&#x7684;&#x3002;&#x5728;&#x8FDB;&#x7A0B;&#x4E2D;&#xFF0C;&#x6709;&#x4E9B;&#x7A0B;&#x5E8F;&#x6D41;&#x7A0B;&#x5757;&#x662F;&#x53EF;&#x4EE5;&#x4E71;&#x5E8F;&#x6267;&#x884C;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x8FD9;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#x53EF;&#x4EE5;&#x540C;&#x65F6;&#x88AB;&#x591A;&#x6B21;&#x6267;&#x884C;&#x3002;&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x8FD9;&#x6837;&#x7684;&#x4EE3;&#x7801;&#x5757;&#x5C31;&#x662F;&#x7EBF;&#x7A0B;&#x4F53;&#x3002;&#x7EBF;&#x7A0B;&#x662F;&#x8FDB;&#x7A0B;&#x4E2D;&#x4E71;&#x5E8F;&#x6267;&#x884C;&#x7684;&#x4EE3;&#x7801;&#x6D41;&#x7A0B;&#x3002;&#x5F53;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x540C;&#x65F6;&#x8FD0;&#x884C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8FD9;&#x6837;&#x7684;&#x6267;&#x884C;&#x6A21;&#x5F0F;&#x6210;&#x4E3A;&#x5E76;&#x53D1;&#x6267;&#x884C;&#x3002;
&#x591A;&#x7EBF;&#x7A0B;&#x7684;&#x76EE;&#x7684;&#x662F;&#x4E3A;&#x4E86;&#x6700;&#x5927;&#x9650;&#x5EA6;&#x7684;&#x5229;&#x7528;CPU&#x8D44;&#x6E90;&#x3002;</p>
<p>Java&#x7F16;&#x5199;&#x7A0B;&#x5E8F;&#x90FD;&#x8FD0;&#x884C;&#x5728;&#x5728;Java&#x865A;&#x62DF;&#x673A;&#xFF08;JVM&#xFF09;&#x4E2D;&#xFF0C;&#x5728;JVM&#x7684;&#x5185;&#x90E8;&#xFF0C;&#x7A0B;&#x5E8F;&#x7684;&#x591A;&#x4EFB;&#x52A1;&#x662F;&#x901A;&#x8FC7;&#x7EBF;&#x7A0B;&#x6765;&#x5B9E;&#x73B0;&#x7684;&#x3002;&#x6BCF;&#x7528;java&#x547D;&#x4EE4;&#x542F;&#x52A8;&#x4E00;&#x4E2A;java&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#xFF0C;&#x5C31;&#x4F1A;&#x542F;&#x52A8;&#x4E00;&#x4E2A;JVM&#x8FDB;&#x7A0B;&#x3002;&#x5728;&#x540C;&#x4E00;&#x4E2A;JVM&#x8FDB;&#x7A0B;&#x4E2D;&#xFF0C;&#x6709;&#x4E14;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF0C;&#x5C31;&#x662F;&#x5B83;&#x81EA;&#x5DF1;&#x3002;&#x5728;&#x8FD9;&#x4E2A;JVM&#x73AF;&#x5883;&#x4E2D;&#xFF0C;&#x6240;&#x6709;&#x7A0B;&#x5E8F;&#x4EE3;&#x7801;&#x7684;&#x8FD0;&#x884C;&#x90FD;&#x662F;&#x4EE5;&#x7EBF;&#x7A0B;&#x6765;&#x8FD0;&#x884C;&#x3002;
&#x4E00;&#x822C;&#x5E38;&#x89C1;&#x7684;Java&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x90FD;&#x662F;&#x5355;&#x7EBF;&#x7A0B;&#x7684;&#x3002;&#x6BD4;&#x5982;&#xFF0C;&#x7528;java&#x547D;&#x4EE4;&#x8FD0;&#x884C;&#x4E00;&#x4E2A;&#x6700;&#x7B80;&#x5355;&#x7684;HelloWorld&#x7684;Java&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x65F6;&#xFF0C;&#x5C31;&#x542F;&#x52A8;&#x4E86;&#x4E00;&#x4E2A;JVM&#x8FDB;&#x7A0B;&#xFF0C;JVM&#x627E;&#x5230;&#x7A0B;&#x5E8F;&#x7A0B;&#x5E8F;&#x7684;&#x5165;&#x53E3;&#x70B9;main()&#xFF0C;&#x7136;&#x540E;&#x8FD0;&#x884C;main()&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x4EA7;&#x751F;&#x4E86;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF0C;&#x8FD9;&#x4E2A;&#x7EBF;&#x7A0B;&#x79F0;&#x4E4B;&#x4E3A;&#x4E3B;&#x7EBF;&#x7A0B;&#x3002;&#x5F53;main&#x65B9;&#x6CD5;&#x7ED3;&#x675F;&#x540E;&#xFF0C;&#x4E3B;&#x7EBF;&#x7A0B;&#x8FD0;&#x884C;&#x5B8C;&#x6210;&#x3002;JVM&#x8FDB;&#x7A0B;&#x4E5F;&#x968F;&#x5373;&#x9000;&#x51FA; &#x3002;</p>
<p>&#x5F53;&#x6211;&#x4EEC;&#x5728;tomcat&#x670D;&#x52A1;&#x5668;&#x4E2D;&#x8FD0;&#x884C;&#x4E00;&#x4E2A;WEB&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x542F;&#x52A8;&#x4E86;&#x4E00;&#x4E2A;JAVA&#x8FDB;&#x7A0B;&#xFF0C;&#x5BF9;WEB&#x754C;&#x9762;&#x7684;&#x6BCF;&#x4E2A;&#x64CD;&#x4F5C;&#x90FD;&#x662F;&#x5728;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x7EBF;&#x7A0B;&#x4E2D;&#x6267;&#x884C;&#x7684;&#xFF0C;&#x5BF9;&#x4E8E;&#x76F8;&#x540C;&#x7684;&#x64CD;&#x4F5C;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x7684;&#x65B9;&#x6CD5;&#x4F53;&#x662F;&#x4E00;&#x6837;&#x7684;(&#x6BD4;&#x5982;&#x8BF4;&#x540C;&#x65F6;&#x6709;&#x591A;&#x4E2A;&#x4EBA;&#x5728;&#x6DD8;&#x5B9D;&#x67E5;&#x770B;&#x540C;&#x4E00;&#x4E2A;&#x5546;&#x54C1;&#x7684;&#x8BE6;&#x7EC6;)&#x3002;</p>
<h3 id="java&#x4E2D;&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x591A;&#x7EBF;&#x7A0B;">Java&#x4E2D;&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x591A;&#x7EBF;&#x7A0B;</h3>
<ol>
<li>
<p>&#x76F4;&#x63A5;&#x7EE7;&#x627F;java.lang.Thread&#x6216;&#x8005;&#x76F4;&#x63A5;&#x4F7F;&#x7528;java.lang.Thread
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Thread().start();</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>&#x5B9E;&#x73B0;java.lang.Runnable&#x63A5;&#x53E3;,&#x5E76;&#x5C06;&#x5176;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x7ED9;java.lang.Thread
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() {</span><br><span class="line">     </span><br><span class="line">     <span class="annotation">@Override</span></span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>{</span><br><span class="line">       </span><br><span class="line">     }</span><br><span class="line">   }).start();</span><br></pre></td></tr></table></figure></p>
</li>
</ol>
<p>&#x6CE8;&#x610F;&#xFF0C;&#x8FD9;&#x91CC;&#x8C03;&#x7528;&#x7684;&#x662F;start&#x65B9;&#x6CD5;&#xFF0C;&#x53EA;&#x6709;&#x8C03;&#x7528;start&#x65B9;&#x6CD5;&#x624D;&#x4F1A;&#x542F;&#x52A8;&#x7EBF;&#x7A0B;&#xFF0C;&#x7136;&#x540E;&#x7EBF;&#x7A0B;&#x4F1A;&#x6267;&#x884C;run&#x65B9;&#x6CD5;&#x4E2D;&#x7684;&#x4EE3;&#x7801;,&#x5982;&#x679C;&#x76F4;&#x63A5;&#x8C03;&#x7528;run&#x65B9;&#x6CD5;,java&#x53EA;&#x662F;&#x5F53;&#x6210;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x7684;&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#xFF0C;&#x5E76;&#x4E0D;&#x4F1A;&#x542F;&#x52A8;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;</p>
<h3 id="&#x591A;&#x7EBF;&#x7A0B;&#x7684;&#x4F7F;&#x7528;&#x573A;&#x666F;">&#x591A;&#x7EBF;&#x7A0B;&#x7684;&#x4F7F;&#x7528;&#x573A;&#x666F;</h3>
<p>&#x521A;&#x624D;&#x4E5F;&#x8BF4;&#x4E86;&#x7EBF;&#x7A0B;&#x662F;&#x4E3A;&#x4E86;&#x66F4;&#x597D;&#x7684;&#x5229;&#x7528;CPU&#x8D44;&#x6E90;,&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x4E00;&#x822C;&#x5728;&#x54EA;&#x4E9B;&#x573A;&#x666F;&#x4E0B;&#x4F7F;&#x7528;&#x591A;&#x7EBF;&#x7A0B;&#x5462;&#xFF1F;&#x5F53;&#x7136;&#x8FD9;&#x5E76;&#x6CA1;&#x6709;&#x4E00;&#x4E2A;&#x7EDF;&#x4E00;&#x7684;&#x7B54;&#x6848;&#xFF0C;&#x6211;&#x5728;&#x8FD9;&#x91CC;&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#x6211;&#x4F7F;&#x7528;&#x591A;&#x7EBF;&#x7A0B;&#x7684;&#x573A;&#x666F;</p>
<ol>
<li>&#x5728;&#x6570;&#x636E;&#x5E93;&#x5907;&#x4EFD;&#x7B49;&#x6BD4;&#x8F83;&#x8017;&#x65F6;&#x7684;&#x64CD;&#x4F5C;&#x4E2D;&#x4F7F;&#x7528;&#x591A;&#x7EBF;&#x7A0B;,&#x540E;&#x53F0;&#x9ED8;&#x9ED8;&#x6267;&#x884C;&#x5373;&#x53EF;</li>
<li>&#x7CFB;&#x7EDF;&#x9700;&#x8981;&#x5B9A;&#x65F6;&#x505A;&#x4E00;&#x4E9B;&#x4EFB;&#x52A1;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6BD4;&#x5982;&#x5B9A;&#x65F6;&#x53D1;&#x9001;&#x90AE;&#x4EF6;,&#x66F4;&#x65B0;&#x914D;&#x7F6E;&#x7B49;</li>
<li>&#x9700;&#x8981;&#x5F02;&#x6B65;&#x5904;&#x7406;&#x7684;&#x6570;&#x636E;&#x7684;&#x65F6;&#x5019;,&#x6BD4;&#x5982;&#x8BF4;&#x524D;&#x53F0;&#x89E6;&#x53D1;&#x5B8C;&#x6210;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;,&#x540E;&#x53F0;&#x7EBF;&#x7A0B;&#x76F4;&#x63A5;&#x6267;&#x884C;&#xFF0C;&#x524D;&#x53F0;&#x53EA;&#x9700;&#x8981;&#x8F6E;&#x8BE2;&#x72B6;&#x6001;&#x5373;&#x53EF;&#x3002;</li>
</ol>
<h3 id="&#x4EC0;&#x4E48;&#x662F;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;">&#x4EC0;&#x4E48;&#x662F;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;</h3>
<p>&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x6307;&#x7684;&#x662F;&#x591A;&#x7EBF;&#x7A0B;&#x73AF;&#x5883;&#x4E0B;,&#x4E00;&#x4E2A;&#x7C7B;&#x5728;&#x5728;&#x6267;&#x884C;&#x67D0;&#x4E2A;&#x65B9;&#x6CD5;&#x7684;&#x65F6;&#x5019;,&#x5BF9;&#x7C7B;&#x7684;&#x5185;&#x90E8;&#x5B9E;&#x4F8B;&#x53D8;&#x91CF;&#x7684;&#x8BBF;&#x95EE;&#x662F;&#x5B89;&#x5168;&#x7684;&#x3002;&#x56E0;&#x6B64;&#x5BF9;&#x4E8E;&#x4E0B;&#x9762;&#x5217;&#x51FA;&#x6765;&#x7684;2&#x7C7B;&#x53D8;&#x91CF;,&#x5E76;&#x4E0D;&#x5B58;&#x5728;&#x4EFB;&#x4F55;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x8BF4;&#x6CD5;&#xFF1A;</p>
<ol>
<li>&#x65B9;&#x6CD5;&#x7B7E;&#x540D;&#x4E2D;&#x7684;&#x4EFB;&#x4F55;&#x53C2;&#x6570;&#x5BF9;&#x8C61;</li>
<li>&#x5904;&#x4E8E;&#x65B9;&#x6CD5;&#x5185;&#x90E8;&#x7684;&#x5C40;&#x90E8;&#x53D8;&#x91CF;</li>
</ol>
<p><strong>&#x4E3A;&#x4EC0;&#x4E48;&#x5462;&#xFF1F;</strong>
Java&#x865A;&#x62DF;&#x673A;&#x5728;&#x8FD0;&#x884C;java&#x7A0B;&#x5E8F;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x4F1A;&#x5C06;&#x5B83;&#x6240;&#x7BA1;&#x7406;&#x7684;&#x5185;&#x5B58;&#x533A;&#x57DF;&#x5212;&#x5206;&#x6210;&#x4E3A;&#x51E0;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x533A;&#x5757;,&#x5176;&#x5C06;&#x4F1A;&#x5305;&#x62EC;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x8FD0;&#x884C;&#x65F6;&#x6570;&#x636E;&#x533A;&#x5757;
<img src="/images/thread-java-running-data-area.png" alt="Java&#x8FD0;&#x884C;&#x65F6;&#x6570;&#x636E;&#x533A;"></p>
<p>&#x4ECE;&#x4E0A;&#x56FE;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x6709;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x5171;&#x4EAB;&#x7684;&#x6570;&#x636E;&#x5E93;&#x53EA;&#x6709;&#x5806;&#x548C;&#x65B9;&#x6CD5;&#x533A;,&#x65B9;&#x6CD5;&#x533A;&#x7528;&#x4E8E;&#x5B58;&#x53D6;&#x4EE5;&#x88AB;&#x865A;&#x62DF;&#x673A;&#x52A0;&#x8F7D;&#x7684;&#x7C7B;&#x4FE1;&#x606F;&#x3001;&#x5E38;&#x91CF;&#x3001;&#x9759;&#x6001;&#x53D8;&#x91CF;&#x3001;&#x5373;&#x65F6;&#x7F16;&#x8BD1;&#x5668;&#x7F16;&#x8BD1;&#x540E;&#x7684;&#x4EE3;&#x7801;&#x7B49;&#x6570;&#x636E;,&#x800C;&#x5806;&#x7684;&#x552F;&#x4E00;&#x76EE;&#x7684;&#x5C31;&#x662F;&#x5B58;&#x653E;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;,&#x51E0;&#x4E4E;&#x6240;&#x6709;&#x7684;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x90FD;&#x5728;&#x8FD9;&#x91CC;&#x5206;&#x914D;&#x5185;&#x5B58;&#x3002;</p>
<blockquote>
<p>&#x4E00;&#x4E2A;&#x672C;&#x5730;&#x53D8;&#x91CF;&#x53EF;&#x80FD;&#x662F;&#x539F;&#x59CB;&#x7C7B;&#x578B;&#xFF0C;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5B83;&#x603B;&#x662F;&#x201C;&#x5446;&#x5728;&#x201D;&#x7EBF;&#x7A0B;&#x6808;&#x4E0A;&#x3002;</p>
<p>&#x4E00;&#x4E2A;&#x672C;&#x5730;&#x53D8;&#x91CF;&#x4E5F;&#x53EF;&#x80FD;&#x662F;&#x6307;&#x5411;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x4E00;&#x4E2A;&#x5F15;&#x7528;&#x3002;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5F15;&#x7528;&#xFF08;&#x8FD9;&#x4E2A;&#x672C;&#x5730;&#x53D8;&#x91CF;&#xFF09;&#x5B58;&#x653E;&#x5728;&#x7EBF;&#x7A0B;&#x6808;&#x4E0A;&#xFF0C;&#x4F46;&#x662F;&#x5BF9;&#x8C61;&#x672C;&#x8EAB;&#x5B58;&#x653E;&#x5728;&#x5806;&#x4E0A;&#x3002;</p>
</blockquote>
<blockquote>
<p>&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x53EF;&#x80FD;&#x5305;&#x542B;&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x53EF;&#x80FD;&#x5305;&#x542B;&#x672C;&#x5730;&#x53D8;&#x91CF;&#x3002;&#x8FD9;&#x4E9B;&#x672C;&#x5730;&#x53D8;&#x91CF;&#x4EFB;&#x7136;&#x5B58;&#x653E;&#x5728;&#x7EBF;&#x7A0B;&#x6808;&#x4E0A;&#xFF0C;&#x5373;&#x4F7F;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x6240;&#x5C5E;&#x7684;&#x5BF9;&#x8C61;&#x5B58;&#x653E;&#x5728;&#x5806;&#x4E0A;&#x3002;</p>
</blockquote>
<blockquote>
<p>&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x6210;&#x5458;&#x53D8;&#x91CF;&#x53EF;&#x80FD;&#x968F;&#x7740;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x81EA;&#x8EAB;&#x5B58;&#x653E;&#x5728;&#x5806;&#x4E0A;&#x3002;&#x4E0D;&#x7BA1;&#x8FD9;&#x4E2A;&#x6210;&#x5458;&#x53D8;&#x91CF;&#x662F;&#x539F;&#x59CB;&#x7C7B;&#x578B;&#x8FD8;&#x662F;&#x5F15;&#x7528;&#x7C7B;&#x578B;&#x3002;</p>
</blockquote>
<blockquote>
<p>&#x9759;&#x6001;&#x6210;&#x5458;&#x53D8;&#x91CF;&#x8DDF;&#x968F;&#x7740;&#x7C7B;&#x5B9A;&#x4E49;&#x4E00;&#x8D77;&#x4E5F;&#x5B58;&#x653E;&#x5728;&#x5806;&#x4E0A;&#x3002;</p>
</blockquote>
<blockquote>
<p>&#x5B58;&#x653E;&#x5728;&#x5806;&#x4E0A;&#x7684;&#x5BF9;&#x8C61;&#x53EF;&#x4EE5;&#x88AB;&#x6240;&#x6709;&#x6301;&#x6709;&#x5BF9;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x5F15;&#x7528;&#x7684;&#x7EBF;&#x7A0B;&#x8BBF;&#x95EE;&#x3002;&#x5F53;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x65F6;&#xFF0C;&#x5B83;&#x4E5F;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x6210;&#x5458;&#x53D8;&#x91CF;&#x3002;&#x5982;&#x679C;&#x4E24;&#x4E2A;&#x7EBF;&#x7A0B;&#x540C;&#x65F6;&#x8C03;&#x7528;&#x540C;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x4E0A;&#x7684;&#x540C;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x5B83;&#x4EEC;&#x5C06;&#x4F1A;&#x90FD;&#x8BBF;&#x95EE;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x6210;&#x5458;&#x53D8;&#x91CF;&#xFF0C;&#x4F46;&#x662F;&#x6BCF;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x90FD;&#x62E5;&#x6709;&#x8FD9;&#x4E2A;&#x672C;&#x5730;&#x53D8;&#x91CF;&#x7684;&#x79C1;&#x6709;&#x62F7;&#x8D1D;&#x3002;</p>
</blockquote>
<p>&#x66F4;&#x591A;&#x5173;&#x4E8E;java&#x5185;&#x5B58;&#x6A21;&#x578B;&#x6570;&#x636E;&#x53EF;&#x4EE5;&#x53C2;&#x8003;<a href="http://ifeve.com/java-memory-model-6/" target="_blank" rel="external">http://ifeve.com/java-memory-model-6/</a></p>
<h3 id="&#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;&#x7684;&#x4EE3;&#x7801;">&#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;&#x7684;&#x4EE3;&#x7801;</h3>
<p>&#x524D;&#x9762;&#x4E5F;&#x8BF4;&#x4E86;,&#x591A;&#x7EBF;&#x7A0B;&#x662F;&#x5B8C;&#x6210;&#x540C;&#x4E00;&#x4EF6;&#x4EFB;&#x52A1;&#x7684;,&#x90A3;&#x4E48;&#x5FC5;&#x7136;&#x5B58;&#x5728;&#x5BF9;&#x8D44;&#x6E90;&#x7684;&#x7ADE;&#x4E89;,&#x90A3;&#x4E48;&#x5728;&#x7ADE;&#x4E89;&#x7684;&#x65F6;&#x5019;,&#x5BF9;&#x8D44;&#x6E90;&#x7684;&#x4E0D;&#x6B63;&#x5F53;&#x4F7F;&#x7528;&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;&#x7A0B;&#x5E8F;&#x51FA;&#x73B0;&#x95EE;&#x9898;&#xFF0C;&#x4F8B;&#x5982;&#x4E0B;&#x9762;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>{</span><br><span class="line">  <span class="keyword">protected</span> MySalary mySalary;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">int</span> value;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">MyThread</span><span class="params">(MySalary mySalary,<span class="keyword">int</span> value)</span> </span>{</span><br><span class="line">    <span class="keyword">this</span>.mySalary = mySalary;</span><br><span class="line">    <span class="keyword">this</span>.value = value;</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">   <span class="annotation">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>{</span><br><span class="line">     mySalary.add(value);</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>{</span><br><span class="line">    MySalary ms = <span class="keyword">new</span> MySalary();</span><br><span class="line">    MyThread t1 = <span class="keyword">new</span> MyThread(ms,<span class="number">200</span>);</span><br><span class="line">    MyThread t2 = <span class="keyword">new</span> MyThread(ms,<span class="number">300</span>);</span><br><span class="line">    t1.start();</span><br><span class="line">    t2.start();</span><br><span class="line">    Thread.sleep(<span class="number">1000</span>);<span class="comment">//&#x4E3B;&#x7EBF;&#x7A0B;&#x7761;&#x7720;1&#x79D2;&#x949F;,&#x4FDD;&#x8BC1;&#x4E24;&#x4E2A;&#x7EBF;&#x7A0B;&#x8FD0;&#x884C;&#x5B8C;&#x6BD5;</span></span><br><span class="line">     System.out.println(Thread.currentThread().getName() + <span class="string">&quot; run over and salary = &quot;</span> + salary);</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MySalary</span> </span>{</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">int</span> salary = <span class="number">1000</span>;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> value)</span> </span>{</span><br><span class="line">    <span class="keyword">try</span> {</span><br><span class="line">      Thread.sleep(<span class="number">150</span>);</span><br><span class="line">      <span class="keyword">this</span>.salary = salary + value;</span><br><span class="line">      <span class="comment">//&#x6253;&#x5370;&#x51FA;&#x5F53;&#x524D;&#x8FD0;&#x884C;&#x7684;&#x7EBF;&#x7A0B;</span></span><br><span class="line">      System.out.println(Thread.currentThread() + <span class="string">&quot; run and salary = &quot;</span> + salary);</span><br><span class="line">    } <span class="keyword">catch</span> (InterruptedException e) {</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    }</span><br><span class="line"> }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x9884;&#x671F;&#x7ED3;&#x679C;&#x5E94;&#x8BE5;&#x6253;&#x5370;&#x7684;&#x662F;1500,&#x4F46;&#x662F;&#x5B9E;&#x9645;&#x60C5;&#x51B5;&#x53EF;&#x80FD;&#x4E0E;&#x9884;&#x671F;&#x7ED3;&#x679C;&#x4E0D;&#x7B26;,&#x5728;&#x672C;&#x5730;&#x591A;&#x8FD0;&#x884C;&#x51E0;&#x6B21;&#x4E4B;&#x540E;&#x51FA;&#x73B0;&#x4E86;&#x8FD9;&#x6837;&#x7684;&#x7ED3;&#x679C;:
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Thread-<span class="number">0</span> <span class="command">run</span> <span class="keyword">over</span> <span class="keyword">and</span> salary = <span class="number">1300</span></span><br><span class="line">Thread-<span class="number">1</span> <span class="command">run</span> <span class="keyword">over</span> <span class="keyword">and</span> salary = <span class="number">1300</span></span><br><span class="line">main <span class="command">run</span> <span class="keyword">over</span> <span class="keyword">and</span> salary = <span class="number">1300</span></span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x5C31;&#x662F;&#x591A;&#x7EBF;&#x7A0B;&#x8FD0;&#x884C;&#x5BFC;&#x81F4;&#x7684;&#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;&#x7684;&#x7ED3;&#x679C;!</p>
<h3 id="&#x4E3A;&#x4EC0;&#x4E48;&#x4F1A;&#x5BFC;&#x81F4;&#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;">&#x4E3A;&#x4EC0;&#x4E48;&#x4F1A;&#x5BFC;&#x81F4;&#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;</h3>
<p>&#x5728;&#x6CA1;&#x6709;&#x540C;&#x6B65;&#x7684;&#x60C5;&#x51B5;&#x4E0B;,Java&#x5185;&#x5B58;&#x6A21;&#x578B;&#x5141;&#x8BB8;&#x7F16;&#x8BD1;&#x5668;&#x5BF9;&#x64CD;&#x4F5C;&#x987A;&#x5E8F;&#x8FDB;&#x884C;&#x91CD;&#x6392;&#x5E8F;,&#x5E76;&#x5C06;&#x6570;&#x503C;&#x7F13;&#x5B58;&#x5728;&#x5BC4;&#x5B58;&#x5668;&#x4E2D;,&#x6B64;&#x5916;,&#x5B83;&#x8FD8;&#x5141;&#x8BB8;CPU&#x5BF9;&#x64CD;&#x4F5C;&#x987A;&#x5E8F;&#x8FDB;&#x884C;&#x91CD;&#x6392;&#x5E8F;,&#x5E76;&#x5C06;&#x6570;&#x503C;&#x7F13;&#x5B58;&#x5728;&#x5BC4;&#x5B58;&#x5668;&#x4E2D;&#x3002;&#x6240;&#x4EE5;&#x5728;&#x7F3A;&#x4E4F;&#x8DB3;&#x591F;&#x540C;&#x6B65;&#x7684;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x4E2D;,&#x8981;&#x60F3;&#x5BF9;&#x5185;&#x5B58;&#x7684;&#x64CD;&#x4F5C;&#x987A;&#x5E8F;&#x8FDB;&#x884C;&#x5224;&#x65AD;,&#x51E0;&#x4E4E;&#x65E0;&#x6CD5;&#x5F97;&#x51FA;&#x6B63;&#x786E;&#x7684;&#x7ED3;&#x8BBA;&#x3002;</p>
<p>&#x4E4B;&#x524D;&#x8BF4;&#x4E86;Java&#x865A;&#x62DF;&#x673A;&#x5BF9;&#x5185;&#x5B58;&#x7684;&#x5212;&#x5206;,&#x4F46;&#x662F;&#x5176;&#x548C;&#x786C;&#x4EF6;&#x662F;&#x5B58;&#x5728;&#x5DEE;&#x5F02;,&#x5728;&#x786C;&#x4EF6;&#x7EA7;&#x522B;&#x4E0A;&#x662F;&#x4E0D;&#x5B58;&#x5728;&#x5806;&#x6808;&#x7684;&#x5212;&#x5206;&#x7684;,&#x538B;&#x6839;&#x6CA1;&#x6709;&#x8FD9;&#x4E2A;&#x6982;&#x5FF5;&#x3002;
<img src="/images/thread-java-memory-model-4.png" alt="&#x786C;&#x4EF6;&#x4E2D;&#x5BF9;&#x4E8E;&#x5185;&#x5B58;&#x7684;&#x5212;&#x5206;"></p>
<p>&#x8981;&#x77E5;&#x9053;,CPU&#x7684;&#x8FD0;&#x884C;&#x901F;&#x5EA6;&#x662F;&#x975E;&#x5E38;&#x5FEB;&#x7684;,CPU&#x7684;&#x8FD0;&#x884C;&#x6570;&#x636E;&#x662F;&#x4ECE;&#x5185;&#x5B58;(&#x4E3B;&#x5B58;)&#x6765;&#x7684;,&#x4F46;&#x662F;&#x4ECE;&#x5185;&#x5B58;&#x4E2D;&#x53D6;&#x6570;&#x636E;&#x5BF9;&#x4E8E;CPU&#x6765;&#x8BF4;&#x662F;&#x975E;&#x5E38;&#x6162;&#x7684;,&#x5BF9;&#x4E8E;&#x4E00;&#x4E9B;&#x5E38;&#x7528;&#x7684;&#x6570;&#x636E;,CPU&#x5C31;&#x505A;&#x4E86;&#x4E00;&#x4E9B;&#x7F13;&#x5B58;,&#x6240;&#x4EE5;&#x6709;&#x4E86;CPU&#x7684;&#x7F13;&#x5B58;&#x3002;&#x800C;&#x6211;&#x4EEC;&#x4E0A;&#x9762;&#x9020;&#x6210;&#x7684;&#x591A;&#x7EBF;&#x7A0B;&#x95EE;&#x9898;&#x4E5F;&#x6B63;&#x662F;&#x7531;&#x4E8E;&#x8FD9;&#x79CD;&quot;&#x4FE1;&#x606F;&#x4E0D;&#x5BF9;&#x7B49;&quot;&#x7684;&#x60C5;&#x51B5;&#x5BFC;&#x81F4;&#x7684;&#x3002;&#x521A;&#x624D;&#x4E5F;&#x8BF4;&#x4E86;&#x786C;&#x4EF6;&#x548C;JVM&#x7684;&#x8FD0;&#x884C;&#x65F6;&#x533A;&#x5E76;&#x4E0D;&#x4E00;&#x6837;,&#x90A3;&#x4E48;&#x5B83;&#x4EEC;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;&#x662F;&#x600E;&#x6837;&#x7684;&#x5462;?&#x8FD9;&#x91CC;&#x540C;&#x6837;&#x53EF;&#x4EE5;&#x7528;&#x4E00;&#x5F20;&#x56FE;&#x6765;&#x63CF;&#x8FF0;&#x5B83;&#x4EEC;&#x7684;&#x5173;&#x7CFB;
<img src="/images/thread-java-memory-model-5.png" alt="JVM&#x4E0E;&#x786C;&#x4EF6;&#x7684;&#x4EA4;&#x4E92;"></p>
<p>&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x5C31;&#x53EF;&#x4EE5;&#x89E3;&#x91CA;&#x4E3A;&#x4EC0;&#x4E48;&#x4F1A;&#x51FA;&#x73B0;&#x4E0A;&#x9762;&#x4EE3;&#x7801;&#x8FD0;&#x884C;&#x7684;&#x7ED3;&#x679C;&#x4E86;
<img src="/images/thread-java_running_result.png" alt="&#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;&#x4EE3;&#x7801;&#x89E3;&#x6790;"></p>
<h3 id="synconized&#x7684;&#x4F5C;&#x7528;&#x4EE5;&#x53CA;&#x4F7F;&#x7528;">synconized&#x7684;&#x4F5C;&#x7528;&#x4EE5;&#x53CA;&#x4F7F;&#x7528;</h3>
<p>synconized&#x662F;java&#x4E2D;&#x7684;&#x5173;&#x952E;&#x5B57;,&#x4F7F;&#x7528;&#x5B83;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;,&#x540C;&#x6B65;&#x5757;&#x5728;Java&#x4E2D;&#x662F;&#x540C;&#x6B65;&#x5728;&#x67D0;&#x4E2A;&#x5BF9;&#x8C61;&#x4E0A;&#x3002;&#x6240;&#x6709;&#x540C;&#x6B65;&#x5728;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x4E0A;&#x7684;&#x540C;&#x6B65;&#x5757;&#x5728;&#x540C;&#x65F6;&#x53EA;&#x80FD;&#x88AB;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x8FDB;&#x5165;&#x5E76;&#x6267;&#x884C;&#x64CD;&#x4F5C;&#x3002;&#x6240;&#x6709;&#x5176;&#x4ED6;&#x7B49;&#x5F85;&#x8FDB;&#x5165;&#x8BE5;&#x540C;&#x6B65;&#x5757;&#x7684;&#x7EBF;&#x7A0B;&#x5C06;&#x88AB;&#x963B;&#x585E;&#xFF0C;&#x76F4;&#x5230;&#x6267;&#x884C;&#x8BE5;&#x540C;&#x6B65;&#x5757;&#x4E2D;&#x7684;&#x7EBF;&#x7A0B;&#x9000;&#x51FA;&#x3002;
&#x8FD9;&#x5C31;&#x76F8;&#x5F53;&#x4E8E;&#x5BDD;&#x5BA4;6&#x4E2A;&#x540C;&#x5B66;&#x540C;&#x65F6;&#x8981;&#x4E0A;&#x5395;&#x6240;,&#x7136;&#x540E;&#x4E00;&#x8D77;&#x62A2;&#x5395;&#x6240;&#xFF0C;&#x62A2;&#x5230;&#x5395;&#x6240;&#x7684;&#x90A3;&#x4E2A;&#x4EBA;&#x4F1A;&#x628A;&#x5395;&#x6240;&#x95E8;&#x7ED9;&#x5173;&#x4E0A;,&#x8868;&#x793A;&#x5395;&#x6240;&#x6709;&#x4EBA;,&#x7136;&#x540E;&#x5176;&#x4ED6;&#x4EBA;&#x53EA;&#x80FD;&#x5728;&#x95E8;&#x5916;&#x7B49;&#x7740;,&#x7B49;&#x522B;&#x4EBA;&#x4E0A;&#x5B8C;&#x5395;&#x6240;&#x4E86;,&#x5176;&#x4ED6;&#x4EBA;&#x5728;&#x63A5;&#x7740;&#x62A2;&#x3002;
&#x90A3;&#x4E48;&#x4E0A;&#x9762;&#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;&#x7684;&#x4EE3;&#x7801;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x90E8;&#x5206;&#x6539;&#x5199;
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">synchronized</span> (<span class="keyword">this</span>) {</span><br><span class="line">    <span class="keyword">this</span>.salary = salary + value;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x6B64;&#x65F6;&#xFF0C;&#x65E0;&#x8BBA;&#x542F;&#x52A8;&#x591A;&#x5C11;&#x4E2A;&#x7EBF;&#x7A0B;&#x90FD;&#x80FD;&#x591F;&#x4FDD;&#x8BC1;&#x7EBF;&#x7A0B;&#x7684;&#x5B89;&#x5168;&#x4E86;,synchronized&#x4E0D;&#x4EC5;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5728;&#x4EE3;&#x7801;&#x5757;&#x4E0A;&#x8FD8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5728;&#x65B9;&#x6CD5;&#x58F0;&#x660E;&#x4E0A;,&#x4F46;&#x662F;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;synconized&#x662F;&#x6BD4;&#x8F83;&#x8017;&#x8D39;&#x7CFB;&#x7EDF;&#x8D44;&#x6E90;&#x7684;,&#x6240;&#x4EE5;&#x8981;&#x5C3D;&#x53EF;&#x80FD;&#x5C0F;&#x8303;&#x56F4;&#x7684;&#x4F7F;&#x7528;&#x3002;</p>
<h3 id="volitale&#x7684;&#x4F7F;&#x7528;">volitale&#x7684;&#x4F7F;&#x7528;</h3>
<p>volitale&#x7684;&#x4F5C;&#x7528;&#x662F;&#x4FDD;&#x8BC1;&#x5185;&#x5B58;&#x53EF;&#x89C1;&#x6027;,&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x6210;&#x5458;&#x53D8;&#x91CF;&#x88AB;valitale&#x4FEE;&#x9970;,&#x5728;A&#x7EBF;&#x7A0B;&#x4E2D;&#x4FEE;&#x6539;&#x4E86;valitale&#x53D8;&#x91CF;&#x7684;&#x503C;&#xFF0C;&#x5BF9;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x6765;&#x8BF4;&#x8BE5;&#x4FEE;&#x6539;&#x662F;&#x53EF;&#x89C1;&#x7684;&#x3002;
&#x5373;&#x8BFB;&#x53D6;valitale&#x53D8;&#x91CF;&#x76F8;&#x5F53;&#x4E8E;&#x8FDB;&#x5165;&#x540C;&#x6B65;&#x4EE3;&#x7801;&#x5757;,&#x5199;&#x5165;valitale&#x53D8;&#x91CF;&#x76F8;&#x5F53;&#x4E8E;&#x9000;&#x51FA;&#x540C;&#x6B65;&#x4EE3;&#x7801;&#x5757;,&#x800C;&#x4E14;&#x8BFB;&#x53D6;valitaile&#x53D8;&#x91CF;&#x7684;&#x5F00;&#x9500;&#x4EC5;&#x4EC5;&#x53EA;&#x6BD4;&#x975E;valitale&#x53D8;&#x91CF;&#x7684;&#x5F00;&#x9500;&#x7565;&#x9AD8;&#x4E00;&#x70B9;,&#x66F4;&#x8FDC;&#x8FDC;&#x4F4E;&#x4E8E;synchronized.
&#x503C;&#x5F97;&#x6CE8;&#x610F;&#x7684;&#x662F;volitale&#x5E76;&#x4E0D;&#x80FD;&#x4FDD;&#x8BC1;count++&#x8FD9;&#x6837;&#x64CD;&#x4F5C;&#x7684;&#x539F;&#x5B50;&#x6027;,&#x6240;&#x4EE5;volitale&#x5E76;&#x4E0D;&#x80FD;&#x4FDD;&#x8BC1;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x3002;</p>
<p><strong>&#x56E0;&#x6B64;synchronized&#x548C;volitale&#x7684;&#x533A;&#x522B;&#x662F;:&#x52A0;&#x9501;&#x673A;&#x5236;&#x65E2;&#x53EF;&#x4EE5;&#x786E;&#x5B9A;&#x53EF;&#x89C1;&#x6027;&#x53C8;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x539F;&#x5B50;&#x6027;,&#x800C;volatile&#x53D8;&#x91CF;&#x53EA;&#x80FD;&#x786E;&#x4FDD;&#x53EF;&#x89C1;&#x6027;&#x3002;</strong></p>
<p>&#x6240;&#x4EE5;&#x5B83;&#x7684;&#x4F7F;&#x7528;&#x573A;&#x666F;&#x4E00;&#x822C;&#x5305;&#x62EC;:&#x786E;&#x4FDD;&#x5B83;&#x4EEC;&#x81EA;&#x8EAB;&#x72B6;&#x6001;&#x7684;&#x53EF;&#x89C1;&#x6027;,&#x786E;&#x4FDD;&#x5B83;&#x4EEC;&#x6240;&#x5F15;&#x7528;&#x72B6;&#x6001;&#x7684;&#x53EF;&#x89C1;&#x6027;&#xFF0C;&#x4EE5;&#x53CA;&#x6807;&#x793A;&#x4E00;&#x4E9B;&#x91CD;&#x8981;&#x7684;&#x7A0B;&#x5E8F;&#x751F;&#x547D;&#x5468;&#x671F;&#x7684;&#x4E8B;&#x4EF6;&#x7684;&#x53D1;&#x751F;(&#x4F8B;&#x5982;&#x521D;&#x59CB;&#x5316;&#x6216;&#x8005;&#x5173;&#x95ED;)&#x3002;
&#x4E00;&#x79CD;&#x5178;&#x578B;&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;:&#x68C0;&#x67E5;&#x67D0;&#x4E2A;&#x5224;&#x65AD;&#x6807;&#x8BB0;&#x5224;&#x65AD;&#x662F;&#x5426;&#x9000;&#x51FA;&#x5FAA;&#x73AF;
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">valitale <span class="keyword">boolean</span> isExit;</span><br><span class="line"><span class="keyword">while</span>(!isExit) {</span><br><span class="line">    doSomething();</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x8FD9;&#x6837;&#x5F53;isExit&#x6807;&#x5FD7;&#x88AB;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x4FEE;&#x6539;&#x4E3A;true&#x7684;&#x65F6;&#x5019;,&#x6267;&#x884C;&#x5224;&#x65AD;&#x7684;&#x7EBF;&#x7A0B;&#x5C31;&#x80FD;&#x591F;&#x51C6;&#x786E;&#x7684;&#x8BFB;&#x53D6;&#x5230;isExit&#x7684;&#x503C;&#xFF0C;&#x4ECE;&#x800C;&#x9000;&#x51FA;&#x5FAA;&#x73AF;&#x3002;</p>
<h3 id="threadlocal&#x7684;&#x4F7F;&#x7528;">ThreadLocal&#x7684;&#x4F7F;&#x7528;</h3>
<p>&#x65E2;&#x7136;&#x63D0;&#x5230;&#x4E86;Thread,&#x5C31;&#x4E0D;&#x5F97;&#x4E0D;&#x8BF4;ThreadLocal&#x4E86;,&#x5148;&#x770B;&#x4E0B;ThreadLocal&#x5185;&#x90E8;&#x5B9E;&#x73B0;&#x673A;&#x5236;:
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(T value)</span> </span>{</span><br><span class="line">    Thread t = Thread.currentThread();</span><br><span class="line">    <span class="comment">//&#x901A;&#x8FC7;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x83B7;&#x53D6;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x7684;&#x672C;&#x5730;&#x53D8;&#x91CF;ThreadLocalMap</span></span><br><span class="line">    ThreadLocalMap map = getMap(t);</span><br><span class="line">    <span class="keyword">if</span> (map != <span class="keyword">null</span>)</span><br><span class="line">        map.set(<span class="keyword">this</span>, value);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        createMap(t, value);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> T <span class="title">get</span><span class="params">()</span> </span>{</span><br><span class="line">    Thread t = Thread.currentThread();</span><br><span class="line">    ThreadLocalMap map = getMap(t);</span><br><span class="line">    <span class="keyword">if</span> (map != <span class="keyword">null</span>) {</span><br><span class="line">        <span class="comment">//&#x83B7;&#x53D6;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x4E2D;&#x4EE5;&#x5F53;&#x524D;ThreadLocal&#x5B9E;&#x4F8B;&#x4E3A;key&#x7684;&#x53D8;&#x91CF;&#x503C;</span></span><br><span class="line">        ThreadLocalMap.Entry e = map.getEntry(<span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">if</span> (e != <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span> (T)e.value;</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">//&#x5F53;map&#x4E0D;&#x5B58;&#x5728;&#x65F6;,&#x8BBE;&#x7F6E;&#x521D;&#x59CB;&#x503C;,&#x53EF;&#x4EE5;&#x901A;&#x8FC7;new ThreadLocal&#x65F6;&#x8986;&#x76D6;initialValue&#x65B9;&#x6CD5;,&#x8FD9;&#x4E5F;&#x662F;setInitialValue&#x4E3B;&#x8981;&#x7684;&#x8C03;&#x7528;&#x65B9;&#x6CD5;</span></span><br><span class="line">    <span class="keyword">return</span> setInitialValue();</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function">ThreadLocalMap <span class="title">getMap</span><span class="params">(Thread t)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> t.threadLocals;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">createMap</span><span class="params">(Thread t, T firstValue)</span> </span>{</span><br><span class="line">    t.threadLocals = <span class="keyword">new</span> ThreadLocalMap(<span class="keyword">this</span>, firstValue);</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x4ECE;ThreadLocal&#x7684;&#x5185;&#x90E8;&#x5B9E;&#x73B0;&#x673A;&#x5236;&#x5206;&#x6790;,synchronized&#x8FD9;&#x79CD;&#x673A;&#x5236;&#x662F;&#x63D0;&#x4F9B;&#x4E00;&#x4EFD;&#x53D8;&#x91CF;&#x8BA9;&#x4E0D;&#x540C;&#x7684;&#x7EBF;&#x7A0B;&#x6392;&#x961F;&#x8BBF;&#x95EE;,&#x800C;ThreadLocal&#x662F;&#x4E3A;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x90FD;&#x63D0;&#x4F9B;&#x4E00;&#x4EFD;&#x53D8;&#x91CF;&#x7684;&#x526F;&#x672C;,&#x4ECE;&#x800C;&#x5B9E;&#x73B0;&#x540C;&#x65F6;&#x8BBF;&#x95EE;&#x800C;&#x4E0D;&#x53D7;&#x5F71;&#x54CD;&#x3002;
&#x4ECE;&#x8FD9;&#x91CC;&#x4E5F;&#x770B;&#x51FA;&#x6765;&#x4E86;&#x4E24;&#x8005;&#x4E4B;&#x95F4;&#x7684;&#x5E94;&#x7528;&#x573A;&#x666F;&#x4E0D;&#x540C;,synchronized&#x662F;&#x4E3A;&#x4E86;&#x8BA9;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x5BF9;&#x53D8;&#x91CF;&#x7684;&#x4FEE;&#x6539;&#x90FD;&#x5BF9;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x53EF;&#x89C1;,&#x800C;ThreadLocal&#x662F;&#x4E3A;&#x4E86;&#x7EBF;&#x7A0B;&#x5BF9;&#x8C61;&#x7684;&#x6570;&#x636E;&#x4E0D;&#x53D7;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x5F71;&#x54CD;,&#x5B83;&#x6700;&#x9002;&#x5408;&#x7684;&#x573A;&#x666F;&#x5E94;&#x8BE5;&#x662F;&#x5728;&#x540C;&#x4E00;&#x7EBF;&#x7A0B;&#x7684;&#x4E0D;&#x540C;&#x5F00;&#x53D1;&#x5C42;&#x6B21;&#x4E2D;&#x5171;&#x4EAB;&#x6570;&#x636E;&#x3002;</p>
<h3 id="&#x5B89;&#x5168;&#x7684;&#x53D1;&#x5E03;&#x5BF9;&#x8C61;">&#x5B89;&#x5168;&#x7684;&#x53D1;&#x5E03;&#x5BF9;&#x8C61;</h3>
<p>&#x6211;&#x4EEC;&#x5206;&#x6790;&#x4E86;,&#x5176;&#x5B9E;&#x7EBF;&#x7A0B;&#x4E0D;&#x5B89;&#x5168;&#x5C31;&#x662F;&#x56E0;&#x4E3A;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x5BF9;&#x516C;&#x5171;&#x8D44;&#x6E90;(&#x5B58;&#x5728;&#x4E8E;&#x5806;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;)&#x7684;&#x4E0D;&#x6B63;&#x5F53;&#x5229;&#x7528;,&#x90A3;&#x4E48;&#x5982;&#x4F55;&#x4FDD;&#x8BC1;&#x53D1;&#x5E03;&#x7684;&#x5BF9;&#x8C61;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x5462;&#xFF1F;
&#x4E00;&#x4E2A;&#x6B63;&#x786E;&#x6784;&#x9020;&#x7684;&#x5BF9;&#x8C61;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4EE5;&#x4E0B;&#x65B9;&#x5F0F;&#x6765;&#x5B89;&#x5168;&#x7684;&#x53D1;&#x5E03;:</p>
<ol>
<li>&#x5728;&#x9759;&#x6001;&#x521D;&#x59CB;&#x5316;&#x51FD;&#x6570;&#x4E2D;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x5F15;&#x7528;(JVM&#x5728;&#x9759;&#x6001;&#x521D;&#x59CB;&#x5316;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x4FDD;&#x8BC1;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;)</li>
<li>&#x5C06;&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#x4FDD;&#x5B58;&#x5230;volatile&#x7C7B;&#x578B;&#x7684;&#x57DF;&#x6216;&#x8005;AtomicReferance&#x4E2D;</li>
<li>&#x5C06;&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#x4FDD;&#x5B58;&#x5230;&#x67D0;&#x4E2A;&#x6B63;&#x786E;&#x6784;&#x9020;&#x5BF9;&#x8C61;&#x7684;&#x7684;final&#x7C7B;&#x578B;&#x57DF;&#x4E2D;</li>
<li>&#x5C06;&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#x4FDD;&#x5B58;&#x5230;&#x4E00;&#x4E2A;&#x7531;&#x9501;&#x4FDD;&#x62A4;&#x7684;&#x57DF;&#x4E2D;</li>
</ol>
<h3 id="java&#x4E2D;&#x5176;&#x4ED6;&#x4FDD;&#x8BC1;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x65B9;&#x5F0F;">Java&#x4E2D;&#x5176;&#x4ED6;&#x4FDD;&#x8BC1;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x65B9;&#x5F0F;</h3>
<ol>
<li>&#x901A;&#x8FC7;&#x5C06;&#x4E00;&#x4E2A;&#x952E;&#x6216;&#x8005;&#x503C;&#x653E;&#x5165;HashTable&#x3001;synchronizedMap&#x6216;&#x8005;ConcurrentMap&#x4E2D;&#xFF0C;&#x53EF;&#x4EE5;&#x5B89;&#x5168;&#x7684;&#x5C06;&#x5B83;&#x53D1;&#x5E03;&#x7ED9;&#x4EFB;&#x4F55;&#x4ECE;&#x8FD9;&#x4E9B;&#x5BB9;&#x5668;&#x4E2D;&#x8BBF;&#x95EE;&#x5B83;&#x7684;&#x7EBF;&#x7A0B;(&#x65E0;&#x8BBA;&#x662F;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;&#x8FD8;&#x662F;&#x901A;&#x8FC7;&#x8FED;&#x4EE3;&#x5668;&#x8BBF;&#x95EE;)</li>
<li>&#x901A;&#x8FC7;&#x5C06;&#x67D0;&#x4E2A;&#x5143;&#x7D20;&#x653E;&#x5165;Vector&#x3001;CopyOnWriteArrayList&#x3001;CopyOnWriteArraySet&#x3001;synchronizedList&#x6216;&#x8005;synchronizedSet&#x4E2D;,&#x53EF;&#x4EE5;&#x5C06;&#x5143;&#x7D20;&#x5B89;&#x5168;&#x7684;&#x53D1;&#x5E03;&#x5230;&#x4EFB;&#x4F55;&#x4ECE;&#x8FD9;&#x4E9B;&#x5BB9;&#x5668;&#x4E2D;&#x8BBF;&#x95EE;&#x5B83;&#x7684;&#x7EBF;&#x7A0B;</li>
<li>&#x901A;&#x8FC7;&#x5C06;&#x67D0;&#x4E2A;&#x5143;&#x7D20;&#x653E;&#x5165;BlockingQueue&#x6216;&#x8005;ConcurrentLinkedQueue&#x4E2D;,&#x53EF;&#x4EE5;&#x5C06;&#x5143;&#x7D20;&#x5B89;&#x5168;&#x7684;&#x53D1;&#x5E03;&#x5230;&#x4EFB;&#x4F55;&#x4ECE;&#x8FD9;&#x4E9B;&#x961F;&#x5217;&#x4E2D;&#x8BBF;&#x95EE;&#x8BE5;&#x5143;&#x7D20;&#x7684;&#x7EBF;&#x7A0B;</li>
</ol>
<p>&#x7C7B;&#x5E93;&#x4E2D;&#x7684;&#x5176;&#x4ED6;&#x673A;&#x5236;&#x4E5F;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x5B89;&#x5168;&#x53D1;&#x5E03;,&#x6BD4;&#x5982;Futrue&#x548C;Exchange.</p>
<h3 id="&#x5199;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;">&#x5199;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;</h3>
<ol>
<li>
<p>&#x997F;&#x6C49;&#x5F0F;
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyFactory</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> MyFactory factory = <span class="keyword">new</span> MyFactory();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">MyFactory</span><span class="params">()</span> </span>{</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> MyFactory <span class="title">getFactory</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> factory;</span><br><span class="line">    } </span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>&#x61D2;&#x6C49;&#x5F0F;
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyFactory</span> </span>{</span><br><span class="line">    <span class="comment">//&#x8FD9;&#x91CC;&#x7684;volitale&#x4E0D;&#x53EF;&#x6216;&#x7F3A;</span></span><br><span class="line">    <span class="keyword">public</span> volitale <span class="keyword">static</span> MyFactory factory = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">MyFactory</span><span class="params">()</span> </span>{</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> MyFactory <span class="title">getFactory</span><span class="params">()</span> </span>{</span><br><span class="line">       <span class="keyword">if</span>(factory == <span class="keyword">null</span>){</span><br><span class="line">            <span class="keyword">synchronized</span> (MyFactory.class){</span><br><span class="line">                <span class="keyword">if</span>(factory == <span class="keyword">null</span>){</span><br><span class="line">                    factory = <span class="keyword">new</span> MyFactory();</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> factory;</span><br><span class="line">    } </span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
</li>
</ol>
<p>&#x61D2;&#x6C49;&#x5F0F;&#x4F7F;&#x7528;&#x4E86;&quot;&#x53CC;&#x91CD;&#x68C0;&#x67E5;&#x9501;&quot;,&#x5728;&#x4E0A;&#x9501;&#x4E4B;&#x524D;&#x591A;&#x8FDB;&#x884C;&#x4E00;&#x6B21;null&#x68C0;&#x67E5;&#x5C31;&#x53EF;&#x4EE5;&#x51CF;&#x5C11;&#x7EDD;&#x5927;&#x591A;&#x6570;&#x7684;&#x52A0;&#x9501;&#x64CD;&#x4F5C;&#x3002;&#x5F53;&#x7136;&#x8FD9;&#x79CD;&#x5199;&#x6CD5;&#x4E5F;&#x4E0D;&#x662F;&#x552F;&#x4E00;&#x7684;,&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x9759;&#x6001;&#x5185;&#x90E8;&#x7C7B;,&#x8FD8;&#x4F7F;&#x7528;&#x679A;&#x4E3E;(&#x8FD9;&#x79CD;&#x662F;Effective Java&#x7684;&#x63A8;&#x8350;&#x5199;&#x6CD5;)&#x3002;&#x4F7F;&#x7528;&#x679A;&#x4E3E;&#x9664;&#x4E86;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x548C;&#x9632;&#x6B62;&#x53CD;&#x5C04;&#x5F3A;&#x884C;&#x8C03;&#x7528;&#x6784;&#x9020;&#x5668;&#x4E4B;&#x5916;(&#x4E0A;&#x9762;&#x8D77;&#x5230;&#x7684;&#x5176;&#x4ED6;&#x65B9;&#x5F0F;&#x5747;&#x4E0D;&#x80FD;&#x907F;&#x514D;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;)&#xFF0C;&#x8FD8;&#x63D0;&#x4F9B;&#x4E86;&#x81EA;&#x52A8;&#x5E8F;&#x5217;&#x5316;&#x673A;&#x5236;&#xFF0C;&#x9632;&#x6B62;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x65F6;&#x5019;&#x521B;&#x5EFA;&#x65B0;&#x7684;&#x5BF9;&#x8C61;&#x3002;</p>
<h3 id="&#x5199;&#x5728;&#x6700;&#x540E;">&#x5199;&#x5728;&#x6700;&#x540E;</h3>
<p>&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x8BF4;&#x7B80;&#x5355;&#x4E5F;&#x7B80;&#x5355;,&#x8BF4;&#x96BE;&#x4E5F;&#x96BE;,&#x7B80;&#x5355;&#x5C31;&#x7B80;&#x5355;&#x5728;&#x63A7;&#x5236;&#x597D;&#x88AB;&#x7EBF;&#x7A0B;&#x5171;&#x4EAB;&#x7684;&#x8D44;&#x6E90;&#x5373;&#x53EF;,&#x96BE;&#x5C31;&#x96BE;&#x5728;&#x5728;&#x63A7;&#x5236;&#x7684;&#x540C;&#x65F6;&#x4FDD;&#x8BC1;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x6548;&#x7387;&#x4EE5;&#x53CA;&#x4E0D;&#x51FA;&#x73B0;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x95EE;&#x9898;&#x3002;&#x5F53;&#x7136;&#x8FD9;&#x8BBE;&#x8BA1;&#x5230;&#x5F88;&#x591A;&#x65B9;&#x9762;&#x4E86;&#xFF0C;&#x672C;&#x6587;&#x4E5F;&#x53EA;&#x662F;&#x4F5C;&#x8005;&#x5728;&#x4E86;&#x89E3;&#x4E86;&#x591A;&#x7EBF;&#x7A0B;&#x4E4B;&#x540E;&#x5199;&#x4E0B;&#x7684;&#x7C97;&#x6D45;&#x89C1;&#x63A5;&#xFF0C;&#x8FD9;&#x5176;&#x4E2D;&#x4E5F;&#x53C2;&#x8003;&#x4E86;&#x5F88;&#x591A;&#x8D44;&#x6599;,&#x5982;&#x6709;&#x9519;&#x8BEF;&#x6216;&#x8005;&#x9057;&#x6F0F;,&#x8BF7;&#x6307;&#x51FA;&#x3002;</p>
<h3 id="&#x53C2;&#x8003;&#x8D44;&#x6599;">&#x53C2;&#x8003;&#x8D44;&#x6599;</h3>
<ol>
<li>http://www.ruanyifeng.com/blog/2013/04/processes_and_threads.html</li>
<li>http://ifeve.com/java-memory-model-6/</li>
</ol>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="&#x8FDB;&#x7A0B;&#x4E0E;&#x7EBF;&#x7A0B;">&#x8FDB;&#x7A0B;&#x4E0E;&#x7EBF;&#x7A0B;</h3>
<p>&#x8BA1;&#x7B97;&#x673A;&#x7684;&#x6838;&]]>
    </summary>
    
      <category term="java" scheme="http://yoursite.com/tags/java/"/>
    
      <category term="java" scheme="http://yoursite.com/categories/java/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Mysql必知必会读书笔记]]></title>
    <link href="http://yoursite.com/2016/08/30/mysql-basic-note/"/>
    <id>http://yoursite.com/2016/08/30/mysql-basic-note/</id>
    <published>2016-08-30T14:15:41.000Z</published>
    <updated>2018-10-28T13:19:04.000Z</updated>
    <content type="html"><![CDATA[<p><strong>Mysql&#x5FC5;&#x77E5;&#x5FC5;&#x4F1A;&#x7B14;&#x8BB0;(&#x9700;&#x8981;&#x6709;&#x4E00;&#x5B9A;Mysql&#x57FA;&#x7840;)</strong></p>
<p>--&#x67E5;&#x770B;&#x6709;&#x54EA;&#x4E9B;&#x5E93;
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">show</span> <span class="keyword">databases</span>;</span></span><br></pre></td></tr></table></figure></p>
<p>--&#x67E5;&#x770B;&#x5F53;&#x524D;&#x5E93;&#x4E2D;&#x6709;&#x54EA;&#x4E9B;&#x8868;
<figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">show</span> <span class="built_in">tables</span></span><br></pre></td></tr></table></figure></p>
<p>--&#x67E5;&#x770B;&#x8868;&#x4E2D;&#x6709;&#x54EA;&#x4E9B;&#x5217;
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">show</span> <span class="keyword">columns</span> <span class="keyword">from</span>  table_name;</span> &#x6216;&#x8005;   <span class="operator"><span class="keyword">describe</span> table_name;</span></span><br></pre></td></tr></table></figure></p>
<p>--&#x67E5;&#x770B;&#x670D;&#x52A1;&#x5668;&#x72B6;&#x6001;
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">show</span> <span class="keyword">status</span>;</span></span><br></pre></td></tr></table></figure></p>
<p>--&#x67E5;&#x770B;&#x5EFA;&#x8868;&#x8BED;&#x53E5;&#x6216;&#x8005;&#x521B;&#x5EFA;&#x6570;&#x636E;&#x5E93;&#x7684;&#x8BED;&#x53E5;
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> table_name &#x548C; <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">database</span> database_name;</span></span><br></pre></td></tr></table></figure></p>
<p>--&#x7528;&#x6765;&#x663E;&#x793A;&#x6388;&#x6743;&#x7528;&#x6237;&#x7684;&#x5B89;&#x5168;&#x6743;&#x9650;
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">show</span> <span class="keyword">grants</span></span></span><br></pre></td></tr></table></figure></p>
<p>--&#x7528;&#x6765;&#x663E;&#x793A;&#x670D;&#x52A1;&#x5668;&#x9519;&#x8BEF;&#x6216;&#x8005;&#x8B66;&#x544A;
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">show</span> <span class="keyword">errors</span> &#x548C; <span class="keyword">show</span> <span class="keyword">warnings</span></span></span><br></pre></td></tr></table></figure></p>
<p>--limit&#x8BED;&#x53E5;</p>
<pre><code><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#&#x8868;&#x793A;&#x4ECE;&#x7B2C;&#x4E09;&#x884C;(&#x5305;&#x62EC;)&#x5F00;&#x59CB;&#x53D6;&#x503C;&#xFF0C;&#x53D6;&#x56DB;&#x6761;&#x6570;&#x636E;(mysql&#x7684;&#x884C;&#x662F;&#x4ECE;0&#x5F00;&#x59CB;&#x7684;)</span><br><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> table_name <span class="keyword">limit</span> <span class="number">3</span>,<span class="number">4</span>;</span></span><br><span class="line"></span><br><span class="line">#Mysql5&#x7248;&#x672C;&#x652F;&#x6301;&#x540C;&#x6837;&#x8BED;&#x4E49;&#x7684;&#x5199;&#x6CD5;:</span><br><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> table_name <span class="keyword">limit</span> <span class="number">4</span> <span class="keyword">offset</span> <span class="number">3</span>;</span></span><br></pre></td></tr></table></figure>
</code></pre>
<p>--sql&#x8BED;&#x53E5;&#x4E2D;&#x4F7F;&#x7528;&#x5168;&#x9650;&#x5B9A;&#x540D;&#x79F0;
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">select</span> table_name.column_name <span class="keyword">from</span> database_name.table_name;</span></span><br></pre></td></tr></table></figure></p>
<p>--order by &#x7684;&#x8BF4;&#x660E;
order by &#x591A;&#x4E2A;&#x5217;&#x7684;&#x65F6;&#x5019;,&#x53EA;&#x6709;&#x5F53;&#x7B2C;&#x4E00;&#x4E2A;&#x5217;&#x76F8;&#x540C;&#x7684;&#x65F6;&#x5019;,&#x624D;&#x4F1A;&#x6839;&#x636E;&#x7B2C;&#x4E8C;&#x4E2A;&#x5217;&#x8FDB;&#x884C;&#x6392;&#x5E8F;,&#x4EE5;&#x6B64;&#x7C7B;&#x63A8;,&#x4F46;&#x662F;&#x5982;&#x679C;&#x7B2C;&#x4E00;&#x4E2A;&#x5217;&#x662F;&#x552F;&#x4E00;&#x7684;&#x8BDD;,
&#x90A3;&#x4E48;&#x5C31;&#x4E0D;&#x4F1A;&#x6839;&#x636E;&#x5176;&#x4ED6;&#x5217;&#x8FDB;&#x884C;&#x6392;&#x5E8F;</p>
<p>--mysql&#x5728;&#x6267;&#x884C;&#x5339;&#x914D;&#x7684;&#x65F6;&#x5019;&#x9ED8;&#x8BA4;&#x4E0D;&#x533A;&#x5206;&#x5927;&#x5C0F;&#x5199;
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#&#x8FD9;&#x6837;&#x53EF;&#x80FD;&#x67E5;&#x8BE2;&#x51FA;name=&apos;li&apos;&#x7684;&#x7ED3;&#x679C;</span><br><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">name</span> <span class="keyword">from</span> table_name <span class="keyword">where</span> <span class="keyword">name</span> = <span class="string">&apos;Li&apos;</span>;</span></span><br></pre></td></tr></table></figure></p>
<p>--&#x5224;&#x65AD;&#x662F;&#x5426;&#x4E3A;&#x7A7A;&#x6216;&#x8005;&#x4E0D;&#x4E3A;&#x7A7A;
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> table_name <span class="keyword">where</span> <span class="keyword">id</span> <span class="keyword">is</span> <span class="literal">null</span>;</span> &#x6216;&#x8005; <span class="operator"><span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> table_name <span class="keyword">where</span> <span class="keyword">id</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>;</span></span><br></pre></td></tr></table></figure></p>
<p>--and&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x5927;&#x4E8E;or&#x4F18;&#x5148;&#x7EA7;
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#&#x8868;&#x793A;&#x67E5;&#x8BE2;age &lt; 10&#x7684;&#x4EFB;&#x4F55;&#x6570;&#x636E;&#x548C;(id = 13&#x5E76;&#x4E14;age &gt; 20)&#x7684;&#x6570;&#x636E;</span><br><span class="line">select id,name from table_name where age &lt; 10 or id = 13 and age &gt; 20;</span><br></pre></td></tr></table></figure></p>
<p>--in&#x548C;or&#x7684;&#x6BD4;&#x8F83;
_ in&#x548C;or&#x7684;&#x4F5C;&#x7528;&#x4E00;&#x81F4;,&#x4F46;&#x662F;in&#x6BD4;or&#x66F4;&#x52A0;&#x6E05;&#x6670;,&#x800C;&#x4E14;&#x4E00;&#x822C;&#x6765;&#x8BF4;in&#x7684;&#x6548;&#x7387;&#x6BD4;or&#x9AD8;,&#x800C;&#x4E14;in&#x8FD8;&#x53EF;&#x4EE5;&#x5305;&#x542B;&#x5B50;&#x67E5;&#x8BE2;</p>
<p>--&#x4F7F;&#x7528;&#x901A;&#x914D;&#x7B26;</p>
<ol>
<li>
<p>%&#x8868;&#x793A;&#x4EFB;&#x610F;&#x5B57;&#x7B26;&#x51FA;&#x73B0;&#x4EFB;&#x610F;&#x6B21;&#x6570;,&#x6BD4;&#x5982;select id from table_name where name like &apos;jack%&apos;;&#x8868;&#x793A;&#x67E5;&#x8BE2;&#x6240;&#x6709;&#x540D;&#x79F0;&#x4E3A;jack&#x5F00;&#x5934;&#x7684;&#x6570;&#x636E;
&#x901A;&#x914D;&#x7B26;&#x53EF;&#x4EE5;&#x5728;&#x4EFB;&#x610F;&#x4F4D;&#x7F6E;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x591A;&#x4E2A;&#x901A;&#x914D;&#x7B26;,&#x503C;&#x5F97;&#x6CE8;&#x610F;&#x7684;&#x662F;%&#x4EE3;&#x8868;&#x641C;&#x7D22;&#x6A21;&#x5F0F;&#x4E2D;&#x7ED9;&#x5B9A;&#x4F4D;&#x7F6E;&#x7684;0&#x4E2A;&#x3001;1&#x4E2A;&#x6216;&#x8005;&#x591A;&#x4E2A;&#x5B57;&#x7B26;&#x3002;</p>
</li>
<li>
<p>_&#x901A;&#x914D;&#x7B26;&#x53EA;&#x5339;&#x914D;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;</p>
</li>
<li>
<p>&#x4E0D;&#x8981;&#x8FC7;&#x5EA6;&#x4F7F;&#x7528;&#x901A;&#x914D;&#x7B26;,&#x56E0;&#x4E3A;&#x5B83;&#x7684;&#x6548;&#x7387;&#x4E0D;&#x9AD8;,&#x4E0D;&#x8981;&#x8BB2;&#x901A;&#x914D;&#x7B26;&#x653E;&#x5728;&#x5339;&#x914D;&#x6A21;&#x5F0F;&#x7684;&#x5F00;&#x59CB;&#x5904;,&#x56E0;&#x4E3A;&#x8FD9;&#x6837;&#x641C;&#x7D22;&#x8D77;&#x6765;&#x662F;&#x6700;&#x6162;&#x7684;,&#x5982;&#x679C;&#x4F60;&#x5728;&#x67D0;&#x4E2A;&#x5B57;&#x6BB5;&#x4F7F;&#x7528;&#x4E86;&#x7D22;&#x5F15;,&#x7136;&#x540E;&#x4F7F;&#x7528;&#x901A;&#x914D;&#x7B26;&#x8FDB;&#x884C;&#x67E5;&#x8BE2;,&#x5982;&#x679C;&#x5C06;&#x901A;&#x914D;&#x7B26;&#x653E;&#x5230;&#x5F00;&#x59CB;&#x5904;,&#x90A3;&#x4E48;&#x5C31;&#x4E0D;&#x4F1A;&#x4F7F;&#x7528;&#x7D22;&#x5F15;&#x3002;&#x4E0D;&#x8981;&#x628A;&#x901A;&#x914D;&#x7B26;&#x653E;&#x9519;&#x4F4D;&#x7F6E;&#x4E86;</p>
</li>
</ol>
<p>--Mysql&#x4E2D;&#x7684;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;</p>
<ol>
<li>
<p>&#x4F7F;&#x7528;regexp&#x5173;&#x952E;&#x5B57;
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> table_name <span class="keyword">where</span> <span class="keyword">name</span> regexp <span class="string">&apos;zhangsan&apos;</span>;</span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>&#x4F7F;&#x7528;&#x70B9;(.)&#x6765;&#x8868;&#x793A;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#&#x627E;&#x51FA;id&#x4E3A;1000,2000,3000&#x7B49;&#x7684;name</span><br><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">name</span> <span class="keyword">from</span> table_name <span class="keyword">where</span> <span class="keyword">id</span> regexp <span class="string">&apos;.000&apos;</span>;</span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>&#x5982;&#x679C;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x5B58;&#x5728;id:10 name:pack10 &#x8FD9;&#x6837;&#x4E00;&#x6761;&#x6570;&#x636E;,&#x90A3;&#x4E48;&#x4EE5;&#x4E0B;&#x4E24;&#x6761;sql&#x4E2D;&#x7B2C;&#x4E00;&#x6761;&#x4E0D;&#x4F1A;&#x8FD4;&#x56DE;&#x4EFB;&#x4F55;&#x6570;&#x636E;,&#x800C;&#x7B2C;&#x4E8C;&#x6761;&#x4F1A;&#x8FD4;&#x56DE;
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> table_name <span class="keyword">where</span> <span class="keyword">name</span> <span class="keyword">like</span> <span class="string">&apos;10&apos;</span>;</span></span><br><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> table_name <span class="keyword">where</span> <span class="keyword">name</span> regexp <span class="string">&apos;10&apos;</span>;</span></span><br></pre></td></tr></table></figure></p>
</li>
</ol>
<p>&#x56E0;&#x4E3A;like&#x5339;&#x914D;&#x6574;&#x4E2A;&#x5217;,&#x5982;&#x679C;&#x6570;&#x636E;&#x5728;&#x5217;&#x503C;&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x8BDD;,&#x90A3;&#x4E48;like&#x4E0D;&#x4F1A;&#x627E;&#x5230;&#x5B83;&#xFF0C;&#x9664;&#x975E;&#x4F7F;&#x7528;%&#x8FDB;&#x884C;&#x6A21;&#x7CCA;&#x5339;&#x914D;&#x3002;
&#x4F46;&#x662F;regexp&#x5219;&#x53EF;&#x4EE5;&#x5728;&#x5217;&#x503C;&#x5185;&#x8FDB;&#x884C;&#x5339;&#x914D;,&#x5982;&#x679C;&#x627E;&#x5230;&#x5219;&#x4F1A;&#x8FD4;&#x56DE;,&#x5F53;&#x7136;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;^10$&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x8FDB;&#x884C;&#x5339;&#x914D;&#x6574;&#x4E2A;&#x5217;&#x503C;&#x3002;</p>
<ol start="4">
<li>
<p>&#x5339;&#x914D;&#x662F;&#x4E0D;&#x533A;&#x5206;&#x5927;&#x5C0F;&#x5199;&#x7684;,&#x9664;&#x975E;&#x624B;&#x52A8;&#x52A0;&#x4E0A;binary&#x5173;&#x952E;&#x5B57;,&#x6BD4;&#x5982;name regexp binary &apos;zhangsan&apos;;</p>
</li>
<li>
<p>or&#x5339;&#x914D;,&#x6BD4;&#x5982; id regexp &apos;100|200|300&apos;;</p>
</li>
<li>
<p>&#x5339;&#x914D;&#x5355;&#x4E00;&#x7684;&#x5B57;&#x7B26;,&#x90A3;&#x4E48;&#x4F7F;&#x7528;[]&#x5C06;&#x5185;&#x5BB9;&#x62EC;&#x8D77;&#x6765;,&#x6BD4;&#x5982;&#x6211;&#x8981;&#x67E5;&#x770B;a,b,1,2&#x8FD9;&#x51E0;&#x4E2A;&#x5B57;&#x7B26;,&#x90A3;&#x4E48;&#x5C31;&#x662F;name regexp &apos;[ab12]test&apos;;</p>
</li>
<li>
<p>&#x5339;&#x914D;&#x975E;&#x64CD;&#x4F5C;&#xFF0C;&#x4F7F;&#x7528;^,&#x6BD4;&#x5982;[^123]&#x5C06;&#x4F1A;&#x5339;&#x914D;&#x975E;1,2,3&#x8FD9;&#x4E9B;&#x5B57;&#x7B26;&#x7684;&#x6570;&#x636E;</p>
</li>
<li>
<p>&#x5339;&#x914D;&#x8303;&#x56F4;,&#x53EF;&#x4EE5;&#x4F7F;&#x7528;[0-9A-Za-z]&#x7B49;&#x65B9;&#x5F0F;&#x4F7F;&#x7528;</p>
</li>
<li>
<p>&#x7279;&#x6B8A;&#x5B57;&#x7B26;&#x7684;&#x5339;&#x914D;
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x5339;&#x914D;&#x7279;&#x6B8A;&#x5B57;&#x7B26;,&#x5982;&#x679C;&#x60F3;&#x8981;&#x5728;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x4E2D;&#x5339;&#x914D;. | <span class="special">[</span> <span class="special">]</span>&#x8FD9;&#x4E9B;&#x6B63;&#x5219;&#x4E2D;&#x7279;&#x6B8A;&#x7684;&#x5B57;&#x7B26;,&#x90A3;&#x4E48;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x8F6C;&#x4E49;,&#x5728;Mysql&#x4E2D;&#x4F7F;&#x7528;<span class="command">\\</span>&#x8FDB;&#x884C;&#x8F6C;&#x4E49;,&#x6BD4;&#x5982;regexp &apos;<span class="command">\\</span>.&apos;,</span><br><span class="line">&#x5982;&#x679C;&#x9700;&#x8981;&#x5339;&#x914D;<span class="command">\&#x90A3;</span>&#x4E48;&#x5C31;&#x9700;&#x8981;&#x4F7F;&#x7528;<span class="command">\\</span>\</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>&#x5143;&#x5B57;&#x7B26;&#x7684;&#x5F15;&#x7528;
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">\\f</span>    &#x6362;&#x9875;</span><br><span class="line"><span class="string">\\n</span>    &#x6362;&#x884C;</span><br><span class="line"><span class="string">\\r</span>    &#x56DE;&#x8F66;</span><br><span class="line"><span class="string">\\t</span>    &#x5236;&#x8868;</span><br><span class="line"><span class="string">\\v</span>    &#x7EB5;&#x5411;&#x5236;&#x8868;</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>&#x5339;&#x914D;&#x5B57;&#x7B26;&#x7C7B;
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="list">[<span class="keyword">:alnum:</span>]   &#x4EFB;&#x610F;&#x5B57;&#x6BCD;&#x548C;&#x6570;&#x5B57;,<span class="list">(<span class="keyword">&#x540C;</span><span class="list">[<span class="keyword">a-zA-Z0-9</span>])</span><br><span class="line"><span class="list">[<span class="keyword">:alpha:</span>]   &#x4EFB;&#x610F;&#x5B57;&#x6BCD;<span class="list">(<span class="keyword">&#x540C;</span><span class="list">[<span class="keyword">a-aA-Z</span>])</span><br><span class="line"><span class="list">[<span class="keyword">:blank:</span>]   &#x7A7A;&#x683C;&#x548C;&#x5236;&#x8868;,<span class="list">(<span class="keyword">&#x540C;</span><span class="list">[\\t])</span><br><span class="line"><span class="list">[<span class="keyword">:cntrl:</span>]   ASCII&#x63A7;&#x5236;&#x5B57;&#x7B26;<span class="list">(<span class="keyword">ASCII</span> <span class="number">0</span>&#x5230;31&#x548C;127)</span></span><br><span class="line"><span class="list">[<span class="keyword">:digit:</span>]   &#x4EFB;&#x610F;&#x6570;&#x5B57;<span class="list">(<span class="keyword">&#x540C;</span><span class="list">[<span class="keyword">0-9</span>])</span><br><span class="line"><span class="list">[<span class="keyword">:graph:</span>]   &#x4E0E;<span class="list">[<span class="keyword">:print:</span>]&#x76F8;&#x540C;,&#x4F46;&#x4E0D;&#x5305;&#x542B;&#x7A7A;&#x683C;</span><br><span class="line"><span class="list">[<span class="keyword">:lower:</span>]   &#x4EFB;&#x610F;&#x5C0F;&#x5199;&#x5B57;&#x6BCD;,<span class="list">(<span class="keyword">&#x540C;</span><span class="list">[<span class="keyword">a-z</span>])</span><br><span class="line"><span class="list">[<span class="keyword">:print:</span>]   &#x4EFB;&#x610F;&#x53EF;&#x6253;&#x5370;&#x5B57;&#x7B26;</span><br><span class="line"><span class="list">[<span class="keyword">:punct:</span>]   &#x65E2;&#x4E0D;&#x5728;<span class="list">[<span class="keyword">:alpha:</span>]&#x53C8;&#x4E0D;&#x5728;<span class="list">[<span class="keyword">:cntrl:</span>]&#x4E2D;&#x7684;&#x4EFB;&#x610F;&#x5B57;&#x7B26;</span><br><span class="line"><span class="list">[<span class="keyword">:space:</span>]   &#x5305;&#x542B;&#x7A7A;&#x683C;&#x5728;&#x5185;&#x7684;&#x4EFB;&#x610F;&#x7A7A;&#x683C;&#x5B57;&#x7B26;<span class="list">(<span class="keyword">&#x540C;</span><span class="list">[\\f\\n\\r\\t\\v])</span><br><span class="line"><span class="list">[<span class="keyword">:upper:</span>]   &#x4EFB;&#x610F;&#x5927;&#x5199;&#x5B57;&#x6BCD;<span class="list">(<span class="keyword">&#x540C;</span><span class="list">[<span class="keyword">A-Z</span>])</span><br><span class="line"><span class="list">[<span class="keyword">:xdigit:</span>]  &#x4EFB;&#x610F;&#x5341;&#x516D;&#x8FDB;&#x5236;&#x6570;&#x5B57;<span class="list">(<span class="keyword">&#x540C;</span><span class="list">[<span class="keyword">a-fA-F0-9</span>])</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>&#x91CD;&#x590D;&#x5143;&#x5B57;&#x7B26;</p>
<p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">*       <span class="number">0</span>&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5339;&#x914D;</span><br><span class="line">+       <span class="number">1</span>&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5339;&#x914D;(&#x540C;{<span class="number">1</span>,})</span><br><span class="line">?       <span class="number">0</span>&#x4E2A;&#x6216;<span class="number">1</span>&#x4E2A;&#x5339;&#x914D;(&#x540C;{<span class="number">0</span>,<span class="number">1</span>})</span><br><span class="line">n       &#x6307;&#x5B9A;&#x6570;&#x76EE;&#x7684;&#x5339;&#x914D;</span><br><span class="line">{n,}    &#x4E0D;&#x5C11;&#x4E8E;&#x6307;&#x5B9A;&#x6570;&#x76EE;&#x7684;&#x5339;&#x914D;</span><br><span class="line">{n,m}   &#x5339;&#x914D;&#x6570;&#x76EE;&#x7684;&#x8303;&#x56F4;,m&#x4E0D;&#x8D85;&#x8FC7;<span class="number">255</span></span><br></pre></td></tr></table></figure></p>
<p>&#x4F8B;&#x5B50;&#xFF1A;
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#&#x5F97;&#x5230;&#x7684;&#x7B54;&#x6848;&#x4E3A;(1 stricks)&#x548C;tiny (5 strick)</span><br><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">name</span> <span class="keyword">from</span> table_name <span class="keyword">where</span> <span class="keyword">name</span> regext <span class="string">&apos;\\([1-9] stricks?\\)&apos;</span>;</span></span><br><span class="line"></span><br><span class="line">#&#x5339;&#x914D;&#x8FDE;&#x5728;&#x4E00;&#x8D77;&#x7684;&#x4EFB;&#x610F;&#x56DB;&#x4F4D;&#x6570;&#x5B57;: </span><br><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">name</span> <span class="keyword">from</span> table_name <span class="keyword">where</span> <span class="keyword">id</span> regext <span class="string">&apos;[[:digit:]]{4}&apos;</span>;</span></span><br></pre></td></tr></table></figure></p>
</li>
</ol>
<ol start="13">
<li>&#x4E3A;&#x4E86;&#x5339;&#x914D;&#x7279;&#x5B9A;&#x4F4D;&#x7F6E;&#x7684;&#x6587;&#x672C;,&#x9700;&#x8981;&#x4F7F;&#x7528;&#x5B9A;&#x4F4D;&#x7B26;
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#x5143;&#x5B57;&#x7B26;         &#x8BF4;&#x660E;</span><br><span class="line">^              &#x6587;&#x672C;&#x7684;&#x5F00;&#x59CB;</span><br><span class="line">$              &#x6587;&#x672C;&#x7684;&#x7ED3;&#x5C3E;</span><br><span class="line"><span class="string">[[:&lt;:]]</span>        &#x8BCD;&#x7684;&#x5F00;&#x59CB;</span><br><span class="line"><span class="string">[[:&gt;:]]</span>        &#x8BCD;&#x7684;&#x7ED3;&#x5C3E;</span><br><span class="line"></span><br><span class="line"><span class="built_in">select</span> <span class="string">&apos;.3abc&apos;</span> REGEXP <span class="string">&apos;^[0-9\\.]&apos;</span>&#x8FD4;&#x56DE;&#x7ED3;&#x679C;&#x4E3A;<span class="number">1</span>,&#x56E0;&#x4E3A;<span class="string">&apos;.3abc&apos;</span>&#x4E2D;&#x5305;&#x542B;&#x4E86;&#x4EE5;&#x6570;&#x5B57;&#x5F00;&#x5934;&#x7684;&#x6570;&#x636E;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>--Mysql&#x51FD;&#x6570;</p>
<ol>
<li>
<p>concat()&#x62FC;&#x63A5;&#x4E32;,&#x53C2;&#x6570;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x6216;&#x8005;&#x591A;&#x4E2A;&#x4E32;,&#x5404;&#x4E2A;&#x4E32;&#x4E4B;&#x95F4;&#x7528;&#x9017;&#x53F7;&#x95F4;&#x9694;</p>
</li>
<li>
<p>rtirm()&#x5220;&#x9664;&#x53F3;&#x8FB9;&#x7A7A;&#x683C;,ltrim()&#x5220;&#x9664;&#x5DE6;&#x8FB9;&#x7A7A;&#x683C;,trim&#x5220;&#x9664;&#x5DE6;&#x53F3;&#x4E24;&#x8FB9;&#x7A7A;&#x683C;</p>
</li>
<li>
<p>&#x5E38;&#x7528;&#x6587;&#x672C;&#x5904;&#x7406;&#x51FD;&#x6570;
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">Left</span><span class="params">()</span></span>              &#x8FD4;&#x56DE;&#x4E32;&#x5DE6;&#x8FB9;&#x7684;&#x5B57;&#x7B26;</span><br><span class="line"><span class="function"><span class="title">Length</span><span class="params">()</span></span>            &#x8FD4;&#x56DE;&#x4E32;&#x7684;&#x957F;&#x5EA6;</span><br><span class="line"><span class="function"><span class="title">Locate</span><span class="params">()</span></span>            &#x627E;&#x51FA;&#x4E32;&#x7684;&#x4E00;&#x4E2A;&#x5B50;&#x4E32;</span><br><span class="line"><span class="function"><span class="title">Lower</span><span class="params">()</span></span>             &#x5C06;&#x4E32;&#x8F6C;&#x6362;&#x6210;&#x4E3A;&#x5C0F;&#x5199;</span><br><span class="line"><span class="function"><span class="title">LTrim</span><span class="params">()</span></span>             &#x53BB;&#x6389;&#x5DE6;&#x8FB9;&#x7684;&#x7A7A;&#x683C;</span><br><span class="line"><span class="function"><span class="title">Right</span><span class="params">()</span></span>             &#x8FD4;&#x56DE;&#x4E32;&#x53F3;&#x8FB9;&#x7684;&#x5B57;&#x7B26;</span><br><span class="line"><span class="function"><span class="title">RTrim</span><span class="params">()</span></span>             &#x53BB;&#x6389;&#x53F3;&#x8FB9;&#x7684;&#x7A7A;&#x683C;</span><br><span class="line"><span class="function"><span class="title">SubString</span><span class="params">()</span></span>         &#x8FD4;&#x56DE;&#x5B50;&#x4E32;&#x7684;&#x5B57;&#x7B26;</span><br><span class="line"><span class="function"><span class="title">Upper</span><span class="params">()</span></span>             &#x5C06;&#x4E32;&#x8F6C;&#x6362;&#x6210;&#x5927;&#x5199;</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>&#x5E38;&#x7528;&#x65E5;&#x671F;&#x548C;&#x65F6;&#x95F4;&#x5904;&#x7406;&#x51FD;&#x6570;
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">AddDate</span><span class="params">()</span></span>           &#x589E;&#x52A0;&#x4E00;&#x4E2A;&#x65E5;&#x671F;(&#x5929;&#x3001;&#x5468;&#x7B49;)</span><br><span class="line"><span class="function"><span class="title">AddTime</span><span class="params">()</span></span>           &#x589E;&#x52A0;&#x4E00;&#x4E2A;&#x65F6;&#x95F4;(&#x65F6;&#x3001;&#x5206;&#x7B49;)</span><br><span class="line"><span class="function"><span class="title">CurDate</span><span class="params">()</span></span>           &#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x65E5;&#x671F;</span><br><span class="line"><span class="function"><span class="title">CurTime</span><span class="params">()</span></span>           &#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x65F6;&#x95F4;</span><br><span class="line"><span class="function"><span class="title">Date</span><span class="params">()</span></span>              &#x8FD4;&#x56DE;&#x65E5;&#x671F;&#x65F6;&#x95F4;&#x7684;&#x65E5;&#x671F;&#x90E8;&#x5206;</span><br><span class="line"><span class="function"><span class="title">DateDiff</span><span class="params">()</span></span>          &#x8BA1;&#x7B97;&#x4E24;&#x4E2A;&#x65E5;&#x671F;&#x4E4B;&#x5DEE;</span><br><span class="line"><span class="function"><span class="title">Date_Add</span><span class="params">()</span></span>          &#x9AD8;&#x5EA6;&#x7075;&#x6D3B;&#x7684;&#x65E5;&#x671F;&#x8FD0;&#x7B97;&#x51FD;&#x6570;</span><br><span class="line"><span class="function"><span class="title">Date_Format</span><span class="params">()</span></span>       &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x683C;&#x5F0F;&#x5316;&#x7684;&#x65E5;&#x671F;&#x6216;&#x8005;&#x5B57;&#x7B26;&#x4E32;</span><br><span class="line"><span class="function"><span class="title">Day</span><span class="params">()</span></span>               &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x65E5;&#x671F;&#x7684;&#x5929;&#x6570;&#x90E8;&#x5206;</span><br><span class="line"><span class="function"><span class="title">DayOfWeek</span><span class="params">()</span></span>         &#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x65E5;&#x671F;,&#x8FD4;&#x56DE;&#x5BF9;&#x5E94;&#x7684;&#x661F;&#x671F;&#x51E0;</span><br><span class="line"><span class="function"><span class="title">Hour</span><span class="params">()</span></span>              &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x65F6;&#x95F4;&#x7684;&#x5C0F;&#x65F6;&#x90E8;&#x5206;</span><br><span class="line"><span class="function"><span class="title">Minute</span><span class="params">()</span></span>            &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x65F6;&#x95F4;&#x7684;&#x5206;&#x949F;&#x90E8;&#x5206;</span><br><span class="line"><span class="function"><span class="title">Month</span><span class="params">()</span></span>             &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x65E5;&#x671F;&#x7684;&#x6708;&#x4EFD;&#x90E8;&#x5206;</span><br><span class="line"><span class="function"><span class="title">Now</span><span class="params">()</span></span>               &#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x65E5;&#x671F;&#x548C;&#x65F6;&#x95F4;</span><br><span class="line"><span class="function"><span class="title">Second</span><span class="params">()</span></span>            &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x65F6;&#x95F4;&#x7684;&#x79D2;&#x90E8;&#x5206;</span><br><span class="line"><span class="function"><span class="title">Time</span><span class="params">()</span></span>              &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x65E5;&#x671F;&#x65F6;&#x95F4;&#x7684;&#x65F6;&#x95F4;&#x90E8;&#x5206;</span><br><span class="line"><span class="function"><span class="title">Year</span><span class="params">()</span></span>              &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x65E5;&#x671F;&#x7684;&#x5E74;&#x4EFD;&#x90E8;&#x5206;</span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>&#x805A;&#x96C6;&#x51FD;&#x6570;
count(*)&#x5BF9;&#x8868;&#x4E2D;&#x884C;&#x7684;&#x6570;&#x76EE;&#x8FDB;&#x884C;&#x8BA1;&#x6570;,&#x4E0D;&#x7BA1;&#x8868;&#x5217;&#x4E2D;&#x5305;&#x542B;&#x7684;&#x662F;&#x7A7A;&#x503C;(NULL)&#x8FD8;&#x662F;&#x975E;&#x7A7A;&#x503C;
count(column)&#x5BF9;&#x7279;&#x5B9A;&#x5217;&#x4E2D;&#x5177;&#x6709;&#x503C;&#x7684;&#x884C;&#x8FDB;&#x884C;&#x8BA1;&#x6570;,&#x5FFD;&#x7565;NULL&#x503C;</p>
<p>Max()&#x4E00;&#x822C;&#x7528;&#x4E8E;&#x627E;&#x51FA;&#x6700;&#x5927;&#x7684;&#x6570;&#x503C;&#x6216;&#x8005;&#x65E5;&#x671F;&#x503C;,&#x4F46;&#x662F;&#x5728;&#x7528;&#x4E8E;&#x6587;&#x672C;&#x6570;&#x636E;&#x65F6;,&#x5982;&#x679C;&#x6570;&#x636E;&#x6309;&#x7167;&#x76F8;&#x5E94;&#x7684;&#x5217;&#x8FDB;&#x884C;&#x6392;&#x5E8F;,&#x5219;Max()&#x8FD4;&#x56DE;&#x6700;&#x540E;&#x4E00;&#x884C;&#x3002;
Max(),Min()&#x5747;&#x5FFD;&#x7565;&#x5217;&#x503C;&#x4E3A;NULL&#x7684;&#x884C;</p>
</li>
</ol>
<p>--&#x4F7F;&#x7528;group by</p>
<ol>
<li>
<p>group by &#x53EF;&#x4EE5;&#x5305;&#x542B;&#x4EFB;&#x610F;&#x5217;
&#x5982;&#x679C;&#x5728;group by &#x5B50;&#x53E5;&#x4E2D;&#x5D4C;&#x5957;&#x4E86;&#x5206;&#x7EC4;,&#x6570;&#x636E;&#x5C06;&#x5728;&#x6700;&#x540E;&#x89C4;&#x5B9A;&#x7684;&#x5206;&#x7EC4;&#x4E0A;&#x8FDB;&#x884C;&#x6C47;&#x603B;
group by&#x5B50;&#x53E5;&#x4E2D;&#x5217;&#x51FA;&#x7684;&#x6BCF;&#x4E2A;&#x5217;&#x90FD;&#x5FC5;&#x987B;&#x662F;&#x68C0;&#x7D22;&#x5217;&#x6216;&#x8005;&#x6709;&#x6548;&#x7684;&#x8868;&#x8FBE;&#x5F0F;(&#x4F46;&#x4E0D;&#x80FD;&#x662F;&#x805A;&#x96C6;&#x51FD;&#x6570;)
&#x9664;&#x6389;&#x805A;&#x96C6;&#x8BA1;&#x7B97;&#x8BED;&#x53E5;&#x5916;,select&#x8BED;&#x53E5;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x5217;&#x90FD;&#x5FC5;&#x987B;&#x5728;group by&#x5B50;&#x53E5;&#x4E2D;&#x7ED9;&#x51FA;
&#x5982;&#x679C;&#x5206;&#x7EC4;&#x5217;&#x4E2D;&#x5177;&#x6709;NULL&#x503C;,&#x5219;NULL&#x5C06;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x5206;&#x7EC4;&#x8FD4;&#x56DE;,&#x5982;&#x679C;&#x5217;&#x4E2D;&#x6709;&#x591A;&#x884C;NULL&#x503C;,&#x5B83;&#x4EEC;&#x5C06;&#x5206;&#x4E3A;&#x4E00;&#x7EC4;&#x3002;
group by&#x5B50;&#x53E5;&#x5FC5;&#x987B;&#x51FA;&#x73B0;&#x5728;where&#x4E4B;&#x540E;,order by &#x4E4B;&#x524D;</p>
</li>
<li>
<p>&#x4F7F;&#x7528;having&#x6765;&#x8FDB;&#x884C;&#x5BF9;&#x5206;&#x7EC4;&#x8FDB;&#x884C;&#x8FC7;&#x6EE4;,&#x4F8B;&#x5982;:
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">sum</span>(score) <span class="keyword">from</span> table_name <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">id</span> <span class="keyword">having</span> <span class="keyword">sum</span>(score) &gt; <span class="number">120</span>;</span></span><br></pre></td></tr></table></figure></p>
</li>
</ol>
<p>--having&#x548C;where&#x7684;&#x533A;&#x522B;</p>
<p>where&#x5728;&#x6570;&#x636E;&#x5206;&#x7EC4;&#x524D;&#x8FDB;&#x884C;&#x8FC7;&#x6EE4;,having&#x5728;&#x6570;&#x636E;&#x5206;&#x7EC4;&#x540E;&#x8FDB;&#x884C;&#x8FC7;&#x6EE4;</p>
<p>--&#x4F7F;&#x7528;&#x5B50;&#x67E5;&#x8BE2;</p>
<ol>
<li>
<p>&#x4F7F;&#x7528;&#x5B50;&#x67E5;&#x8BE2;&#x7684;&#x65F6;&#x5019;,&#x5FC5;&#x987B;&#x4FDD;&#x8BC1;select&#x8BED;&#x53E5;&#x4E0E;where&#x5B50;&#x53E5;&#x4E2D;&#x5B58;&#x5728;&#x76F8;&#x540C;&#x6570;&#x76EE;&#x7684;&#x5217;</p>
</li>
<li>
<p>ANSI SQL&#x89C4;&#x8303;&#x9996;&#x9009;inner join&#x8BED;&#x6CD5;</p>
</li>
<li>
<p>&#x81EA;&#x8FDE;&#x63A5;(&#x5C06;&#x4E00;&#x4E2A;&#x8868;&#x5F53;&#x505A;&#x4E24;&#x4E2A;&#x8868;&#x770B;)&#x7684;&#x4F7F;&#x7528;:
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">name</span> <span class="keyword">from</span> table_name <span class="keyword">where</span> <span class="keyword">id</span> = (<span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> table_name <span class="keyword">where</span> score &gt; <span class="number">60</span>);</span></span><br><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">name</span> <span class="keyword">from</span> table_name <span class="keyword">as</span> t1,table_name <span class="keyword">as</span> t2 <span class="keyword">where</span> t1.<span class="keyword">id</span> == t2.pid;</span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>MySQL&#x4E2D;&#x7684;&#x5404;&#x79CD;&#x8FDE;&#x63A5;
&#x5DE6;&#x5916;&#x8FDE;&#x63A5;&#x4E5F;&#x53EB;&#x5DE6;&#x8FDE;&#x63A5;&#xFF08;left outer join&#x4E5F;&#x53EF;&#x4EE5;&#x7B80;&#x5199;&#x4E3A;left join&#xFF09;
&#x663E;&#x793A;&#x5DE6;&#x8868;&#x7684;&#x6240;&#x6709;&#x6570;&#x636E;&#xFF0C;&#x7136;&#x540E;&#x6839;&#x636E;&#x6761;&#x4EF6;&#x4E0E;&#x53F3;&#x8868;&#x8FDB;&#x884C;&#x5339;&#x914D;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x5339;&#x914D;&#x7684;&#x5C31;&#x52A0;&#x5728;&#x5DE6;&#x8868;&#x7684;&#x540E;&#x9762;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x591A;&#x6761;&#x5339;&#x914D;&#x6570;&#x636E;&#xFF0C;&#x5219;&#x663E;&#x793A;&#x591A;&#x6761;&#x3002;
&#x6CA1;&#x6709;&#x7684;&#x8BDD;&#xFF0C;&#x8BE5;&#x884C;&#x7684;&#x53F3;&#x8868;&#x5C31;&#x4EE5;null&#x503C;&#x586B;&#x5145;&#x3002;</p>
<p>&#x53F3;&#x8FDE;&#x63A5;&#xFF08;right outerjoin &#x4E5F;&#x53EF;&#x4EE5;&#x7B80;&#x5199;&#x4E3A;right join&#xFF09;
&#x663E;&#x793A;&#x53F3;&#x8868;&#x7684;&#x6240;&#x6709;&#x6570;&#x636E;&#xFF0C;&#x7136;&#x540E;&#x6839;&#x636E;&#x6761;&#x4EF6;&#x4E0E;&#x5DE6;&#x8868;&#x5339;&#x914D;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x5339;&#x914D;&#x7684;&#x5C31;&#x52A0;&#x5728;&#x5DE6;&#x8868;&#x7684;&#x540E;&#x9762;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x591A;&#x6761;&#x5339;&#x914D;&#x6570;&#x636E;&#xFF0C;&#x5219;&#x663E;&#x793A;&#x591A;&#x6761;&#x3002;
&#x6CA1;&#x6709;&#x7684;&#x8BDD;&#xFF0C;&#x8BE5;&#x884C;&#x4EE5;null&#x503C;&#x586B;&#x5145;&#x3002;&#xFF08;&#x548C;&#x5DE6;&#x8FDE;&#x63A5;&#x7C7B;&#x4F3C;&#xFF09;</p>
<p>&#x4F55;&#x4E3A;&#x5DE6;&#x8868;&#x3001;&#x53F3;&#x8868;&#x5462; &#xFF1F;&#x5728;join&#x7684;&#x5DE6;&#x8FB9;&#x5C31;&#x79F0;&#x4E3A;&#x5DE6;&#x8868;&#xFF0C;&#x53F3;&#x8FB9;&#x5C31;&#x79F0;&#x4E3A;&#x53F3;&#x8868;</p>
</li>
</ol>
<p>--union&#x7684;&#x4F7F;&#x7528;</p>
<ol>
<li>
<p>&#x7EC4;&#x5408;&#x67E5;&#x8BE2;,&#x5229;&#x7528;union&#x53EF;&#x4EE5;&#x5C06;&#x591A;&#x6761;select&#x8BED;&#x53E5;&#x5C06;&#x5B83;&#x4EEC;&#x7684;&#x7ED3;&#x679C;&#x7EC4;&#x5408;&#x6210;&#x5F53;&#x4E2A;&#x7ED3;&#x679C;&#x96C6;,union&#x89C4;&#x5219;&#xFF1A;
union&#x5FC5;&#x987B;&#x7531;&#x4E24;&#x6761;&#x6216;&#x8005;&#x4E24;&#x6761;&#x4EE5;&#x4E0A;&#x7684;select&#x8BED;&#x53E5;&#x7EC4;&#x6210;,&#x8BED;&#x53E5;&#x4E4B;&#x95F4;&#x53EF;&#x4EE5;&#x7528;union&#x5206;&#x5272;
union&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x67E5;&#x8BE2;&#x5FC5;&#x987B;&#x5305;&#x542B;&#x76F8;&#x540C;&#x7684;&#x5217;&#x3001;&#x8868;&#x8FBE;&#x5F0F;&#x6216;&#x805A;&#x96C6;&#x51FD;&#x6570;(&#x4E0D;&#x8FC7;&#x5404;&#x4E2A;&#x5217;&#x4E0D;&#x9700;&#x8981;&#x4EE5;&#x76F8;&#x540C;&#x7684;&#x6B21;&#x5E8F;&#x8F93;&#x51FA;)
&#x5217;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x5FC5;&#x987B;&#x517C;&#x5BB9;&#xFF1A;&#x7C7B;&#x578B;&#x4E0D;&#x5FC5;&#x5B8C;&#x5168;&#x76F8;&#x540C;,&#x5F53;&#x5FC5;&#x987B;&#x662F;DBMS&#x53EF;&#x4EE5;&#x9690;&#x542B;&#x7684;&#x8F6C;&#x6362;&#x7684;&#x7C7B;&#x578B;(&#x4F8B;&#x5982;:&#x4E0D;&#x540C;&#x7684;&#x6570;&#x503C;&#x7C7B;&#x578B;&#x6216;&#x4E0D;&#x540C;&#x7684;&#x65E5;&#x671F;&#x7C7B;&#x578B;)</p>
</li>
<li>
<p>union&#x4F1A;&#x5C06;&#x8FD4;&#x56DE;&#x7684;&#x7ED3;&#x679C;&#x96C6;&#x4E2D;&#x91CD;&#x590D;&#x7684;&#x6570;&#x636E;&#x884C;&#x81EA;&#x52A8;&#x53D6;&#x6D88;(&#x5373;&#x53EA;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x884C;),&#x5982;&#x679C;&#x60F3;&#x5339;&#x914D;&#x6240;&#x6709;&#x8FD4;&#x56DE;&#x884C;,&#x8FD9;&#x9700;&#x8981;&#x4F7F;&#x7528;union all</p>
</li>
</ol>
<p>--&#x5168;&#x6587;&#x672C;&#x641C;&#x7D22;</p>
<ol>
<li>
<p>MyIsam&#x5F15;&#x64CE;&#x652F;&#x6301;&#x5168;&#x6587;&#x672C;&#x641C;&#x7D22;,InnoDB&#x4E0D;&#x652F;&#x6301;</p>
</li>
<li>
<p>&#x542F;&#x7528;&#x5168;&#x6587;&#x672C;&#x641C;&#x7D22;&#x652F;&#x6301;,&#x4E00;&#x822C;&#x5728;&#x521B;&#x5EFA;&#x8868;&#x7684;&#x65F6;&#x5019;&#x542F;&#x7528;&#x5168;&#x6587;&#x641C;&#x7D22;
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">create</span> <span class="keyword">table</span> tabl_name (</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span> auto_increment,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">200</span>) <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">default</span> <span class="string">&apos;&apos;</span>,</span><br><span class="line">    note_text <span class="built_in">text</span> <span class="literal">null</span>,</span><br><span class="line">    fulltext(note_text)</span><br><span class="line">)<span class="keyword">engine</span>=myisam</span></span><br></pre></td></tr></table></figure></p>
</li>
<li>
<p>&#x5728;&#x5BFC;&#x5165;&#x7684;&#x65F6;&#x5019;&#x4E0D;&#x8981;&#x4F7F;&#x7528;fulltext,&#x56E0;&#x4E3A;&#x4F1A;&#x7EF4;&#x62A4;&#x4E00;&#x4EFD;&#x7D22;&#x5F15;&#x5BFC;&#x81F4;&#x5BFC;&#x5165;&#x8FC7;&#x6162;</p>
</li>
<li>
<p>Match()&#x6307;&#x5B9A;&#x88AB;&#x641C;&#x7D22;&#x7684;&#x5217;,Against()&#x6307;&#x5B9A;&#x8981;&#x4F7F;&#x7528;&#x7684;&#x641C;&#x7D22;&#x8868;&#x8FBE;&#x5F0F;&#x4F7F;&#x7528;:select node_text from table_name where Match(node_text) against(&apos;rabbit&apos;);</p>
</li>
<li>
<p>&#x4F20;&#x9012;&#x7ED9;Match()&#x7684;&#x503C;&#x5FC5;&#x987B;&#x4E0E;FullText()&#x5B9A;&#x4E49;&#x7684;&#x76F8;&#x540C;,&#x5982;&#x679C;&#x6307;&#x5B9A;&#x591A;&#x4E2A;&#x5217;,&#x5219;&#x5FC5;&#x987B;&#x5217;&#x51FA;&#x4ED6;&#x4EEC;(&#x800C;&#x4E14;&#x6B21;&#x5E8F;&#x6B63;&#x786E;)</p>
</li>
<li>
<p>fullText&#x4E0D;&#x533A;&#x5206;&#x5927;&#x5C0F;&#x5199;,&#x9664;&#x975E;&#x4F7F;&#x7528;binary&#x5173;&#x952E;&#x5B57;</p>
</li>
<li>
<p>&#x4F7F;&#x7528;Like&#x4E5F;&#x80FD;&#x8FBE;&#x5230;&#x76F8;&#x540C;&#x7684;&#x60F3;&#x8FC7;,&#x4F46;&#x662F;&#x4F7F;&#x7528;FullText&#x4F1A;&#x5BF9;&#x8FD4;&#x56DE;&#x7684;&#x7ED3;&#x679C;&#x96C6;&#x8FDB;&#x884C;&#x6392;&#x5E8F;,&#x51FA;&#x73B0;&#x7684;&#x5173;&#x952E;&#x5B57;&#x5728;&#x524D;&#x9762;&#x7684;&#x53EF;&#x80FD;&#x4F1A;&#x6700;&#x5148;&#x8FD4;&#x56DE;,&#x5373;&#x5177;&#x6709;&#x9AD8;&#x4F18;&#x5148;&#x7EA7;&#x7684;&#x6700;&#x5148;&#x8FD4;&#x56DE;(&#x53EF;&#x80FD;&#x8FD9;&#x6B63;&#x662F;&#x4F60;&#x60F3;&#x8981;&#x7684;&#x884C;)</p>
</li>
<li></li>
</ol>
<p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#&#x5C06;&#x5176;&#x653E;&#x5728;<span class="operator"><span class="keyword">select</span>&#x4E2D;&#x5982;&#x679C;&#x6587;&#x672C;&#x4E2D;&#x5305;&#x62EC;rabbit&#x8FD4;&#x56DE;&#x7684;<span class="keyword">rank</span>&#x503C;&#x5C31;&#x5927;&#x4E8E;<span class="number">0</span>,&#x5426;&#x5219;&#x5C31;&#x4E3A;<span class="number">0</span>,&#x8FD9;&#x4E5F;&#x8BC1;&#x660E;&#x4E86;fullText&#x662F;&#x5982;&#x4F55;&#x6392;&#x9664;&#x884C;,&#x5982;&#x4F55;&#x6392;&#x5E8F;&#x7ED3;&#x679C;&#x7684;</span><br><span class="line"><span class="keyword">select</span> node_text&#xFF0C;<span class="keyword">Match</span>(node_text) against(<span class="string">&apos;rabbit&apos;</span>) <span class="keyword">as</span> <span class="keyword">rank</span> <span class="keyword">from</span> table_name;</span></span><br></pre></td></tr></table></figure></p>
<p>--&#x63D2;&#x5165;</p>
<ol>
<li>&#x4F7F;&#x7528;insert&#x7684;&#x65F6;&#x5019;&#x6700;&#x597D;&#x6307;&#x5B9A;&#x5217;</li>
<li>&#x5982;&#x679C;&#x8868;&#x7684;&#x5B9A;&#x4E49;&#x5141;&#x8BB8;,&#x5219;&#x53EF;&#x4EE5;&#x5728;insert&#x64CD;&#x4F5C;&#x4E2D;&#x7701;&#x7565;&#x67D0;&#x4E9B;&#x5217;,&#x7701;&#x7565;&#x7684;&#x5217;&#x5FC5;&#x987B;&#x6EE1;&#x8DB3;&#x4EE5;&#x4E0B;&#x67D0;&#x4E2A;&#x6761;&#x4EF6;&#x3002;
&#x8BE5;&#x5217;&#x5141;&#x8BB8;&#x4E3A;NULL&#x503C;(&#x65E0;&#x503C;&#x6216;&#x7A7A;&#x503C;)
&#x5728;&#x8868;&#x5B9A;&#x4E49;&#x4E2D;&#x7ED9;&#x51FA;&#x9ED8;&#x8BA4;&#x503C;&#xFF0C;&#x8FD9;&#x8868;&#x793A;&#x5982;&#x679C;&#x4E0D;&#x7ED9;&#x51FA;&#x503C;&#xFF0C;&#x5C06;&#x4F7F;&#x7528;&#x9ED8;&#x8BA4;&#x503C;
3.MySql&#x7ECF;&#x5E38;&#x88AB;&#x591A;&#x4E2A;&#x5BA2;&#x6237;&#x8BBF;&#x95EE;,&#x5BF9;&#x5904;&#x7406;&#x4EC0;&#x4E48;&#x8BF7;&#x6C42;&#x4EE5;&#x53CA;&#x7528;&#x4EC0;&#x4E48;&#x6B21;&#x5E8F;&#x7BA1;&#x7406;&#x662F;Mysql&#x7684;&#x4EFB;&#x52A1;,insert&#x64CD;&#x4F5C;&#x53EF;&#x80FD;&#x5F88;&#x8017;&#x65F6;(&#x7279;&#x522B;&#x662F;&#x6709;&#x5F88;&#x591A;&#x7D22;&#x5F15;&#x9700;&#x8981;&#x66F4;&#x65B0;&#x7684;&#x65F6;&#x5019;),&#x800C;&#x4E14;&#x4ED6;&#x53EF;&#x80FD;&#x964D;&#x4F4E;&#x7B49;&#x5F85;&#x5904;&#x7406;&#x7684;select&#x8BED;&#x53E5;&#x7684;&#x6027;&#x80FD;&#x3002;&#x5982;&#x679C;&#x6570;&#x636E;&#x68C0;&#x7D22;&#x662F;&#x91CD;&#x8981;&#x7684;(&#x901A;&#x5E38;&#x662F;&#x8FD9;&#x6837;),&#x5219;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5728;insert&#x548C;into&#x4E2D;&#x95F4;&#x6DFB;&#x52A0;&#x5173;&#x952E;&#x5B57;LOW_PRIORITY,&#x6307;&#x793A;Mysql&#x964D;&#x4F4E;insert&#x8BED;&#x53E5;&#x7684;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x3002;</li>
<li>&#x63D2;&#x5165;&#x591A;&#x6761;&#x6570;&#x636E;
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#&#x6B64;&#x4E3E;&#x53EF;&#x4EE5;&#x63D0;&#x9AD8;<span class="operator"><span class="keyword">insert</span>&#x7684;&#x6027;&#x80FD;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table_name(<span class="keyword">id</span>,<span class="keyword">name</span>) <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&apos;zhangsan&apos;</span>),(<span class="string">&apos;2&apos;</span>,<span class="string">&apos;lisi&apos;</span>);</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p>56.insert select&#x8BED;&#x6CD5;
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">insert</span> <span class="keyword">into</span> table_name(<span class="keyword">id</span>,<span class="keyword">name</span>) <span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">name</span> <span class="keyword">from</span> table_name2</span></span><br></pre></td></tr></table></figure></p>
<p>--&#x66F4;&#x65B0;&#x548C;&#x5220;&#x9664;</p>
<ol>
<li>
<p>&#x4F7F;&#x7528;update&#x7684;&#x65F6;&#x5019;&#x6700;&#x597D;&#x6307;&#x5B9A;&#x6761;&#x4EF6;,&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5B50;&#x67E5;&#x8BE2;</p>
</li>
<li>
<p>&#x5982;&#x679C;&#x7528;update&#x8BED;&#x53E5;&#x66F4;&#x65B0;&#x591A;&#x884C;,&#x5E76;&#x4E14;&#x5728;&#x66F4;&#x65B0;&#x7684;&#x65F6;&#x5019;&#x5176;&#x4E2D;&#x7684;&#x4E00;&#x884C;&#x6216;&#x8005;&#x591A;&#x884C;&#x51FA;&#x73B0;&#x9519;&#x8BEF;,&#x5219;&#x6574;&#x4E2A;update&#x64CD;&#x4F5C;&#x88AB;&#x53D6;&#x6D88;(&#x9519;&#x8BEF;&#x53D1;&#x751F;&#x524D;&#x66F4;&#x65B0;&#x7684;&#x6240;&#x6709;&#x884C;&#x4E3A;&#x88AB;&#x6062;&#x590D;&#x5230;&#x5B83;&#x4EEC;&#x539F;&#x6709;&#x7684;&#x503C;),&#x5982;&#x679C;&#x60F3;&#x5373;&#x4F7F;&#x53D1;&#x751F;&#x4E86;&#x9519;&#x8BEF;,&#x4E5F;&#x7EE7;&#x7EED;&#x8FDB;&#x884C;&#x66F4;&#x65B0;,&#x53EF;&#x4EE5;&#x4F7F;&#x7528;ignore&#x5173;&#x952E;&#x5B57;,&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;update ignore table_name</p>
</li>
<li>
<p>delete&#x5220;&#x9664;&#x7684;&#x662F;&#x8868;&#x7684;&#x884C;,&#x800C;&#x4E0D;&#x5305;&#x542B;&#x8868;&#x672C;&#x8EAB;</p>
</li>
<li>
<p>&#x5982;&#x679C;&#x60F3;&#x8981;&#x5FEB;&#x901F;&#x5220;&#x9664;&#x8868;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x6570;&#x636E;,&#x53EF;&#x4EE5;&#x4F7F;&#x7528;truncate table&#x8BED;&#x53E5;,&#x5B83;&#x5B8C;&#x6210;&#x76F8;&#x540C;&#x7684;&#x5DE5;&#x4F5C;,&#x4F46;&#x662F;&#x5B83;&#x66F4;&#x5FEB;(truncate&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x5220;&#x9664;&#x539F;&#x6765;&#x7684;&#x8868;&#x5E76;&#x91CD;&#x65B0;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;&#x8868;,&#x800C;&#x4E0D;&#x662F;&#x9010;&#x884C;&#x5220;&#x9664;&#x8868;&#x4E2D;&#x7684;&#x6570;&#x636E;)</p>
</li>
</ol>
<p>--&#x521B;&#x5EFA;&#x548C;&#x64CD;&#x7EB5;&#x8868;</p>
<ol>
<li>
<p>&#x5982;&#x679C;&#x4F60;&#x4EC5;&#x4EC5;&#x73B0;&#x5728;&#x4E00;&#x4E2A;&#x8868;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x65F6;&#x5019;&#x521B;&#x5EFA;&#x5B83;,&#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;create table table_name if not exists &#x8BED;&#x53E5;</p>
</li>
<li>
<p>mysql&#x4E0D;&#x5141;&#x8BB8;&#x4F7F;&#x7528;&#x51FD;&#x6570;&#x4F5C;&#x4E3A;&#x5217;&#x7684;&#x9ED8;&#x8BA4;&#x503C;,&#x5B83;&#x53EA;&#x652F;&#x6301;&#x5E38;&#x91CF;</p>
</li>
<li>
<p>&#x5E38;&#x7528;&#x5F15;&#x64CE;
InnoDB&#x662F;&#x4E00;&#x4E2A;&#x53EF;&#x9760;&#x7684;&#x4E8B;&#x52A1;&#x5904;&#x7406;&#x5F15;&#x64CE;&#xFF0C;&#x5B83;&#x4E0D;&#x652F;&#x6301;&#x5168;&#x6587;&#x641C;&#x7D22;
MyIsam&#x662F;&#x4E00;&#x4E2A;&#x6027;&#x80FD;&#x6781;&#x9AD8;&#x7684;&#x5F15;&#x64CE;,&#x5B83;&#x652F;&#x6301;&#x5168;&#x6587;&#x641C;&#x7D22;
Memory&#x5728;&#x529F;&#x80FD;&#x4E0A;&#x7B49;&#x540C;&#x4E8E;MyIsam,&#x4F46;&#x662F;&#x7531;&#x4E8E;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x5728;&#x5185;&#x5B58;&#x4E2D;,&#x901F;&#x5EA6;&#x5F88;&#x5FEB;(&#x7279;&#x522B;&#x9002;&#x5408;&#x4E8E;&#x4E34;&#x65F6;&#x8868;)</p>
</li>
<li>
<p>&#x5F15;&#x64CE;&#x7C7B;&#x578B;&#x53EF;&#x4EE5;&#x4E92;&#x7528;,&#x4F46;&#x662F;&#x5916;&#x952E;&#x4E0D;&#x80FD;&#x8DE8;&#x5F15;&#x64CE;</p>
</li>
<li>
<p>alter table&#x7528;&#x4E8E;&#x66F4;&#x6539;&#x8868;&#x7ED3;&#x6784;,&#x5FC5;&#x987B;&#x7ED9;&#x51FA;&#x4EE5;&#x4E0B;&#x4FE1;&#x606F;:
&#x5728;alter table&#x4E4B;&#x540E;&#x5FC5;&#x987B;&#x8981;&#x7ED9;&#x51FA;&#x8981;&#x66F4;&#x6539;&#x7684;&#x8868;&#x540D;(&#x8BE5;&#x8868;&#x5FC5;&#x987B;&#x5B58;&#x5728;,&#x5426;&#x5219;&#x5C06;&#x51FA;&#x9519;)
&#x6240;&#x505A;&#x66F4;&#x6539;&#x7684;&#x5217;&#x8868;</p>
</li>
<li>
<p>&#x5220;&#x9664;&#x8868;:<figure class="highlight"><figcaption><span>table table_name;```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7. &#x91CD;&#x547D;&#x540D;&#x8868;:```rename table table_name1 to table_name2;</span><br></pre></td></tr></table></figure></p>
<p>&#x91CD;&#x547D;&#x540D;&#x591A;&#x4E2A;&#x8868;:<code>rename table table1 to table2,table3 to table4;</code></p>
</li>
</ol>
<p>--&#x89C6;&#x56FE;&#x7684;&#x4F7F;&#x7528;
Mysql5&#x4E4B;&#x540E;&#x624D;&#x6709;&#x89C6;&#x56FE;</p>
]]></content>
    <summary type="html">
    <![CDATA[重温一下MySQL,最近看了MySQL必知必会这本书,对书上一些以前模糊的地方做了一下笔记。]]>
    
    </summary>
    
      <category term="mysql" scheme="http://yoursite.com/tags/mysql/"/>
    
      <category term="mysql" scheme="http://yoursite.com/categories/mysql/"/>
    
  </entry>
  
</feed>
